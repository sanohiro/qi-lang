# Tutorial: Getting Started with Qi

This tutorial will teach you from project creation to execution through hands-on practice.

> **ðŸ“š New to Lisp-family languages?**
> Qi is a **Lisp-family language**. If you're not familiar with parentheses syntax, please check this first:
> âž¡ï¸ **[Lisp Language Basics](00-lisp-basics.md)** - How to read parentheses and basic concepts (5-minute read)

## Table of Contents

- [Environment Check](#environment-check)
- [Your First Project](#your-first-project)
- [Writing Code](#writing-code)
- [Creating an HTTP Server](#creating-an-http-server)
- [Try the REPL](#try-the-repl)
- [Next Steps](#next-steps)
---

## Environment Check

First, let's verify that Qi is properly installed.

```bash
qi --version
```

If version information is displayed, you're good to go.

```
Qi Programming Language v0.1.0
```

Let's also check the help:

```bash
qi --help
```

---

## Your First Project

### Creating a Project

Use the `qi new` command to create a new project.

```bash
qi new hello-qi
```

You'll be asked a few questions. Press Enter to use default values.

```
Creating new Qi project

Project name [hello-qi]:
Version [0.1.0]:
Description (optional): My first Qi project
Author (optional): Your Name
License [MIT]:

New Qi project created: hello-qi

Next steps:
  cd hello-qi
  qi main.qi
```

### Project Structure

Let's check the created project:

```bash
cd hello-qi
ls -la
```

The following files and directories have been created:

```
hello-qi/
â”œâ”€â”€ qi.toml         # Project configuration
â”œâ”€â”€ main.qi         # Main file
â”œâ”€â”€ src/            # Library code
â”‚   â””â”€â”€ lib.qi
â”œâ”€â”€ examples/       # Sample code
â”‚   â””â”€â”€ example.qi
â””â”€â”€ tests/          # Test code
    â””â”€â”€ test.qi
```

### Examining qi.toml

Let's open the project configuration file:

```bash
cat qi.toml
```

```toml
[project]
name = "hello-qi"
version = "0.1.0"
description = "My first Qi project"
authors = ["Your Name"]
license = "MIT"
qi-version = "0.1.0"

[dependencies]

[features]
default = []
```

This is the project metadata. You can edit it as needed.

### Running It

Let's run it right away:

```bash
qi main.qi
```

Output:
```
Hello, Qi!
ã“ã‚“ã«ã¡ã¯ã€hello-qiã•ã‚“ï¼
Vector([Integer(16), Integer(25)])
```

Success! The sample code generated by the template has been executed.

---

## Writing Code

### Editing main.qi

Open `main.qi` and check the contents:

```qi
;; main.qi - Entry point

(println "Hello, Qi!")

;; Greeting function
(defn greet [name]
  (str "ã“ã‚“ã«ã¡ã¯ã€" name "ã•ã‚“ï¼"))

;; Using the function
(println (greet "hello-qi"))

;; Pipeline example
(println ([1 2 3 4 5]
          |> (map (fn [x] (* x x)))
          |> (filter (fn [x] (> x 10)))))
```

### Adding Your Own Code

Try adding the following to the end of the file:

```qi
;; My own code
(println "\n=== My Own Code ===")

;; Filter even numbers and sum
(def numbers [1 2 3 4 5 6 7 8 9 10])
(def sum-of-evens
  (numbers
   |> (filter (fn [x] (= (% x 2) 0)))
   |> (reduce + 0)))

(println f"Sum of evens: {sum-of-evens}")

;; Map data processing
(def users [
  {:name "Alice" :age 30}
  {:name "Bob" :age 25}
  {:name "Charlie" :age 35}
])

(def adult-names
  (users
   |> (filter (fn [u] (>= (get u :age) 30)))
   |> (map (fn [u] (get u :name)))))

(println f"Age 30+: {adult-names}")
```

Run it:

```bash
qi main.qi
```

Output:
```
...
=== My Own Code ===
Sum of evens: 30
Age 30+: Vector([String("Alice"), String("Charlie")])
```

### Experience Qi's Features

**Pipeline operator `|>`**:
```qi
[1 2 3 4 5]
|> (map (fn [x] (* x 2)))
|> (filter (fn [x] (> x 5)))
|> (reduce + 0)
```

You can write it as if data flows from left to right!

---

## Creating an HTTP Server

Next, let's create an HTTP server.

### Creating the Project

Use the `http-server` template:

```bash
cd ..
qi new myapi --template http-server
cd myapi
```

### Checking the Structure

```bash
cat qi.toml
```

Note the `[features]`:
```toml
[features]
default = ["http-server", "format-json"]
```

HTTP and JSON features are enabled.

### Viewing the Server Code

```bash
cat main.qi
```

```qi
;; myapi - HTTP Server
;;
;; JSON API server
;; Run: qi main.qi

(println "=== myapi HTTP Server ===")

;; Root handler
(defn handle-root [req]
  (server/json {:message "Welcome to myapi!"
                :version "0.1.0"
                :endpoints ["/api/hello" "/api/users"]}))

;; Hello API handler
(defn handle-hello [req]
  (let [name (get (get req :params) "name" "World")]
    (server/json {:message (str "Hello, " name "!")})))

;; Users API handler
(defn handle-users [req]
  (server/json {:users [{:id 1 :name "Alice"}
                        {:id 2 :name "Bob"}
                        {:id 3 :name "Charlie"}]}))

;; Main handler (routing)
(defn handler [req]
  (let [path (get req :path)]
    (match path
      "/" -> (handle-root req)
      "/api/hello" -> (handle-hello req)
      "/api/users" -> (handle-users req)
      _ -> (server/json {:error "Not Found"} 404))))

;; Start server
(def port 3000)
(println f"Starting server on http://localhost:{port}")
(println "Press Ctrl+C to stop")

(server/serve port handler)
```

### Starting the Server

```bash
qi main.qi
```

Output:
```
=== myapi HTTP Server ===
Starting server on http://localhost:3000
Press Ctrl+C to stop
Listening on http://0.0.0.0:3000
```

### Testing the API

In another terminal:

```bash
# Root
curl http://localhost:3000/

# Hello API
curl http://localhost:3000/api/hello
curl http://localhost:3000/api/hello?name=Alice

# Users API
curl http://localhost:3000/api/users
```

### Customizing

Let's add a new endpoint to `main.qi`:

```qi
;; Status API handler (added)
(defn handle-status [req]
  (server/json {:status "ok"
                :uptime 123
                :version "0.1.0"}))

;; Add to handler
(defn handler [req]
  (let [path (get req :path)]
    (match path
      "/" -> (handle-root req)
      "/api/hello" -> (handle-hello req)
      "/api/users" -> (handle-users req)
      "/api/status" -> (handle-status req)  ; Added
      _ -> (server/json {:error "Not Found"} 404))))
```

Restart the server (stop with Ctrl+C and re-run) and test:

```bash
curl http://localhost:3000/api/status
```

---

## Try the REPL

### Starting the REPL

```bash
qi
```

```
Qi Programming Language v0.1.0
Press Ctrl+C to interrupt, Ctrl+D to exit
Type :help for available commands

qi:1>
```

### Basic Calculations

```qi
qi:1> (+ 1 2 3)
6

qi:2> (* 2 (+ 3 4))
14

qi:3> (/ 10 3)
3
```

### Defining Variables and Functions

```qi
qi:4> (def x 10)
10

qi:5> (defn square [n] (* n n))
Function(square)

qi:6> (square x)
100
```

### Trying Pipelines

```qi
qi:7> ([1 2 3 4 5] |> (map (fn [x] (* x 2))))
Vector([Integer(2), Integer(4), Integer(6), Integer(8), Integer(10)])

qi:8> ([1 2 3 4 5]
        |> (map (fn [x] (* x 2)))
        |> (filter (fn [x] (> x 5)))
        |> (reduce + 0))
30
```

### REPL Commands

```qi
qi:9> :help
Available commands:
  :help                    Show help
  :doc <name>              Show documentation for a function
  :vars                    Show defined variables
  ...

qi:10> :vars
Defined variables:
  x

qi:11> :funcs
Defined functions:
  square

qi:12> :doc map
(Documentation will be displayed)
```

### Loading Files

```qi
qi:13> :load src/lib.qi
Loading src/lib.qi...
Loaded

qi:14> (greet "REPL")
"ã“ã‚“ã«ã¡ã¯ã€REPLã•ã‚“ï¼"
```

---

## Next Steps

Congratulations! You've now mastered the basics of using Qi.

### Learn More

- **[Language Specification](../spec/README.md)** - Learn all Qi language features
  - [Pipeline Operators](../spec/02-flow-pipes.md) - `|>`, `|>?`, `||>`, `~>`
  - [Concurrency and Parallelism](../spec/03-concurrency.md) - `go`, `chan`
  - [Pattern Matching](../spec/04-match.md) - `match` expressions
  - [Error Handling](../spec/08-error-handling.md) - `try`, `defer`

- **[Standard Library](../spec/10-stdlib-string.md)** - 60+ built-in functions
  - String manipulation
  - HTTP client/server
  - JSON/YAML processing
  - File I/O

- **[CLI Reference](../cli.md)** - Details of the `qi` command

- **[Project Management](../project.md)** - qi.toml, templates, customization

### Project Ideas

- **CLI Tools**: File processing, data transformation
- **Web APIs**: RESTful APIs, microservices
- **Data Pipelines**: Log analysis, ETL processing
- **Automation Scripts**: Task automation, batch processing

### Community

- [GitHub Repository](https://github.com/sanohiro/qi-lang) - Issue reports and PRs welcome!
- Documentation improvement suggestions are also very welcome

---

Happy coding with Qi! ðŸš€
