{"config":{"lang":["en","ja"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Qi - A Lisp that flows","text":"<p>\u65e5\u672c\u8a9e | English</p> <p> </p> <p>A simple Lisp-based programming language for designing data flow. Strong support for pipelines, pattern matching, and concurrency.</p>"},{"location":"#development-status","title":"\u26a0\ufe0f Development Status","text":"<p>This project is under active development (Pre-1.0)</p> <ul> <li>Breaking changes occur frequently</li> <li>APIs and interfaces may change without notice</li> <li>Not recommended for production use</li> <li>Many features remain untested</li> </ul> <p>Current development stage: Alpha / Experimental</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Pipelines: Express data flow intuitively with <code>|&gt;</code> <code>|&gt;?</code> <code>||&gt;</code> <code>~&gt;</code></li> <li>Pattern Matching: Unified branching and transformation with powerful <code>match</code> expressions</li> <li>Concurrency &amp; Parallelism: Goroutine-style concurrency with channels and parallel pipelines</li> <li>Web Development: JSON/HTTP support with Railway Pipeline for error handling</li> <li>Authentication &amp; Authorization: JWT authentication, Argon2 password hashing, auth middleware</li> <li>Databases: PostgreSQL/MySQL/SQLite support (unified interface)</li> <li>KVS: Redis support (unified interface, Memcached/InMemory support planned)</li> <li>Debugging: Trace, breakpoints, stack traces (VSCode debugger support)</li> <li>F-strings: String interpolation and multi-line strings (<code>\"\"\"...\"\"\"</code>)</li> <li>i18n: English/Japanese error messages (<code>QI_LANG=ja</code>)</li> </ul>"},{"location":"#hello-world","title":"Hello World","text":"<pre><code>(defn greet [name]\n  f\"Hello, {name}!\")\n\n(println (greet \"World\"))\n;; =&gt; Hello, World!\n</code></pre>"},{"location":"#pipeline-examples","title":"Pipeline Examples","text":""},{"location":"#basic-pipeline","title":"Basic Pipeline","text":"<pre><code>;; Filter and transform numbers\n([1 2 3 4 5 6 7 8 9 10]\n |&gt; (filter (fn [x] (&gt; x 5)))\n |&gt; (map (fn [x] (* x 2)))\n |&gt; (reduce + 0))\n;; =&gt; 90\n\n;; String processing\n(\"hello world\"\n |&gt; str/upper\n |&gt; str/reverse)\n;; =&gt; \"DLROW OLLEH\"\n</code></pre>"},{"location":"#railway-pipeline-error-handling","title":"Railway Pipeline - Error Handling","text":"<pre><code>;; Everything except {:error} is treated as success (no :ok wrapping!)\n(defn validate-positive [x]\n  (if (&gt; x 0)\n    x                          ;; Plain value \u2192 success\n    {:error \"Must be positive\"}))\n\n(defn double [x]\n  (* x 2))                     ;; Plain value \u2192 success\n\n(defn format-result [x]\n  f\"Result: {x}\")              ;; Plain value \u2192 success\n\n;; Success case - values flow through\n(10\n |&gt;? validate-positive\n |&gt;? double\n |&gt;? format-result)\n;; =&gt; \"Result: 20\"\n\n;; Error case - errors propagate automatically\n(-5\n |&gt;? validate-positive\n |&gt;? double                    ;; Not executed (short-circuit)\n |&gt;? format-result)            ;; Not executed\n;; =&gt; {:error \"Must be positive\"}\n</code></pre>"},{"location":"#parallel-pipeline","title":"Parallel Pipeline","text":"<pre><code>;; ||&gt; executes multiple operations in parallel\n([1 2 3 4 5]\n ||&gt; (fn [x] (* x 2))\n ||&gt; (fn [x] (+ x 10))\n ||&gt; (fn [x] (* x x)))\n;; =&gt; [144, 196, 256, 324, 400]\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code># If Rust is installed\ncargo install --path .\n\n# Or\ncargo build --release\n</code></pre>"},{"location":"#upgrade","title":"Upgrade","text":"<pre><code># Upgrade to the latest version\nqi --upgrade\n</code></pre> <p>Qi can automatically upgrade itself to the latest release from GitHub. No need to manually build or install.</p>"},{"location":"#create-a-project","title":"Create a Project","text":"<pre><code># Basic project\nqi new my-project\ncd my-project\nqi main.qi\n\n# HTTP server project\nqi new myapi --template http-server\ncd myapi\nqi main.qi\n</code></pre>"},{"location":"#available-templates","title":"Available Templates","text":"<pre><code>qi template list\nqi template info http-server\n</code></pre>"},{"location":"#repl-interactive-environment","title":"REPL (Interactive Environment)","text":"<pre><code>qi\n\n# Inside REPL\nqi:1&gt; (+ 1 2 3)\n6\n\nqi:2&gt; ([1 2 3 4 5] |&gt; (map (fn [x] (* x 2))))\nVector([Integer(2), Integer(4), Integer(6), Integer(8), Integer(10)])\n</code></pre>"},{"location":"#other-commands","title":"Other Commands","text":"<pre><code># Execute script file\nqi script.qi\n\n# One-liner execution\nqi -e '(+ 1 2 3)'\n\n# Process piped input (automatically stored in stdin variable)\ncat data.csv | qi -e '(stdin |&gt; (map str/trim) |&gt; (filter (fn [x] (&gt; (len x) 0))))'\nls -l | qi -e '(count stdin)'\n\n# Show help\nqi --help\n</code></pre>"},{"location":"#initialization-file-qiinitqi","title":"Initialization File (.qi/init.qi)","text":"<p>During REPL and one-liner execution, initialization files are automatically loaded in the following order:</p> <pre><code># 1. User global settings (priority)\n~/.qi/init.qi\n\n# 2. Project local settings\n./.qi/init.qi\n</code></pre> <p>You can preload commonly used libraries or define convenience functions in initialization files:</p> <pre><code>;; Example ~/.qi/init.qi\n;; Preload table processing library\n(use \"std/lib/table\" :as table)\n\n;; Debug function\n(defn dbg [x]\n  (do (println (str \"DEBUG: \" x))\n      x))\n</code></pre>"},{"location":"#editor-extensions","title":"Editor Extensions","text":""},{"location":"#visual-studio-code","title":"Visual Studio Code","text":"<p>Official VSCode extension is available:</p> <ul> <li>Repository: qi-vscode</li> <li>Features:</li> <li>Syntax highlighting</li> <li>Code snippets</li> <li>Bracket matching</li> </ul> <p>See the qi-vscode repository for installation instructions and details.</p>"},{"location":"#testing","title":"Testing","text":""},{"location":"#unit-tests-fast","title":"Unit Tests (Fast)","text":"<pre><code># Normal tests (without Docker)\ncargo test\n\n# Test specific modules\ncargo test parser\ncargo test eval\n</code></pre>"},{"location":"#integration-tests-auto-docker","title":"Integration Tests (Auto Docker)","text":"<p>Integration tests for PostgreSQL, MySQL, and Redis automatically start and clean up Docker containers using testcontainers.</p> <p>Prerequisites: Docker must be installed.</p> <pre><code># Run integration tests (PostgreSQL + MySQL + Redis)\ncargo test --features integration-tests\n\n# Individual execution\ncargo test --features integration-tests --test integration_postgres\ncargo test --features integration-tests --test integration_mysql\ncargo test --features integration-tests --test integration_redis\n</code></pre> <p>Behavior: - Containers automatically start at test startup (ports auto-assigned) - Containers automatically removed after tests - Images remain for faster subsequent test runs</p>"},{"location":"#links","title":"Links","text":"<ul> <li>GitHub Repository: qi-lang</li> <li>VSCode Extension: qi-vscode</li> </ul>"},{"location":"#documentation","title":"Documentation","text":""},{"location":"#getting-started","title":"Getting Started","text":"<ul> <li>Lisp Basics \ud83d\udcda For Lisp beginners - How to read parentheses (5 min)</li> <li>Tutorial \u2b50 For beginners - Getting started with Qi</li> <li>CLI Reference - How to use the <code>qi</code> command</li> <li>Project Management - qi.toml, templates, customization</li> </ul>"},{"location":"#language-reference","title":"Language Reference","text":"<ul> <li>Language Specification - Complete Qi specification and reference</li> <li>Pipeline Operators - <code>|&gt;</code>, <code>|&gt;?</code>, <code>||&gt;</code>, <code>~&gt;</code></li> <li>Concurrency &amp; Parallelism - <code>go</code>, <code>chan</code></li> <li>Pattern Matching - <code>match</code> expressions</li> <li>Error Handling - <code>try</code>, <code>defer</code></li> <li>Standard Library - 60+ built-in functions</li> </ul>"},{"location":"#license","title":"License","text":"<p>Dual-licensed under MIT OR Apache-2.0. Choose whichever you prefer.</p> <ul> <li>LICENSE-MIT - MIT License</li> <li>LICENSE-APACHE - Apache License 2.0</li> </ul> <p>See each license file for details.</p>"},{"location":"cli/","title":"Qi CLI Reference","text":"<p>Complete reference for the Qi command-line tool.</p>"},{"location":"cli/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Basic Usage</li> <li>Command List</li> <li>Project Management</li> <li>Code Execution</li> <li>REPL</li> <li>Environment Variables</li> <li>Exit Codes</li> </ul>"},{"location":"cli/#basic-usage","title":"Basic Usage","text":"<pre><code>qi [OPTIONS] [FILE]\n</code></pre> <p>Starting without arguments launches REPL mode.</p>"},{"location":"cli/#command-list","title":"Command List","text":""},{"location":"cli/#project-management","title":"Project Management","text":""},{"location":"cli/#qi-new-name-options","title":"<code>qi new &lt;name&gt; [OPTIONS]</code>","text":"<p>Creates a new Qi project.</p> <p>Arguments: - <code>&lt;name&gt;</code> - Project name (directory name)</p> <p>Options: - <code>-t, --template &lt;template&gt;</code> - Template to use (default: <code>basic</code>)</p> <p>Examples: <pre><code># Create a basic project\nqi new my-project\n\n# Create an HTTP server project\nqi new myapi --template http-server\nqi new myapi -t http-server\n</code></pre></p> <p>Behavior: 1. Creates project directory 2. Interactively prompts for project metadata (name, version, description, author, license) 3. Copies files from template 4. Generates <code>qi.toml</code></p>"},{"location":"cli/#qi-template-list","title":"<code>qi template list</code>","text":"<p>Displays a list of available templates.</p> <p>Examples: <pre><code>qi template list\n</code></pre></p> <p>Sample Output: <pre><code>Available templates:\n  basic            - Basic project structure\n  http-server      - JSON API server with routing\n</code></pre></p>"},{"location":"cli/#qi-template-info-name","title":"<code>qi template info &lt;name&gt;</code>","text":"<p>Displays detailed information about a template.</p> <p>Arguments: - <code>&lt;name&gt;</code> - Template name</p> <p>Examples: <pre><code>qi template info http-server\n</code></pre></p> <p>Sample Output: <pre><code>Template: http-server\nDescription: JSON API server with routing\nAuthor: Qi Team\nVersion: 0.1.0\nRequired features: http-server, format-json\nLocation: std/templates/http-server\n</code></pre></p>"},{"location":"cli/#code-execution","title":"Code Execution","text":""},{"location":"cli/#qi-file","title":"<code>qi &lt;file&gt;</code>","text":"<p>Executes a Qi script file.</p> <p>Arguments: - <code>&lt;file&gt;</code> - Script file to execute (<code>.qi</code>)</p> <p>Examples: <pre><code>qi script.qi\nqi main.qi\nqi examples/example.qi\n</code></pre></p>"},{"location":"cli/#qi-e-code-qi-c-code","title":"<code>qi -e &lt;code&gt;</code> / <code>qi -c &lt;code&gt;</code>","text":"<p>Executes code directly (one-liner).</p> <p>Options: - <code>-e, -c &lt;code&gt;</code> - Qi code to execute</p> <p>Automatic stdin Binding:</p> <p>When input is provided via pipe, it is automatically stored in the <code>stdin</code> variable as a vector of strings:</p> <pre><code># Count lines\ncat data.txt | qi -e '(count stdin)'\n\n# Process CSV data (exclude empty lines)\ncat users.csv | qi -e '(stdin |&gt; (filter (fn [x] (&gt; (len x) 0))))'\n\n# Exclude empty lines and convert to uppercase\necho -e \"hello\\n\\nworld\" | qi -e '(stdin |&gt; (filter (fn [x] (&gt; (len x) 0))) |&gt; (map str/upper))'\n</code></pre> <p>Examples: <pre><code>qi -e '(+ 1 2 3)'\n# =&gt; 6\n\nqi -e '(println \"Hello, Qi!\")'\n# =&gt; Hello, Qi!\n\nqi -c '([1 2 3 4 5] |&gt; (map (fn [x] (* x 2))) |&gt; (reduce + 0))'\n# =&gt; 30\n</code></pre></p>"},{"location":"cli/#qi-","title":"<code>qi -</code>","text":"<p>Reads and executes code from stdin.</p> <p>Examples: <pre><code>echo '(println 42)' | qi -\n\ncat script.qi | qi -\n</code></pre></p>"},{"location":"cli/#repl","title":"REPL","text":""},{"location":"cli/#qi-no-arguments","title":"<code>qi</code> (no arguments)","text":"<p>Launches the interactive REPL.</p> <p>Examples: <pre><code>qi\n</code></pre></p> <p>REPL Commands: - <code>:help</code> - Display help - <code>:doc &lt;name&gt;</code> - Display function documentation - <code>:vars</code> - Display defined variables - <code>:funcs</code> - Display defined functions - <code>:builtins [filter]</code> - Display built-in functions (filterable) - <code>:clear</code> - Clear environment - <code>:load &lt;file&gt;</code> - Load a file - <code>:reload</code> - Reload the last loaded file - <code>:quit</code> - Exit REPL</p> <p>Features: - Tab completion (function names, variable names, REPL commands) - History (saved in <code>~/.qi_history</code>) - Multi-line input (automatic parenthesis balance detection) - Ctrl+C to cancel input - Ctrl+D or <code>:quit</code> to exit</p>"},{"location":"cli/#qi-l-file-qi-load-file","title":"<code>qi -l &lt;file&gt;</code> / <code>qi --load &lt;file&gt;</code>","text":"<p>Loads a file and then launches the REPL.</p> <p>Options: - <code>-l, --load &lt;file&gt;</code> - File to load</p> <p>Examples: <pre><code>qi -l utils.qi\nqi --load lib.qi\n</code></pre></p>"},{"location":"cli/#other-options","title":"Other Options","text":""},{"location":"cli/#qi-h-qi-help","title":"<code>qi -h</code> / <code>qi --help</code>","text":"<p>Displays help message.</p> <pre><code>qi --help\nqi -h\n</code></pre>"},{"location":"cli/#qi-v-qi-version","title":"<code>qi -v</code> / <code>qi --version</code>","text":"<p>Displays version information.</p> <pre><code>qi --version\nqi -v\n</code></pre>"},{"location":"cli/#qi-upgrade","title":"<code>qi --upgrade</code>","text":"<p>Upgrades Qi to the latest version from GitHub Releases.</p> <pre><code>qi --upgrade\n</code></pre> <p>Behavior: 1. Checks the latest release from GitHub 2. Downloads the appropriate binary for your platform 3. Replaces the current binary (backs up to <code>.old</code>) 4. Displays upgrade status</p> <p>Supported Platforms: - macOS (Apple Silicon / Intel) - Linux (x86_64 / aarch64) - Windows (x86_64)</p> <p>Examples: <pre><code># Upgrade to the latest version\nqi --upgrade\n\n# Check current version\nqi --version\n</code></pre></p>"},{"location":"cli/#environment-variables","title":"Environment Variables","text":""},{"location":"cli/#qi_lang","title":"<code>QI_LANG</code>","text":"<p>Sets the language for Qi messages.</p> <p>Values: - <code>ja</code> - Japanese - <code>en</code> - English (default)</p> <p>Examples: <pre><code>QI_LANG=ja qi script.qi\nQI_LANG=en qi --help\n</code></pre></p> <p>Behavior: - Error messages, help messages, and REPL messages are displayed in the specified language - Documentation (<code>:doc</code>) is also displayed in the specified language</p>"},{"location":"cli/#lang","title":"<code>LANG</code>","text":"<p>System locale setting. Used as a fallback when <code>QI_LANG</code> is not set.</p> <p>Examples: <pre><code>LANG=ja_JP.UTF-8 qi script.qi\n</code></pre></p>"},{"location":"cli/#exit-codes","title":"Exit Codes","text":"Code Meaning <code>0</code> Normal exit <code>1</code> Error occurred (syntax error, runtime error, file not found, etc.) <p>Examples: <pre><code>qi script.qi\necho $?  # Check exit code\n\nqi -e '(+ 1 2 3)'\necho $?  # =&gt; 0\n\nqi -e '(invalid syntax'\necho $?  # =&gt; 1\n</code></pre></p>"},{"location":"cli/#template-search-order","title":"Template Search Order","text":"<p>The <code>qi new</code> command searches for templates in the following order:</p> <ol> <li><code>./.qi/templates/&lt;name&gt;/</code> - Project-local</li> <li><code>~/.qi/templates/&lt;name&gt;/</code> - User-global</li> <li><code>&lt;qi-binary-dir&gt;/std/templates/&lt;name&gt;/</code> - Installed version</li> <li><code>std/templates/&lt;name&gt;/</code> - Development version</li> </ol> <p>The first template found is used.</p>"},{"location":"cli/#usage-examples","title":"Usage Examples","text":""},{"location":"cli/#project-creation-workflow","title":"Project Creation Workflow","text":"<pre><code># Check template list\nqi template list\n\n# Create an HTTP server project\nqi new myapi --template http-server\n\n# Navigate to project directory\ncd myapi\n\n# Start the server\nqi main.qi\n</code></pre>"},{"location":"cli/#data-processing-with-one-liners","title":"Data Processing with One-liners","text":"<pre><code># Fibonacci sequence\nqi -e '(defn fib [n] (if (&lt;= n 1) n (+ (fib (- n 1)) (fib (- n 2))))) (fib 10)'\n\n# Pipeline processing\nqi -e '([1 2 3 4 5] |&gt; (filter (fn [x] (&gt; x 2))) |&gt; (map (fn [x] (* x 10))))'\n\n# JSON processing (when HTTP feature is enabled)\nqi -e '(json/parse \"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\")'\n</code></pre>"},{"location":"cli/#development-with-repl","title":"Development with REPL","text":"<pre><code># Load library and start REPL\nqi -l src/lib.qi\n\n# Test functions in REPL\nqi:1&gt; (greet \"World\")\nHello, World!\n\n# Check documentation\nqi:2&gt; :doc map\n\n# Search built-in functions\nqi:3&gt; :builtins str\n</code></pre>"},{"location":"cli/#related-documentation","title":"Related Documentation","text":"<ul> <li>Project Management and qi.toml Specification - qi.toml, templates, project structure</li> <li>Tutorial - Practical usage</li> <li>Language Specification - Qi language syntax and features</li> </ul>"},{"location":"project/","title":"Qi Project Management","text":"<p>Complete reference for Qi project structure, configuration files (qi.toml), and template system.</p>"},{"location":"project/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Project Structure</li> <li>qi.toml Specification</li> <li>Template System</li> <li>Creating Custom Templates</li> </ul>"},{"location":"project/#project-structure","title":"Project Structure","text":"<p>A standard Qi project has the following structure:</p> <pre><code>my-project/\n\u251c\u2500\u2500 qi.toml           # Project configuration file\n\u251c\u2500\u2500 main.qi           # Entry point\n\u251c\u2500\u2500 src/              # Library code\n\u2502   \u2514\u2500\u2500 lib.qi\n\u251c\u2500\u2500 examples/         # Sample code\n\u2502   \u2514\u2500\u2500 example.qi\n\u2514\u2500\u2500 tests/            # Test code\n    \u2514\u2500\u2500 test.qi\n</code></pre>"},{"location":"project/#role-of-each-file-and-directory","title":"Role of Each File and Directory","text":""},{"location":"project/#qitoml","title":"<code>qi.toml</code>","text":"<p>TOML-format file describing project metadata and configuration. See qi.toml Specification for details.</p>"},{"location":"project/#mainqi","title":"<code>main.qi</code>","text":"<p>Project entry point. Executed with <code>qi main.qi</code>.</p>"},{"location":"project/#src","title":"<code>src/</code>","text":"<p>Directory for reusable library code. Will be loadable via the module system in the future.</p>"},{"location":"project/#examples","title":"<code>examples/</code>","text":"<p>Directory for usage examples and demo code. Used for documentation purposes and behavior verification.</p>"},{"location":"project/#tests","title":"<code>tests/</code>","text":"<p>Directory for test code. Will be executed with <code>qi test</code> command (planned for future implementation).</p>"},{"location":"project/#qitoml-specification","title":"qi.toml Specification","text":"<p><code>qi.toml</code> is the project configuration file, written in TOML format.</p>"},{"location":"project/#basic-example","title":"Basic Example","text":"<pre><code>[project]\nname = \"my-project\"\nversion = \"0.1.0\"\nauthors = [\"Alice &lt;alice@example.com&gt;\"]\ndescription = \"My awesome Qi project\"\nlicense = \"MIT\"\nqi-version = \"0.1.0\"\n\n[dependencies]\n# For future expansion (currently unimplemented)\n\n[features]\ndefault = [\"http-server\", \"format-json\"]\n</code></pre>"},{"location":"project/#project-section","title":"<code>[project]</code> Section","text":"<p>Defines project metadata.</p>"},{"location":"project/#name-required","title":"<code>name</code> (Required)","text":"<p>Project name. Alphanumeric characters, hyphens, and underscores are allowed.</p> <pre><code>name = \"my-project\"\n</code></pre>"},{"location":"project/#version-required","title":"<code>version</code> (Required)","text":"<p>Project version. Semantic versioning is recommended.</p> <pre><code>version = \"0.1.0\"\n</code></pre>"},{"location":"project/#authors-optional","title":"<code>authors</code> (Optional)","text":"<p>List of project authors.</p> <pre><code>authors = [\"Alice &lt;alice@example.com&gt;\", \"Bob &lt;bob@example.com&gt;\"]\n</code></pre>"},{"location":"project/#description-optional","title":"<code>description</code> (Optional)","text":"<p>Project description.</p> <pre><code>description = \"A web API server written in Qi\"\n</code></pre>"},{"location":"project/#license-optional","title":"<code>license</code> (Optional)","text":"<p>License identifier (SPDX format recommended).</p> <pre><code>license = \"MIT\"\nlicense = \"Apache-2.0\"\nlicense = \"GPL-3.0-or-later\"\n</code></pre>"},{"location":"project/#qi-version-required","title":"<code>qi-version</code> (Required)","text":"<p>Compatible Qi version.</p> <pre><code>qi-version = \"0.1.0\"\n</code></pre>"},{"location":"project/#dependencies-section","title":"<code>[dependencies]</code> Section","text":"<p>Defines dependencies (for future expansion, currently unimplemented).</p> <pre><code>[dependencies]\n# In the future, describe dependencies on other Qi packages\n# my-lib = \"1.0.0\"\n</code></pre>"},{"location":"project/#features-section","title":"<code>[features]</code> Section","text":"<p>Defines feature flags used by the project.</p>"},{"location":"project/#default","title":"<code>default</code>","text":"<p>List of features to enable by default.</p> <pre><code>[features]\ndefault = []  # Basic features only\n\n# Or\ndefault = [\"http-server\", \"format-json\"]  # Enable HTTP + JSON features\n</code></pre>"},{"location":"project/#available-features","title":"Available Features","text":"<p>Below are examples of feature flags available in the Qi runtime:</p> Feature Description <code>http-server</code> HTTP server functionality (<code>server/serve</code>, <code>server/json</code>, etc.) <code>http-client</code> HTTP client functionality (<code>http/get</code>, <code>http/post</code>, etc.) <code>format-json</code> JSON processing functionality (<code>json/parse</code>, <code>json/stringify</code>, etc.) <code>format-yaml</code> YAML processing functionality (<code>yaml/parse</code>, <code>yaml/stringify</code>, etc.) <code>io-file</code> File I/O functionality (<code>io/read-file</code>, <code>io/write-file</code>, etc.) <code>io-glob</code> File glob functionality (<code>io/glob</code>, etc.) <code>db-sqlite</code> SQLite database functionality (planned for future implementation) <code>concurrency</code> Concurrency functionality (<code>go</code>, <code>chan</code>, etc.) <code>std-math</code> Math functions (<code>math/rand</code>, <code>math/sqrt</code>, etc.) <code>string-encoding</code> String encoding (base64, URL encoding, etc.) <p>Note: Feature flags are currently for documentation purposes only and do not affect runtime behavior (planned for use in future build system).</p>"},{"location":"project/#template-system","title":"Template System","text":"<p>The <code>qi new</code> command generates projects using templates.</p>"},{"location":"project/#built-in-templates","title":"Built-in Templates","text":""},{"location":"project/#basic-default","title":"<code>basic</code> (Default)","text":"<p>Basic project structure.</p> <p>Structure: <pre><code>project/\n\u251c\u2500\u2500 qi.toml\n\u251c\u2500\u2500 main.qi\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 lib.qi\n\u251c\u2500\u2500 examples/\n\u2502   \u2514\u2500\u2500 example.qi\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 test.qi\n</code></pre></p> <p>Use Case: Simple scripts or library development</p>"},{"location":"project/#http-server","title":"<code>http-server</code>","text":"<p>JSON API server.</p> <p>Structure: <pre><code>project/\n\u251c\u2500\u2500 qi.toml          # features = [\"http-server\", \"format-json\"]\n\u251c\u2500\u2500 main.qi          # Server implementation\n\u2514\u2500\u2500 src/\n</code></pre></p> <p>Use Case: RESTful API servers, web backends</p> <p>Features: - Routing implementation (<code>/</code>, <code>/api/hello</code>, <code>/api/users</code>) - JSON responses - Request handler examples</p>"},{"location":"project/#template-search-order","title":"Template Search Order","text":"<p>Templates are searched in the following order:</p> <ol> <li><code>./.qi/templates/&lt;name&gt;/</code> - Project-local</li> <li><code>~/.qi/templates/&lt;name&gt;/</code> - User-global</li> <li><code>&lt;qi-binary-dir&gt;/std/templates/&lt;name&gt;/</code> - Installed version</li> <li><code>std/templates/&lt;name&gt;/</code> - Development version</li> </ol> <p>The first template found is used.</p>"},{"location":"project/#creating-custom-templates","title":"Creating Custom Templates","text":"<p>You can create your own templates.</p>"},{"location":"project/#template-structure","title":"Template Structure","text":"<pre><code>~/.qi/templates/my-template/\n\u251c\u2500\u2500 template.toml          # Template metadata\n\u251c\u2500\u2500 qi.toml.template       # Project configuration template\n\u251c\u2500\u2500 main.qi.template       # Main file template\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 lib.qi.template\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 test.qi.template\n</code></pre>"},{"location":"project/#templatetoml","title":"<code>template.toml</code>","text":"<p>Defines template metadata.</p> <pre><code>[template]\nname = \"my-template\"\ndescription = \"My custom template\"\nauthor = \"Your Name\"\nversion = \"1.0.0\"\n\n[features]\nrequired = [\"http-server\", \"format-json\"]\n</code></pre>"},{"location":"project/#template-section","title":"<code>[template]</code> Section","text":"Field Required Description <code>name</code> \u2713 Template name <code>description</code> \u2713 Template description <code>author</code> Creator <code>version</code> Template version"},{"location":"project/#features-section_1","title":"<code>[features]</code> Section","text":"Field Description <code>required</code> List of feature flags required by this template"},{"location":"project/#template-file-notation","title":"Template File Notation","text":"<p>Template files can use variable substitution and conditional branching.</p>"},{"location":"project/#variable-substitution","title":"Variable Substitution","text":"<p>Embed variables using <code>{{ variable }}</code> format.</p> <p>Available Variables: - <code>{{ project_name }}</code> - Project name - <code>{{ version }}</code> - Version - <code>{{ author }}</code> - Author name - <code>{{ description }}</code> - Description - <code>{{ license }}</code> - License</p> <p>Example: <pre><code># qi.toml.template\n[project]\nname = \"{{ project_name }}\"\nversion = \"{{ version }}\"\ndescription = \"{{ description }}\"\n</code></pre></p> <p>After Generation: <pre><code>[project]\nname = \"my-project\"\nversion = \"0.1.0\"\ndescription = \"My awesome project\"\n</code></pre></p>"},{"location":"project/#conditional-branching","title":"Conditional Branching","text":"<p>Write conditionals using <code>{{ #if variable }}...{{ /if }}</code> format.</p> <p>Example: <pre><code># qi.toml.template\n[project]\nname = \"{{ project_name }}\"\nversion = \"{{ version }}\"\n{{ #if author }}authors = [\"{{ author }}\"]{{ /if }}\n{{ #if description }}description = \"{{ description }}\"{{ /if }}\n{{ #if license }}license = \"{{ license }}\"{{ /if }}\nqi-version = \"0.1.0\"\n</code></pre></p> <p>If a variable is empty, the entire line is removed.</p> <p>After Generation (when author and description are empty): <pre><code>[project]\nname = \"my-project\"\nversion = \"0.1.0\"\nlicense = \"MIT\"\nqi-version = \"0.1.0\"\n</code></pre></p>"},{"location":"project/#file-naming-conventions","title":"File Naming Conventions","text":"<ul> <li>Files with <code>.template</code> suffix have the suffix removed when output</li> <li>Example: <code>main.qi.template</code> \u2192 <code>main.qi</code></li> <li><code>template.toml</code> is not copied</li> </ul>"},{"location":"project/#template-placement","title":"Template Placement","text":""},{"location":"project/#user-global-templates","title":"User-Global Templates","text":"<pre><code>mkdir -p ~/.qi/templates/my-template\ncp -r my-template/* ~/.qi/templates/my-template/\n</code></pre>"},{"location":"project/#project-local-templates","title":"Project-Local Templates","text":"<pre><code>mkdir -p .qi/templates/my-template\ncp -r my-template/* .qi/templates/my-template/\n</code></pre>"},{"location":"project/#using-templates","title":"Using Templates","text":"<pre><code># List available templates\nqi template list\n\n# Use custom template\nqi new my-project --template my-template\n\n# View template information\nqi template info my-template\n</code></pre>"},{"location":"project/#example-custom-cli-tool-template","title":"Example: Custom CLI Tool Template","text":"<p>Example of creating a template for command-line tools:</p>"},{"location":"project/#qitemplatesclitemplatetoml","title":"<code>~/.qi/templates/cli/template.toml</code>","text":"<pre><code>[template]\nname = \"cli\"\ndescription = \"Command-line tool template\"\nauthor = \"Qi Team\"\nversion = \"1.0.0\"\n\n[features]\nrequired = [\"io-file\", \"string-encoding\"]\n</code></pre>"},{"location":"project/#qitemplatescliqitomltemplate","title":"<code>~/.qi/templates/cli/qi.toml.template</code>","text":"<pre><code>[project]\nname = \"{{ project_name }}\"\nversion = \"{{ version }}\"\n{{ #if author }}authors = [\"{{ author }}\"]{{ /if }}\n{{ #if description }}description = \"{{ description }}\"{{ /if }}\n{{ #if license }}license = \"{{ license }}\"{{ /if }}\nqi-version = \"0.1.0\"\n\n[dependencies]\n\n[features]\ndefault = [\"io-file\", \"string-encoding\"]\n</code></pre>"},{"location":"project/#qitemplatesclimainqitemplate","title":"<code>~/.qi/templates/cli/main.qi.template</code>","text":"<pre><code>;; {{ project_name }} - Command-line tool\n;;\n;; Usage: qi main.qi [OPTIONS] [ARGS]\n\n(println \"=== {{ project_name }} v{{ version }} ===\")\n\n;; Parse command-line arguments\n(defn parse-args [args]\n  {:command (first args)\n   :options (rest args)})\n\n;; Main logic\n(defn main [args]\n  (let [parsed (parse-args args)]\n    (match (get parsed :command)\n      \"help\" -&gt; (println \"Help message\")\n      nil -&gt; (println \"Please specify a command\")\n      cmd -&gt; (println f\"Unknown command: {cmd}\"))))\n\n;; Entry point\n(main (get (env) :args []))\n</code></pre>"},{"location":"project/#usage-example","title":"Usage Example","text":"<pre><code># Create CLI tool\nqi new mytool --template cli\ncd mytool\nqi main.qi help\n</code></pre>"},{"location":"project/#related-documentation","title":"Related Documentation","text":"<ul> <li>CLI Reference - How to use the <code>qi</code> command</li> <li>Tutorial - Practical usage</li> <li>Language Specification - Qi language grammar and features</li> </ul>"},{"location":"style-guide/","title":"Qi Style Guide","text":"<p>A style guide that summarizes formatting rules and best practices for Qi code.</p> <p>The <code>qi fmt</code> command automatically formats code based on this guide.</p>"},{"location":"style-guide/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Formatting Rules</li> <li>Naming Conventions</li> <li>Best Practices</li> <li>Anti-patterns</li> <li>Formatter Configuration</li> </ol>"},{"location":"style-guide/#1-formatting-rules","title":"1. Formatting Rules","text":""},{"location":"style-guide/#11-indentation","title":"1.1 Indentation","text":"<p>Use 2 spaces. Do not use tabs.</p> <pre><code>;; \u2705 Good example\n(defn factorial [n]\n  (if (&lt;= n 1)\n    1\n    (* n (factorial (- n 1)))))\n\n;; \u274c Bad example (4 spaces)\n(defn factorial [n]\n    (if (&lt;= n 1)\n        1\n        (* n (factorial (- n 1)))))\n</code></pre>"},{"location":"style-guide/#12-line-length","title":"1.2 Line Length","text":"<p>Maximum 100 characters is recommended.</p> <pre><code>;; \u2705 Within 100 characters\n(some-function arg1 arg2 arg3 arg4 arg5)\n\n;; \u2705 Break lines when exceeding\n(some-very-long-function-name-that-would-exceed-the-limit\n  arg1\n  arg2\n  arg3)\n</code></pre>"},{"location":"style-guide/#13-pipelines","title":"1.3 Pipelines","text":"<p>Pipeline operators should be placed at the beginning of lines, with each step on a new line.</p> <pre><code>;; \u2705 Good example\n(data\n  |&gt; validate\n  |&gt; transform\n  |&gt; (filter active?)\n  |&gt; (map format)\n  |&gt; save)\n\n;; \u2705 Single line is OK for short pipelines\n(\"hello\" |&gt; str/upper |&gt; str/reverse)\n\n;; \u274c Bad example (operator at the end)\n(data |&gt;\n  validate |&gt;\n  transform |&gt;\n  save)\n</code></pre>"},{"location":"style-guide/#parallel-pipeline","title":"Parallel Pipeline (<code>||&gt;</code>)","text":"<pre><code>(data\n  ||&gt; process1\n  ||&gt; process2\n  ||&gt; process3\n  |&gt; collect-results)\n</code></pre>"},{"location":"style-guide/#railway-pipeline","title":"Railway Pipeline (<code>|&gt;?</code>)","text":"<pre><code>(request\n  |&gt;? validate-input\n  |&gt;? check-permissions\n  |&gt;? execute-action\n  |&gt;? format-response)\n</code></pre>"},{"location":"style-guide/#14-special-forms","title":"1.4 Special Forms","text":""},{"location":"style-guide/#def-defn","title":"<code>def</code> / <code>defn</code>","text":"<pre><code>;; \u2705 def\n(def pi 3.14159)\n\n(def config\n  {:host \"localhost\"\n   :port 8080})\n\n;; \u2705 defn\n(defn greet [name]\n  (println f\"Hello, {name}!\"))\n\n(defn complex-function [arg1 arg2 arg3]\n  (let [result (process arg1 arg2)]\n    (if (valid? result)\n      (transform result arg3)\n      nil)))\n</code></pre>"},{"location":"style-guide/#let","title":"<code>let</code>","text":"<p>Clearly separate bindings and body.</p> <pre><code>;; \u2705 Good example\n(let [x 10\n      y 20\n      sum (+ x y)]\n  (* sum 2))\n\n;; \u2705 Complex bindings\n(let [user (get-user id)\n      profile (get-profile user)\n      settings (get-settings user)]\n  (render-page user profile settings))\n</code></pre>"},{"location":"style-guide/#if","title":"<code>if</code>","text":"<p>Align condition, then-clause, and else-clause.</p> <pre><code>;; \u2705 Simple case\n(if (&gt; x 10)\n  \"big\"\n  \"small\")\n\n;; \u2705 Complex case\n(if (and (valid? user)\n         (active? user)\n         (authorized? user))\n  (process-request user)\n  (reject-request user))\n</code></pre>"},{"location":"style-guide/#do","title":"<code>do</code>","text":"<p>Align each expression at the same indentation level.</p> <pre><code>;; \u2705 Good example\n(do\n  (log/info \"Starting process\")\n  (initialize-resources)\n  (execute-main-task)\n  (cleanup-resources)\n  (log/info \"Process completed\"))\n</code></pre>"},{"location":"style-guide/#match","title":"<code>match</code>","text":"<p>Place <code>-&gt;</code> with spaces on both sides between patterns and actions.</p> <pre><code>;; \u2705 Good example\n(match value\n  nil -&gt; \"empty\"\n  0 -&gt; \"zero\"\n  n when (&gt; n 0) -&gt; \"positive\"\n  _ -&gt; \"negative\")\n\n;; \u2705 Complex patterns\n(match [x y]\n  [0 0] -&gt; \"origin\"\n  [0 _] -&gt; \"y-axis\"\n  [_ 0] -&gt; \"x-axis\"\n  [x y] -&gt; f\"point ({x}, {y})\")\n\n;; \u2705 Or patterns\n(match status\n  :pending | :processing -&gt; \"in-progress\"\n  :completed | :success -&gt; \"done\"\n  :failed | :error -&gt; \"error\")\n\n;; \u2705 Long actions\n(match status\n  :pending -&gt; (do\n                (log/info \"Processing request\")\n                (process-request req))\n  :completed -&gt; (notify-user user)\n  :failed -&gt; (retry-with-backoff req))\n</code></pre>"},{"location":"style-guide/#try-defer","title":"<code>try</code> / <code>defer</code>","text":"<pre><code>;; \u2705 try\n(try\n  (risky-operation)\n  (another-operation)\n  (catch e\n    (log/error f\"Failed: {e}\")\n    nil))\n\n;; \u2705 defer\n(do\n  (defer (cleanup-resources))\n  (do-main-work))\n</code></pre>"},{"location":"style-guide/#15-function-calls","title":"1.5 Function Calls","text":""},{"location":"style-guide/#short-arguments","title":"Short Arguments","text":"<pre><code>(+ 1 2 3)\n(str/upper \"hello\")\n(map inc [1 2 3])\n</code></pre>"},{"location":"style-guide/#long-arguments","title":"Long Arguments","text":"<pre><code>;; \u2705 Break each argument to new line\n(create-user\n  \"alice\"\n  \"alice@example.com\"\n  30\n  \"123 Main St\")\n\n;; \u2705 Same for function definitions\n(defn process-user [username\n                    email\n                    age\n                    address]\n  ...)\n</code></pre>"},{"location":"style-guide/#16-data-structures","title":"1.6 Data Structures","text":""},{"location":"style-guide/#vectors","title":"Vectors <code>[]</code>","text":"<pre><code>;; \u2705 Short case\n[1 2 3 4 5]\n\n;; \u2705 Long case\n[first-element\n second-element\n third-element\n fourth-element]\n\n;; \u2705 Nested\n[[1 2 3]\n [4 5 6]\n [7 8 9]]\n</code></pre>"},{"location":"style-guide/#maps","title":"Maps <code>{}</code>","text":"<p>Align keys and values vertically.</p> <pre><code>;; \u2705 Basic form\n{:name \"Alice\"\n :age 30\n :email \"alice@example.com\"}\n\n;; \u2705 Single line is OK for short maps\n{:x 10 :y 20}\n\n;; \u2705 Nested\n{:user {:name \"Alice\"\n        :age 30\n        :email \"alice@example.com\"}\n :status :active\n :created-at \"2025-01-13\"}\n</code></pre>"},{"location":"style-guide/#lists","title":"Lists <code>()</code>","text":"<pre><code>'(1 2 3 4 5)\n\n'(first-item\n  second-item\n  third-item)\n</code></pre>"},{"location":"style-guide/#17-strings","title":"1.7 Strings","text":""},{"location":"style-guide/#regular-strings","title":"Regular Strings","text":"<pre><code>\"Hello, World!\"\n\n;; \u2705 Use multiline strings for long text\n\"\"\"\nThis is a very long string that spans multiple lines.\nYou can write it naturally without worrying about line breaks.\n\"\"\"\n</code></pre>"},{"location":"style-guide/#f-strings","title":"F-strings","text":"<p>Keep interpolation parts as-is.</p> <pre><code>;; \u2705 Single line\n(println f\"Hello, {name}! You are {age} years old.\")\n\n;; \u2705 Multiline\n(println f\"\"\"\n  Dear {name},\n\n  Your account balance is {balance}.\n  Thank you for using our service.\n  \"\"\")\n</code></pre> <p><code>qi fmt</code> respects the input form of string literals without reconstructing line breaks, quotes, or escape representations.</p>"},{"location":"style-guide/#18-comments","title":"1.8 Comments","text":""},{"location":"style-guide/#line-comments","title":"Line Comments","text":"<pre><code>;; \u2705 Top-level: two semicolons\n;; This is a top-level comment\n;; explaining the following code.\n\n(def x 10)\n\n;; \u2705 Inline: one semicolon (with 2 spaces before)\n(def x 10)  ; This is an inline comment\n</code></pre> <p>Comments are not deleted or merged. Feel free to write necessary explanations.</p>"},{"location":"style-guide/#section-separators","title":"Section Separators","text":"<pre><code>;; ========================================\n;; Data Processing Functions\n;; ========================================\n\n(defn process-data [data]\n  ...)\n\n(defn transform-data [data]\n  ...)\n\n\n;; ========================================\n;; Helper Functions\n;; ========================================\n\n(defn helper-1 []\n  ...)\n</code></pre>"},{"location":"style-guide/#19-blank-lines","title":"1.9 Blank Lines","text":""},{"location":"style-guide/#between-top-level-definitions-recommended-1-line-0-2-lines-allowed","title":"Between Top-level Definitions: Recommended 1 line (0-2 lines allowed)","text":"<p>Typically separate with 1 blank line, but can be adjusted within the range of 0-2 lines for readability.</p> <pre><code>(def x 10)\n\n(def y 20)\n\n(def config\n  {:host \"localhost\"\n   :port 8080})\n</code></pre>"},{"location":"style-guide/#before-def-defn-defn-always-1-blank-line-except-comments","title":"Before <code>def</code> / <code>defn</code> / <code>defn-</code>: Always 1 blank line (except comments)","text":"<p>Always insert at least 1 blank line before top-level definition forms (<code>def</code>, <code>defn</code>, <code>defn-</code>) to clearly separate blocks. When placing an explanatory comment immediately before, you can write the definition right after the comment.</p> <pre><code>(def cache (atom {}))\n\n(defn clear-cache []\n  ...)\n\n;; kick entry point\n(defn main []\n  ...)\n\n;; internal helper\n;; It's OK to write defn- right after comment\n(defn- build-index [entries]\n  ...)\n</code></pre>"},{"location":"style-guide/#section-separators-2-lines","title":"Section Separators: 2 lines","text":"<pre><code>(defn helper-1 [] ...)\n(defn helper-2 [] ...)\n\n\n;; ========================================\n;; Public API\n;; ========================================\n\n(defn public-api-1 [] ...)\n(defn public-api-2 [] ...)\n</code></pre>"},{"location":"style-guide/#110-module-system","title":"1.10 Module System","text":""},{"location":"style-guide/#use-declarations","title":"<code>use</code> Declarations","text":"<pre><code>;; \u2705 Short case\n(use str :as s)\n(use list :only [map filter reduce])\n\n;; \u2705 Long case\n(use http\n  :only [get post put delete\n         request with-headers\n         json xml])\n\n;; \u2705 Multiple use declarations (group at file beginning)\n(use str :as s)\n(use list :as l)\n(use io :only [read-file write-file])\n(use http :only [get post])\n</code></pre>"},{"location":"style-guide/#export-declarations","title":"<code>export</code> Declarations","text":"<pre><code>;; \u2705 Short case\n(export [func1 func2 func3])\n\n;; \u2705 Long case\n(export\n  [public-api-1\n   public-api-2\n   public-api-3\n   helper-function\n   utility-function])\n</code></pre>"},{"location":"style-guide/#111-formatter-policy","title":"1.11 Formatter Policy","text":"<p>The Qi formatter aims to \"preserve the author's intended text representation without changing the meaning of the code.\"</p> <ul> <li>Comments and whitespace are not deleted or merged, with minimal adjustments within configured ranges</li> <li>String literals are not re-escaped or normalized</li> <li>Top-level definition separators are normalized based on <code>blank-lines-between-defs</code> in <code>.qi-format.edn</code></li> <li>At least 1 blank line is ensured before <code>def</code>/<code>defn</code>/<code>defn-</code>, allowing definitions immediately after comments</li> <li>For cases not defined in the guide, preserve existing layout as much as possible, with rules to be added in the future</li> </ul>"},{"location":"style-guide/#2-naming-conventions","title":"2. Naming Conventions","text":""},{"location":"style-guide/#21-function-names","title":"2.1 Function Names","text":"<p>Use kebab-case.</p> <pre><code>;; \u2705 Good examples\n(defn get-user [id] ...)\n(defn process-payment [amount] ...)\n(defn calculate-total-price [items] ...)\n\n;; \u274c Bad examples\n(defn getUser [id] ...)          ; camelCase\n(defn process_payment [amount] ...) ; snake_case\n</code></pre>"},{"location":"style-guide/#22-predicate-functions","title":"2.2 Predicate Functions","text":"<p>Add <code>?</code> at the end.</p> <pre><code>(defn active? [user] ...)\n(defn valid-email? [email] ...)\n(defn empty? [coll] ...)\n</code></pre>"},{"location":"style-guide/#23-destructive-operations","title":"2.3 Destructive Operations","text":"<p>Add <code>!</code> at the end.</p> <pre><code>(defn send! [chan value] ...)\n(defn reset! [atom value] ...)\n(defn swap! [atom f] ...)\n</code></pre>"},{"location":"style-guide/#24-variable-names","title":"2.4 Variable Names","text":"<p>Use kebab-case.</p> <pre><code>(def max-connections 100)\n(def api-base-url \"https://api.example.com\")\n(let [user-id 123\n      user-name \"alice\"]\n  ...)\n</code></pre>"},{"location":"style-guide/#25-constants","title":"2.5 Constants","text":"<p>Use kebab-case, same as regular variables.</p> <pre><code>(def pi 3.14159)\n(def max-retry-count 3)\n(def default-timeout 30000)\n</code></pre>"},{"location":"style-guide/#26-keywords","title":"2.6 Keywords","text":"<p>Use kebab-case.</p> <pre><code>{:user-id 123\n :user-name \"alice\"\n :created-at \"2025-01-13\"}\n</code></pre>"},{"location":"style-guide/#27-private-functions","title":"2.7 Private Functions","text":"<p>Use <code>defn-</code>.</p> <pre><code>(defn- internal-helper [x]\n  \"Used only within module\"\n  (* x 2))\n\n(defn public-api [x]\n  \"Exposed to external\"\n  (internal-helper x))\n</code></pre>"},{"location":"style-guide/#3-best-practices","title":"3. Best Practices","text":""},{"location":"style-guide/#31-leverage-pipelines","title":"3.1 Leverage Pipelines","text":"<pre><code>;; \u2705 Pipeline\n(data\n  |&gt; validate\n  |&gt; transform\n  |&gt; save)\n\n;; \u274c Nested function calls\n(save (transform (validate data)))\n</code></pre>"},{"location":"style-guide/#32-use-pattern-matching-with-match","title":"3.2 Use Pattern Matching with match","text":"<pre><code>;; \u2705 match\n(match value\n  nil -&gt; \"empty\"\n  [x] -&gt; f\"single: {x}\"\n  [x ...rest] -&gt; f\"multiple\")\n\n;; \u274c Complex if-else\n(if (nil? value)\n  \"empty\"\n  (if (= (count value) 1)\n    f\"single: {(first value)}\"\n    \"multiple\"))\n</code></pre>"},{"location":"style-guide/#33-leverage-destructuring","title":"3.3 Leverage Destructuring","text":"<pre><code>;; \u2705 let destructuring\n(let [{:name n :age a} user]\n  (println f\"{n} is {a} years old\"))\n\n;; \u2705 Function argument destructuring\n(defn greet [{:name n}]\n  (println f\"Hello, {n}!\"))\n\n;; \u2705 match destructuring\n(match coords\n  [x y] -&gt; (+ x y))\n</code></pre>"},{"location":"style-guide/#34-organize-namespaces-with-use","title":"3.4 Organize Namespaces with use","text":"<pre><code>;; \u2705 Use aliases\n(use str :as s)\n(s/upper \"hello\")\n\n;; \u2705 Import only necessary functions\n(use list :only [map filter reduce])\n</code></pre>"},{"location":"style-guide/#35-leverage-early-returns","title":"3.5 Leverage Early Returns","text":"<pre><code>;; \u2705 Guard clauses\n(defn process [data]\n  (if (nil? data)\n    nil\n    (do\n      (validate data)\n      (transform data))))\n\n;; \u2705 Early return with match\n(match status\n  :invalid -&gt; nil\n  :pending -&gt; (process-pending)\n  :completed -&gt; result)\n</code></pre>"},{"location":"style-guide/#36-leverage-f-strings","title":"3.6 Leverage F-strings","text":"<pre><code>;; \u2705 f-string\n(println f\"User {name} has {count} items\")\n\n;; \u274c str concatenation\n(println (str \"User \" name \" has \" count \" items\"))\n</code></pre>"},{"location":"style-guide/#4-anti-patterns","title":"4. Anti-patterns","text":""},{"location":"style-guide/#41-deep-nesting","title":"4.1 Deep Nesting","text":"<pre><code>;; \u274c Deep nesting\n(if condition1\n  (if condition2\n    (if condition3\n      (do-something)\n      default)\n    default)\n  default)\n\n;; \u2705 Pipeline or match\n(value\n  |&gt;? validate1\n  |&gt;? validate2\n  |&gt;? validate3\n  |&gt;? do-something)\n</code></pre>"},{"location":"style-guide/#42-overly-long-functions","title":"4.2 Overly Long Functions","text":"<pre><code>;; \u274c Functions over 100 lines\n(defn huge-function [...]\n  ;; 100+ lines\n  )\n\n;; \u2705 Split into smaller functions\n(defn- step1 [x] ...)\n(defn- step2 [x] ...)\n(defn main-function [x]\n  (x |&gt; step1 |&gt; step2))\n</code></pre>"},{"location":"style-guide/#43-abusing-global-state","title":"4.3 Abusing Global State","text":"<pre><code>;; \u274c Direct modification of global variables\n(def counter 0)\n(defn increment [] (set! counter (+ counter 1)))\n\n;; \u2705 Use atoms\n(def counter (atom 0))\n(defn increment [] (swap! counter inc))\n</code></pre>"},{"location":"style-guide/#44-meaningless-variable-names","title":"4.4 Meaningless Variable Names","text":"<pre><code>;; \u274c Bad examples\n(defn f [x y z] ...)\n(let [a 1 b 2] ...)\n\n;; \u2705 Good examples\n(defn calculate-total [price quantity tax] ...)\n(let [user-id 1 user-name \"alice\"] ...)\n</code></pre>"},{"location":"style-guide/#5-formatter-configuration","title":"5. Formatter Configuration","text":""},{"location":"style-guide/#51-default-configuration","title":"5.1 Default Configuration","text":"<pre><code>;; .qi-format.edn\n{:indent-width 2\n :max-line-length 100\n :pipeline-newline true\n :pipeline-operator-position :leading\n :match-arrow-spacing :both\n :align-map-values true\n :sort-use-declarations false\n :blank-lines-between-defs 1\n :blank-lines-between-sections 2}\n</code></pre>"},{"location":"style-guide/#52-configuration-options","title":"5.2 Configuration Options","text":"Option Default Description <code>indent-width</code> <code>2</code> Indentation width (number of spaces) <code>max-line-length</code> <code>100</code> Maximum line length (characters) <code>pipeline-newline</code> <code>true</code> Whether to break pipelines into multiple lines <code>pipeline-operator-position</code> <code>:leading</code> Pipeline operator position (<code>:leading</code> or <code>:trailing</code>) <code>match-arrow-spacing</code> <code>:both</code> Space around match arrows (<code>:both</code>, <code>:before</code>, <code>:after</code>, <code>:none</code>) <code>align-map-values</code> <code>true</code> Whether to align map values <code>sort-use-declarations</code> <code>false</code> Whether to sort use declarations <code>blank-lines-between-defs</code> <code>1</code> Normalize blank lines between top-level definitions within 0-2 range (ensure at least 1 line before <code>def</code>/<code>defn</code>/<code>defn-</code>) <code>blank-lines-between-sections</code> <code>2</code> Number of blank lines between sections <p>Current style guide values are the defaults, but you can override them in <code>.qi-format.edn</code> according to your team's policy.</p> <p>Place <code>.qi-format.edn</code> in the directory containing forms or in the current directory root. Write an EDN map like this:</p> <pre><code>{:indent-width 2\n :blank-lines-between-defs 1\n :max-line-length 100}\n</code></pre> <p>Non-numeric values or unsupported keys are ignored, and if a parser error occurs, it will fall back to default values.</p>"},{"location":"style-guide/#53-usage","title":"5.3 Usage","text":"<pre><code># Format file (overwrite)\nqi fmt src/main.qi\n\n# Format file (output to stdout)\nqi fmt --check src/main.qi\n\n# Recursively format directory\nqi fmt src/\n\n# Format from stdin\ncat src/main.qi | qi fmt --stdin\n</code></pre>"},{"location":"style-guide/#54-formatter-checklist","title":"5.4 Formatter Checklist","text":"<p><code>qi fmt</code> is implemented to satisfy the following points (behavior changes based on configuration values, see <code>.qi-format.edn</code>):</p> <ul> <li>String literal line breaks, quotes, and escape representations respect the input and are not re-encoded</li> <li>Comments are not deleted or merged, and their position is maintained within bounds that don't break meaning</li> <li>Normalize the number of blank lines between top-level definitions to 0-2 according to <code>blank-lines-between-defs</code></li> <li>Ensure at least 1 blank line before <code>def</code>/<code>defn</code>/<code>defn-</code>, allowing immediate preceding comments</li> <li>For layouts not defined in this guide, preserve the existing structure as much as possible</li> </ul>"},{"location":"style-guide/#references","title":"References","text":"<p>This style guide references the following:</p> <ul> <li>Clojure Style Guide</li> <li>Rust Style Guide</li> <li>Elixir Style Guide</li> </ul>"},{"location":"style-guide/#license","title":"License","text":"<p>MIT</p>"},{"location":"spec/","title":"Qi Language Specification","text":"<p>Complete language specification and reference for Qi</p> <p>This directory contains the specification for implemented features only of the Qi language.</p>"},{"location":"spec/#table-of-contents","title":"\ud83d\udcda Table of Contents","text":"<p>\u26a1 Quick Start: Quick Reference - Learn Qi basics in one page</p>"},{"location":"spec/#core-features-highlights","title":"Core Features (\u2605 Highlights)","text":"<ul> <li>02-flow-pipes.md - Pipeline Operators and Data Flow \u2b50</li> <li><code>|&gt;</code>, <code>||&gt;</code>, <code>|&gt;?</code>, <code>tap&gt;</code>, <code>~&gt;</code> operators</li> <li>stream (lazy evaluation)</li> <li> <p>Designing data flow</p> </li> <li> <p>03-concurrency.md - Concurrency and Parallelism \u2b50</p> </li> <li>go/chan (goroutine-style)</li> <li>async/await, pmap, pipeline</li> <li> <p>Atom (thread-safe state management)</p> </li> <li> <p>04-match.md - Pattern Matching \u2b50</p> </li> <li>Data structure destructuring</li> <li>Guard conditions, or patterns</li> <li>Railway Oriented Programming</li> </ul>"},{"location":"spec/#basics","title":"Basics","text":"<ul> <li>01-overview.md - Overview of Qi</li> <li>Language philosophy (Flow-Oriented Programming)</li> <li>Design principles</li> <li> <p>Core design</p> </li> <li> <p>05-syntax-basics.md - Basic Syntax</p> </li> <li>Data types, literals, comments</li> <li>Special forms (def, fn, let, do, if, match, loop/recur, when, while, until, while-some, until-error)</li> <li> <p>Operators</p> </li> <li> <p>06-data-structures.md - Data Structures</p> </li> <li>Vectors, lists, maps, sets</li> <li>Higher-order functions (map, filter, reduce, each)</li> <li> <p>Sorting, grouping</p> </li> <li> <p>07-functions.md - Functions</p> </li> <li>Function definition (fn, defn)</li> <li>Closures</li> <li> <p>Higher-order functions (comp, partial, apply, identity)</p> </li> <li> <p>08-error-handling.md - Error Handling</p> </li> <li>Result type (value / <code>{:error ...}</code>) - also supports <code>{:ok value}</code> format for validation</li> <li>try/catch</li> <li> <p>defer (resource management)</p> </li> <li> <p>09-modules.md - Module System</p> </li> <li>module declaration, export</li> <li>use, load</li> <li>Namespace management</li> </ul>"},{"location":"spec/#standard-library","title":"Standard Library","text":"<ul> <li>10-stdlib-string.md - String Operations (60+ functions)</li> <li>Search, conversion, case conversion, encoding, validation</li> <li>11-stdlib-http.md - HTTP Client/Server</li> <li>Client (GET/POST/PUT/DELETE), Server (routing, middleware)</li> <li>12-stdlib-json.md - JSON/YAML Processing</li> <li>Parse, stringify, Result type integration</li> <li>13-stdlib-io.md - File I/O (encoding support)</li> <li>File read/write, multilingual encoding (Shift_JIS, GBK, Big5, etc.)</li> <li>14-stdlib-test.md - Testing Framework</li> <li>test/run, assertions (assert-eq, assert, assert-not, assert-throws)</li> <li>qi test command (auto-detection, simple output)</li> <li>15-stdlib-math.md - Math Functions</li> <li>Power &amp; root (pow, sqrt), rounding (round, floor, ceil), clamping (clamp)</li> <li>Random generation (rand, rand-int, random-range, shuffle)</li> <li>16-stdlib-auth.md - Authentication &amp; Authorization</li> <li>JWT (JSON Web Token) generation, verification, decoding</li> <li>Password hashing (Argon2)</li> <li>17-stdlib-database.md - Database</li> <li>PostgreSQL connection (query execution, command execution)</li> <li>Parameterized queries, Result type integration</li> <li>18-stdlib-websocket.md - WebSocket Communication</li> <li>WebSocket client (connect, send, receive, close)</li> <li>TLS/SSL support (wss://), message types (text, binary, close, error)</li> <li>19-stdlib-validation.md - Data Validation</li> <li>Schema-based validation (type checking, required fields, string length, numeric range, pattern matching)</li> <li>Nested map validation, Result type integration</li> <li>20-stdlib-debug.md - Debug Features</li> <li>Tracing (debug/trace), breakpoints (debug/break)</li> <li>Stack trace retrieval (debug/stack), debugger info (debug/info)</li> <li>21-stdlib-table.md - Table Processing</li> <li>SQL/awk-like tabular data operations</li> <li>Grouping (table/group-by), deduplication (table/distinct-table)</li> <li>22-stdlib-csv.md - CSV Processing</li> <li>CSV parsing/generation (csv/parse, csv/stringify)</li> <li>File I/O (csv/read-file, csv/write-file), RFC 4180 compliant</li> <li>23-stdlib-env.md - Environment Variables</li> <li>Get/set environment variables (env/get, env/set)</li> <li>Get all environment variables (env/all)</li> <li>Load .env files (env/load-dotenv)</li> <li>24-stdlib-kvs.md - Key-Value Store</li> <li>Unified interface (Redis/Memcached etc.)</li> <li>Basic ops, numeric ops, list, hash, set, batch operations (22 functions)</li> <li>25-stdlib-log.md - Logging</li> <li>Log levels (DEBUG, INFO, WARN, ERROR)</li> <li>Formats (text, JSON), level setting (log/set-level)</li> <li>26-stdlib-markdown.md - Markdown Processing</li> <li>Markdown generation (markdown/header, markdown/list, markdown/table, etc.)</li> <li>Markdown parsing (markdown/parse), static site generation</li> <li>27-stdlib-path.md - Path Operations</li> <li>Path joining (path/join), filename extraction (path/basename)</li> <li>Cross-platform support (Windows/Unix)</li> <li>28-stdlib-stats.md - Statistical Functions</li> <li>Measures of central tendency (mean, median, mode)</li> <li>Measures of dispersion (variance, stddev)</li> <li>Measures of position (percentile)</li> <li>29-stdlib-stream.md - Stream Processing</li> <li>Lazy evaluation (stream, stream/map, stream/filter)</li> <li>Infinite sequences (stream/range, stream/iterate)</li> <li>Memory-efficient large data processing</li> <li>30-stdlib-temp.md - Temporary Files</li> <li>Temporary file creation (temp/temp-file)</li> <li>Temporary directory creation (temp/temp-dir), automatic cleanup</li> <li>31-stdlib-time.md - Date/Time Processing</li> <li>ISO 8601 format (time/now-iso, time/format, time/parse)</li> <li>Date/time arithmetic (time/add-days, time/diff-days), UTC/timezone</li> <li>32-stdlib-zip.md - ZIP Compression/Decompression</li> <li>ZIP creation (zip/create), extraction (zip/extract), listing (zip/list)</li> <li>gzip compression (zip/gzip), decompression (zip/gunzip)</li> <li>Backup, log rotation, distribution archives</li> <li>33-stdlib-cmd.md - External Command Execution</li> <li>Command execution (cmd/exec, cmd/exec!)</li> <li>Pipelines (cmd/pipe), stream processing (cmd/stream-lines)</li> <li>Security considerations (command injection prevention)</li> <li>34-stdlib-list.md - List Extensions</li> <li>Advanced list operations (list/take-while, list/chunk, list/find)</li> <li>Frequency counting (list/frequencies), rotation (list/rotate)</li> <li>35-stdlib-map.md - Map Extensions</li> <li>Nested map operations (map/assoc-in, map/dissoc-in)</li> <li>Key/value transformation (map/update-keys, map/update-vals)</li> <li>36-stdlib-set.md - Set Operations</li> <li>Mathematical set operations (union, intersect, difference, symmetric-difference)</li> <li>Subset checking (subset?, superset?, disjoint?)</li> </ul>"},{"location":"spec/#qi-features","title":"\ud83c\udfaf Qi Features","text":""},{"location":"spec/#1-flow-oriented-programming","title":"1. Flow-Oriented Programming","text":"<p>\"Data flows, programs design the flow\"</p> <pre><code>(data\n |&gt; parse\n |&gt; (filter valid?)\n |&gt; (map transform)\n |&gt; save)\n</code></pre>"},{"location":"spec/#2-easy-concurrency-parallelism","title":"2. Easy Concurrency &amp; Parallelism","text":"<p>Qi's Essence - Thread-safe and Natural Parallelization</p> <pre><code>;; Parallel pipeline\n(urls ||&gt; http/get ||&gt; json/parse)\n\n;; goroutine-style concurrency\n(def result (data ~&gt; transform ~&gt; process))\n(recv! result)\n</code></pre>"},{"location":"spec/#3-pattern-matching","title":"3. Pattern Matching","text":"<p>Branch and Transform Data Flow</p> <pre><code>;; HTTP response pattern matching (try catches errors)\n(match (try (http/get! url))  ;; Detailed version to get status code\n  {:error e} -&gt; (log-error e)\n  {:status 200 :body body} -&gt; (process-body body)\n  {:status 404} -&gt; nil\n  {:status _} -&gt; (error \"Unexpected status\"))\n</code></pre>"},{"location":"spec/#how-to-read-this-documentation","title":"\ud83d\udcd6 How to Read This Documentation","text":""},{"location":"spec/#for-beginners","title":"For Beginners","text":"<ol> <li>01-overview.md - What is Qi?</li> <li>05-syntax-basics.md - Learn basic syntax</li> <li>06-data-structures.md - How to handle data</li> <li>02-flow-pipes.md - Try using pipelines</li> <li>10-stdlib-string.md - Learn string operations</li> </ol>"},{"location":"spec/#for-intermediate-users","title":"For Intermediate Users","text":"<ol> <li>04-match.md - Utilize pattern matching</li> <li>07-functions.md - Functional programming</li> <li>08-error-handling.md - Error handling strategies</li> <li>03-concurrency.md - Utilize concurrent processing</li> <li>11-stdlib-http.md - Build HTTP client/server</li> <li>13-stdlib-io.md - File I/O and encoding</li> </ol>"},{"location":"spec/#for-advanced-users","title":"For Advanced Users","text":"<ol> <li>03-concurrency.md - 3-tier concurrency architecture</li> <li>09-modules.md - Module design</li> <li>02-flow-pipes.md - stream (lazy evaluation)</li> <li>12-stdlib-json.md - JSON/YAML pipeline processing</li> </ol>"},{"location":"spec/#function-operator-index","title":"\ud83d\udd0d Function &amp; Operator Index","text":""},{"location":"spec/#special-forms-14","title":"Special Forms (14)","text":"<ul> <li><code>def</code>, <code>defn</code>, <code>defn-</code> - Definition \u2192 05-syntax-basics.md</li> <li><code>fn</code> - Function definition \u2192 05-syntax-basics.md, 07-functions.md</li> <li><code>let</code> - Local binding \u2192 05-syntax-basics.md</li> <li><code>if</code>, <code>do</code> - Control structures \u2192 05-syntax-basics.md</li> <li><code>when</code> - Execute only when condition is true \u2192 05-syntax-basics.md</li> <li><code>while</code> - Loop while condition is true \u2192 05-syntax-basics.md</li> <li><code>until</code> - Loop until condition is true \u2192 05-syntax-basics.md</li> <li><code>while-some</code> - Loop until nil (with binding) \u2192 05-syntax-basics.md</li> <li><code>until-error</code> - Loop until error (with binding) \u2192 05-syntax-basics.md</li> <li><code>loop</code>, <code>recur</code> - Loop \u2192 05-syntax-basics.md</li> <li><code>match</code> - Pattern matching \u2192 04-match.md</li> <li><code>try</code>, <code>defer</code> - Error handling \u2192 08-error-handling.md</li> <li><code>mac</code> - Macro \u2192 05-syntax-basics.md</li> <li><code>module</code>, <code>export</code>, <code>use</code> - Modules \u2192 09-modules.md</li> </ul>"},{"location":"spec/#pipeline-operators-5","title":"Pipeline Operators (5) \u2b50","text":"<ul> <li><code>|&gt;</code> - Sequential pipe \u2192 02-flow-pipes.md</li> <li><code>|&gt;?</code> - Railway Pipeline (error handling) \u2192 02-flow-pipes.md, 08-error-handling.md</li> <li><code>||&gt;</code> - Parallel pipe \u2192 02-flow-pipes.md</li> <li><code>~&gt;</code> - Async pipe \u2192 02-flow-pipes.md, 03-concurrency.md</li> <li><code>tap&gt;</code> - Side effect tap \u2192 02-flow-pipes.md</li> </ul>"},{"location":"spec/#core-functions-commonly-used","title":"Core Functions (commonly used)","text":"<p>Numeric Operations: - <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> - Arithmetic operations \u2192 05-syntax-basics.md - <code>abs</code>, <code>min</code>, <code>max</code>, <code>inc</code>, <code>dec</code>, <code>sum</code> - Numeric functions \u2192 06-data-structures.md - <code>=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code> - Comparison operations \u2192 05-syntax-basics.md</p> <p>Collections: - <code>first</code>, <code>rest</code>, <code>last</code>, <code>nth</code> - Access \u2192 06-data-structures.md - <code>cons</code>, <code>conj</code>, <code>concat</code> - Concatenation \u2192 06-data-structures.md - <code>take</code>, <code>drop</code>, <code>filter</code>, <code>map</code>, <code>reduce</code>, <code>each</code> - Transformation \u2192 06-data-structures.md - <code>sort</code>, <code>reverse</code>, <code>distinct</code> - Sorting &amp; deduplication \u2192 06-data-structures.md</p> <p>Strings: - <code>str</code>, <code>split</code>, <code>join</code> - Basic operations \u2192 05-syntax-basics.md - 60+ string functions \u2192 10-stdlib-string.md</p> <p>Predicates (23): - <code>nil?</code>, <code>some?</code>, <code>empty?</code> - nil/existence check \u2192 05-syntax-basics.md - <code>number?</code>, <code>string?</code>, <code>list?</code>, <code>vector?</code>, <code>map?</code> - Type checking \u2192 05-syntax-basics.md - <code>even?</code>, <code>odd?</code>, <code>positive?</code>, <code>negative?</code>, <code>zero?</code> - Numeric predicates \u2192 05-syntax-basics.md - <code>error?</code> - Error checking \u2192 05-syntax-basics.md, 08-error-handling.md</p> <p>I/O: - <code>print</code>, <code>println</code> - Output \u2192 05-syntax-basics.md - File I/O \u2192 13-stdlib-io.md</p> <p>Concurrency \u2b50: - <code>go/chan</code>, <code>go/send!</code>, <code>go/recv!</code> - goroutine-style \u2192 03-concurrency.md - <code>pmap</code>, <code>pfilter</code>, <code>preduce</code> - Parallel map/filter/reduce \u2192 03-concurrency.md - <code>atom</code>, <code>swap!</code>, <code>reset!</code>, <code>deref</code> - Thread-safe state management \u2192 03-concurrency.md</p>"},{"location":"spec/#standard-library-functions","title":"Standard Library Functions","text":"<ul> <li>HTTP: <code>http/get</code>, <code>http/post</code>, <code>server/serve</code> \u2192 11-stdlib-http.md</li> <li>WebSocket: <code>ws/connect</code>, <code>ws/send</code>, <code>ws/receive</code>, <code>ws/close</code> \u2192 18-stdlib-websocket.md</li> <li>JSON/YAML: <code>json/parse</code>, <code>json/stringify</code>, <code>yaml/parse</code> \u2192 12-stdlib-json.md</li> <li>Math: <code>math/pow</code>, <code>math/sqrt</code>, <code>math/round</code>, <code>math/rand</code> \u2192 15-stdlib-math.md</li> <li>Stats: <code>stats/mean</code>, <code>stats/median</code>, <code>stats/stddev</code>, <code>stats/percentile</code> \u2192 28-stdlib-stats.md</li> <li>Test: <code>test/assert-eq</code>, <code>test/run</code> \u2192 14-stdlib-test.md</li> <li>String: <code>string/upper</code>, <code>string/lower</code>, <code>string/trim</code>, plus 60+ \u2192 10-stdlib-string.md</li> <li>Auth: <code>jwt/sign</code>, <code>jwt/verify</code>, <code>password/hash</code>, <code>password/verify</code> \u2192 16-stdlib-auth.md</li> <li>Database: <code>db/connect</code>, <code>db/query</code>, <code>db/exec</code> (PostgreSQL/MySQL/SQLite) \u2192 17-stdlib-database.md</li> <li>Debug: <code>debug/trace</code>, <code>debug/break</code>, <code>debug/stack</code>, <code>debug/info</code> \u2192 20-stdlib-debug.md</li> </ul> <p>\ud83d\udcd1 Complete Function Index: FUNCTION-INDEX.md - Detailed reference for all functions (generated by <code>./scripts/list_qi_functions.sh</code>)</p>"},{"location":"spec/#unimplemented-features","title":"\ud83d\ude80 Unimplemented Features","text":"<p>For unimplemented features and roadmap, please refer to <code>ROADMAP.md</code> in the project root.</p>"},{"location":"spec/#documentation-policy","title":"\ud83d\udcdd Documentation Policy","text":"<p>Documentation in this directory:</p> <ul> <li>Only implemented features - All code examples work</li> <li>No Phase markers - All implemented, Phase markers removed</li> <li>Practical examples focus - Not just concepts, but actual working code examples</li> <li>Flow-Oriented - Explanations aligned with Qi's philosophy</li> </ul>"},{"location":"spec/#multilingual-support","title":"\ud83c\udf0d Multilingual Support","text":"<p>Qi supports multilingual error messages.</p>"},{"location":"spec/#usage","title":"Usage","text":"<p>You can specify the language using the <code>QI_LANG</code> environment variable:</p> <pre><code># Display error messages in Japanese\nQI_LANG=ja qi script.qi\n\n# Display error messages in English (default)\nQI_LANG=en qi script.qi\n</code></pre>"},{"location":"spec/#example","title":"Example","text":"<pre><code># Japanese error\n$ QI_LANG=ja qi -e '(+ 1 \"abc\")'\n\u30a8\u30e9\u30fc: \u6570\u5024\u6f14\u7b97\u306b\u306f\u6570\u5024\u306e\u307f\u3092\u4f7f\u7528\u3067\u304d\u307e\u3059\n\n# English error\n$ QI_LANG=en qi -e '(+ 1 \"abc\")'\nError: Numeric operations require numbers only\n</code></pre> <p>Currently supported languages: - Japanese (<code>ja</code>) - Default (for Japanese developers) - English (<code>en</code>) - International support</p> <p>Implementation: Messages are centrally managed in <code>src/i18n.rs</code>.</p>"},{"location":"spec/#related-documentation","title":"\ud83d\udd17 Related Documentation","text":"<ul> <li>ROADMAP.md - Unimplemented features and roadmap</li> <li>style-guide.md - Coding style guide</li> <li>README.md - Overall project description</li> </ul>"},{"location":"spec/#license","title":"\ud83d\udcdc License","text":"<p>This documentation is part of the Qi language project and follows the same license.</p>"},{"location":"spec/01-overview/","title":"Qi Language Overview","text":"<p>Qi - A Lisp that flows</p> <p>A simple, fast, and concise modern Lisp with strong support for pipelines, pattern matching, and concurrency/parallelism.</p> <p>Making parallelism and concurrency easy is Qi's core strength - Thread-safe design with 3-layer concurrency architecture.</p> <p>Note: See style-guide.md for coding style and formatting conventions.</p>"},{"location":"spec/01-overview/#language-philosophy-flow-oriented-programming","title":"Language Philosophy - Flow-Oriented Programming","text":""},{"location":"spec/01-overview/#core-concept","title":"Core Concept","text":"<p>\"Data flows, programs design the flow\"</p> <p>Qi embodies Flow-Oriented Programming:</p> <ol> <li>Data flow as a first-class citizen</li> <li>Pipeline operator <code>|&gt;</code> at the language's core</li> <li><code>match</code> as a control structure for branching and transforming flows</li> <li>Combine small transformations to create larger flows</li> <li> <p>Unix philosophy's \"Do One Thing Well\" realized in functional style</p> </li> <li> <p>Simple, Fast, Concise</p> </li> <li>Simple: 9 special forms, minimal notation, gentle learning curve</li> <li>Fast: Lightweight, fast startup, future JIT compilation</li> <li> <p>Concise: Short function names, pipelines, <code>defn</code> sugar for expressiveness</p> </li> <li> <p>Energy Flow</p> </li> <li>Data flows unidirectionally (left-to-right, top-to-bottom)</li> <li>Side effects observed via taps (<code>tap&gt;</code>)</li> <li>Parallel processing expressed as flow branching/merging</li> <li> <p>Easy parallelism &amp; concurrency - Natural parallelization with thread-safe design</p> </li> <li> <p>Pragmatism</p> </li> <li>Practical utility over Lisp purity</li> <li>Modern features actively adopted (f-strings, pattern matching)</li> <li>Batteries included (rich string operations, utilities)</li> </ol>"},{"location":"spec/01-overview/#design-principles","title":"Design Principles","text":"<ol> <li>Readability &gt; Writability</li> <li>Pipelines read top-to-bottom, left-to-right</li> <li> <p>Data flow visible at a glance</p> </li> <li> <p>Composability</p> </li> <li>Combine small functions to build larger processes</li> <li> <p>Each step independently testable</p> </li> <li> <p>Progressive Disclosure</p> </li> <li>Beginners: Start with basic <code>|&gt;</code></li> <li>Intermediate: Leverage <code>match</code>, <code>loop</code></li> <li> <p>Advanced: Master parallel processing</p> </li> <li> <p>Runtime Efficiency</p> </li> <li>Pipeline optimization</li> <li>Lazy evaluation to avoid unnecessary computation</li> <li>Natural scaling through parallelism</li> </ol>"},{"location":"spec/01-overview/#file-extension","title":"File Extension","text":"<pre><code>.qi\n</code></pre>"},{"location":"spec/01-overview/#usage-running-qi","title":"Usage - Running Qi","text":"<p>Qi supports 3 execution modes + standard input:</p>"},{"location":"spec/01-overview/#1-repl-interactive-mode","title":"1. REPL (Interactive Mode)","text":"<pre><code>qi\n# or\nqi -l utils.qi  # Preload file and start REPL\n</code></pre>"},{"location":"spec/01-overview/#2-script-file-execution","title":"2. Script File Execution","text":"<pre><code>qi script.qi\nqi examples/hello.qi\n</code></pre>"},{"location":"spec/01-overview/#3-one-liner-execution","title":"3. One-liner Execution","text":"<pre><code>qi -e '(println \"Hello!\")'\nqi -e '((range 1 10) |&gt; (map (fn [x] (* x x))) |&gt; sum)'\n</code></pre>"},{"location":"spec/01-overview/#4-standard-input-execution","title":"4. Standard Input Execution","text":"<p>Following Unix Philosophy - Pipeline Integration</p> <pre><code># From echo\necho '(println \"Hello from stdin!\")' | qi -\n\n# Multiline script with heredoc\nqi - &lt;&lt;'EOF'\n(def data [1 2 3 4 5])\n(def result (data |&gt; (map (fn [x] (* x x))) |&gt; sum))\n(println (str \"Sum of squares: \" result))\nEOF\n\n# Generate Qi script from other commands\njq -r '.script' config.json | qi -\ncurl -s https://example.com/script.qi | qi -\n\n# No temporary files needed (security improvement)\necho \"$SECRET_SCRIPT\" | qi -\n\n# Dynamic script execution in CI/CD\ncat automation.qi | qi -\n</code></pre>"},{"location":"spec/01-overview/#why-standard-input-execution-matters","title":"Why Standard Input Execution Matters","text":"<ol> <li>Unix Philosophy - Other tools (python/node/ruby) support <code>-</code></li> <li>Pipeline Integration - Execute command output directly</li> <li>Security - No sensitive scripts left on disk</li> <li>Dynamic Generation - Other tools generate Qi code \u2192 immediate execution</li> <li>CI/CD Support - Inject scripts from GitHub Secrets</li> </ol> <pre><code># Real-world example: Extract and execute Qi script from JSON\ncat automation.json | jq -r '.tasks.cleanup.script' | qi -\n\n# Real-world example: Dynamically generate data processing script\n./generate-processor.sh --type=csv --columns=3 | qi -\n</code></pre>"},{"location":"spec/01-overview/#basic-design","title":"Basic Design","text":""},{"location":"spec/01-overview/#namespace","title":"Namespace","text":"<p>Lisp-1 (Scheme-style) - Variables and functions share the same namespace</p> <pre><code>(def add (fn [x y] (+ x y)))\n(def op add)           ;; Assign function to variable\n(op 1 2)               ;; 3\n</code></pre>"},{"location":"spec/01-overview/#nil-and-bool","title":"nil and bool","text":"<p>nil and bool are distinct, but nil is falsy in conditionals</p> <pre><code>nil false true          ;; Three distinct values\n(if nil \"yes\" \"no\")     ;; \"no\" (nil is falsy)\n(if false \"yes\" \"no\")   ;; \"no\" (false is falsy)\n(if 0 \"yes\" \"no\")       ;; \"yes\" (0 is truthy)\n(if \"\" \"yes\" \"no\")      ;; \"yes\" (empty string is truthy)\n\n;; Explicit comparison\n(= x nil)               ;; nil check\n(= x false)             ;; false check\n</code></pre>"},{"location":"spec/01-overview/#type-system","title":"Type System","text":"<p>Qi is dynamically typed with the following basic types:</p> <ul> <li>Numbers: Integers, floating-point</li> <li>Strings: UTF-8, f-string support</li> <li>Booleans: <code>true</code>, <code>false</code></li> <li>nil: Represents absence of value</li> <li>Vectors: <code>[1 2 3]</code></li> <li>Maps: <code>{:key \"value\"}</code></li> <li>Lists: <code>'(1 2 3)</code> (quote required)</li> <li>Functions: First-class objects</li> <li>Keywords: <code>:keyword</code></li> </ul>"},{"location":"spec/02-flow-pipes/","title":"Pipeline Extensions - Flow DSL","text":"<p>A language for designing flow</p> <p>Qi extends pipeline operators to intuitively express data flow.</p> <p>Implementation: <code>src/builtins/flow.rs</code>, <code>src/builtins/util.rs</code>, <code>src/builtins/stream.rs</code></p>"},{"location":"spec/02-flow-pipes/#pipeline-operator-system","title":"Pipeline Operator System","text":"Operator Meaning Use Case <code>|&gt;</code> Sequential pipe Basic data transformation <code>\\|&gt;?</code> Railway pipe Error handling, Result chaining <code>||&gt;</code> Parallel pipe Auto-pmap, list parallelization <code>tap&gt;</code> Side-effect tap Debugging, logging, monitoring <code>~&gt;</code> Async pipe go/chan integration, async I/O"},{"location":"spec/02-flow-pipes/#basic-pipeline","title":"<code>|&gt;</code> Basic Pipeline","text":"<p>Flow data left-to-right</p> <pre><code>;; Basic\n(data |&gt; parse |&gt; transform |&gt; save)\n\n;; Avoid nesting\n(data\n |&gt; (filter valid?)\n |&gt; (map transform)\n |&gt; (reduce merge {}))\n\n;; Functions with arguments\n(10 |&gt; (+ 5) |&gt; (* 2))  ;; (+ 10 5) |&gt; (* 2) =&gt; 30\n\n;; _ placeholder: Insert value at any position\n(42 |&gt; (+ 10 _ 3))  ;; (+ 10 42 3) =&gt; 55\n(\"world\" |&gt; (str \"Hello, \" _))  ;; (str \"Hello, \" \"world\") =&gt; \"Hello, world\"\n\n;; Real-world example: URL construction\n(def params [[\"user\" \"john\"] [\"id\" \"123\"]])\n(def base-url \"https://api.example.com\")\n(params\n |&gt; (map (fn [[k v]] f\"{k}={v}\"))\n |&gt; (join \"&amp;\" _)\n |&gt; (str base-url \"?\" _))\n</code></pre>"},{"location":"spec/02-flow-pipes/#parallel-pipeline","title":"<code>||&gt;</code> Parallel Pipeline","text":"<p>Auto-expands to pmap</p> <pre><code>;; Parallel processing\n(urls ||&gt; http/get ||&gt; json/parse)\n;; \u2193 Expands to\n(urls |&gt; (pmap http/get) |&gt; (pmap json/parse))\n\n;; Basic usage\n([1 2 3 4 5] ||&gt; inc)  ;; (2 3 4 5 6)\n\n;; CPU-intensive processing\n(images ||&gt; resize ||&gt; compress ||&gt; save)\n\n;; Data analysis\n(files\n ||&gt; load-csv\n ||&gt; analyze\n |&gt; merge-results)  ;; Final merge is sequential\n\n;; Complex pipeline\n(data\n ||&gt; (fn [x] (* x 2))\n |&gt; (filter (fn [n] (&gt; n 50)))\n |&gt; sum)\n</code></pre> <p>Implementation: - lexer: Recognizes <code>||&gt;</code> as <code>Token::ParallelPipe</code> - parser: <code>x ||&gt; f</code> \u2192 expands to <code>(pmap f x)</code></p>"},{"location":"spec/02-flow-pipes/#performance-guidelines","title":"Performance Guidelines \u26a1","text":"<p>When to parallelize: - CPU-intensive operations (image processing, compression, computation) - I/O-bound operations (HTTP requests, file reading) - Large number of elements (guideline: 100+ elements)</p> <p>When NOT to parallelize: - Lightweight operations (&lt; 1ms per element) - Small number of elements (guideline: &lt; 10 elements) - Memory constraints</p> <pre><code>;; \u2705 Good: CPU-intensive + large dataset\n(large-images ||&gt; resize ||&gt; compress)\n\n;; \u274c Bad: Lightweight operation + small data (parallelization overhead slows it down)\n([1 2 3] ||&gt; inc)  ;; Use |&gt; instead\n\n;; \ud83d\udca1 Guideline for choosing\n(if (&gt; (len data) 100)\n  (data ||&gt; heavy-process)  ;; Parallelize\n  (data |&gt; (map heavy-process)))  ;; Sequential\n</code></pre>"},{"location":"spec/02-flow-pipes/#railway-pipeline","title":"<code>|&gt;?</code> Railway Pipeline","text":"<p>Build error handling into the flow - Railway Oriented Programming</p>"},{"location":"spec/02-flow-pipes/#new-specification-everything-except-error-is-success","title":"New Specification: Everything except <code>:error</code> is success","text":"<p>Everything except <code>{:error}</code> is treated as success! No <code>:ok</code> wrapping</p> <pre><code>;; Simple! Values flow through as-is\n(10\n |&gt;? (fn [x] (* x 2))     ;; 20 \u2192 passes to next\n |&gt;? (fn [x] (+ x 5)))    ;; 25 \u2192 passes to next\n;; =&gt; 25\n\n;; Only use {:error} explicitly when you want to return an error\n(10\n |&gt;? (fn [x] (if (&gt; x 0) (* x 2) {:error \"negative\"}))\n |&gt;? (fn [x] (+ x 5)))\n;; =&gt; 25\n\n(-5\n |&gt;? (fn [x] (if (&gt; x 0) (* x 2) {:error \"negative\"}))\n |&gt;? (fn [x] (+ x 5)))    ;; Not executed (short-circuit)\n;; =&gt; {:error \"negative\"}\n</code></pre>"},{"location":"spec/02-flow-pipes/#behavior-rules","title":"Behavior Rules","text":"<p>Input processing: 1. <code>{:error ...}</code> \u2192 Short-circuit (don't execute next function) 2. Everything else \u2192 Pass to next function as-is</p> <p>Output processing: 1. <code>{:error ...}</code> \u2192 Return as-is (error propagation) 2. Everything else \u2192 Return as-is (no <code>:ok</code> wrapping!)</p>"},{"location":"spec/02-flow-pipes/#real-world-examples","title":"Real-world Examples","text":"<pre><code>;; HTTP request + data transformation (Simple!)\n(\"https://api.example.com/users/123\"\n |&gt; http/get                 ;; =&gt; \"{\\\"user\\\": {...}}\" (body only)\n |&gt;? json/parse              ;; =&gt; Parse result (value as-is)\n |&gt;? (fn [data] (get data \"user\")))  ;; Just return the value!\n;; =&gt; User data (value as-is)\n\n;; Conditional error\n(defn validate-age [age]\n  (if (&gt;= age 18)\n    age                       ;; Plain value \u2192 success\n    {:error \"Must be 18+\"}))  ;; Only errors are explicit\n\n(20 |&gt;? validate-age |&gt;? (fn [x] (* x 2)))  ;; =&gt; 40\n(15 |&gt;? validate-age |&gt;? (fn [x] (* x 2)))  ;; =&gt; {:error \"Must be 18+\"}\n</code></pre> <p>Usage distinction: - <code>|&gt;</code>: Normal data transformation (no errors) - <code>|&gt;?</code>: Error-prone operations (API, file I/O, parsing)</p> <p>Design Philosophy: Express error handling as part of the flow. Avoid try-catch nesting, keeping data flow clear. Perfect integration with JSON and HTTP for web development. Everything except <code>{:error}</code> is success - same philosophy as Lisp's \"everything except nil is true,\" keeping it simple.</p>"},{"location":"spec/02-flow-pipes/#tap-side-effect-tap","title":"<code>tap&gt;</code> Side-effect Tap","text":"<p>Observe without stopping the flow (Unix <code>tee</code> equivalent)</p> <pre><code>;; Debugging\n(data\n |&gt; clean\n |&gt; (tap print)\n |&gt; analyze\n |&gt; (tap log)\n |&gt; save)\n\n;; Logging\n(requests\n |&gt; (tap log-request)\n |&gt; process\n |&gt; (tap log-response))\n\n;; Concise usage\n([1 2 3]\n |&gt; (map inc)\n |&gt; (tap print)\n |&gt; sum)\n</code></pre> <p>Implementation: - Implemented as <code>tap</code> function - Used as <code>|&gt; (tap f)</code> in pipelines - Executes function and returns original value</p>"},{"location":"spec/02-flow-pipes/#async-pipeline","title":"<code>~&gt;</code> Async Pipeline","text":"<p>Integration with concurrency - goroutine-style async execution</p> <p>The <code>~&gt;</code> operator automatically executes pipelines in goroutines and returns results via channels.</p> <pre><code>;; Basic async pipeline\n(def result (data ~&gt; transform ~&gt; process))  ; Returns channel immediately\n(go/recv! result)  ; Receive result\n\n;; Multiple async operations\n(def r1 (10 ~&gt; inc ~&gt; (fn [x] (* x 2))))\n(def r2 (20 ~&gt; (fn [x] (* x 2)) ~&gt; inc))\n(println (go/recv! r1) (go/recv! r2))  ; Execute concurrently\n\n;; Also usable in go blocks\n(go/run\n  (go/send! output-chan (data ~&gt; transform)))\n</code></pre>"},{"location":"spec/02-flow-pipes/#stream-lazy-evaluation","title":"<code>stream</code> Lazy Evaluation","text":"<p>Efficient processing of large data - Lazy evaluation and infinite data structures</p> <p>Streams are lazy-evaluated data structures that don't compute values until needed. They enable memory-efficient handling of infinite data structures and large datasets.</p>"},{"location":"spec/02-flow-pipes/#stream-creation","title":"Stream Creation","text":"<pre><code>;; Create stream from collection\n(stream/stream [1 2 3 4 5])\n\n;; Range stream\n(stream/range 0 10)  ;; 0 to 9\n\n;; Infinite stream: repeat same value\n(stream/repeat 42)  ;; 42, 42, 42, ...\n\n;; Infinite stream: cycle through list\n(stream/cycle [1 2 3])  ;; 1, 2, 3, 1, 2, 3, ...\n\n;; Infinite stream: iterate function application\n(stream/iterate (fn [x] (* x 2)) 1)  ;; 1, 2, 4, 8, 16, 32, ...\n</code></pre>"},{"location":"spec/02-flow-pipes/#stream-transformations","title":"Stream Transformations","text":"<pre><code>;; map: Apply function to each element\n(def s (stream/range 1 6))\n(def s2 (stream/map (fn [x] (* x 2)) s))\n(stream/realize s2)  ;; (2 4 6 8 10)\n\n;; filter: Only elements matching condition\n(def s (stream/range 1 11))\n(def s2 (stream/filter (fn [x] (= (% x 2) 0)) s))\n(stream/realize s2)  ;; (2 4 6 8 10)\n\n;; take: Get first n elements (make infinite streams finite)\n(def s (stream/repeat 42))\n(def s2 (stream/take 5 s))\n(stream/realize s2)  ;; (42 42 42 42 42)\n\n;; drop: Skip first n elements\n(def s (stream/range 0 10))\n(def s2 (stream/drop 5 s))\n(stream/realize s2)  ;; (5 6 7 8 9)\n</code></pre>"},{"location":"spec/02-flow-pipes/#stream-execution","title":"Stream Execution","text":"<pre><code>;; realize: Convert stream to list (compute all elements)\n(stream/realize (stream/stream [1 2 3]))  ;; (1 2 3)\n\n;; \u26a0\ufe0f Warning: Realizing infinite streams causes infinite loops\n;; (stream/realize (stream/repeat 42))  ;; NG: Never terminates\n\n;; Correct usage: Make finite with take before realizing\n(stream/realize (stream/take 5 (stream/repeat 42)))  ;; OK\n</code></pre>"},{"location":"spec/02-flow-pipes/#pipeline-integration","title":"Pipeline Integration","text":"<pre><code>;; Works with existing |&gt; pipeline operator\n[1 2 3 4 5]\n  |&gt; stream/stream\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (&gt; x 10)))\n  |&gt; stream/realize\n;; (16 25)\n\n;; Infinite stream processing\n1\n  |&gt; (stream/iterate (fn [x] (* x 2)))\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; (1 2 4 8 16 32 64 128 256 512)\n\n;; Complex transformation chain\n(stream/range 1 100)\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (= (% x 3) 0)))\n  |&gt; (stream/take 5)\n  |&gt; stream/realize\n;; (9 36 81 144 225)\n</code></pre>"},{"location":"spec/02-flow-pipes/#real-world-examples_1","title":"Real-world Examples","text":"<pre><code>;; Infinite stream of primes (concept - requires prime? function)\n(comment\n  (defn prime? [n]\n    (and (&gt; n 1)\n         (not (some (fn [i] (= (% n i) 0)) (range 2 (+ (int (math/sqrt n)) 1))))))\n\n  (def primes\n    (2\n     |&gt; (stream/iterate inc)\n     |&gt; (stream/filter prime?)))\n\n  (stream/realize (stream/take 10 primes)))  ;; First 10 primes\n\n;; Fibonacci sequence\n(def fib-stream\n  (stream/iterate (fn [[a b]] [b (+ a b)]) [0 1]))\n\n(stream/realize (stream/take 10 fib-stream)\n  |&gt; (map first))  ;; (0 1 1 2 3 5 8 13 21 34)\n\n;; Data processing pipeline (concept - requires parse and valid? functions)\n(comment\n  (defn parse [x] (json/parse x))\n  (defn valid? [x] (get x \"valid\"))\n\n  (defn process-data [data]\n    (data\n     |&gt; stream/stream\n     |&gt; (stream/map parse)\n     |&gt; (stream/filter valid?)\n     |&gt; (stream/take 1000)\n     |&gt; stream/realize)))\n</code></pre>"},{"location":"spec/02-flow-pipes/#io-streams","title":"I/O Streams","text":"<p>Lazy file and HTTP data loading - Text &amp; binary support</p>"},{"location":"spec/02-flow-pipes/#text-mode-line-based","title":"Text Mode (line-based)","text":"<pre><code>;; stream/file: Lazy line-by-line file reading (concept example)\n(comment\n  (defn error-line? [line] (str/contains? line \"ERROR\"))\n  (defn parse [line] (str/split line \" \"))\n\n  (stream/file \"large.log\")\n    |&gt; (stream/filter error-line?)\n    |&gt; (stream/map parse)\n    |&gt; (stream/take 100)\n    |&gt; stream/realize)\n\n;; http/get-stream: Read HTTP response line-by-line\n(http/get-stream \"https://api.example.com/data\")\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n\n;; http/post-stream: Streaming POST request reception\n(http/post-stream \"https://api.example.com/upload\" {:data \"value\"})\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n\n;; http/request-stream: Streaming with detailed configuration (concept example)\n(comment\n  (defn important? [line] (str/contains? line \"IMPORTANT\"))\n\n  (http/request-stream {\n    :method \"GET\"\n    :url \"https://api.example.com/stream\"\n  })\n    |&gt; (stream/filter important?)\n    |&gt; stream/realize)\n</code></pre>"},{"location":"spec/02-flow-pipes/#binary-mode-byte-chunks","title":"Binary Mode (byte chunks)","text":"<pre><code>;; stream/file :bytes - Read file in 4KB chunks\n(stream/file \"image.png\" :bytes)\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; =&gt; List of Vector of Integers (bytes)\n\n;; http/get-stream :bytes - HTTP binary download\n(http/get-stream \"https://example.com/file.bin\" :bytes)\n  |&gt; (stream/map process-chunk)\n  |&gt; stream/realize\n\n;; Byte processing example\n(def bytes (first (stream/realize (stream/take 1 (stream/file \"data.bin\" :bytes)))))\n(def sum (reduce + bytes))  ; Sum of bytes\n(println sum)\n\n;; Image download\n(http/get-stream \"https://example.com/logo.png\" :bytes)\n  |&gt; stream/realize\n  |&gt; flatten\n  |&gt; (write-bytes \"logo.png\")  ; write-bytes to be implemented\n</code></pre> <p>Mode Comparison:</p> Mode Use Case Return Value Example Text (default) Logs, CSV, JSON String (per line) <code>(stream/file \"data.txt\")</code> Binary (<code>:bytes</code>) Images, video, binary Vector of Integers (4KB chunks) <code>(stream/file \"image.png\" :bytes)</code> <pre><code>;; CSV file processing\n(stream/file \"data.csv\")\n  |&gt; (stream/drop 1)  ; Skip header\n  |&gt; (stream/map (fn [line] (split line \",\")))\n  |&gt; (stream/filter (fn [cols] (&gt; (len cols) 2)))\n  |&gt; (stream/take 1000)\n  |&gt; stream/realize\n\n;; Fetch and parse JSON from HTTP\n(http/get-stream \"https://jsonplaceholder.typicode.com/todos/1\")\n  |&gt; stream/realize\n  |&gt; (join \"\\n\")\n  |&gt; json/parse\n</code></pre> <p>Real-world Example: Log File Analysis</p> <pre><code>;; Process large log files memory-efficiently (concept example)\n(comment\n  (defn parse-log-line [line]\n    (let [parts (str/split line \" \")]\n      {:timestamp (first parts)\n       :level (get parts 1)\n       :message (join \" \" (drop 2 parts))}))\n\n  (defn analyze-logs [file]\n    (stream/file file\n     |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n     |&gt; (stream/map parse-log-line)\n     |&gt; (stream/take 100)  ; First 100 errors\n     |&gt; stream/realize))\n\n  ;; Get results\n  (def errors (analyze-logs \"/var/log/app.log\"))\n  (println (str \"Found \" (len errors) \" errors\")))\n</code></pre>"},{"location":"spec/02-flow-pipes/#pipeline-culture","title":"Pipeline Culture","text":"<p>Unix Philosophy \u00d7 Functional \u00d7 Lisp</p> <p>You can build complex processing by defining small pipes and combining them.</p> <pre><code>;; Define small pipes (concept example)\n(comment\n  (defn remove-punctuation [text]\n    (str/replace text \"[^a-zA-Z0-9\\\\s@.]\" \"\"))\n\n  (defn email? [s]\n    (str/contains? s \"@\"))\n\n  (def clean-text\n    (fn [text]\n      (text |&gt; str/trim |&gt; str/lower |&gt; remove-punctuation)))\n\n  (def extract-emails\n    (fn [text]\n      (text |&gt; (str/split \"\\\\s+\") |&gt; (filter email?))))\n\n  (def dedupe\n    (fn [coll]\n      (coll |&gt; sort |&gt; distinct)))\n\n  ;; Combine them\n  (def document \"Contact: john@example.com, JANE@EXAMPLE.COM!! Support: support@example.com\")\n  (document\n   |&gt; clean-text\n   |&gt; extract-emails\n   |&gt; dedupe\n   |&gt; (join \", \")))\n</code></pre>"},{"location":"spec/03-concurrency/","title":"Concurrency &amp; Parallelism - Qi's Core Strength","text":"<p>Qi treats concurrency and parallelism as first-class citizens.</p> <p>\"Making parallelism and concurrency easy is Qi's core strength\" - This is the heart of Qi's design philosophy.</p> <p>Implementation: <code>src/builtins/concurrency.rs</code>, <code>src/builtins/fn.rs</code></p>"},{"location":"spec/03-concurrency/#design-philosophy","title":"Design Philosophy","text":"<p>Qi's concurrency and parallelism use a 3-layer architecture:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Layer 3: go/await (High-level)     \u2502  \u2190 Ease of use (I/O, API)\n\u2502  - go/await, go/then, go/catch      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Layer 2: Pipeline (Mid-level)      \u2502  \u2190 Functional style\n\u2502  - pmap, go/pipeline, go/fan-out/in \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Layer 1: go/chan (Low-level base)  \u2502  \u2190 Power and flexibility\n\u2502  - go/run, go/chan, go/send!, ...   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>All unified under go/ namespace - Simple and consistent architecture.</p>"},{"location":"spec/03-concurrency/#layer-1-gochan-foundation","title":"Layer 1: go/chan (Foundation)","text":"<p>Go-style concurrency</p>"},{"location":"spec/03-concurrency/#channel-creation","title":"Channel Creation","text":"<pre><code>(go/chan)       ;; Unlimited buffer\n(go/chan 10)    ;; Buffer size 10\n</code></pre>"},{"location":"spec/03-concurrency/#sendreceive","title":"Send/Receive","text":"<pre><code>;; Channel send and receive\n(def ch (go/chan))\n(def value 42)\n\n(go/send! ch value)              ;; Send to channel\n(go/recv! ch)                    ;; Blocking receive\n(go/recv! ch :timeout 1000)      ;; Receive with timeout (milliseconds)\n(go/try-recv! ch)                ;; Non-blocking receive\n(go/close! ch)                   ;; Close channel\n</code></pre>"},{"location":"spec/03-concurrency/#goroutines","title":"Goroutines","text":"<pre><code>(go/run (println \"async!\"))\n\n(def result-ch (go/chan))\n(go/run (go/send! result-ch (* 2 3)))\n(go/recv! result-ch)  ;; 6\n</code></pre>"},{"location":"spec/03-concurrency/#usage-example-parallel-computation","title":"Usage Example: Parallel Computation","text":"<pre><code>;; Parallel computation with multiple goroutines\n(def ch (go/chan))\n\n(go/run (go/send! ch (* 2 3)))\n(go/run (go/send! ch (* 4 5)))\n(go/run (go/send! ch (* 6 7)))\n\n[(go/recv! ch) (go/recv! ch) (go/recv! ch)]  ;; =&gt; [6 20 42]\n</code></pre>"},{"location":"spec/03-concurrency/#select-waiting-on-multiple-channels","title":"select! - Waiting on Multiple Channels","text":"<pre><code>;; Process first data from multiple channels\n(def ch1 (go/chan))\n(def ch2 (go/chan))\n\n(go/run (go/send! ch1 \"from ch1\"))\n(go/run (go/send! ch2 \"from ch2\"))\n\n(go/select!\n  ch1 (fn [val] (println \"Got from ch1:\" val))\n  ch2 (fn [val] (println \"Got from ch2:\" val)))\n</code></pre>"},{"location":"spec/03-concurrency/#structured-concurrency","title":"Structured Concurrency","text":"<pre><code>;; Create scope\n(def ctx (go/make-scope))\n\n;; Launch goroutine within scope\n(go/scope-go ctx (fn []\n  (loop [i 0]\n    (if (go/cancelled? ctx)\n      (println \"cancelled\")\n      (do\n        (println i)\n        (sleep 100)\n        (recur (inc i)))))))\n\n;; Cancel all goroutines in scope\n(go/cancel! ctx)\n\n;; with-scope function (convenient version)\n(go/with-scope (fn [ctx]\n  (go/scope-go ctx task1)\n  (go/scope-go ctx task2)\n  ;; Auto-cancel on scope exit\n  ))\n</code></pre>"},{"location":"spec/03-concurrency/#layer-2-pipeline-structured-concurrency","title":"Layer 2: Pipeline (Structured Concurrency)","text":"<p>Functional-style parallelism</p>"},{"location":"spec/03-concurrency/#parallel-collection-operations","title":"Parallel Collection Operations","text":"<pre><code>;; pmap - parallel map (using rayon)\n([1 2 3 4 5] |&gt; (pmap (fn [x] (* x x))))\n;; =&gt; (1 4 9 16 25)\n\n;; go/pfilter - parallel filter\n([1 2 3 4 5 6] |&gt; (go/pfilter (fn [x] (= (% x 2) 0))))\n;; =&gt; (2 4 6)\n\n;; go/preduce - parallel reduce (fn collection init)\n([1 2 3 4 5] |&gt; (fn [data] (go/preduce + data 0)))\n;; =&gt; 15\n\n;; go/parallel-do - parallel execution of multiple expressions\n(go/parallel-do\n  (println \"Task 1\")\n  (println \"Task 2\")\n  (println \"Task 3\"))\n</code></pre>"},{"location":"spec/03-concurrency/#pipeline-processing","title":"Pipeline Processing","text":"<pre><code>;; pipeline - apply xf transformation to ch with n parallelism\n(def ch (go/chan))\n(go/pipeline 4 (fn [x] (* x 2)) ch)\n</code></pre>"},{"location":"spec/03-concurrency/#fan-outfan-in","title":"Fan-out/Fan-in","text":"<pre><code>;; fan-out - branch one channel into n channels\n(def ch (go/chan))\n(def output-chs (go/fan-out ch 3))\n\n;; fan-in - merge multiple channels into one\n(def ch1 (go/chan))\n(def ch2 (go/chan))\n(def ch3 (go/chan))\n(def merged (go/fan-in [ch1 ch2 ch3]))\n</code></pre>"},{"location":"spec/03-concurrency/#layer-3-goawait-high-level","title":"Layer 3: go/await (High-level)","text":"<p>Modern async processing</p>"},{"location":"spec/03-concurrency/#basic-await","title":"Basic await","text":"<pre><code>(def p (go/run (fn [] (+ 1 2 3))))\n(go/await p)  ;; =&gt; 6\n</code></pre>"},{"location":"spec/03-concurrency/#promise-chain","title":"Promise Chain","text":"<pre><code>(-&gt; (go/run (fn [] 10))\n    (go/then (fn [x] (* x 2)))\n    (go/then (fn [x] (+ x 1)))\n    (go/await))  ;; =&gt; 21\n</code></pre>"},{"location":"spec/03-concurrency/#promiseall-style","title":"Promise.all-style","text":"<pre><code>(def promises [(go/run (fn [] 1)) (go/run (fn [] 2)) (go/run (fn [] 3))])\n(go/await (go/all promises))  ;; =&gt; [1 2 3]\n</code></pre>"},{"location":"spec/03-concurrency/#promiserace-style","title":"Promise.race-style","text":"<pre><code>(def promises [(go/run (fn [] \"slow\")) (go/run (fn [] \"fast\"))])\n(go/await (go/race promises))  ;; =&gt; \"fast\"\n</code></pre>"},{"location":"spec/03-concurrency/#error-handling","title":"Error Handling","text":"<pre><code>(go/catch promise (fn [e] (println \"Error:\" e)))\n</code></pre>"},{"location":"spec/03-concurrency/#state-management-atom","title":"State Management - Atom","text":"<p>Thread-safe state management</p> <p>Qi uses Atoms for state management. Atoms provide a mechanism to have state only where needed while maintaining referential transparency.</p>"},{"location":"spec/03-concurrency/#basic-operations","title":"Basic Operations","text":"<pre><code>atom                    ;; Create atom\nderef                   ;; Get value\n@                       ;; deref shorthand (@counter =&gt; (deref counter))\nswap!                   ;; Update with function (atomic)\nreset!                  ;; Set value directly\n</code></pre>"},{"location":"spec/03-concurrency/#atom-creation-and-reference","title":"Atom Creation and Reference","text":"<pre><code>;; Counter\n(def counter (atom 0))\n\n;; Get value\n(deref counter)  ;; 0\n\n;; Update value\n(reset! counter 10)\n(deref counter)  ;; 10\n\n;; Update with function (uses current value)\n(swap! counter inc)\n(deref counter)  ;; 11\n\n(swap! counter + 5)\n(deref counter)  ;; 16\n</code></pre>"},{"location":"spec/03-concurrency/#syntax-deref-shorthand","title":"@ Syntax (deref shorthand)","text":"<pre><code>;; deref shorthand\n(deref counter)  ;; Traditional\n@counter         ;; Shorthand\n\n;; Both mean the same thing\n(print (deref state))\n(print @state)\n\n;; Convenient in pipelines\n(def cache (atom {:user-123 {:name \"Alice\"}}))\n(get @cache :user-123)  ;; {:name \"Alice\"}\n\n;; Also usable as function arguments\n(def users (atom [{:name \"Alice\"} {:name \"Bob\"}]))\n(first @users)  ;; {:name \"Alice\"}\n(map (fn [u] (get u :name)) @users)  ;; (\"Alice\" \"Bob\")\n</code></pre>"},{"location":"spec/03-concurrency/#real-world-example-1-counter","title":"Real-world Example 1: Counter","text":"<pre><code>;; Request counter\n(def request-count (atom 0))\n\n(defn handle-request [req]\n  (do\n    (swap! request-count inc)\n    (process req)))\n\n;; Check current count\n(deref request-count)  ;; Number of processed requests\n</code></pre>"},{"location":"spec/03-concurrency/#real-world-example-2-stateful-cache","title":"Real-world Example 2: Stateful Cache","text":"<pre><code>;; Cache\n(def cache (atom {}))\n\n(defn get-or-fetch [key fetch-fn]\n  (let [cached (get (deref cache) key)]\n    (if cached\n      cached\n      (let [value (fetch-fn)]\n        (do\n          (swap! cache assoc key value)\n          value)))))\n\n;; Usage\n(get-or-fetch :user-123 (fn [] (fetch-from-db :user-123)))\n</code></pre>"},{"location":"spec/03-concurrency/#real-world-example-3-connection-management-with-defer","title":"Real-world Example 3: Connection Management (with defer)","text":"<pre><code>;; Manage active connections\n(def clients (atom #{}))\n\n(defn handle-connection [conn]\n  (do\n    (swap! clients conj conn)\n    (defer (swap! clients dissoc conn))  ;; Guaranteed cleanup\n    (process-connection conn)))\n\n;; Active connection count\n(len (deref clients))\n</code></pre>"},{"location":"spec/03-concurrency/#real-world-example-4-complex-state-updates","title":"Real-world Example 4: Complex State Updates","text":"<pre><code>;; Application state\n(def app-state (atom {\n  :users {}\n  :posts []\n  :status \"running\"\n}))\n\n;; Add user\n(defn add-user [user]\n  (swap! app-state (fn [state]\n    (assoc state :users\n      (assoc (get state :users) (get user :id) user)))))\n\n;; Add post\n(defn add-post [post]\n  (swap! app-state (fn [state]\n    (assoc state :posts (conj (get state :posts) post)))))\n\n;; Check state\n(deref app-state)\n</code></pre>"},{"location":"spec/03-concurrency/#real-world-example-5-thread-safe-counter","title":"Real-world Example 5: Thread-safe Counter","text":"<pre><code>(def counter (atom 0))\n\n;; Safe increment from multiple goroutines\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n\n(sleep 100)  ;; Wait for completion\n(deref counter)  ;; =&gt; 3\n</code></pre>"},{"location":"spec/03-concurrency/#atom-design-philosophy","title":"Atom Design Philosophy","text":"<ol> <li>Local state: Use Atoms only where needed instead of global variables</li> <li>Atomic swap!: Updates are guaranteed to apply (avoid race conditions)</li> <li>Coexistence with functional: Combine pure functions with Atoms</li> <li>Great with defer: Powerful for resource management</li> </ol>"},{"location":"spec/03-concurrency/#implementation-technology-stack","title":"Implementation Technology Stack","text":"<ul> <li>crossbeam-channel: Go-style channel implementation (also provides select! macro)</li> <li>rayon: Data parallelism (pmap, go/pfilter, go/preduce, etc.)</li> <li>parking_lot: High-performance RwLock</li> <li>Arc&lt;RwLock&lt;_&gt;&gt;: Complete thread-safety of Evaluator</li> </ul>"},{"location":"spec/03-concurrency/#function-list","title":"Function List","text":""},{"location":"spec/03-concurrency/#layer-1-gochan","title":"Layer 1 (go/chan)","text":"<ul> <li><code>go/chan</code>: Create channel</li> <li><code>go/send!</code>: Send</li> <li><code>go/recv!</code>: Blocking receive</li> <li><code>go/recv! :timeout</code>: Receive with timeout</li> <li><code>go/try-recv!</code>: Non-blocking receive</li> <li><code>go/close!</code>: Close channel</li> <li><code>go/run</code>: Launch goroutine</li> <li><code>go/select!</code>: Wait on multiple channels</li> <li><code>go/make-scope</code>: Create scope</li> <li><code>go/scope-go</code>: Goroutine within scope</li> <li><code>go/cancel!</code>: Cancel scope</li> <li><code>go/cancelled?</code>: Check cancellation</li> <li><code>go/with-scope</code>: Auto-manage scope</li> </ul>"},{"location":"spec/03-concurrency/#layer-2-pipeline","title":"Layer 2 (Pipeline)","text":"<ul> <li><code>pmap</code>: Parallel map</li> <li><code>go/pfilter</code>: Parallel filter</li> <li><code>go/preduce</code>: Parallel reduce</li> <li><code>go/parallel-do</code>: Parallel execution of multiple expressions</li> <li><code>go/pipeline</code>: Pipeline processing</li> <li><code>go/pipeline-map</code>: Pipeline map</li> <li><code>go/pipeline-filter</code>: Pipeline filter</li> <li><code>go/fan-out</code>: Fan-out</li> <li><code>go/fan-in</code>: Fan-in</li> </ul>"},{"location":"spec/03-concurrency/#layer-3-goawait","title":"Layer 3 (go/await)","text":"<ul> <li><code>go/await</code>: Wait for Promise</li> <li><code>go/then</code>: Promise chain</li> <li><code>go/catch</code>: Error handling</li> <li><code>go/all</code>: Execute multiple Promises in parallel</li> <li><code>go/race</code>: Return fastest Promise</li> </ul>"},{"location":"spec/03-concurrency/#state-management","title":"State Management","text":"<ul> <li><code>atom</code>: Create atom</li> <li><code>deref</code> (<code>@</code>): Get value</li> <li><code>swap!</code>: Update with function (atomic)</li> <li><code>reset!</code>: Set value directly</li> </ul>"},{"location":"spec/04-match/","title":"Pattern Matching","text":"<p>Control structure for branching data flow</p> <p>Qi's pattern matching isn't just conditional branching - it routes processing while decomposing, transforming, and validating data structures.</p>"},{"location":"spec/04-match/#basic-patterns","title":"Basic Patterns","text":""},{"location":"spec/04-match/#value-matching","title":"Value Matching","text":"<pre><code>(match x\n  0 -&gt; \"zero\"\n  1 -&gt; \"one\"\n  n -&gt; (str \"other: \" n))\n</code></pre>"},{"location":"spec/04-match/#nilbool-distinction","title":"nil/bool Distinction","text":"<pre><code>(match result\n  nil -&gt; \"not found\"\n  false -&gt; \"explicitly false\"\n  true -&gt; \"success\"\n  v -&gt; (str \"value: \" v))\n</code></pre>"},{"location":"spec/04-match/#map-matching","title":"Map Matching","text":"<pre><code>(match data\n  {:type \"user\" :name n} -&gt; (greet n)\n  {:type \"admin\"} -&gt; \"admin\"\n  _ -&gt; \"unknown\")\n</code></pre>"},{"location":"spec/04-match/#list-matching","title":"List Matching","text":"<pre><code>(match lst\n  [] -&gt; \"empty\"\n  [x] -&gt; x\n  [x ...rest] -&gt; (str \"first: \" x))\n</code></pre>"},{"location":"spec/04-match/#guard-conditions","title":"Guard Conditions","text":"<pre><code>(match x\n  n when (&gt; n 0) -&gt; \"positive\"\n  n when (&lt; n 0) -&gt; \"negative\"\n  _ -&gt; \"zero\")\n</code></pre>"},{"location":"spec/04-match/#extended-patterns","title":"Extended Patterns","text":""},{"location":"spec/04-match/#1-as-binding-use-both-parts-and-whole","title":"1. <code>:as</code> Binding - Use Both Parts and Whole","text":"<p>You can bind the whole matched pattern to a variable.</p> <pre><code>;; Basic :as usage\n(match data\n  {:user {:name n :age a} :as u} -&gt; (do\n    (log u)           ;; Log the whole\n    (process n a)))   ;; Process parts\n\n;; Works with nested structures\n(match response\n  {:body {:user u :posts ps} :as body} -&gt; (cache body)\n  {:error e :as err} -&gt; (log err))\n\n;; Deeply nested :as\n(match {:type \"person\" :data {:name \"Alice\" :age 30}}\n  {:type t :data {:name n :age a :as user-data} :as record} -&gt;\n    (do\n      (println f\"Type: {t}\")           ;; \"Type: person\"\n      (println f\"Name: {n}, Age: {a}\") ;; \"Name: Alice, Age: 30\"\n      (println f\"User data: {user-data}\") ;; {:name \"Alice\", :age 30}\n      (println f\"Full record: {record}\"))) ;; Full map\n\n;; Combining vectors and maps\n(match [1 {:x 10 :y 20}]\n  [a {:x b :as inner}] -&gt; [a b inner])\n;; =&gt; [1 10 {:x 10 :y 20}]\n\n;; Also works in function parameters\n(defn process [{:name n :age a :as user}]\n  (do\n    (println f\"Processing: {n}\")\n    user))  ;; Return whole\n\n;; Complex nesting example\n(defn handle-request [{:headers h :body {:user u :data d :as body} :as req}]\n  (do\n    (log req)      ;; Log full request\n    (cache body)   ;; Cache body only\n    (process-user u d)))\n</code></pre>"},{"location":"spec/04-match/#2-or-pattern-same-processing-for-multiple-patterns","title":"2. <code>or</code> Pattern - Same Processing for Multiple Patterns","text":"<p>You can match multiple values for the same processing (using <code>|</code> notation).</p> <pre><code>;; Match multiple values\n(match status\n  200 | 201 | 204 -&gt; \"success\"\n  400 | 401 | 403 -&gt; \"client error\"\n  500 | 502 | 503 -&gt; \"server error\"\n  _ -&gt; \"unknown\")\n\n;; Works with strings\n(match day\n  \"\u6708\" | \"\u706b\" | \"\u6c34\" | \"\u6728\" | \"\u91d1\" -&gt; \"\u5e73\u65e5\"\n  \"\u571f\" | \"\u65e5\" -&gt; \"\u9031\u672b\")\n\n;; Works with keywords\n(match result\n  :ok | :success -&gt; (handle-ok)\n  :error | :fail -&gt; (handle-error))\n</code></pre>"},{"location":"spec/04-match/#3-nesting-guard-structural-conditional-branching","title":"3. Nesting + Guard - Structural Conditional Branching","text":"<p>You can combine deep nesting with guard conditions.</p> <pre><code>;; Readable even with deep nesting\n(match request\n  {:user {:age a :country c}} when (and (&gt;= a 18) (= c \"JP\")) -&gt; (allow)\n  {:user {:age a}} when (&lt; a 18) -&gt; (error \"age restriction\")\n  _ -&gt; (deny))\n\n;; Flow-style reading: Decompose data structure \u2192 Validate with guard \u2192 Process\n</code></pre>"},{"location":"spec/04-match/#4-wildcard-_-extract-only-what-matters","title":"4. Wildcard <code>_</code> - Extract Only What Matters","text":"<p>Extract only needed parts, ignoring the rest with <code>_</code>.</p> <pre><code>;; Use only some fields\n(match data\n  {:user {:name _ :age a :city c}} -&gt; (process-location a c)\n  {:error _} -&gt; \"error occurred\")\n\n;; Skip parts of list\n(match coords\n  [_ y _] -&gt; y  ;; Extract only y coordinate\n  _ -&gt; 0)\n</code></pre>"},{"location":"spec/04-match/#5-array-multiple-binding","title":"5. Array Multiple Binding","text":"<p>You can bind multiple elements simultaneously.</p> <pre><code>;; Bind multiple elements at once\n(match data\n  [{:id id1} {:id id2}] -&gt; (compare id1 id2)\n  [first ...rest] -&gt; (process-batch first rest))\n\n;; Combine with pipelines\n(match (coords |&gt; (take 2))\n  [x y] -&gt; (distance x y)\n  _ -&gt; 0)\n</code></pre>"},{"location":"spec/04-match/#match-design-philosophy","title":"match Design Philosophy","text":"<ol> <li>Branch data flow: match isn't just if-else, it decomposes data structures to create flows</li> <li>Readability first: Patterns readable top-to-bottom, conditions at a glance</li> <li>Progressive disclosure: Start with basic patterns, use extensions as needed</li> </ol>"},{"location":"spec/04-match/#combining-with-try","title":"Combining with try","text":"<p><code>try</code> catches exceptions and returns <code>{:error e}</code> on error. Success values are returned as-is.</p> <pre><code>;; Values as-is on success, {:error e} on error\n(match (try (risky-operation))\n  {:error e} -&gt; (log e)\n  result -&gt; result)\n\n;; Combine with pipelines\n(match (try\n         (url\n          |&gt; http-get\n          |&gt; parse\n          |&gt; process))\n  {:error e} -&gt; []\n  data -&gt; data)\n</code></pre>"},{"location":"spec/04-match/#real-world-examples","title":"Real-world Examples","text":""},{"location":"spec/04-match/#example-1-http-response-handling","title":"Example 1: HTTP Response Handling","text":"<pre><code>;; http/get! may throw exceptions, so catch with try\n(match (try (http/get! url))  ;; Detailed version to get status code\n  {:error e} -&gt; (log-error e)\n  {:status 200 :body body} -&gt; (process-body body)\n  {:status 404} -&gt; nil\n  {:status s} -&gt; (error (str \"Unexpected status: \" s)))\n</code></pre>"},{"location":"spec/04-match/#example-2-data-validation","title":"Example 2: Data Validation","text":"<pre><code>(match user\n  {:name n :age a :email e} when (and (&gt; a 0) (str/contains? e \"@\")) -&gt; (save-user user)\n  {:name _ :age a} when (&lt;= a 0) -&gt; (error \"Invalid age\")\n  {:name _ :email e} when (not (str/contains? e \"@\")) -&gt; (error \"Invalid email\")\n  _ -&gt; (error \"Missing required fields\"))\n</code></pre>"},{"location":"spec/04-match/#example-3-list-processing","title":"Example 3: List Processing","text":"<pre><code>(defn process-list [lst]\n  (match lst\n    [] -&gt; \"empty\"\n    [x] -&gt; (str \"single: \" x)\n    [x y] -&gt; (str \"pair: \" x \", \" y)\n    [x y ...rest] -&gt; (str \"multiple: \" x \", \" y \", and \" (len rest) \" more\")))\n</code></pre>"},{"location":"spec/05-syntax-basics/","title":"Basic Syntax","text":"<p>Qi's fundamental syntax elements</p>"},{"location":"spec/05-syntax-basics/#comments","title":"Comments","text":"<pre><code>; Single-line comment\n;; Typically use ;;\n\n(def x 42)  ; End-of-line comment\n</code></pre>"},{"location":"spec/05-syntax-basics/#data-types","title":"Data Types","text":"<p>Qi is dynamically typed with the following basic types:</p> <ul> <li>Numbers: Integers, floating-point numbers</li> <li>Strings: UTF-8 support, f-string support</li> <li>Booleans: <code>true</code>, <code>false</code></li> <li>nil: Represents absence of value</li> <li>Vectors: <code>[1 2 3]</code></li> <li>Maps: <code>{:key \"value\"}</code></li> <li>Lists: <code>'(1 2 3)</code> (quote required)</li> <li>Functions: First-class objects</li> <li>Keywords: <code>:keyword</code></li> </ul>"},{"location":"spec/05-syntax-basics/#literals","title":"Literals","text":""},{"location":"spec/05-syntax-basics/#numbers","title":"Numbers","text":"<pre><code>42          ;; Integer\n3.14        ;; Floating-point\n-10         ;; Negative number\n1_000_000   ;; Underscore separator (readability)\n</code></pre>"},{"location":"spec/05-syntax-basics/#strings","title":"Strings","text":"<pre><code>;; Basic\n\"hello\"\n\"hello\\nworld\"      ;; Escape sequences\n\"say \\\"hello\\\"\"     ;; Quote escaping\n\n;; Multi-line strings (Python-style)\n\"\"\"\nThis is a\nmulti-line\nstring\n\"\"\"\n\n;; Multi-line SQL or HTML\n(def query \"\"\"\n  SELECT name, age\n  FROM users\n  WHERE age &gt;= 18\n  ORDER BY name\n\"\"\")\n</code></pre>"},{"location":"spec/05-syntax-basics/#f-strings-string-interpolation","title":"f-strings (String Interpolation)","text":"<pre><code>;; Basic usage\nf\"Hello, World!\"  ;; =&gt; \"Hello, World!\"\n\n;; Variable interpolation\n(def name \"Alice\")\nf\"Hello, {name}!\"  ;; =&gt; \"Hello, Alice!\"\n\n;; Expressions\nf\"Result: {(+ 1 2)}\"  ;; =&gt; \"Result: 3\"\n\n;; List and vector interpolation\nf\"List: {[1 2 3]}\"  ;; =&gt; \"List: [1 2 3]\"\n\n;; Map access\n(def user {:name \"Bob\" :age 30})\nf\"Name: {(get user :name)}, Age: {(get user :age)}\"\n;; =&gt; \"Name: Bob, Age: 30\"\n\n;; Escaping\nf\"Escaped: \\{not interpolated\\}\"  ;; =&gt; \"Escaped: {not interpolated}\"\n\n;; Multi-line f-string\n(def name \"Alice\")\n(def age 30)\n\nf\"\"\"\nName: {name}\nAge: {age}\nStatus: Active\n\"\"\"\n</code></pre>"},{"location":"spec/05-syntax-basics/#bool-and-nil","title":"bool and nil","text":"<pre><code>true\nfalse\nnil\n\n;; Conditional expression behavior\n(if nil \"yes\" \"no\")     ;; \"no\" (nil is falsy)\n(if false \"yes\" \"no\")   ;; \"no\" (false is falsy)\n(if 0 \"yes\" \"no\")       ;; \"yes\" (0 is truthy)\n(if \"\" \"yes\" \"no\")      ;; \"yes\" (empty string is truthy)\n\n;; Explicit comparison\n(= x nil)               ;; nil check\n(= x false)             ;; false check\n</code></pre>"},{"location":"spec/05-syntax-basics/#keywords","title":"Keywords","text":"<pre><code>:keyword\n:name\n:type\n\n;; Used as map keys\n{:name \"Alice\" :age 30}\n\n;; Get value from map using get function\n(def user {:name \"Bob\" :age 25})\n(get user :name)  ;; =&gt; \"Bob\"\n</code></pre>"},{"location":"spec/05-syntax-basics/#internal-implementation-interning","title":"Internal Implementation: Interning","text":"<p>In Qi, keywords and symbols are automatically interned.</p> <p>What is interning: - A mechanism to store the same string in a single memory location and share it across multiple places - Implemented using Rust's <code>Arc&lt;str&gt;</code></p> <p>Benefits: 1. Memory efficiency: Same keyword uses only one memory location, no matter how many times it's used 2. Fast comparison: Just compare pointers instead of string contents 3. Thread-safe: Arc allows safe sharing across multiple threads</p> <pre><code>;; \u2705 Interned (recommended)\n(def k1 :name)\n(def k2 :name)\n;; k1 and k2 point to the same memory location \u2192 fast comparison\n\n;; Symbols are also interned\n(def s1 'foo)\n(def s2 'foo)\n;; s1 and s2 point to the same memory location\n</code></pre> <p>Technical details: <pre><code>// Internal implementation (Rust)\npub enum Value {\n    Keyword(Arc&lt;str&gt;),  // :name\n    Symbol(Arc&lt;str&gt;),   // 'symbol\n    String(String),     // Regular strings (not interned)\n    // ...\n}\n</code></pre></p> <p>This design makes Qi fast and memory-efficient even when dealing with large numbers of keywords and symbols.</p>"},{"location":"spec/05-syntax-basics/#vectors","title":"Vectors","text":"<pre><code>[]              ;; Empty vector\n[1 2 3]         ;; Number vector\n[\"a\" \"b\" \"c\"]   ;; String vector\n[1 \"hello\" :key]  ;; Mixed types allowed\n</code></pre>"},{"location":"spec/05-syntax-basics/#maps","title":"Maps","text":"<pre><code>{}                          ;; Empty map\n{:name \"Alice\" :age 30}     ;; Keywords as keys\n{\"name\" \"Bob\" \"age\" 25}     ;; Strings as keys\n</code></pre>"},{"location":"spec/05-syntax-basics/#lists","title":"Lists","text":"<pre><code>'()             ;; Empty list\n'(1 2 3)        ;; Quote required\n</code></pre>"},{"location":"spec/05-syntax-basics/#special-forms-9","title":"Special Forms (9)","text":""},{"location":"spec/05-syntax-basics/#def-global-definition","title":"<code>def</code> - Global Definition","text":"<pre><code>(def x 42)\n(def greet (fn [name] (str \"Hello, \" name)))\n(def ops [+ - * /])\n</code></pre>"},{"location":"spec/05-syntax-basics/#defn-function-definition-sugar-syntax","title":"<code>defn</code> - Function Definition (Sugar Syntax)","text":"<pre><code>;; Basic form\n(defn greet [name]\n  (str \"Hello, \" name))\n\n;; Variadic arguments\n(defn sum [&amp; nums]\n  (reduce + 0 nums))\n\n;; Vector destructuring\n(defn add-pair [[x y]]\n  (+ x y))\n\n(defn format-kv [[k v]]\n  f\"{k}={v}\")\n\n;; ...rest syntax (get rest of vector elements)\n(defn process-list [[first ...rest]]\n  (str \"first: \" first \", rest: \" rest))\n\n(process-list [1 2 3 4])  ;; =&gt; \"first: 1, rest: (2 3 4)\"\n\n;; Map destructuring\n(defn greet [{:name n :age a}]\n  (str n \" is \" a \" years old\"))\n\n(greet {:name \"Taro\" :age 25})  ;; =&gt; \"Taro is 25 years old\"\n\n;; Map destructuring + :as binding\n(defn log-user [{:name n :as user}]\n  (do\n    (println f\"Processing: {n}\")\n    user))\n\n;; defn expands to this\n(defn greet [name] body)\n;; \u2193\n(def greet (fn [name] body))\n</code></pre>"},{"location":"spec/05-syntax-basics/#fn-function-definition","title":"<code>fn</code> - Function Definition","text":"<pre><code>(fn [x] (* x 2))\n(fn [x y] (+ x y))\n(fn [] (println \"no args\"))\n\n;; Variadic arguments\n(fn [&amp; args] (reduce + 0 args))\n\n;; Vector destructuring\n(fn [[x y]] (+ x y))  ;; Takes 2-element vector\n(fn [[k v]] f\"{k}={v}\")  ;; Key-value pair\n\n;; Nested destructuring\n(fn [[[a b] c]] (+ a b c))  ;; [[1 2] 3] =&gt; 6\n\n;; ...rest syntax\n(fn [[first ...rest]]\n  (str \"first: \" first \", rest: \" rest))\n\n;; Map destructuring\n(fn [{:name n :age a}]\n  (str n \" is \" a \" years old\"))\n\n;; Map destructuring + :as binding\n(fn [{:name n :as user}]\n  (do\n    (println f\"Processing: {n}\")\n    user))\n</code></pre>"},{"location":"spec/05-syntax-basics/#let-local-binding","title":"<code>let</code> - Local Binding","text":"<pre><code>(let [x 10 y 20]\n  (+ x y))\n\n;; Nesting allowed\n(let [a 1]\n  (let [b 2]\n    (+ a b)))\n\n;; Vector destructuring\n(let [[x y] [10 20]]\n  (+ x y))  ;; =&gt; 30\n\n(let [[k v] [\"name\" \"Alice\"]]\n  f\"{k}={v}\")  ;; =&gt; \"name=Alice\"\n\n;; Nested destructuring\n(let [[[a b] c] [[1 2] 3]]\n  (+ a b c))  ;; =&gt; 6\n\n;; ...rest syntax\n(let [[first ...rest] [1 2 3 4]]\n  (str \"first: \" first \", rest: \" rest))\n;; =&gt; \"first: 1, rest: (2 3 4)\"\n\n(let [[x y ...tail] [10 20 30 40]]\n  {:x x :y y :tail tail})\n;; =&gt; {:x 10, :y 20, :tail (30 40)}\n\n;; Map destructuring\n(let [{:name n :age a} {:name \"Alice\" :age 30}]\n  (str n \" is \" a))\n;; =&gt; \"Alice is 30\"\n\n;; :as binding (get both parts and whole)\n(let [{:name n :age a :as person} {:name \"Bob\" :age 25 :role \"admin\"}]\n  [n a person])\n;; =&gt; [\"Bob\" 25 {:name \"Bob\", :age 25, :role \"admin\"}]\n</code></pre>"},{"location":"spec/05-syntax-basics/#do-sequential-execution","title":"<code>do</code> - Sequential Execution","text":"<pre><code>(do\n  (println \"first\")\n  (println \"second\")\n  42)  ;; Returns value of last expression\n</code></pre>"},{"location":"spec/05-syntax-basics/#if-conditional-branching","title":"<code>if</code> - Conditional Branching","text":"<pre><code>;; Basic form\n(if test then else)\n\n;; Practical example\n(if (&gt; x 10) \"big\" \"small\")\n\n;; else can be omitted (returns nil)\n(if (valid? data)\n  (process data))\n\n;; Nesting\n(if (&gt; x 0)\n    (if (&lt; x 10) \"small positive\" \"big positive\")\n    \"negative or zero\")\n</code></pre>"},{"location":"spec/05-syntax-basics/#quote-quote","title":"<code>quote</code> - Quote","text":"<pre><code>;; Return expression as-is without evaluation\n'(1 2 3)        ;; Returns as list\n'(+ 1 2)        ;; Not evaluated, remains (+ 1 2)\n'symbol         ;; Returns as symbol\n\n;; Without quote causes error (list evaluated as function call)\n(1 2 3)         ;; Error: 1 is not a function\n</code></pre>"},{"location":"spec/05-syntax-basics/#mac-macro-definition","title":"<code>mac</code> - Macro Definition","text":"<p>Macros are special functions for code generation. Use quasiquote (<code>`</code>), unquote (<code>,</code>), and unquote-splice (<code>,@</code>) to create code templates.</p>"},{"location":"spec/05-syntax-basics/#quasiquote-unquote-basics","title":"Quasiquote / Unquote Basics","text":"<pre><code>;; quasiquote (`) - Create template\n`(+ 1 2)         ;; =&gt; (+ 1 2) Returns as list\n\n;; unquote (,) - Evaluate expression in template\n(def x 10)\n`(+ 1 ,x)        ;; =&gt; (+ 1 10) x is evaluated\n\n;; unquote-splice (,@) - Expand list\n(def items [1 2 3])\n`(list ,@items)  ;; =&gt; (list 1 2 3) items expanded\n</code></pre>"},{"location":"spec/05-syntax-basics/#unquote-in-special-forms","title":"Unquote in Special Forms","text":"<p>Unquote works correctly inside special forms like fn, let, def:</p> <pre><code>(def value 42)\n\n;; Unquote in fn\n`(fn [x] ,value)          ;; =&gt; (fn [x] 42)\n`(fn [y] (+ y ,value))    ;; =&gt; (fn [y] (+ y 42))\n\n;; Unquote in let\n`(let [x ,value] x)       ;; =&gt; (let [x 42] x)\n`(let [a ,value b 10] (+ a b))  ;; =&gt; (let [a 42 b 10] (+ a b))\n\n;; Unquote in def\n`(def myvar ,value)       ;; =&gt; (def myvar 42)\n</code></pre>"},{"location":"spec/05-syntax-basics/#macro-implementation-examples","title":"Macro Implementation Examples","text":"<pre><code>;; when macro - concise if + do\n(mac when [test &amp; body]\n  `(if ,test\n     (do ,@body)\n     nil))\n\n(when (&gt; x 0)\n  (println \"positive\")\n  (process x))\n;; Expands to: (if (&gt; x 0) (do (println \"positive\") (process x)) nil)\n\n;; unless macro - execute when condition is false\n(mac unless [test &amp; body]\n  `(if ,test\n     nil\n     (do ,@body)))\n\n(unless (empty? data)\n  (println \"has data\")\n  (process data))\n\n;; debug macro - display expression and result\n(mac debug [expr]\n  `(let [result ,expr]\n     (do\n       (println f\"Debug: {',expr} = {result}\")\n       result)))\n\n(debug (+ 1 2))\n;; Output: Debug: (+ 1 2) = 3\n;; Returns: 3\n</code></pre>"},{"location":"spec/05-syntax-basics/#loop-recur-loop","title":"<code>loop</code> / <code>recur</code> - Loop","text":"<p>Special forms for tail recursion optimization.</p> <pre><code>;; Basic form\n(loop [var1 val1 var2 val2 ...]\n  body\n  (recur new-val1 new-val2 ...))\n\n;; Factorial (5! = 120)\n(defn factorial [n]\n  (loop [i n acc 1]\n    (if (= i 0)\n      acc\n      (recur (dec i) (* acc i)))))\n\n(factorial 5)  ;; 120\n\n;; Countdown\n(defn count-down [n]\n  (loop [i n]\n    (if (&lt;= i 0)\n      \"done\"\n      (do\n        (print i)\n        (recur (dec i))))))\n\n;; List processing\n(defn sum-list [lst]\n  (loop [items lst result 0]\n    (if (empty? items)\n      result\n      (recur (rest items) (+ result (first items))))))\n\n(sum-list [1 2 3 4 5])  ;; 15\n</code></pre> <p>Implementation notes: - <code>loop</code> creates new environment and binds variables with initial values - <code>recur</code> handled as special error, caught by <code>loop</code> to update variables - Unlike normal recursion, doesn't consume stack (tail recursion optimization)</p>"},{"location":"spec/05-syntax-basics/#detailed-specification-and-constraints","title":"Detailed Specification and Constraints","text":"<p>How loop works: 1. Creates a dedicated new environment (scope) for the loop 2. Evaluates initial values and binds them to variables 3. Evaluates the body 4. Repeats until <code>recur</code> is called</p> <p>Constraints on recur: - Must be used only in tail position of loop - All of these are errors:   <pre><code>;; \u274c recur in non-tail position (Error)\n(loop [i 10]\n  (if (&gt; i 0)\n    (+ (recur (dec i)) 1)  ;; Not in tail position\n    0))\n\n;; \u2705 Correct tail position\n(loop [i 10 acc 0]\n  (if (&gt; i 0)\n    (recur (dec i) (+ acc i))  ;; OK: tail position of if\n    acc))\n</code></pre> - Number of arguments must match the number of loop variables <pre><code>(loop [x 1 y 2]\n  (recur x))  ;; Error: requires 2 args but only 1 provided\n</code></pre></p> <p>Internal implementation details: - Qi implements <code>recur</code> as a special error message (sentinel value) - Arguments to <code>recur</code> are evaluated beforehand and stored in thread_local - <code>loop</code> catches this sentinel, updates variables, and re-evaluates - This design achieves tail recursion without consuming stack space</p> <p>Performance characteristics: - Normal recursion: O(n) stack consumption \u2192 Risk of stack overflow - loop/recur: O(1) stack consumption \u2192 Safe for infinite loops (as long as memory permits)</p> <pre><code>;; Normal recursion (consumes stack)\n(defn factorial-recursive [n]\n  (if (&lt;= n 1)\n    1\n    (* n (factorial-recursive (dec n)))))\n\n;; loop/recur (no stack consumption)\n(defn factorial-loop [n]\n  (loop [i n acc 1]\n    (if (&lt;= i 1)\n      acc\n      (recur (dec i) (* acc i)))))\n\n;; Safe even with 1 million iterations\n(factorial-loop 1000000)  ;; OK\n(factorial-recursive 1000000)  ;; Stack overflow\n</code></pre>"},{"location":"spec/05-syntax-basics/#when-execute-only-when-condition-is-true","title":"<code>when</code> - Execute Only When Condition is True","text":"<p>Concise notation when if's else clause is unnecessary. Can execute multiple expressions sequentially.</p> <pre><code>;; Basic form\n(when test\n  expr1\n  expr2\n  ...)\n\n;; Practical example\n(when (&gt; x 10)\n  (println \"Large value\")\n  (process x))\n\n;; Comparison with if\n(if (&gt; x 10)\n  (do\n    (println \"Large value\")\n    (process x))\n  nil)  ;; Same as this\n\n;; Combined with pipeline\n(data\n |&gt; (when (valid? data)\n      (println \"Processing started\")\n      (process data)))\n</code></pre> <p>Return value: - If condition is true: value of last expression - If condition is false: <code>nil</code></p>"},{"location":"spec/05-syntax-basics/#while-loop-while-condition-is-true","title":"<code>while</code> - Loop While Condition is True","text":"<p>Repeatedly executes body while condition expression is true (truthy value).</p> <pre><code>;; Basic form\n(while test\n  body...)\n\n;; Counter example\n(def counter (atom 0))\n(while (&lt; @counter 5)\n  (println f\"Count: {@counter}\")\n  (swap! counter inc))\n\n;; File processing example\n(def lines (atom (io/stdin-lines)))\n(while (some? (first @lines))\n  (println (first @lines))\n  (swap! lines rest))\n</code></pre> <p>Return value: Always <code>nil</code></p> <p>Caution: To avoid infinite loops, modify condition in body.</p>"},{"location":"spec/05-syntax-basics/#until-loop-until-condition-becomes-true","title":"<code>until</code> - Loop Until Condition Becomes True","text":"<p>Repeatedly executes body until condition expression becomes true (opposite of <code>while</code>).</p> <pre><code>;; Basic form\n(until test\n  body...)\n\n;; Counter example (opposite of while)\n(def counter (atom 0))\n(until (&gt;= @counter 5)\n  (println f\"Count: {@counter}\")\n  (swap! counter inc))\n\n;; Retry example\n(def success (atom false))\n(until @success\n  (println \"Retrying...\")\n  (reset! success (try-operation)))\n</code></pre> <p>Return value: Always <code>nil</code></p>"},{"location":"spec/05-syntax-basics/#while-some-loop-until-nil-with-binding","title":"<code>while-some</code> - Loop Until nil (With Binding)","text":"<p>Evaluates expression and repeats until result is <code>nil</code>. Binds result to variable in each iteration.</p> <pre><code>;; Basic form\n(while-some [binding expr]\n  body...)\n\n;; List processing\n(def remaining (atom [1 2 3 4 5]))\n(while-some [item (first @remaining)]\n  (println f\"Processing: {item}\")\n  (swap! remaining rest))\n\n;; File reading (line-by-line)\n(while-some [line (io/stdin-line)]\n  (line\n   |&gt; str/trim\n   |&gt; (when (&gt; (len line) 0)\n        (process-line line))))\n\n;; Combined with pipeline\n(while-some [val (get-next-value)]\n  (val\n   |&gt; transform\n   |&gt; validate\n   |&gt; save))\n</code></pre> <p>Behavior: - Evaluate <code>expr</code> - If result is <code>nil</code>, terminate - If result is not <code>nil</code>, bind value to <code>binding</code> and execute body - Continue to next iteration</p> <p>Return value: Always <code>nil</code></p>"},{"location":"spec/05-syntax-basics/#until-error-loop-until-error-with-binding","title":"<code>until-error</code> - Loop Until Error (With Binding)","text":"<p>Evaluates expression and repeats until result is <code>{:error ...}</code>. Binds result to variable in each iteration.</p> <pre><code>;; Basic form\n(until-error [binding expr]\n  body...)\n\n;; Result type integration\n(until-error [result (fetch-next)]\n  (println f\"Fetch success: {result}\")\n  (process result))\n\n;; HTTP request example\n(until-error [response (http/get next-url)]\n  (println f\"Status: {(get response :status)}\")\n  (when (= (get response :status) 200)\n    (process-response response)))\n\n;; Pagination processing\n(def page (atom 1))\n(until-error [data (api/fetch-page @page)]\n  (data\n   |&gt; process-items\n   |&gt; save-to-db)\n  (swap! page inc))\n</code></pre> <p>Behavior: - Evaluate <code>expr</code> - If result is <code>{:error ...}</code>, return that value and terminate - If result is not <code>{:error ...}</code>, bind value to <code>binding</code> and execute body - Continue to next iteration</p> <p>Return value: Error map <code>{:error ...}</code>, or <code>nil</code> if loop never executes</p> <p>Railway Oriented Programming: Powerful error handling when combined with <code>|&gt;?</code> pipeline:</p> <pre><code>(until-error [result (fetch-data)]\n  (result\n   |&gt;? validate\n   |&gt;? transform\n   |&gt;? save))\n</code></pre>"},{"location":"spec/05-syntax-basics/#loop-syntax-usage-guide","title":"Loop Syntax Usage Guide","text":"<p>Qi has multiple loop constructs. Choose appropriately based on the situation.</p>"},{"location":"spec/05-syntax-basics/#collection-processing","title":"Collection Processing","text":"<p>When processing entire collections \u2192 Use higher-order functions</p> <pre><code>;; \u2705 Recommended\n(map transform data)\n(filter valid? data)\n(each println data)\n\n;; \u274c Not recommended (verbose)\n(def items (atom data))\n(while (some? (first @items))\n  (process (first @items))\n  (swap! items rest))\n</code></pre> <p>Use case: Data transformation, filtering, applying side effects</p>"},{"location":"spec/05-syntax-basics/#conditional-loops-functional-style","title":"Conditional Loops (Functional Style)","text":"<p>nil-checking loop \u2192 <code>while-some</code></p> <pre><code>;; \u2705 Recommended (functional, good pipeline compatibility)\n(while-some [line (io/stdin-line)]\n  (line\n   |&gt; str/trim\n   |&gt; process\n   |&gt; save))\n</code></pre> <p>Error-checking loop \u2192 <code>until-error</code></p> <pre><code>;; \u2705 Recommended (Result type integration, Railway Oriented Programming)\n(until-error [result (fetch-next)]\n  (result\n   |&gt;? validate\n   |&gt;? save))\n</code></pre> <p>Use case: Stream processing, pagination, API calls</p>"},{"location":"spec/05-syntax-basics/#simple-loops-side-effect-based","title":"Simple Loops (Side Effect-Based)","text":"<p>Counter-based loops \u2192 <code>while</code> / <code>until</code></p> <pre><code>;; \u2705 Recommended (simple and intuitive)\n(def count (atom 0))\n(while (&lt; @count 100)\n  (do-something)\n  (swap! count inc))\n\n;; Retry logic\n(def success (atom false))\n(until @success\n  (reset! success (try-operation)))\n</code></pre> <p>Use case: Counter processing, retry logic, external resource polling</p> <p>Caution: Always modify condition in body to avoid infinite loops.</p>"},{"location":"spec/05-syntax-basics/#tail-recursion-optimization","title":"Tail Recursion Optimization","text":"<p>Recursion without stack consumption \u2192 <code>loop</code> / <code>recur</code></p> <pre><code>;; \u2705 Recommended (large iterations, recursive algorithms)\n(defn factorial [n]\n  (loop [i n acc 1]\n    (if (&lt;= i 1)\n      acc\n      (recur (dec i) (* acc i)))))\n</code></pre> <p>Use case: Recursive algorithms, heavy iteration processing</p>"},{"location":"spec/05-syntax-basics/#quick-reference","title":"Quick Reference","text":"Use Case Syntax Features Collection processing <code>map</code>, <code>filter</code>, <code>each</code> Concise, pipeline-friendly Loop until nil <code>while-some</code> Functional, with binding Loop until error <code>until-error</code> Result type integration Counter loops <code>while</code>, <code>until</code> Simple, side effect-based Tail recursion <code>loop/recur</code> No stack consumption <p>Principle: Choose the most concise syntax with clear intent. When in doubt, start with higher-order functions (<code>map</code>, <code>filter</code>, <code>each</code>).</p>"},{"location":"spec/05-syntax-basics/#namespace","title":"Namespace","text":"<p>Lisp-1 (Scheme-style) - Variables and functions share the same namespace</p> <pre><code>(def add (fn [x y] (+ x y)))\n(def op add)           ;; Assign function to variable\n(op 1 2)               ;; 3\n</code></pre>"},{"location":"spec/05-syntax-basics/#operators","title":"Operators","text":""},{"location":"spec/05-syntax-basics/#arithmetic-operators","title":"Arithmetic Operators","text":"<p>Supports both integers and floating-point numbers. Mixing different types results in floating-point.</p> <pre><code>(+ 1 2)         ;; 3\n(+ 1.5 2.5)     ;; 4.0\n(+ 1 2.5)       ;; 3.5 (type promotion)\n\n(- 5 3)         ;; 2\n(- 5.0 3.0)     ;; 2.0\n\n(* 4 5)         ;; 20\n(* 2.5 3)       ;; 7.5\n\n(/ 10 2)        ;; 5\n(/ 10.0 2.0)    ;; 5.0\n(/ 10 3.0)      ;; 3.3333...\n\n(% 10 3)        ;; 1 (modulo)\n(% 10.5 3)      ;; 1.5 (supports floating-point)\n</code></pre>"},{"location":"spec/05-syntax-basics/#comparison-operators","title":"Comparison Operators","text":"<p>Supports both integers and floating-point numbers. Can compare different types.</p> <pre><code>(= 1 1)         ;; true\n(= 1.0 1.0)     ;; true\n(= 1 1.0)       ;; false (different types)\n\n(!= 1 2)        ;; true\n(!= 1.0 2.0)    ;; true\n\n(&lt; 1 2)         ;; true\n(&lt; 1.5 2.0)     ;; true\n(&lt; 1 2.5)       ;; true (integer and floating-point comparison)\n\n(&lt;= 1 1)        ;; true\n(&lt;= 1.0 2.0)    ;; true\n\n(&gt; 2 1)         ;; true\n(&gt; 2.5 1.5)     ;; true\n\n(&gt;= 2 2)        ;; true\n(&gt;= 2.0 2.0)    ;; true\n</code></pre>"},{"location":"spec/05-syntax-basics/#logical-operators","title":"Logical Operators","text":"<pre><code>(and true false)     ;; false\n(or true false)      ;; true\n(not true)           ;; false\n</code></pre>"},{"location":"spec/05-syntax-basics/#basic-function-calls","title":"Basic Function Calls","text":"<pre><code>;; Function application\n(f x y z)         ;; Call f with arguments x, y, z\n\n;; Built-in functions\n(+ 1 2 3)         ;; 6\n(str \"hello\" \" \" \"world\")  ;; \"hello world\"\n\n;; User-defined functions\n(defn square [x] (* x x))\n(square 5)        ;; 25\n\n;; Higher-order functions\n(map inc [1 2 3])  ;; (2 3 4)\n(filter even? [1 2 3 4])  ;; (2 4)\n</code></pre>"},{"location":"spec/05-syntax-basics/#core-predicate-functions","title":"Core Predicate Functions","text":"<p>Qi provides many predicate functions (functions ending with <code>?</code>) for type checking and conditional testing.</p>"},{"location":"spec/05-syntax-basics/#type-check-predicates-12","title":"Type Check Predicates (12)","text":"<pre><code>;; nil check\n(nil? nil)          ;; =&gt; true\n(nil? 0)            ;; =&gt; false\n(nil? \"\")           ;; =&gt; false\n\n;; Collection types\n(list? '(1 2 3))    ;; =&gt; true\n(vector? [1 2 3])   ;; =&gt; true\n(map? {:a 1})       ;; =&gt; true\n\n;; Primitive types\n(string? \"hello\")   ;; =&gt; true\n(integer? 42)       ;; =&gt; true\n(float? 3.14)       ;; =&gt; true\n(number? 42)        ;; =&gt; true  (integer or float)\n\n;; Special types\n(keyword? :test)    ;; =&gt; true\n(function? inc)     ;; =&gt; true\n(atom? (atom 0))    ;; =&gt; true\n(stream? (stream/range 0 10))  ;; =&gt; true\n</code></pre>"},{"location":"spec/05-syntax-basics/#collection-predicates-3","title":"Collection Predicates (3)","text":"<pre><code>(coll? [1 2 3])           ;; =&gt; true  (list/vector/map)\n(sequential? [1 2 3])     ;; =&gt; true  (list or vector)\n(empty? [])               ;; =&gt; true\n(empty? nil)              ;; =&gt; true\n</code></pre>"},{"location":"spec/05-syntax-basics/#state-predicates-4","title":"State Predicates (4)","text":"<pre><code>;; Not nil check\n(some? 0)           ;; =&gt; true\n(some? \"\")          ;; =&gt; true\n(some? nil)         ;; =&gt; false\n\n;; Strict boolean check\n(true? true)        ;; =&gt; true\n(true? 1)           ;; =&gt; false  (truthy but not true)\n\n(false? false)      ;; =&gt; true\n(false? nil)        ;; =&gt; false  (falsy but not false)\n\n;; Error check\n(error? {:error \"failed\"})  ;; =&gt; true\n(error? 42)                 ;; =&gt; false\n(error? nil)                ;; =&gt; false\n</code></pre>"},{"location":"spec/05-syntax-basics/#numeric-predicates-5","title":"Numeric Predicates (5)","text":"<pre><code>;; Even/odd\n(even? 2)           ;; =&gt; true\n(odd? 3)            ;; =&gt; true\n\n;; Sign check\n(positive? 1)       ;; =&gt; true\n(negative? -1)      ;; =&gt; true\n(zero? 0)           ;; =&gt; true\n(zero? 0.0)         ;; =&gt; true\n</code></pre>"},{"location":"spec/05-syntax-basics/#predicate-usage","title":"Predicate Usage","text":"<p>Predicates are used in scenarios like:</p> <pre><code>;; Combined with filter\n(filter even? [1 2 3 4 5])        ;; =&gt; (2 4)\n(filter some? [1 nil 2 nil 3])    ;; =&gt; (1 2 3)\n\n;; Conditional branching\n(if (nil? x)\n  \"x is nil\"\n  \"x has some value\")\n\n;; match guards\n(match data\n  {:value v} when (positive? v) -&gt; \"positive\"\n  {:value v} when (zero? v) -&gt; \"zero\"\n  _ -&gt; \"other\")\n</code></pre> <p>Note: Collection operations <code>list/some?</code> and <code>list/every?</code> (predicate + collection testing) are separate functions (\u2192 see Data Structures).</p>"},{"location":"spec/06-data-structures/","title":"Data Structures","text":"<p>Qi's Collection Types and Operations</p> <p>Implementation: <code>src/builtins/core_collections.rs</code>, <code>src/builtins/list.rs</code>, <code>src/builtins/map.rs</code>, <code>src/builtins/set.rs</code></p>"},{"location":"spec/06-data-structures/#when-to-use-lists-vs-vectors","title":"When to Use Lists vs Vectors","text":""},{"location":"spec/06-data-structures/#when-to-use-lists","title":"When to Use Lists","text":"<p>Lists <code>(...)</code> are suitable for:</p> <ul> <li>Recursive data processing - Natural decomposition with first/rest</li> <li>Lisp-style processing - Quoted code, S-expressions</li> <li>Functional programming - Good compatibility with pattern matching</li> <li>Sequential processing - When processing from the beginning</li> </ul> <pre><code>;; Recursive processing\n(defn sum [lst]\n  (if (empty? lst)\n    0\n    (+ (first lst) (sum (rest lst)))))\n\n(sum (list 1 2 3 4 5))  ;; =&gt; 15\n</code></pre>"},{"location":"spec/06-data-structures/#when-to-use-vectors","title":"When to Use Vectors","text":"<p>Vectors <code>[...]</code> are suitable for:</p> <ul> <li>Random access - O(1) access to any position with nth function</li> <li>Performance-focused - Better memory efficiency</li> <li>JSON interoperability - Natural correspondence with JSON arrays</li> <li>Large datasets - Efficient memory usage</li> </ul> <pre><code>;; Random access\n(def data [10 20 30 40 50])\n(nth data 2)  ;; =&gt; 30 (fast)\n\n;; JSON interoperability\n(json/stringify {:items [1 2 3]})\n;; =&gt; \"{\\\"items\\\":[1,2,3]}\"\n</code></pre>"},{"location":"spec/06-data-structures/#practical-guidelines","title":"Practical Guidelines","text":"<ul> <li>Default to vectors - Use vectors when in doubt (modern, JSON-compatible)</li> <li>Pipeline processing - Both work the same way</li> <li>Pattern matching - Both supported, lists are more idiomatic</li> <li>Performance - Vectors are faster (though the difference is rarely noticeable)</li> </ul> <pre><code>;; Both work the same way\n[1 2 3] |&gt; (map inc) |&gt; (filter even?)  ;; =&gt; [2 4]\n(list 1 2 3) |&gt; (map inc) |&gt; (filter even?)  ;; =&gt; (2 4)\n</code></pre>"},{"location":"spec/06-data-structures/#type-preservation-rules-for-lists-and-vectors","title":"Type Preservation Rules for Lists and Vectors","text":"<p>In Qi, collection operation functions determine return value types according to the following rules:</p>"},{"location":"spec/06-data-structures/#transformation-functions-process-input","title":"Transformation Functions (Process Input)","text":"<p>Preserve input type. List input \u2192 List return, Vector input \u2192 Vector return.</p> <ul> <li><code>map</code>, <code>filter</code>, <code>reduce</code> (higher-order functions)</li> <li><code>sort</code>, <code>distinct</code>, <code>reverse</code></li> <li><code>take</code>, <code>drop</code>, <code>rest</code>, <code>take-while</code>, <code>drop-while</code></li> </ul> <pre><code>;; Vector input \u2192 Vector return\n(map inc [1 2 3])              ;; =&gt; [2 3 4]\n(filter even? [1 2 3 4])       ;; =&gt; [2 4]\n(sort [3 1 4])                 ;; =&gt; [1 3 4]\n\n;; List input \u2192 List return\n(map inc (list 1 2 3))         ;; =&gt; (2 3 4)\n(filter even? (list 1 2 3 4))  ;; =&gt; (2 4)\n</code></pre>"},{"location":"spec/06-data-structures/#concatenation-functions-combine-multiple-collections","title":"Concatenation Functions (Combine Multiple Collections)","text":"<p>Prioritize the first argument's type.</p> <ul> <li><code>concat</code> - Returns Vector if first argument is Vector</li> <li><code>zip</code> - Returns Vector if first argument is Vector</li> <li><code>cons</code> - Preserves the type of the second argument (collection side)</li> </ul> <pre><code>;; Prioritize first argument's type\n(concat [1 2] (list 3 4))      ;; =&gt; [1 2 3 4]\n(concat (list 1 2) [3 4])      ;; =&gt; (1 2 3 4)\n(zip [1 2] (list \"a\" \"b\"))     ;; =&gt; [[1 \"a\"] [2 \"b\"]]\n\n;; cons preserves second argument's type\n(cons 0 [1 2 3])               ;; =&gt; [0 1 2 3]\n(cons 0 (list 1 2 3))          ;; =&gt; (0 1 2 3)\n</code></pre>"},{"location":"spec/06-data-structures/#construction-functions-generate-new-collections","title":"Construction Functions (Generate New Collections)","text":"<p>Always return Lists (Lisp-family language convention).</p> <ul> <li><code>range</code>, <code>repeat</code>, <code>flatten</code></li> <li><code>keys</code>, <code>vals</code> (map operations)</li> </ul> <pre><code>(range 5)                      ;; =&gt; (0 1 2 3 4)\n(repeat 3 \"x\")                 ;; =&gt; (\"x\" \"x\" \"x\")\n(flatten [[1 2] [3 4]])        ;; =&gt; (1 2 3 4)\n</code></pre>"},{"location":"spec/06-data-structures/#type-conversion-functions","title":"Type Conversion Functions","text":"<p>Explicit type conversion as needed.</p> <ul> <li><code>list</code> - Create List from variadic arguments</li> <li><code>vector</code> - Create Vector from variadic arguments</li> <li><code>to-list</code> - Convert List/Vector to List</li> <li><code>to-vector</code> - Convert List/Vector to Vector</li> </ul> <pre><code>(list 1 2 3)                   ;; =&gt; (1 2 3)\n(vector 1 2 3)                 ;; =&gt; [1 2 3]\n(to-list [1 2 3])              ;; =&gt; (1 2 3)\n(to-vector (list 1 2 3))       ;; =&gt; [1 2 3]\n</code></pre>"},{"location":"spec/06-data-structures/#vectors","title":"Vectors","text":""},{"location":"spec/06-data-structures/#basics","title":"Basics","text":"<pre><code>[1 2 3]           ;; Vector of numbers\n[\"a\" \"b\" \"c\"]     ;; Vector of strings\n[1 \"hello\" :key]  ;; Mixed types allowed\n[]                ;; Empty vector\n</code></pre>"},{"location":"spec/06-data-structures/#access","title":"Access","text":"<pre><code>;; nth - Get nth element (0-indexed)\n(nth [10 20 30] 1)     ;; =&gt; 20\n\n;; first - First element\n(first [10 20 30])     ;; =&gt; 10\n\n;; last - Last element\n(last [10 20 30])      ;; =&gt; 30\n\n;; rest - All except first element\n(rest [10 20 30])      ;; =&gt; [20 30]\n</code></pre>"},{"location":"spec/06-data-structures/#adding-combining","title":"Adding &amp; Combining","text":"<pre><code>;; cons - Add element to front (preserves collection type)\n(cons 0 [10 20 30])       ;; =&gt; [0 10 20 30]\n\n;; conj - Add element to end (Vectors add to end, Lists add to front)\n(conj [10 20 30] 40)      ;; =&gt; [10 20 30 40]\n\n;; concat - Concatenate lists (prioritizes first argument's type)\n(concat [10 20] [30 40])  ;; =&gt; [10 20 30 40]\n</code></pre>"},{"location":"spec/06-data-structures/#taking-skipping","title":"Taking &amp; Skipping","text":"<pre><code>;; take - Get first n elements (preserves type)\n(take 2 [10 20 30 40])    ;; =&gt; [10 20]\n\n;; drop - Skip first n elements (preserves type)\n(drop 2 [10 20 30 40])    ;; =&gt; [30 40]\n\n;; take-while - Take while predicate is true\n(take-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])  ;; =&gt; (1 2 3)\n\n;; drop-while - Drop while predicate is true\n(drop-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])  ;; =&gt; (6 7 4)\n\n;; list/drop-last - Drop last n elements\n(list/drop-last 2 [1 2 3 4 5])  ;; =&gt; (1 2 3)\n\n;; list/take-nth - Take every nth element\n(list/take-nth 2 [1 2 3 4 5 6])  ;; =&gt; (1 3 5)\n\n;; list/split-at - Split at specified position\n(list/split-at 2 [1 2 3 4 5])  ;; =&gt; [(1 2) (3 4 5)]\n</code></pre>"},{"location":"spec/06-data-structures/#transformation","title":"Transformation","text":"<pre><code>;; reverse - Reverse order (preserves type)\n(reverse [10 20 30])         ;; =&gt; [30 20 10]\n\n;; flatten - Flatten nesting (always returns List)\n(flatten [[1 2] [3 [4 5]]])  ;; =&gt; (1 2 3 4 5)\n\n;; distinct - Remove duplicates (preserves type)\n(distinct [1 2 2 3 3 3])     ;; =&gt; [1 2 3]\n\n;; list/dedupe - Remove consecutive duplicates\n(list/dedupe [1 1 2 2 3 3])  ;; =&gt; (1 2 3)\n(list/dedupe [1 2 1 2])      ;; =&gt; (1 2 1 2) (non-consecutive remain)\n\n;; sort - Sort ascending (preserves type)\n(sort [3 1 4 1 5])           ;; =&gt; [1 1 3 4 5]\n\n;; list/interleave - Interleave two lists\n(list/interleave [1 2 3] [4 5 6])  ;; =&gt; (1 4 2 5 3 6)\n\n;; list/chunk - Split into chunks of specified size\n(list/chunk 2 [1 2 3 4 5 6])  ;; =&gt; ((1 2) (3 4) (5 6))\n\n;; list/zipmap - Create map from two lists\n(list/zipmap [:a :b :c] [1 2 3])  ;; =&gt; {:a 1, :b 2, :c 3}\n</code></pre>"},{"location":"spec/06-data-structures/#size-state","title":"Size &amp; State","text":"<pre><code>;; len - Return number of elements\n(len [10 20 30])      ;; =&gt; 3\n\n;; count - Return number of elements (alias for len)\n(count [10 20 30])    ;; =&gt; 3\n\n;; empty? - Check if empty\n(empty? [])           ;; =&gt; true\n(empty? [1])          ;; =&gt; false\n</code></pre>"},{"location":"spec/06-data-structures/#lists","title":"Lists","text":""},{"location":"spec/06-data-structures/#basics_1","title":"Basics","text":"<pre><code>'(1 2 3)          ;; Quote required\n'()               ;; Empty list\n\n(first '(1 2 3))  ;; =&gt; 1\n(rest '(1 2 3))   ;; =&gt; (2 3)\n</code></pre>"},{"location":"spec/06-data-structures/#creation","title":"Creation","text":"<pre><code>;; list - Create List from variadic arguments\n(list 1 2 3)      ;; =&gt; (1 2 3)\n(list)            ;; =&gt; ()\n\n;; range - Generate range of numbers\n(range 5)         ;; =&gt; (0 1 2 3 4)\n(range 2 5)       ;; =&gt; (2 3 4)\n\n;; repeat - Repeat same value n times\n(repeat 5 0)      ;; =&gt; (0 0 0 0 0)\n(repeat 3 \"a\")    ;; =&gt; (\"a\" \"a\" \"a\")\n(repeat 2 [1 2])  ;; =&gt; ([1 2] [1 2])\n</code></pre>"},{"location":"spec/06-data-structures/#maps","title":"Maps","text":""},{"location":"spec/06-data-structures/#basics_2","title":"Basics","text":"<pre><code>{:name \"Alice\" :age 30}    ;; Keywords as keys\n{\"name\" \"Bob\" \"age\" 25}    ;; Strings as keys\n{}                         ;; Empty map\n</code></pre>"},{"location":"spec/06-data-structures/#valid-map-key-types","title":"Valid Map Key Types","text":"<p>Qi maps support only type-safe keys (<code>MapKey</code> type). The following 4 types can be used as keys:</p> Type Example Usage Keyword <code>:name</code>, <code>:age</code> Most common. Keys for structured data String <code>\"name\"</code>, <code>\"email\"</code> JSON-compatible, external data integration Symbol <code>'foo</code>, <code>'bar</code> Macros, metaprogramming Integer <code>0</code>, <code>1</code>, <code>42</code> Array-like access, indices"},{"location":"spec/06-data-structures/#floats-cannot-be-keys","title":"Floats Cannot Be Keys","text":"<p>Reason: Floating-point numbers have unstable hashing, so they cannot be used as map keys.</p> <pre><code>;; \u2705 Valid types\n{:name \"Alice\"}           ;; Keyword\n{\"email\" \"test@test.com\"} ;; String\n{42 \"value\"}              ;; Integer\n\n;; \u274c Error\n{3.14 \"pi\"}               ;; Float - Error: Floats cannot be keys\n</code></pre>"},{"location":"spec/06-data-structures/#internal-implementation","title":"Internal Implementation","text":"<p>Internally, map keys are represented as the <code>MapKey</code> enum type:</p> <pre><code>pub enum MapKey {\n    Keyword(Arc&lt;str&gt;),   // :name\n    Symbol(Arc&lt;str&gt;),    // 'symbol\n    String(String),      // \"text\"\n    Integer(i64),        // 42\n}\n</code></pre> <p>This design provides: - Type safety: Key types are checked at compile time - Performance: Fast comparison via Arc interning - Memory efficiency: Same keywords/symbols share memory"},{"location":"spec/06-data-structures/#access_1","title":"Access","text":"<pre><code>;; get - Get value by key\n(get {:name \"Alice\" :age 30} :name)   ;; =&gt; \"Alice\"\n(get {:name \"Alice\"} :age 0)          ;; =&gt; 0 (default value)\n\n;; Keywords and strings can be used as functions (concise syntax)\n(:name {:name \"Alice\" :age 30})       ;; =&gt; \"Alice\"\n(:age {:name \"Alice\" :age 30})        ;; =&gt; 30\n(\"name\" {\"name\" \"Bob\" \"age\" 25})      ;; =&gt; \"Bob\"\n\n;; Use with pipelines\n(def response {:status 200 :body \"OK\"})\n(response |&gt; :status)                 ;; =&gt; 200\n\n;; Access external data (JSON, etc.)\n(def user-data {\"name\" \"Carol\" \"email\" \"carol@example.com\"})\n(\"email\" user-data)                   ;; =&gt; \"carol@example.com\"\n\n;; keys - Get all keys\n(keys {:name \"Alice\" :age 30})        ;; =&gt; (\"name\" \"age\")\n\n;; vals - Get all values\n(vals {:name \"Alice\" :age 30})        ;; =&gt; (\"Alice\" 30)\n</code></pre>"},{"location":"spec/06-data-structures/#adding-removing","title":"Adding &amp; Removing","text":"<pre><code>;; assoc - Add key and value\n(assoc {:name \"Alice\"} :age 30)           ;; =&gt; {:name \"Alice\" :age 30}\n\n;; dissoc - Remove key\n(dissoc {:name \"Alice\" :age 30} :age)     ;; =&gt; {:name \"Alice\"}\n</code></pre>"},{"location":"spec/06-data-structures/#merging-selecting","title":"Merging &amp; Selecting","text":"<pre><code>;; merge - Combine maps\n(merge {:a 1} {:b 2})                         ;; =&gt; {:a 1 :b 2}\n(merge {:a 1} {:a 2})                         ;; =&gt; {:a 2} (right takes precedence)\n\n;; map/select-keys - Extract only specified keys\n(map/select-keys {:a 1 :b 2 :c 3} [:a :c])   ;; =&gt; {:a 1 :c 3}\n</code></pre>"},{"location":"spec/06-data-structures/#nested-operations","title":"Nested Operations","text":"<pre><code>;; update - Update value with function\n(update {:name \"Alice\" :age 30} :age inc)\n;; =&gt; {:name \"Alice\" :age 31}\n\n;; update-in - Update nested value\n(update-in {:user {:profile {:visits 10}}} [:user :profile :visits] inc)\n;; =&gt; {:user {:profile {:visits 11}}}\n\n;; get-in - Get nested value\n(get-in {:user {:name \"Bob\"}} [:user :name])    ;; =&gt; \"Bob\"\n(get-in {} [:user :name] \"guest\")               ;; =&gt; \"guest\"\n\n;; map/assoc-in - Set nested value\n(map/assoc-in {} [:user :profile :name] \"Alice\")\n;; =&gt; {:user {:profile {:name \"Alice\"}}}\n(map/assoc-in {:user {:age 30}} [:user :name] \"Bob\")\n;; =&gt; {:user {:age 30, :name \"Bob\"}}\n\n;; map/dissoc-in - Remove nested key\n(map/dissoc-in {:user {:name \"Alice\" :age 30}} [:user :age])\n;; =&gt; {:user {:name \"Alice\"}}\n(map/dissoc-in {:a {:b {:c 1}}} [:a :b :c])\n;; =&gt; {:a {:b {}}}\n</code></pre>"},{"location":"spec/06-data-structures/#bulk-map-transformations","title":"Bulk Map Transformations","text":"<pre><code>;; map/map-keys - Transform keys\n(map/map-keys str/upper {:name \"Alice\" :age 30})\n;; =&gt; {\"NAME\" \"Alice\", \"AGE\" 30}\n\n;; map/map-vals - Transform values\n(map/map-vals inc {:a 1 :b 2})\n;; =&gt; {:a 2, :b 3}\n\n;; map/filter-keys - Filter by keys\n(map/filter-keys keyword? {:name \"Alice\" \"age\" 30})\n;; =&gt; {:name \"Alice\"}\n\n;; map/filter-vals - Filter by values\n(map/filter-vals even? {:a 1 :b 2 :c 3})\n;; =&gt; {:b 2}\n</code></pre>"},{"location":"spec/06-data-structures/#sets-set-operations","title":"Sets (Set Operations)","text":"<pre><code>;; set/union - Union\n(set/union [1 2] [2 3])                         ;; =&gt; [1 2 3]\n\n;; set/intersect - Intersection\n(set/intersect [1 2 3] [2 3 4])                 ;; =&gt; [2 3]\n\n;; set/difference - Difference\n(set/difference [1 2 3] [2])                    ;; =&gt; [1 3]\n\n;; set/symmetric-difference - Symmetric difference\n(set/symmetric-difference [1 2 3] [2 3 4])      ;; =&gt; [1 4]\n\n;; set/subset? - Subset check\n(set/subset? [1 2] [1 2 3])                     ;; =&gt; true\n\n;; set/superset? - Superset check\n(set/superset? [1 2 3] [1 2])                   ;; =&gt; true\n\n;; set/disjoint? - Disjoint check\n(set/disjoint? [1 2] [3 4])                     ;; =&gt; true\n</code></pre>"},{"location":"spec/06-data-structures/#higher-order-functions","title":"Higher-Order Functions","text":""},{"location":"spec/06-data-structures/#map-apply-function-to-each-element","title":"map - Apply Function to Each Element","text":"<pre><code>;; Vector input \u2192 Vector return\n(map inc [1 2 3])                    ;; =&gt; [2 3 4]\n(map str [1 2 3])                    ;; =&gt; [\"1\" \"2\" \"3\"]\n\n;; List input \u2192 List return\n(map inc (list 1 2 3))               ;; =&gt; (2 3 4)\n\n;; Use in pipeline\n([1 2 3] |&gt; (map (fn [x] (* x x))))  ;; =&gt; [1 4 9]\n</code></pre>"},{"location":"spec/06-data-structures/#filter-extract-elements-matching-condition","title":"filter - Extract Elements Matching Condition","text":"<pre><code>;; Vector input \u2192 Vector return\n(filter even? [1 2 3 4 5])                      ;; =&gt; [2 4]\n(filter (fn [x] (&gt; x 10)) [5 15 3 20])          ;; =&gt; [15 20]\n\n;; List input \u2192 List return\n(filter even? (list 1 2 3 4 5))                 ;; =&gt; (2 4)\n\n;; Use in pipeline\n([1 2 3 4 5] |&gt; (filter odd?))                  ;; =&gt; [1 3 5]\n</code></pre>"},{"location":"spec/06-data-structures/#reduce-fold","title":"reduce - Fold","text":"<pre><code>(reduce + 0 [1 2 3 4])        ;; =&gt; 10\n(reduce * 1 [2 3 4])          ;; =&gt; 24\n\n;; Use in pipeline\n([1 2 3 4 5] |&gt; (reduce + 0)) ;; =&gt; 15\n</code></pre>"},{"location":"spec/06-data-structures/#each-apply-function-to-each-element-for-side-effects","title":"each - Apply Function to Each Element (For Side Effects)","text":"<p>Unlike <code>map</code>, does not collect return values and returns <code>nil</code>. Use for side effects (println, file writing, etc.).</p> <pre><code>;; Basic usage\n(each println [1 2 3])\n;; Output:\n;; 1\n;; 2\n;; 3\n;; =&gt; nil\n\n;; Works with both Vectors and Lists\n(each println (list \"a\" \"b\" \"c\"))\n;; Output:\n;; a\n;; b\n;; c\n;; =&gt; nil\n\n;; With lambda expression\n(each (fn [x] (println f\"Value: {x}\")) [10 20 30])\n;; Output:\n;; Value: 10\n;; Value: 20\n;; Value: 30\n;; =&gt; nil\n\n;; Use in pipeline\n(lines\n |&gt; (map str/trim)\n |&gt; (map str/upper)\n |&gt; (each println))\n;; Convert each line to uppercase and print\n\n;; Conditional processing with when\n(data\n |&gt; (each (fn [item]\n            (when (&gt; (len item) 0)\n              (println f\"Processing: {item}\")))))\n\n;; Statistical aggregation\n(def count (atom 0))\n(data\n |&gt; (each (fn [item]\n            (when (valid? item)\n              (swap! count inc)))))\n</code></pre> <p>Choosing between map and each: - <code>map</code>: When return value is needed (data transformation) - <code>each</code>: When return value is not needed (side effects only)</p> <pre><code>;; map - Returns transformation result\n(map inc [1 2 3])  ;; =&gt; [2 3 4]\n\n;; each - Side effects only, returns nil\n(each println [1 2 3])  ;; =&gt; nil (but each element is printed)\n</code></pre>"},{"location":"spec/06-data-structures/#find-first-element-matching-condition","title":"find - First Element Matching Condition","text":"<pre><code>(find (fn [x] (&gt; x 5)) [1 7 3])     ;; =&gt; 7\n(find even? [1 3 4 5])              ;; =&gt; 4\n</code></pre>"},{"location":"spec/06-data-structures/#predicates-whole-collection-check","title":"Predicates (Whole Collection Check)","text":"<pre><code>;; list/every? - Check if all elements satisfy condition\n(list/every? (fn [x] (&gt; x 0)) [1 2 3])   ;; =&gt; true\n(list/every? even? [2 4 6])              ;; =&gt; true\n\n;; list/some? - Check if any element satisfies condition\n(list/some? (fn [x] (&gt; x 5)) [1 7 3])    ;; =&gt; true\n(list/some? even? [1 3 5])               ;; =&gt; false\n</code></pre> <p>Note: <code>some?</code> (1 argument) is a Core predicate function that checks if value is not nil (\u2192 See Basic Syntax).</p>"},{"location":"spec/06-data-structures/#sorting-grouping","title":"Sorting &amp; Grouping","text":""},{"location":"spec/06-data-structures/#sorting","title":"Sorting","text":"<pre><code>;; sort - Sort ascending (preserves type)\n(sort [3 1 4 1 5])                             ;; =&gt; [1 1 3 4 5]\n(sort [\"zebra\" \"apple\" \"banana\"])              ;; =&gt; [\"apple\" \"banana\" \"zebra\"]\n(sort (list 3 1 4 1 5))                        ;; =&gt; (1 1 3 4 5)\n\n;; list/sort-by - Sort by key\n(list/sort-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; ({:name \"Bob\" :age 25} {:name \"Alice\" :age 30})\n</code></pre>"},{"location":"spec/06-data-structures/#grouping","title":"Grouping","text":"<pre><code>;; list/group-by - Group by key function\n(list/group-by even? [1 2 3 4 5 6])\n;; =&gt; {true [2 4 6], false [1 3 5]}\n\n;; list/partition - Partition into 2 groups by predicate\n(list/partition even? [1 2 3 4])\n;; =&gt; [[2 4] [1 3]]\n</code></pre>"},{"location":"spec/06-data-structures/#frequency-counting","title":"Frequency &amp; Counting","text":"<pre><code>;; list/frequencies - Count occurrences\n(list/frequencies [1 2 2 3 3 3])\n;; =&gt; {1 1, 2 2, 3 3}\n\n;; list/count-by - Count by predicate\n(list/count-by even? [1 2 3 4])\n;; =&gt; {true 2, false 2}\n</code></pre>"},{"location":"spec/06-data-structures/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/06-data-structures/#data-analysis-pipeline","title":"Data Analysis Pipeline","text":"<pre><code>;; Remove duplicates and sort\n([5 2 8 2 9 1 3 8 4]\n |&gt; distinct\n |&gt; sort)\n;; =&gt; (1 2 3 4 5 8 9)\n\n;; Group and aggregate\n(list/group-by (fn [n] (% n 3)) [1 2 3 4 5 6 7 8 9])\n;; =&gt; {0 (3 6 9), 1 (1 4 7), 2 (2 5 8)}\n</code></pre>"},{"location":"spec/06-data-structures/#user-search","title":"User Search","text":"<pre><code>(def users [{:name \"Alice\" :age 30} {:name \"Bob\" :age 25}])\n\n;; Find user by name\n(find (fn [u] (= (get u :name) \"Bob\")) users)\n;; =&gt; {:name \"Bob\" :age 25}\n\n;; Check if all are adults\n(list/every? (fn [u] (&gt;= (get u :age) 20)) users)\n;; =&gt; true\n\n;; Search via pipeline\n(users\n |&gt; (filter (fn [u] (&gt;= (get u :age) 25)))\n |&gt; (map (fn [u] (get u :name))))\n;; =&gt; (\"Alice\" \"Bob\")\n</code></pre>"},{"location":"spec/07-functions/","title":"Functions","text":"<p>Functions as First-Class Objects</p> <p>In Qi, functions are first-class objects that can be assigned to variables, passed as arguments, and returned as values.</p>"},{"location":"spec/07-functions/#function-definition","title":"Function Definition","text":""},{"location":"spec/07-functions/#fn-anonymous-functions","title":"fn - Anonymous Functions","text":"<pre><code>;; Basic function\n(fn [x] (* x 2))\n\n;; Multiple arguments\n(fn [x y] (+ x y))\n\n;; No arguments\n(fn [] (println \"no args\"))\n\n;; Variadic arguments\n(fn [&amp; args] (reduce + 0 args))\n</code></pre>"},{"location":"spec/07-functions/#defn-named-functions","title":"defn - Named Functions","text":"<pre><code>;; Basic form\n(defn greet [name]\n  (str \"Hello, \" name))\n\n;; Variadic arguments\n(defn sum [&amp; nums]\n  (reduce + 0 nums))\n\n;; Vector destructuring\n(defn add-pair [[x y]]\n  (+ x y))\n\n;; Map destructuring\n(defn greet-user [{:name n :age a}]\n  (str n \" is \" a \" years old\"))\n</code></pre>"},{"location":"spec/07-functions/#closures","title":"Closures","text":"<p>Functions can capture variables from their defining scope (closures).</p> <pre><code>;; Counter function generator\n(defn make-counter []\n  (let [count (atom 0)]\n    (fn []\n      (swap! count inc)\n      (deref count))))\n\n(def counter (make-counter))\n(counter)  ;; =&gt; 1\n(counter)  ;; =&gt; 2\n(counter)  ;; =&gt; 3\n\n;; Closure-based partial application\n(defn make-adder [n]\n  (fn [x] (+ x n)))\n\n(def add5 (make-adder 5))\n(add5 10)  ;; =&gt; 15\n</code></pre>"},{"location":"spec/07-functions/#higher-order-functions","title":"Higher-Order Functions","text":""},{"location":"spec/07-functions/#identity-return-argument-as-is","title":"identity - Return Argument As-Is","text":"<pre><code>(identity 42)                         ;; =&gt; 42\n\n;; Filter out nil and false\n(filter identity [1 false nil 2])     ;; =&gt; (1 2)\n</code></pre>"},{"location":"spec/07-functions/#constantly-generate-function-that-always-returns-same-value","title":"constantly - Generate Function That Always Returns Same Value","text":"<pre><code>(def always-42 (constantly 42))\n(always-42 \"anything\")                ;; =&gt; 42\n(always-42 1 2 3)                     ;; =&gt; 42\n\n;; Practical example: Default value generation\n(map (constantly 0) [1 2 3])          ;; =&gt; (0 0 0)\n</code></pre>"},{"location":"spec/07-functions/#apply-apply-function-with-list-as-arguments","title":"apply - Apply Function with List as Arguments","text":"<pre><code>(apply + [1 2 3])                     ;; =&gt; 6\n(apply max [5 2 8 3])                 ;; =&gt; 8\n\n;; Practical example: Variadic argument expansion\n(defn sum-all [&amp; nums]\n  (apply + nums))\n\n(sum-all 1 2 3 4 5)                   ;; =&gt; 15\n</code></pre>"},{"location":"spec/07-functions/#comp-function-composition-apply-right-to-left","title":"comp - Function Composition (Apply Right-to-Left)","text":"<pre><code>;; Function composition\n(def process (comp inc (* 2)))\n(process 5)                           ;; =&gt; 11  ((5 * 2) + 1)\n\n;; Compose multiple functions\n(def transform (comp str/upper str/trim))\n(transform \"  hello  \")               ;; =&gt; \"HELLO\"\n\n;; Comparison with pipelines\n;; comp: (comp f g h) applies h \u2192 g \u2192 f\n;; |&gt;:   x |&gt; h |&gt; g |&gt; f is the same processing\n</code></pre>"},{"location":"spec/07-functions/#partial-application-using-fn","title":"Partial Application (using fn)","text":"<pre><code>;; Create new function with partial application\n(def add5 (fn [x] (+ 5 x)))\n(add5 10)                             ;; =&gt; 15\n\n;; Partial application with multiple arguments\n(def greet-hello (fn [name] (str \"Hello, \" name)))\n(greet-hello \"Alice\")                 ;; =&gt; \"Hello, Alice\"\n\n;; Practical example: Generate filter condition\n(def greater-than-10 (fn [x] (&gt; x 10)))\n(filter greater-than-10 [5 15 3 20])  ;; =&gt; (15 20)\n</code></pre>"},{"location":"spec/07-functions/#fn-module-advanced-higher-order-functions","title":"fn/ Module (Advanced Higher-Order Functions)","text":""},{"location":"spec/07-functions/#fncomplement-negate-predicate","title":"fn/complement - Negate Predicate","text":"<pre><code>;; Generate negated predicate function\n(def odd? (fn/complement even?))\n(odd? 3)                              ;; =&gt; true\n(odd? 4)                              ;; =&gt; false\n\n;; Practical example: Invert filter\n(filter (fn/complement nil?) [1 nil 2 nil 3])  ;; =&gt; (1 2 3)\n</code></pre>"},{"location":"spec/07-functions/#fnjuxt-apply-multiple-functions-in-parallel","title":"fn/juxt - Apply Multiple Functions in Parallel","text":"<pre><code>;; Apply multiple functions in parallel and return results in vector\n((fn/juxt inc dec) 5)                 ;; =&gt; [6 4]\n\n;; Practical example: Multi-faceted data analysis\n(def analyze (fn/juxt min max sum len))\n(analyze [1 2 3 4 5])                 ;; =&gt; [1 5 15 5]\n\n;; Extract user data\n(def extract-info (fn/juxt :name :age :email))\n(extract-info {:name \"Alice\" :age 30 :email \"alice@example.com\"})\n;; =&gt; [\"Alice\" 30 \"alice@example.com\"]\n</code></pre>"},{"location":"spec/07-functions/#fntap-processing-with-side-effects","title":"fn/tap&gt; - Processing with Side Effects","text":"<pre><code>;; Return value as-is while executing side effect (logging, etc.)\n(def log-and-pass (fn/tap&gt; println))\n(log-and-pass 42)  ;; Prints 42 and returns 42\n\n;; Debugging in pipelines\n(10\n  |&gt; (fn/tap&gt; (fn [x] (println \"Input:\" x)))\n  |&gt; (* _ 2)\n  |&gt; (fn/tap&gt; (fn [x] (println \"Doubled:\" x)))\n  |&gt; (+ _ 5))\n;; Output:\n;; Input: 10\n;; Doubled: 20\n;; =&gt; 25\n\n;; Counter implementation\n(def counter (atom 0))\n(def count-and-pass\n  (fn/tap&gt; (fn [_] (reset! counter (+ (deref counter) 1)))))\n\n(map count-and-pass [1 2 3 4 5])\n;; =&gt; (1 2 3 4 5)\n(deref counter)  ;; =&gt; 5\n</code></pre>"},{"location":"spec/07-functions/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/07-functions/#data-transformation-pipeline","title":"Data Transformation Pipeline","text":"<pre><code>;; Process data with function composition\n(def process-text\n  (comp\n    str/upper\n    str/trim\n    (fn [s] (str/replace s \"!\" \".\"))))\n\n(process-text \"  hello world!  \")     ;; =&gt; \"HELLO WORLD.\"\n</code></pre>"},{"location":"spec/07-functions/#filter-combination","title":"Filter Combination","text":"<pre><code>;; Filter with multiple conditions\n(def valid-user?\n  (fn [user]\n    (and\n      ((complement nil?) (get user :name))\n      (&gt; (get user :age) 18))))\n\n(filter valid-user?\n  [{:name \"Alice\" :age 30}\n   {:name nil :age 20}\n   {:name \"Bob\" :age 15}])\n;; =&gt; ({:name \"Alice\" :age 30})\n</code></pre>"},{"location":"spec/07-functions/#debugging-with-higher-order-functions","title":"Debugging with Higher-Order Functions","text":"<pre><code>;; Use tap to observe data flow\n(defn debug [label]\n  (fn [x]\n    (println label x)\n    x))\n\n([1 2 3]\n |&gt; (map inc)\n |&gt; ((debug \"after map:\"))\n |&gt; sum)\n;; Output: after map: (2 3 4)\n;; =&gt; 9\n</code></pre>"},{"location":"spec/07-functions/#currying-style-function-definition","title":"Currying-Style Function Definition","text":"<pre><code>;; Apply multiple arguments in stages\n(defn make-multiplier [n]\n  (fn [x] (* x n)))\n\n(def double (make-multiplier 2))\n(def triple (make-multiplier 3))\n\n(double 5)  ;; =&gt; 10\n(triple 5)  ;; =&gt; 15\n\n;; Use in pipeline\n([1 2 3] |&gt; (map double))  ;; =&gt; (2 4 6)\n</code></pre>"},{"location":"spec/08-error-handling/","title":"Error Handling","text":"<p>Qi's Error Handling Strategy</p> <p>Qi provides three error handling methods for different use cases:</p> <ol> <li>Result Type (value / <code>{:error ...}</code>) - Recoverable errors, Railway Pipeline (also supports <code>{:ok value}</code> format for validation)</li> <li>try/catch - Exception catching and recovery</li> <li>defer - Guaranteed resource cleanup (<code>finally</code> alternative)</li> </ol>"},{"location":"spec/08-error-handling/#1-result-type-railway-pipeline-recommended-pattern","title":"1. Result Type - Railway Pipeline (Recommended Pattern)","text":"<p>Use Cases: API calls, file I/O, parsing, and other operations where failure is expected</p>"},{"location":"spec/08-error-handling/#new-specification-everything-except-error-is-success","title":"New Specification: Everything Except <code>{:error}</code> is Success","text":"<p>Everything except <code>{:error}</code> is success! No <code>:ok</code> wrapping</p> <pre><code>;; Simple! Just return regular values\n(defn divide [x y]\n  (if (= y 0)\n    {:error \"division by zero\"}  ;; Only errors are explicit\n    (/ x y)))                     ;; Regular value \u2192 success\n\n;; Process with match (if needed)\n(match (divide 10 2)\n  {:error e} -&gt; (log e)\n  result -&gt; result)\n\n;; Check with error? predicate (simple)\n(def result (divide 10 2))\n(if (error? result)\n  (log \"Error occurred\")\n  (process result))\n\n;; Error handling in pipelines (see 02-flow-pipes.md for details)\n(user-input\n |&gt; validate\n |&gt;? parse-number      ;; Just return regular value\n |&gt;? (fn [n] (divide 100 n))\n |&gt;? format-result)\n;; On success =&gt; result value, On error =&gt; {:error ...}\n</code></pre>"},{"location":"spec/08-error-handling/#integration-with-railway-pipeline","title":"Integration with Railway Pipeline","text":"<p>Using the <code>|&gt;?</code> operator integrates error handling into pipelines.</p> <pre><code>;; HTTP request + error handling (simple!)\n(\"https://api.example.com/users/123\"\n |&gt; http/get                      ;; =&gt; \"{\\\"user\\\": {...}}\" (body only)\n |&gt;? json/parse                   ;; =&gt; Parse result (value as-is)\n |&gt;? (fn [data] (get data \"user\")))  ;; Just return the value!\n;; On success =&gt; user data, On error =&gt; {:error ...}\n\n;; JSON parse + data transformation\n(\"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\"\n |&gt; json/parse                    ;; =&gt; Parse result (value as-is)\n |&gt;? (fn [data] (get data \"name\"))  ;; Just return the value!\n |&gt;? str/upper)                   ;; Pass function directly!\n;; =&gt; \"ALICE\"\n</code></pre>"},{"location":"spec/08-error-handling/#behavior-rules","title":"Behavior Rules","text":"<p>Input processing: 1. <code>{:error ...}</code> \u2192 Short-circuit (don't execute next function) 2. Everything else \u2192 Pass to next function as-is</p> <p>Output processing: 1. <code>{:error ...}</code> \u2192 Return as-is (error propagation) 2. Everything else \u2192 Return as-is (no <code>:ok</code> wrapping!)</p>"},{"location":"spec/08-error-handling/#design-philosophy","title":"Design Philosophy","text":"<p>Treat errors as data and flow them through pipelines. Avoid try-catch nesting, keeping data flow clear. Everything except <code>{:error}</code> is treated as success - same philosophy as Lisp's \"everything except nil is true,\" keeping it simple.</p>"},{"location":"spec/08-error-handling/#2-trycatch-exception-handling","title":"2. try/catch - Exception Handling","text":"<p>Use Cases: Catching unexpected errors, calling third-party code</p>"},{"location":"spec/08-error-handling/#basic-usage","title":"Basic Usage","text":"<pre><code>;; try-catch block\n(match (try (risky-operation))\n  {:error e} -&gt; (handle-error e)\n  result -&gt; result)\n\n;; Nesting allowed\n(match (try\n         (let [data (parse-data input)]\n           (process data)))\n  {:error e} -&gt; {:error (str \"Failed: \" e)}\n  result -&gt; result)\n</code></pre>"},{"location":"spec/08-error-handling/#practical-examples","title":"Practical Examples","text":"<pre><code>;; File reading error handling\n(match (try (io/read-file \"config.json\"))\n  {:error e} -&gt; (do\n                  (log/error \"Failed to read config:\" e)\n                  {:error e})\n  content -&gt; (json/parse content))\n\n;; Use in pipeline\n(match (try\n         (url\n          |&gt; http-get\n          |&gt; parse\n          |&gt; process))\n  {:error e} -&gt; []\n  data -&gt; data)\n</code></pre> <p>Note: Qi doesn't have <code>finally</code>. Use <code>defer</code> instead (see below).</p>"},{"location":"spec/08-error-handling/#3-defer-guaranteed-resource-cleanup-finally-alternative","title":"3. defer - Guaranteed Resource Cleanup (finally Alternative)","text":"<p>Use Cases: Resource management for files, connections, locks, etc.</p>"},{"location":"spec/08-error-handling/#basic-usage_1","title":"Basic Usage","text":"<pre><code>;; Ensure cleanup with defer\n(defn process-file [path]\n  (let [f (open-file path)]\n    (do\n      (defer (close-file f))  ;; Always executed on function exit\n      (let [data (io/read-file f)]\n        (transform data)))))\n\n;; Practical example: File processing\n(defn safe-read [path]\n  (let [f (open path)]\n    (do\n      (defer (close f))  ;; Always executed on function exit\n      (read f))))\n</code></pre>"},{"location":"spec/08-error-handling/#execution-order-of-multiple-defers","title":"Execution Order of Multiple defers","text":"<p>Multiple defers execute in stack order (LIFO: Last In, First Out).</p> <pre><code>(defn complex-operation []\n  (do\n    (let [conn (open-connection)]\n      (defer (close-connection conn)))\n    (let [lock (acquire-lock)]\n      (defer (release-lock lock)))\n    (let [file (open-file \"data.txt\")]\n      (defer (close-file file)))\n    ;; Process...\n    ;; Execution order on exit: close-file \u2192 release-lock \u2192 close-connection\n    ))\n\n;; Simple example\n(do\n  (defer (log \"3\"))\n  (defer (log \"2\"))\n  (defer (log \"1\"))\n  (work))\n;; Execution order: work \u2192 \"1\" \u2192 \"2\" \u2192 \"3\"\n</code></pre>"},{"location":"spec/08-error-handling/#defer-with-errors","title":"defer with Errors","text":"<p>Even when errors occur, defer is always executed.</p> <pre><code>(defn safe-process []\n  (do\n    (let [res (allocate-resource)]\n      (defer (free-resource res)))\n    (if (error-condition?)\n      (error \"something went wrong\")  ;; defer still executes\n      (process res))))\n</code></pre>"},{"location":"spec/08-error-handling/#design-philosophy_1","title":"Design Philosophy","text":"<ul> <li>Simpler than <code>finally</code> - Can be written anywhere in function</li> <li>Powerful - Multiple defers can be combined</li> <li>Same design as Go's defer</li> <li>Lisp-like - No special syntax added</li> </ul> <p>Why no finally?: <code>defer</code> is more flexible and makes multiple resource management more intuitive. More readable than try-catch-finally nesting.</p>"},{"location":"spec/08-error-handling/#4-error-unrecoverable-errors","title":"4. error - Unrecoverable Errors","text":"<p>Use Cases: Fatal errors, precondition violations</p>"},{"location":"spec/08-error-handling/#basic-usage_2","title":"Basic Usage","text":"<pre><code>;; Throw fatal error with error\n(defn critical-init []\n  (if (not (io/file-exists? \"config.qi\"))\n    (error \"config.qi not found\")\n    (load-config)))\n\n(defn factorial [n]\n  (if (&lt; n 0)\n    (error \"negative input not allowed\")\n    (loop [i n acc 1]\n      (if (= i 0)\n        acc\n        (recur (dec i) (* acc i))))))\n</code></pre>"},{"location":"spec/08-error-handling/#catching-with-try","title":"Catching with try","text":"<pre><code>;; Catch and process error\n(match (try (factorial -5))\n  {:error e} -&gt; (log (str \"Error: \" e))\n  result -&gt; result)\n</code></pre>"},{"location":"spec/08-error-handling/#choosing-error-handling-methods","title":"Choosing Error Handling Methods","text":""},{"location":"spec/08-error-handling/#when-to-use-result-type","title":"When to Use Result Type","text":"<ul> <li>API calls, HTTP requests</li> <li>File I/O, database queries</li> <li>JSON/YAML parsing</li> <li>User input validation</li> <li>Any operation where failure is expected</li> </ul>"},{"location":"spec/08-error-handling/#when-to-use-trycatch","title":"When to Use try/catch","text":"<ul> <li>Catching unexpected errors</li> <li>Calling third-party libraries</li> <li>Catching complex processing errors all at once</li> <li>Handling exceptional situations</li> </ul>"},{"location":"spec/08-error-handling/#standard-library-return-formats","title":"Standard Library Return Formats","text":"<p>Qi's built-in functions return different formats based on the nature of the error.</p>"},{"location":"spec/08-error-handling/#functions-returning-result-type-value-error","title":"Functions Returning Result Type (value / <code>{:error ...}</code>)","text":"<p>Data format functions - Parse errors are expected, requiring explicit handling:</p> <ul> <li><code>json/parse</code>, <code>json/stringify</code>, <code>json/pretty</code> - JSON processing</li> <li><code>yaml/parse</code>, <code>yaml/stringify</code> - YAML processing</li> <li><code>csv/parse</code>, <code>csv/stringify</code> - CSV processing (planned)</li> </ul> <pre><code>;; Explicitly handle parse errors\n(match (json/parse user-input)\n  {:error msg} -&gt; (show-error-to-user msg)\n  data -&gt; (process data))\n\n;; Use in pipeline\n(user-input\n |&gt; json/parse\n |&gt;? (fn [data] (get data \"name\"))\n |&gt;? str/upper)\n</code></pre>"},{"location":"spec/08-error-handling/#functions-throwing-exceptions-okvalue-errmessage","title":"Functions Throwing Exceptions (<code>Ok(value)</code> / <code>Err(message)</code>)","text":"<p>I/O &amp; Network functions - Failure is treated as exceptional:</p> <ul> <li><code>http/get</code>, <code>http/post</code>, <code>http/put</code>, <code>http/delete</code> - HTTP operations</li> <li><code>io/read-file</code>, <code>io/write-file</code> - File I/O</li> <li><code>io/open</code>, <code>io/close</code> - File operations</li> <li><code>db/*</code> - Database operations (planned)</li> </ul> <pre><code>;; Failure propagates as exception\n(def content (io/read-file \"config.json\"))\n\n;; Catch and process with try\n(match (try (http/get \"https://api.example.com/data\"))\n  {:error e} -&gt; (log-error e)\n  response -&gt; (process response))\n</code></pre>"},{"location":"spec/08-error-handling/#design-policy","title":"Design Policy","text":"<p>This distinction is based on the following reasoning:</p> <ol> <li>Data format functions return value/<code>{:error}</code></li> <li>Parse errors are expected failures (invalid JSON strings, etc.)</li> <li>Error cases are part of normal flow, like user input validation</li> <li>Handle explicitly with match or pipeline (<code>|&gt;?</code>)</li> <li> <p>On success, return value directly (no <code>:ok</code> wrapping)</p> </li> <li> <p>I/O &amp; Network functions throw exceptions</p> </li> <li>File not found, network errors are exceptional situations</li> <li>Keep normal path code concise</li> <li>Catch with try/catch as needed</li> </ol> <p>This policy allows users to naturally distinguish between \"expected errors\" and \"exceptional situations\".</p>"},{"location":"spec/08-error-handling/#when-to-use-defer","title":"When to Use defer","text":"<ul> <li>Closing files</li> <li>Closing database connections</li> <li>Releasing locks</li> <li>Deleting temporary files</li> <li>Whenever resource cleanup is needed</li> </ul>"},{"location":"spec/08-error-handling/#when-to-use-error","title":"When to Use error","text":"<ul> <li>Missing configuration files</li> <li>Precondition violations</li> <li>Invalid arguments</li> <li>Fatal errors where program cannot continue</li> </ul>"},{"location":"spec/08-error-handling/#internal-implementation-rust-err-vs-qi","title":"Internal Implementation: Rust Err vs Qi","text":"<p>Qi's error handling bridges Rust's Result type and Qi's value type.</p>"},{"location":"spec/08-error-handling/#dual-error-representation","title":"Dual Error Representation","text":"<p>Rust side (internal implementation): <pre><code>fn eval(&amp;self, expr: &amp;Expr) -&gt; Result&lt;Value, String&gt;\n</code></pre> - Success: <code>Ok(Value)</code> - Error: <code>Err(String)</code></p> <p>Qi side (user-facing): <pre><code>;; Success: values as-is\n42\n\"hello\"\n{:user \"alice\"}\n\n;; Error: {:error ...} map\n{:error \"file not found\"}\n{:error {:type \"network\" :code 404}}\n</code></pre></p>"},{"location":"spec/08-error-handling/#conversion-by-try","title":"Conversion by try","text":"<p><code>try</code> converts Rust's Err to Qi's <code>{:error}</code>:</p> <pre><code>;; How try works\n(try (risky-operation))\n;; \u2193 Internal processing\n;; Ok(value) \u2192 value (returns as-is)\n;; Err(msg) \u2192 {:error msg} (converts to error map)\n</code></pre> <p>Implementation details: <pre><code>// src/eval/special_forms.rs\npub fn eval_try(&amp;self, expr: &amp;Expr) -&gt; Result&lt;Value, String&gt; {\n    match self.eval(expr) {\n        Ok(value) =&gt; Ok(value),     // Success \u2192 as-is\n        Err(msg) =&gt; Ok(Value::error(msg)),  // Error \u2192 {:error msg}\n    }\n}\n</code></pre></p>"},{"location":"spec/08-error-handling/#railway-pipeline-internal-operation","title":"Railway Pipeline Internal Operation","text":"<p>The <code>|&gt;?</code> operator detects <code>{:error}</code> and short-circuits:</p> <pre><code>(value\n |&gt;? step1\n |&gt;? step2\n |&gt;? step3)\n</code></pre> <p>Expanded: <pre><code>let v1 = step1(value);\nif v1.is_error() { return v1; }  // Short-circuit if {:error}\nlet v2 = step2(v1);\nif v2.is_error() { return v2; }\nlet v3 = step3(v2);\nv3\n</code></pre></p>"},{"location":"spec/08-error-handling/#design-intent","title":"Design Intent","text":"<p>This dual structure achieves:</p> <ol> <li>Rust side: Type-safe exception handling (Result type)</li> <li>Qi side: Lisp-style data-oriented error handling (treat as values)</li> <li>try: Bridge between them (Err \u2192 {:error})</li> </ol> <pre><code>;; Catch Rust exceptions and convert to Qi values\n(match (try (io/read-file path))\n  {:error e} -&gt; (handle-error e)  ;; Treat as data on Qi side\n  content -&gt; content)\n</code></pre> <p>This design balances Rust's safety with Lisp's flexibility.</p>"},{"location":"spec/08-error-handling/#practical-examples_1","title":"Practical Examples","text":""},{"location":"spec/08-error-handling/#api-client","title":"API Client","text":"<pre><code>(defn fetch-user [user-id]\n  (user-id\n   |&gt; (str \"https://api.example.com/users/\" _)\n   |&gt; http/get\n   |&gt;? json/parse\n   |&gt;? validate-user))\n\n;; Usage example\n(match (fetch-user \"123\")\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  user -&gt; (process-user user))\n</code></pre>"},{"location":"spec/08-error-handling/#file-processing-with-defer","title":"File Processing with defer","text":"<pre><code>(defn process-log-file [path]\n  (let [f (io/open path :read)]\n    (do\n      (defer (io/close f))\n      (io/read-lines f\n       |&gt; (filter (fn [line] (str/contains? line \"ERROR\")))\n       |&gt; (map parse-log-line)\n       |&gt; (take 100)))))\n</code></pre>"},{"location":"spec/08-error-handling/#complex-error-handling","title":"Complex Error Handling","text":"<pre><code>(defn complex-operation [input]\n  (match (try\n           (input\n            |&gt; validate\n            |&gt;? parse-data\n            |&gt;? transform\n            |&gt;? save-to-db))\n    {:error e} -&gt; (do\n                    (log/error \"Operation failed:\" e)\n                    (send-alert e)\n                    {:failure e})\n    result -&gt; {:success result}))\n</code></pre>"},{"location":"spec/09-modules/","title":"Module System","text":"<p>Namespace Separation by File Unit</p> <p>Qi organizes modules on a per-file basis, separating namespaces.</p>"},{"location":"spec/09-modules/#basic-concepts","title":"Basic Concepts","text":"<ul> <li>Search by file name, display by module name: <code>use</code> searches by file name, module name can be changed with <code>module</code> declaration</li> <li>use auto-loads: <code>use</code> reads file + imports symbols</li> <li>load is side-effects only: Executes configuration files etc. without importing</li> <li>No export = all public: Without <code>export</code> declaration, everything is public (except <code>defn-</code>)</li> <li>With export = selective public: With <code>export</code> declaration, only explicitly listed items are public</li> <li>defn- is completely private: Always private regardless of <code>export</code></li> </ul>"},{"location":"spec/09-modules/#module-declaration","title":"module Declaration","text":"<p><code>module</code> specifies the display name of a module (optional).</p>"},{"location":"spec/09-modules/#basic-usage","title":"Basic Usage","text":"<pre><code>;; http.qi\n(module web-api)  ;; Change display name to 'web-api'\n\n(defn get [url] ...)\n\n;; Search is performed with 'http.qi'\n;; Access becomes 'web-api/get'\n</code></pre>"},{"location":"spec/09-modules/#specification","title":"Specification","text":"<ul> <li>Optional: If not present, file name (basename) becomes module name</li> <li>Does not affect search: <code>use http</code> searches for <code>http.qi</code> (not module name)</li> <li>Changes display name only: Prefix for access changes</li> <li>One per file: Multiple <code>module</code> declarations cause an error</li> <li>Position: Recommended at file top (technically allowed anywhere)</li> <li>Return value: <code>nil</code></li> </ul>"},{"location":"spec/09-modules/#examples","title":"Examples","text":"<pre><code>;; http.qi\n(module web-api)\n\n;; User side\n(use http)              ;; Searches for http.qi \u2192 Success\n(web-api/get \"...\")     ;; OK (access by module name)\n(http/get \"...\")        ;; Error (cannot access by file name)\n</code></pre>"},{"location":"spec/09-modules/#export-declaration","title":"export Declaration","text":"<p><code>export</code> controls which symbols to publish (optional).</p>"},{"location":"spec/09-modules/#mode-a-no-export-declaration-everything-public-default","title":"Mode A: No export declaration \u2192 Everything public (default)","text":"<pre><code>;; utils.qi\n(defn add [a b] (+ a b))        ;; Public (defn)\n(defn multiply [a b] (* a b))   ;; Public (defn)\n(defn- helper [x] (* x 2))      ;; Private (defn-)\n\n;; All defn are automatically public\n</code></pre>"},{"location":"spec/09-modules/#mode-b-with-export-declaration-selective-public","title":"Mode B: With export declaration \u2192 Selective public","text":"<pre><code>;; utils.qi\n(defn add [a b] (+ a b))        ;; Private (not in export)\n(defn multiply [a b] (* a b))   ;; Public (in export)\n(defn- helper [x] (* x 2))      ;; Private (always)\n\n(export multiply)  ;; Only multiply is public\n</code></pre>"},{"location":"spec/09-modules/#specification_1","title":"Specification","text":"<ul> <li>Default public: No <code>export</code> \u2192 all <code>defn</code> public, all <code>defn-</code> private</li> <li>Selective public: With <code>export</code> \u2192 only explicitly listed are public, others private</li> <li>defn- is always private: Error if written in <code>export</code></li> <li>Multiple declarations allowed: Cumulative</li> <li>Position: Anywhere OK (recommended at end)</li> <li>Return value: <code>nil</code></li> </ul>"},{"location":"spec/09-modules/#multiple-export-declarations","title":"Multiple export Declarations","text":"<pre><code>(defn get [url] ...)\n(defn post [url data] ...)\n(defn put [url data] ...)\n\n(export get)        ;; Only get public\n(export post put)   ;; Add post, put (cumulative)\n;; Result: get, post, put all public\n</code></pre>"},{"location":"spec/09-modules/#module-definition-examples","title":"Module Definition Examples","text":""},{"location":"spec/09-modules/#pattern-1-simple-no-export","title":"Pattern 1: Simple (no export)","text":"<pre><code>;; math.qi\n(defn add [a b] (+ a b))        ;; Public\n(defn sub [a b] (- a b))        ;; Public\n(defn- validate [x] (&gt; x 0))    ;; Private\n\n;; From outside: (math/add ...), (math/sub ...) OK\n;;               (math/validate ...) Error\n</code></pre>"},{"location":"spec/09-modules/#pattern-2-explicit-export","title":"Pattern 2: Explicit export","text":"<pre><code>;; math.qi\n(defn add [a b] (+ a b))        ;; Public (in export)\n(defn sub [a b] (- a b))        ;; Private (not in export)\n(defn multiply [a b] (* a b))   ;; Private (not in export)\n(defn- validate [x] (&gt; x 0))    ;; Private (always)\n\n(export add)  ;; Only add public\n\n;; From outside: (math/add ...) OK\n;;               (math/sub ...), (math/multiply ...) Error\n</code></pre>"},{"location":"spec/09-modules/#pattern-3-module-declaration-export","title":"Pattern 3: module declaration + export","text":"<pre><code>;; http.qi\n(module web-client)  ;; Change display name\n\n(defn- build-url [base path] (str base \"/\" path))\n(defn get [url] ...)\n(defn post [url data] ...)\n(defn internal-func [x] ...)  ;; Private (not exported)\n\n(export get post)\n\n;; From outside:\n;; (use http)  ;; Searches for http.qi\n;; (web-client/get ...) OK (access by module name)\n;; (web-client/post ...) OK\n;; (web-client/internal-func ...) Error (private)\n</code></pre>"},{"location":"spec/09-modules/#import-use","title":"Import (use)","text":"<p><code>use</code> performs file loading + symbol import.</p>"},{"location":"spec/09-modules/#pattern-1-import-specific-functions-only-recommended","title":"Pattern 1: Import specific functions only (recommended)","text":"<pre><code>(use http :only [get post])\n(get \"https://...\")                      ;; OK\n</code></pre>"},{"location":"spec/09-modules/#pattern-2-alias-modulefunction-format","title":"Pattern 2: Alias (module/function format)","text":"<pre><code>(use http :as h)\n(h/get \"https://...\")                    ;; OK\n</code></pre>"},{"location":"spec/09-modules/#pattern-3-import-all","title":"Pattern 3: Import all","text":"<pre><code>(use http :all)\n(get \"https://...\")                      ;; OK\n(post \"https://...\" {:data 123})         ;; OK\n</code></pre>"},{"location":"spec/09-modules/#pattern-4-path-specification","title":"Pattern 4: Path specification","text":"<pre><code>(use \"lib/utils\" :only [format-date])    ;; Load lib/utils.qi\n(use \"./vendor/json\" :as json)           ;; Relative path\n</code></pre>"},{"location":"spec/09-modules/#module-name-resolution-rules","title":"Module Name Resolution Rules","text":"<p>Principle: Search by file name, access by module name:</p>"},{"location":"spec/09-modules/#case-1-module-name-only-auto-search","title":"Case 1: Module name only \u2192 Auto-search","text":"<pre><code>(use http :only [get])\n;; 1. Search for http.qi (./http.qi, ~/.qi/modules/http.qi, etc.)\n;; 2. Check module declaration in http.qi\n;;    - (module web-api) \u2192 Access as web-api/get\n;;    - None \u2192 Access as http/get\n</code></pre>"},{"location":"spec/09-modules/#case-2-path-specification-search-by-basename","title":"Case 2: Path specification \u2192 Search by basename","text":"<pre><code>(use \"lib/http\" :only [get])\n;; 1. Load lib/http.qi\n;; 2. Check module declaration in lib/http.qi\n;;    - (module web-api) \u2192 Access as web-api/get\n;;    - None \u2192 Access as http/get (basename)\n</code></pre>"},{"location":"spec/09-modules/#case-3-alias-with-as","title":"Case 3: Alias with :as","text":"<pre><code>(use \"lib/http\" :as h)\n;; 1. Load lib/http.qi\n;; 2. Use alias 'h' regardless of module declaration\n;; =&gt; Access as h/get\n</code></pre>"},{"location":"spec/09-modules/#case-4-combination-with-module-declaration","title":"Case 4: Combination with module declaration","text":"<pre><code>;; lib/http.qi\n(module web-client)\n(defn get [url] ...)\n\n;; User side\n(use \"lib/http\")\n(web-client/get \"...\")  ;; OK (access by module name)\n\n(use \"lib/http\" :as h)\n(h/get \"...\")           ;; OK (alias takes priority)\n</code></pre>"},{"location":"spec/09-modules/#name-collision-handling","title":"Name Collision Handling","text":"<pre><code>;; lib1/utils.qi \u2192 (module string-utils)\n;; lib2/utils.qi \u2192 (module string-utils)  \u2190 Same module name!\n\n(use \"lib1/utils\")  ;; Module name: string-utils\n(use \"lib2/utils\")  ;; Error: module 'string-utils' already loaded\n\n;; Solution 1: Alias with :as\n(use \"lib1/utils\" :as utils1)\n(use \"lib2/utils\" :as utils2)\n\n;; Solution 2: Change module declaration in file\n;; Change lib2/utils.qi to (module text-utils)\n</code></pre>"},{"location":"spec/09-modules/#load-side-effects-only","title":"load (Side Effects Only)","text":"<p><code>load</code> only evaluates a file without importing symbols. Used for executing configuration files or initialization scripts.</p> <pre><code>;; Load configuration file (side effects only)\n(load \"config.qi\")\n\n;; Difference from use\n(use http)    ;; Load http.qi + import symbols\n(load \"init\") ;; Only evaluate init.qi (no symbol import)\n</code></pre>"},{"location":"spec/09-modules/#publicprivate-decision-flow","title":"Public/Private Decision Flow","text":"<pre><code>Function definition public/private:\n\nDefined with defn-\n  \u2192 Always private (cannot export)\n\nDefined with defn\n  \u2192 Does export declaration exist?\n      YES \u2192 Is it in export list?\n              YES \u2192 Public\n              NO  \u2192 Private\n      NO  \u2192 Public (default)\n</code></pre>"},{"location":"spec/09-modules/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/09-modules/#creating-a-library","title":"Creating a Library","text":"<pre><code>;; lib/string-utils.qi\n(module string-utils)\n\n;; Public functions\n(defn upper [s]\n  (str/upper s))\n\n(defn lower [s]\n  (str/lower s))\n\n;; Internal function (private)\n(defn- validate [s]\n  (and (string? s) (&gt; (len s) 0)))\n\n;; Explicit export\n(export upper lower)\n</code></pre>"},{"location":"spec/09-modules/#using-a-library","title":"Using a Library","text":"<pre><code>;; main.qi\n(use \"lib/string-utils\" :only [upper lower])\n\n(upper \"hello\")  ;; =&gt; \"HELLO\"\n(lower \"WORLD\")  ;; =&gt; \"world\"\n\n;; Or\n(use \"lib/string-utils\" :as str-util)\n(str-util/upper \"hello\")  ;; =&gt; \"HELLO\"\n</code></pre>"},{"location":"spec/09-modules/#loading-configuration-files","title":"Loading Configuration Files","text":"<pre><code>;; config.qi\n(def api-key \"secret-key\")\n(def db-host \"localhost\")\n\n;; main.qi\n(load \"config\")  ;; Side effects only (symbols not imported)\n\n;; api-key and db-host are defined globally\n(println api-key)  ;; =&gt; \"secret-key\"\n</code></pre>"},{"location":"spec/09-modules/#initialization-file-qiinitqi","title":"Initialization File (.qi/init.qi)","text":"<p>Auto-load for REPL and One-liner Execution</p> <p>Qi automatically loads initialization files when running in REPL or one-liner (<code>-e</code> option) mode.</p>"},{"location":"spec/09-modules/#loading-order","title":"Loading Order","text":"<pre><code>1. ~/.qi/init.qi  (User global settings - priority)\n2. ./.qi/init.qi  (Project local settings)\n</code></pre> <ul> <li>If both files exist, both are loaded</li> <li>Files are skipped if they don't exist</li> <li>If an error occurs, a warning is displayed but execution continues</li> </ul>"},{"location":"spec/09-modules/#target-execution-modes","title":"Target Execution Modes","text":"<ul> <li>\u2705 REPL mode (<code>qi</code>)</li> <li>\u2705 One-liner mode (<code>qi -e '...'</code>)</li> <li>\u274c Script file execution (<code>qi script.qi</code>) - Not applicable</li> </ul>"},{"location":"spec/09-modules/#user-global-settings-qiinitqi","title":"User Global Settings (~/.qi/init.qi)","text":"<p>Write settings you want to use across all Qi projects:</p> <pre><code>;; ~/.qi/init.qi - User global settings\n\n;; Preload commonly used libraries\n(use \"table\" :as table)\n(use \"string\" :as str)\n\n;; Debug helper function\n(defn dbg [x]\n  (do (println (str \"DEBUG: \" x))\n      x))\n\n;; Display list length and return\n(defn show-len [lst]\n  (do (println (str \"length: \" (len lst)))\n      lst))\n</code></pre>"},{"location":"spec/09-modules/#project-local-settings-qiinitqi","title":"Project Local Settings (./.qi/init.qi)","text":"<p>Write project-specific settings:</p> <pre><code>;; ./.qi/init.qi - Project local settings\n\n;; Load project-specific library\n(use \"lib/utils\" :as utils)\n\n;; Project-specific constants\n(def db-host \"localhost\")\n(def db-port 5432)\n\n;; Development helper\n(defn reload-config []\n  (load \".env\"))\n</code></pre>"},{"location":"spec/09-modules/#one-liner-usage-example","title":"One-liner Usage Example","text":"<p>When libraries are preloaded in initialization files, you can use them in one-liners without <code>use</code>:</p> <pre><code># Write (use \"table\" :as table) in ~/.qi/init.qi\n\n# Process CSV from pipe (table library already available)\ncat data.csv | qi -e '(stdin |&gt; split \"\\n\" |&gt; table/parse-csv |&gt; (table/where (fn [row] (&gt; (get row :age) 30))))'\n</code></pre>"},{"location":"spec/09-modules/#notes","title":"Notes","text":"<ul> <li>Initialization files are REPL/one-liner only</li> <li>Not loaded when executing script files (use explicit <code>load</code>)</li> <li>Project local settings load after user global settings</li> <li>For same-name definitions, later loaded ones take priority</li> </ul>"},{"location":"spec/10-stdlib-string/","title":"Standard Library - String Manipulation (str/)","text":"<p>60+ String Manipulation Functions</p> <p>All functions belong to the <code>str/</code> module.</p>"},{"location":"spec/10-stdlib-string/#search","title":"Search","text":"<pre><code>;; str/contains? - Check if contains substring\n(str/contains? \"hello world\" \"world\")     ;; =&gt; true\n\n;; str/starts-with? - Check if starts with prefix\n(str/starts-with? \"hello\" \"he\")           ;; =&gt; true\n\n;; str/ends-with? - Check if ends with suffix\n(str/ends-with? \"hello\" \"lo\")             ;; =&gt; true\n\n;; str/index-of - Find first occurrence (nil if not found)\n(str/index-of \"hello world\" \"world\")      ;; =&gt; 6\n(str/index-of \"hello\" \"xyz\")              ;; =&gt; nil\n\n;; str/last-index-of - Find last occurrence (nil if not found)\n(str/last-index-of \"hello hello\" \"hello\") ;; =&gt; 6\n(str/last-index-of \"hello\" \"xyz\")         ;; =&gt; nil\n</code></pre>"},{"location":"spec/10-stdlib-string/#basic-transformations","title":"Basic Transformations","text":"<pre><code>;; str/upper - Convert to uppercase\n(str/upper \"hello\")                       ;; =&gt; \"HELLO\"\n\n;; str/lower - Convert to lowercase\n(str/lower \"HELLO\")                       ;; =&gt; \"hello\"\n\n;; str/capitalize - Capitalize first letter only\n(str/capitalize \"hello\")                  ;; =&gt; \"Hello\"\n\n;; str/title - Title case\n(str/title \"hello world\")                 ;; =&gt; \"Hello World\"\n\n;; str/trim - Remove leading/trailing whitespace\n(str/trim \"  hello  \")                    ;; =&gt; \"hello\"\n\n;; str/trim-left - Remove left whitespace\n(str/trim-left \"  hello  \")               ;; =&gt; \"hello  \"\n\n;; str/trim-right - Remove right whitespace\n(str/trim-right \"  hello  \")              ;; =&gt; \"  hello\"\n\n;; str/repeat - Repeat string\n(str/repeat \"-\" 80)                       ;; =&gt; \"----...\" (80 chars)\n(str/repeat \"ab\" 3)                       ;; =&gt; \"ababab\"\n\n;; str/reverse - Reverse string\n(str/reverse \"hello\")                     ;; =&gt; \"olleh\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#case-conversion","title":"Case Conversion","text":"<pre><code>;; str/snake - Convert to snake_case\n(str/snake \"userName\")                    ;; =&gt; \"user_name\"\n\n;; str/camel - Convert to camelCase\n(str/camel \"user_name\")                   ;; =&gt; \"userName\"\n\n;; str/kebab - Convert to kebab-case\n(str/kebab \"userName\")                    ;; =&gt; \"user-name\"\n\n;; str/pascal - Convert to PascalCase\n(str/pascal \"user_name\")                  ;; =&gt; \"UserName\"\n\n;; str/split-camel - Split camelCase\n(str/split-camel \"userName\")              ;; =&gt; [\"user\" \"Name\"]\n</code></pre>"},{"location":"spec/10-stdlib-string/#splitjoin","title":"Split/Join","text":"<pre><code>;; str/split - Split string\n(str/split \"a,b,c\" \",\")                   ;; =&gt; [\"a\" \"b\" \"c\"]\n\n;; str/lines - Split into lines\n(str/lines \"hello\\nworld\")                ;; =&gt; [\"hello\" \"world\"]\n\n;; str/words - Split into words\n(str/words \"hello world\")                 ;; =&gt; [\"hello\" \"world\"]\n\n;; str/chars - Split into characters\n(str/chars \"hello\")                       ;; =&gt; [\"h\" \"e\" \"l\" \"l\" \"o\"]\n</code></pre>"},{"location":"spec/10-stdlib-string/#replacement","title":"Replacement","text":"<pre><code>;; str/replace - Replace all occurrences\n(str/replace \"hello world\" \"world\" \"qi\")  ;; =&gt; \"hello qi\"\n\n;; str/replace-first - Replace first occurrence only\n(str/replace-first \"aa bb aa\" \"aa\" \"cc\")  ;; =&gt; \"cc bb aa\"\n\n;; str/splice - Replace range\n(str/splice \"hello world\" 6 11 \"universe\") ;; =&gt; \"hello universe\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#substring","title":"Substring","text":"<pre><code>;; str/slice - Get range\n(str/slice \"hello world\" 0 5)             ;; =&gt; \"hello\"\n\n;; str/take-str - Take first n characters (pipeline optimized)\n(str/take-str 3 \"hello\")                  ;; =&gt; \"hel\"\n(\"hello\" |&gt; (str/take-str 3))             ;; =&gt; \"hel\"\n\n;; str/drop-str - Drop first n characters (pipeline optimized)\n(str/drop-str 2 \"hello\")                  ;; =&gt; \"llo\"\n(\"hello\" |&gt; (str/drop-str 2))             ;; =&gt; \"llo\"\n\n;; str/sub-before - Get substring before delimiter\n(str/sub-before \"user@example.com\" \"@\")   ;; =&gt; \"user\"\n\n;; str/sub-after - Get substring after delimiter\n(str/sub-after \"user@example.com\" \"@\")    ;; =&gt; \"example.com\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#formattingalignment","title":"Formatting/Alignment","text":"<pre><code>;; str/pad-left - Left pad\n(str/pad-left \"Total\" 20)                 ;; =&gt; \"               Total\"\n\n;; str/pad-right - Right pad\n(str/pad-right \"Name\" 20)                 ;; =&gt; \"Name               \"\n\n;; str/pad - Center align\n(str/pad \"hi\" 10)                         ;; =&gt; \"    hi    \"\n(str/pad \"hi\" 10 \"*\")                     ;; =&gt; \"****hi****\"\n\n;; str/truncate - Truncate to length\n(str/truncate \"hello world\" 8)            ;; =&gt; \"hello...\"\n\n;; str/trunc-words - Truncate to word count\n(str/trunc-words \"hello world from qi\" 2) ;; =&gt; \"hello world...\"\n\n;; str/indent - Add indentation\n(str/indent \"hello\\nworld\" 2)             ;; =&gt; \"  hello\\n  world\"\n\n;; str/wrap - Wrap text at width\n(str/wrap \"hello world from qi\" 10)       ;; =&gt; \"hello\\nworld from\\nqi\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#normalization","title":"Normalization","text":"<pre><code>;; str/squish - Collapse consecutive whitespace to one (trim included)\n(str/squish \"  hello   world  \\n\")        ;; =&gt; \"hello world\"\n\n;; str/expand-tabs - Convert tabs to spaces\n(str/expand-tabs \"\\thello\\tworld\")        ;; =&gt; \"    hello    world\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#validation-predicates","title":"Validation (Predicates)","text":"<pre><code>;; str/digit? - Check if all digits\n(str/digit? \"12345\")                      ;; =&gt; true\n\n;; str/alpha? - Check if all alphabetic\n(str/alpha? \"hello\")                      ;; =&gt; true\n\n;; str/alnum? - Check if all alphanumeric\n(str/alnum? \"hello123\")                   ;; =&gt; true\n\n;; str/space? - Check if all whitespace\n(str/space? \"  \\n\\t\")                     ;; =&gt; true\n\n;; str/numeric? - Check if numeric representation\n(str/numeric? \"123.45\")                   ;; =&gt; true\n\n;; str/integer? - Check if integer representation\n(str/integer? \"123\")                      ;; =&gt; true\n\n;; str/blank? - Check if blank or empty\n(str/blank? \"  \\n\")                       ;; =&gt; true\n\n;; str/ascii? - Check if all ASCII\n(str/ascii? \"hello\")                      ;; =&gt; true\n\n;; str/lower? - Check if all lowercase\n(str/lower? \"hello\")                      ;; =&gt; true\n\n;; str/upper? - Check if all uppercase\n(str/upper? \"HELLO\")                      ;; =&gt; true\n</code></pre>"},{"location":"spec/10-stdlib-string/#urlweb","title":"URL/Web","text":"<pre><code>;; str/slugify - Convert to URL/filename format\n(str/slugify \"Hello World! 2024\")         ;; =&gt; \"hello-world-2024\"\n(str/slugify \"Caf\u00e9 r\u00e9sum\u00e9\")               ;; =&gt; \"cafe-resume\"\n\n;; str/url-encode - URL encode\n(str/url-encode \"hello world\")            ;; =&gt; \"hello%20world\"\n\n;; str/url-decode - URL decode\n(str/url-decode \"hello%20world\")          ;; =&gt; \"hello world\"\n\n;; str/html-encode - HTML encode\n(str/html-encode \"&lt;div&gt;test&lt;/div&gt;\")       ;; =&gt; \"&amp;lt;div&amp;gt;test&amp;lt;/div&amp;gt;\"\n\n;; str/html-decode - HTML decode\n(str/html-decode \"&amp;lt;div&amp;gt;test&amp;lt;/div&amp;gt;\") ;; =&gt; \"&lt;div&gt;test&lt;/div&gt;\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#encoding","title":"Encoding","text":"<pre><code>;; str/to-base64 - Base64 encode\n(str/to-base64 \"hello\")                   ;; =&gt; \"aGVsbG8=\"\n\n;; str/from-base64 - Base64 decode\n(str/from-base64 \"aGVsbG8=\")              ;; =&gt; \"hello\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#parsing","title":"Parsing","text":"<pre><code>;; str/parse-int - Parse to integer\n(str/parse-int \"123\")                     ;; =&gt; 123\n\n;; str/parse-float - Parse to float\n(str/parse-float \"3.14\")                  ;; =&gt; 3.14\n</code></pre>"},{"location":"spec/10-stdlib-string/#unicode","title":"Unicode","text":"<pre><code>;; str/chars-count - Unicode character count\n(str/chars-count \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\")                ;; =&gt; 1\n\n;; str/bytes-count - Byte count\n(str/bytes-count \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\")                ;; =&gt; 25\n</code></pre>"},{"location":"spec/10-stdlib-string/#generation","title":"Generation","text":"<pre><code>;; str/hash - Generate hash value\n(str/hash \"hello\")                        ;; =&gt; \"2cf24dba5fb0a30e...\"\n(str/hash \"hello\" :sha256)                ;; SHA-256 (default)\n\n;; str/uuid - Generate UUID\n(str/uuid)                                ;; =&gt; \"550e8400-e29b-41d4-a716-446655440000\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#nlp","title":"NLP","text":"<pre><code>;; str/word-count - Count words\n(str/word-count \"hello world\")            ;; =&gt; 2\n</code></pre>"},{"location":"spec/10-stdlib-string/#formatting","title":"Formatting","text":"<pre><code>;; str/format - Placeholder replacement\n(str/format \"Hello, {}!\" \"World\")         ;; =&gt; \"Hello, World!\"\n(str/format \"{} + {} = {}\" 1 2 3)         ;; =&gt; \"1 + 2 = 3\"\n\n;; str/format-decimal - Format decimal places\n(str/format-decimal 3.14159 2)            ;; =&gt; \"3.14\"\n(3.14159 |&gt; (str/format-decimal _ 2))     ;; Use in pipeline\n\n;; str/format-comma - Format with comma separators\n(str/format-comma 1234567)                ;; =&gt; \"1,234,567\"\n(1234567 |&gt; str/format-comma)             ;; Use in pipeline\n\n;; str/format-percent - Format as percentage\n(str/format-percent 0.1234)               ;; =&gt; \"12%\"\n(str/format-percent 0.1234 2)             ;; =&gt; \"12.34%\"\n(0.856 |&gt; (str/format-percent _ 1))       ;; =&gt; \"85.6%\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/10-stdlib-string/#url-processing","title":"URL Processing","text":"<pre><code>;; Generate URL parameters\n(def params {:user \"alice\" :page 1 :sort \"name\"})\n\n(params\n |&gt; keys\n |&gt; (map (fn [k] (str (name k) \"=\" (str/url-encode (get params k)))))\n |&gt; (join \"&amp;\"))\n;; =&gt; \"user=alice&amp;page=1&amp;sort=name\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#text-formatting","title":"Text Formatting","text":"<pre><code>;; Markdown code formatting\n(defn format-code [code lang]\n  f\"```{lang}\\n{(str/trim code)}\\n```\")\n\n(format-code \"  def x = 42  \" \"qi\")\n;; =&gt; \"```qi\\ndef x = 42\\n```\"\n</code></pre>"},{"location":"spec/10-stdlib-string/#validation","title":"Validation","text":"<pre><code>;; Simple email validation\n(defn valid-email? [email]\n  (and\n    (str/contains? email \"@\")\n    (str/contains? (str/sub-after email \"@\") \".\")\n    (not (str/blank? (str/sub-before email \"@\")))))\n\n(valid-email? \"user@example.com\")  ;; =&gt; true\n(valid-email? \"invalid\")           ;; =&gt; false\n</code></pre>"},{"location":"spec/10-stdlib-string/#data-transformation-pipeline","title":"Data Transformation Pipeline","text":"<pre><code>;; Normalize CSV headers\n(def headers [\"User Name\" \"E-Mail\" \"Created At\"])\n\n(headers\n |&gt; (map str/lower)\n |&gt; (map str/squish)\n |&gt; (map (partial str/replace _ \" \" \"_\")))\n;; =&gt; [\"user_name\" \"e-mail\" \"created_at\"]\n</code></pre>"},{"location":"spec/11-stdlib-http/","title":"Standard Library - HTTP","text":"<p>HTTP Client and Server</p>"},{"location":"spec/11-stdlib-http/#http-client-http","title":"HTTP Client (http/)","text":"<p>Qi provides two types of HTTP client functions:</p> <ul> <li>Simple version (<code>http/get</code>, <code>http/post</code>, etc.): Returns response body only. Throws exception for non-2xx status codes</li> <li>Detailed version (<code>http/get!</code>, <code>http/post!</code>, etc.): Returns detailed information including status code, headers, and body. Returns Map for all status codes (does not throw)</li> </ul>"},{"location":"spec/11-stdlib-http/#simple-version-response-body-only","title":"Simple Version - Response Body Only","text":"<p>In many cases, only the response body is needed. The simple version returns a string.</p> <p>Error Handling: Non-2xx status codes (404, 500, etc.) throw exceptions.</p> <pre><code>;; http/get - HTTP GET request (body only)\n(http/get \"https://httpbin.org/get\")\n;; =&gt; \"{\\\"args\\\": {}, \\\"headers\\\": {...}}\"\n\n;; http/post - HTTP POST request\n(http/post \"https://api.example.com/users\" {\"name\" \"Alice\" \"email\" \"alice@example.com\"})\n;; =&gt; \"{\\\"id\\\": 123, \\\"name\\\": \\\"Alice\\\"}\"\n\n;; http/put - HTTP PUT request\n(http/put \"https://api.example.com/users/1\" {\"name\" \"Alice Updated\"})\n\n;; http/delete - HTTP DELETE request\n(http/delete \"https://api.example.com/users/1\")\n\n;; http/patch - HTTP PATCH request\n(http/patch \"https://api.example.com/users/1\" {\"email\" \"newemail@example.com\"})\n\n;; http/head - HTTP HEAD request\n(http/head \"https://api.example.com/status\")\n\n;; http/options - HTTP OPTIONS request\n(http/options \"https://api.example.com\")\n\n;; Simple usage - directly parse body as JSON\n(def users (http/get \"https://api.example.com/users\" |&gt; json/parse))\n\n;; Error handling - 404 and 500 throw exceptions\n(match (try (http/get \"https://api.example.com/notfound\"))\n  {:error e} -&gt; (println \"Error:\" e)  ;; =&gt; \"Error: HTTP error 404\"\n  body -&gt; (json/parse body))\n</code></pre>"},{"location":"spec/11-stdlib-http/#detailed-version-with-status-code-and-headers","title":"Detailed Version - With Status Code and Headers","text":"<p>When status codes or headers are needed, use the detailed version with an exclamation mark (<code>!</code>).</p> <p>Error Handling: Returns Map for all status codes (2xx, 4xx, 5xx). Does not throw exceptions.</p> <pre><code>;; http/get! - HTTP GET request (detailed info)\n(http/get! \"https://httpbin.org/get\")\n;; =&gt; {:status 200 :headers {\"content-type\" \"application/json\" ...} :body \"...\"}\n\n;; http/post! - HTTP POST request (detailed info)\n(http/post! \"https://api.example.com/users\" {\"name\" \"Alice\"})\n;; =&gt; {:status 201 :headers {...} :body \"...\"}\n\n;; http/put! - HTTP PUT request (detailed info)\n(http/put! \"https://api.example.com/users/1\" {\"name\" \"Alice Updated\"})\n\n;; http/delete! - HTTP DELETE request (detailed info)\n(http/delete! \"https://api.example.com/users/1\")\n\n;; http/patch! - HTTP PATCH request (detailed info)\n(http/patch! \"https://api.example.com/users/1\" {\"email\" \"newemail@example.com\"})\n\n;; http/head! - HTTP HEAD request (detailed info)\n(http/head! \"https://api.example.com/status\")\n\n;; http/options! - HTTP OPTIONS request (detailed info)\n(http/options! \"https://api.example.com\")\n\n;; Check status code\n(let [res (http/get! \"https://api.example.com/users\")]\n  (if (= 200 (:status res))\n    (json/parse (:body res))\n    (error (str \"HTTP error: \" (:status res)))))\n\n;; 404 errors also return Map (no exception)\n(let [res (http/get! \"https://api.example.com/notfound\")]\n  (println \"Status:\" (:status res))  ;; =&gt; \"Status: 404\"\n  (println \"Body:\" (:body res)))     ;; Can retrieve error message\n\n;; Get headers\n(let [res (http/get! \"https://api.example.com/data\")]\n  (get-in res [:headers \"content-type\"]))\n</code></pre>"},{"location":"spec/11-stdlib-http/#optional-parameters","title":"Optional Parameters","text":"<p>Both simple and detailed versions support optional parameters:</p> <ul> <li><code>:headers</code> - Custom HTTP headers (Map)</li> <li><code>:timeout</code> - Timeout in milliseconds (Integer)</li> <li><code>:basic-auth</code> - Basic authentication (Vector in <code>[username password]</code> format)</li> <li><code>:bearer-token</code> - Bearer Token authentication (String)</li> </ul> <pre><code>;; Add custom headers to GET request\n(http/get \"https://api.example.com/data\"\n  {:headers {\"X-API-Key\" \"your-api-key\"}})\n\n;; POST request with authentication and timeout\n(http/post \"https://api.example.com/users\"\n  {\"name\" \"Alice\"}\n  {:bearer-token \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n   :timeout 10000})\n\n;; Use Basic authentication\n(http/get! \"https://api.example.com/protected\"\n  {:basic-auth [\"username\" \"password\"]})\n\n;; Combine multiple options\n(http/post! \"https://api.example.com/data\"\n  {\"key\" \"value\"}\n  {:headers {\"X-Request-ID\" \"12345\"}\n   :timeout 5000})\n</code></pre>"},{"location":"spec/11-stdlib-http/#advanced-settings","title":"Advanced Settings","text":"<pre><code>;; http/request - Custom request\n(http/request {\n  :method \"POST\"\n  :url \"https://api.example.com/data\"\n  :headers {\"Authorization\" \"Bearer token123\"}\n  :body {\"data\" \"value\"}\n  :timeout 5000\n})\n</code></pre>"},{"location":"spec/11-stdlib-http/#authentication","title":"Authentication","text":"<pre><code>;; Basic authentication\n(http/request {\n  :url \"https://api.example.com/data\"\n  :basic-auth [\"username\" \"password\"]\n})\n\n;; Bearer Token authentication\n(http/request {\n  :url \"https://api.example.com/data\"\n  :bearer-token \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n})\n</code></pre>"},{"location":"spec/11-stdlib-http/#content-compression","title":"Content Compression","text":"<pre><code>;; Automatic decompression (enabled by default)\n(http/get \"https://example.com/api\")  ;; Auto-decompress gzip/deflate/brotli\n\n;; Compression on send\n(http/post \"https://example.com/api\"\n  {\"data\" \"large payload\"}\n  {:headers {\"content-encoding\" \"gzip\"}})  ;; Auto-compress body with gzip\n</code></pre>"},{"location":"spec/11-stdlib-http/#integration-with-railway-pipeline","title":"Integration with Railway Pipeline","text":"<pre><code>;; Simple version pipeline - body returned directly\n(\"https://api.github.com/users/octocat\"\n |&gt; http/get\n |&gt; json/parse\n |&gt; (fn [data] (get data \"name\")))\n;; =&gt; \"The Octocat\"\n\n;; Detailed version pipeline - check status code\n(\"https://api.github.com/users/octocat\"\n |&gt; http/get!\n |&gt; (fn [resp]\n      (if (= 200 (:status resp))\n        (:body resp)\n        (error (str \"HTTP \" (:status resp)))))\n |&gt; json/parse\n |&gt; (fn [data] (get data \"name\")))\n;; =&gt; \"The Octocat\"\n\n;; Error handling (catch exceptions with try)\n(match (try\n         (\"https://api.github.com/users/octocat\"\n          |&gt; http/get\n          |&gt; json/parse\n          |&gt; (fn [data] (get data \"name\"))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  name -&gt; name)\n;; =&gt; \"The Octocat\" (on success) or {:error ...} (on failure)\n\n;; Error handling with Railway operator\n(\"https://api.github.com/users/octocat\"\n |&gt; (try (http/get _))\n |&gt;? json/parse\n |&gt;? (fn [data] (get data \"name\")))\n;; =&gt; \"The Octocat\" (on success) or {:error ...} (on failure)\n</code></pre>"},{"location":"spec/11-stdlib-http/#http-server-server","title":"HTTP Server (server/)","text":"<p>Flow-Oriented Web Application Development</p>"},{"location":"spec/11-stdlib-http/#response-helpers","title":"Response Helpers","text":"<pre><code>;; server/ok - 200 OK response\n(server/ok \"Hello, World!\")\n;; =&gt; {:status 200 :headers {...} :body \"Hello, World!\"}\n\n;; server/json - JSON response\n(server/json {\"message\" \"hello\" \"status\" \"success\"})\n;; =&gt; {:status 200 :headers {\"Content-Type\" \"application/json\"} :body \"{...}\"}\n\n;; server/not-found - 404 Not Found response\n(server/not-found \"Page not found\")\n\n;; server/no-content - 204 No Content response\n(server/no-content)\n</code></pre>"},{"location":"spec/11-stdlib-http/#routing","title":"Routing","text":"<pre><code>;; server/router - Create router\n(server/router [[\"/\" {:get hello-handler}]\n                [\"/api/users\" {:get list-users :post create-user}]\n                [\"/api/users/:id\" {:get get-user}]])\n\n;; server/serve - Start server (wrapped in comment to prevent actual server startup)\n(comment\n  (server/serve app {:port 3000})\n  ;; =&gt; HTTP server started on http://127.0.0.1:3000\n\n  ;; server/serve - Detailed settings\n  (server/serve app {:port 8080 :host \"0.0.0.0\" :timeout 30})\n  ;; =&gt; HTTP server started on http://0.0.0.0:8080 (timeout: 30s)\n  )\n</code></pre>"},{"location":"spec/11-stdlib-http/#middleware","title":"Middleware","text":"<pre><code>;; server/with-logging - Log requests/responses\n(def handler (server/with-logging (fn [req] (server/ok \"Hello\"))))\n\n;; server/with-cors - Add CORS headers\n(def handler (server/with-cors (fn [req] (server/json {...}))))\n\n;; server/with-json-body - Auto-parse JSON body\n(def handler (server/with-json-body (fn [req] (get req :json))))\n\n;; server/with-compression - Compress response body with gzip\n(def handler (server/with-compression (fn [req] (server/ok \"...\"))))\n\n;; server/with-basic-auth - Basic authentication\n(def handler (server/with-basic-auth (fn [req] ...) \"user\" \"pass\"))\n\n;; server/with-bearer - Extract Bearer Token\n(def handler (server/with-bearer (fn [req] (get req :token))))\n\n;; server/with-no-cache - Add no-cache headers\n(def handler (server/with-no-cache (fn [req] (server/ok \"...\"))))\n\n;; server/with-cache-control - Add custom Cache-Control headers\n(def handler (server/with-cache-control (fn [req] ...) \"public, max-age=3600\"))\n</code></pre>"},{"location":"spec/11-stdlib-http/#static-file-serving","title":"Static File Serving","text":"<pre><code>;; server/static-file - Serve single file\n(server/static-file \"index.html\")\n\n;; server/static-dir - Serve directory\n(server/static-dir \"public\")\n</code></pre>"},{"location":"spec/11-stdlib-http/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/11-stdlib-http/#simple-server","title":"Simple Server","text":"<pre><code>;; Handler (request -&gt; response)\n(def hello-handler\n  (fn [req] (server/ok \"Hello, World!\")))\n\n;; Route definition (data-driven)\n(def routes [[\"/\" {:get hello-handler}]])\n\n;; Start app (wrapped in comment)\n(def app (server/router routes))\n(comment\n  (server/serve app {:port 3000}))\n</code></pre>"},{"location":"spec/11-stdlib-http/#json-api-with-path-parameters","title":"JSON API with Path Parameters","text":"<pre><code>;; Handler definitions\n(def list-users\n  (fn [req]\n    (server/json {\"users\" [{\"id\" 1 \"name\" \"Alice\"}\n                           {\"id\" 2 \"name\" \"Bob\"}]})))\n\n(def get-user\n  (fn [req]\n    (let [user-id (get-in req [:params \"id\"])]\n      (server/json {\"id\" user-id \"name\" \"Alice\"}))))\n\n(def create-user\n  (fn [req]\n    (server/json {\"status\" \"created\"} {:status 201})))\n\n;; Route definition (path parameters: /users/:id format)\n(def routes\n  [[\"/api/users\" {:get list-users :post create-user}]\n   [\"/api/users/:id\" {:get get-user}]\n   [\"/api/users/:user_id/posts/:post_id\" {:get get-post}]])\n\n;; Start app (wrapped in comment)\n(def app (server/router routes))\n(comment\n  (server/serve app {:port 8080 :host \"0.0.0.0\" :timeout 30}))\n</code></pre>"},{"location":"spec/11-stdlib-http/#middleware-composition","title":"Middleware Composition","text":"<pre><code>;; Stack multiple middleware\n(def api-handler\n  (-&gt; (fn [req]\n        (let [json-data (get req :json)]\n          (server/json {\"received\" json-data})))\n      server/with-json-body\n      server/with-cors\n      server/with-logging\n      server/with-compression))\n\n;; Or use comp for function composition\n(def protected-api\n  (comp\n    server/with-logging\n    server/with-cors\n    (fn [handler] (server/with-basic-auth handler \"admin\" \"secret\"))\n    server/with-json-body))\n\n(def routes\n  [[\"/api/data\" {:post (protected-api handle-data)}]])\n</code></pre>"},{"location":"spec/11-stdlib-http/#requestresponse-objects","title":"Request/Response Objects","text":"<pre><code>;; Request structure\n{:method :get                       ;; HTTP method (keyword)\n :path \"/api/users/123\"             ;; Request path\n :query \"page=1&amp;limit=10\"           ;; Query string (raw)\n :query-params {\"page\" \"1\"          ;; Query parameters (auto-parsed)\n                \"limit\" \"10\"}\n :headers {\"content-type\" \"application/json\" ...}\n :body \"...\"                        ;; Request body (string)\n :params {\"id\" \"123\"}}              ;; Path parameters (when matched)\n\n;; Response structure\n{:status 200                        ;; HTTP status code\n :headers {\"Content-Type\" \"text/plain; charset=utf-8\" ...}\n :body \"Hello, World!\"}             ;; Response body (string, JSON, HTML, etc.)\n\n;; Response structure (streaming)\n{:status 200\n :headers {\"Content-Type\" \"video/mp4\" ...}\n :body-file \"/path/to/large-file.mp4\"}  ;; File path (for large files)\n</code></pre>"},{"location":"spec/11-stdlib-http/#implemented-features","title":"Implemented Features","text":"<ul> <li>\u2705 Data-driven: Routing uses inspectable/transformable data structures</li> <li>\u2705 Pipeline: Handlers with clear flow using <code>|&gt;</code></li> <li>\u2705 Composable: Everything is a function, middleware are functions</li> <li>\u2705 Thread-safe: Supports concurrent request processing</li> <li>\u2705 Path parameters: Supports <code>/users/:id</code> format (multiple parameters)</li> <li>\u2705 Query parameters: Auto-parse <code>?page=1&amp;limit=10</code>, array support, URL decode</li> <li>\u2705 Timeout: Configurable request timeout (default 30s)</li> <li>\u2705 Middleware: Logging, CORS, JSON body parsing (multiple stackable)</li> <li>\u2705 Static file serving: Supports binary files (HTML, CSS, JS, images, fonts)</li> <li>\u2705 Streaming: Memory-efficient serving of large files (video, PDF, etc.) with <code>:body-file</code> key</li> <li>\u2705 Content compression: Supports gzip/deflate/brotli</li> <li>\u2705 Authentication: Basic Auth, Bearer Token extraction</li> <li>\u2705 Cache control: Cache-Control, graceful shutdown</li> </ul>"},{"location":"spec/12-stdlib-json/","title":"Standard Library - JSON/YAML","text":"<p>JSON and YAML Processing</p>"},{"location":"spec/12-stdlib-json/#json-processing-json","title":"JSON Processing (json/)","text":""},{"location":"spec/12-stdlib-json/#basic-operations","title":"Basic Operations","text":"<pre><code>;; json/parse - Parse JSON string\n(json/parse \"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\")\n;; =&gt; {\"name\" \"Alice\" \"age\" 30}\n\n;; json/stringify - Stringify value to JSON (compact)\n(json/stringify {\"name\" \"Bob\" \"age\" 25})\n;; =&gt; \"{\\\"name\\\":\\\"Bob\\\",\\\"age\\\":25}\"\n\n;; json/pretty - Stringify value to formatted JSON\n(json/pretty {\"name\" \"Bob\" \"age\" 25})\n;; =&gt; \"{\\n  \\\"name\\\": \\\"Bob\\\",\\n  \\\"age\\\": 25\\n}\"\n</code></pre>"},{"location":"spec/12-stdlib-json/#safe-parsing-with-result-type","title":"Safe Parsing with Result Type","text":"<p>All JSON functions return values as-is on success and return <code>{:error message}</code> on failure.</p> <pre><code>;; Successful parse\n(match (json/parse \"{\\\"valid\\\": true}\")\n  {:error e} -&gt; (log e)\n  data -&gt; data)\n;; =&gt; {\"valid\" true}\n\n;; Error handling\n(match (json/parse \"{invalid json}\")\n  {:error e} -&gt; (println \"Parse error:\" e)\n  data -&gt; data)\n;; =&gt; \"Parse error: ...\"\n</code></pre>"},{"location":"spec/12-stdlib-json/#pipeline-usage","title":"Pipeline Usage","text":"<pre><code>;; API response parse \u2192 transform \u2192 save (HTTP throws exceptions, so catch with try)\n(match (try\n         (\"https://api.example.com/users/123\"\n          |&gt; http/get\n          |&gt;? json/parse\n          |&gt;? (fn [data] (assoc data \"processed\" true))\n          |&gt;? json/pretty\n          |&gt;? (fn [json] (io/write-file \"output.json\" json))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  result -&gt; result)\n</code></pre>"},{"location":"spec/12-stdlib-json/#yaml-processing-yaml","title":"YAML Processing (yaml/)","text":"<p>Pure Rust Implementation - Using serde_yaml</p>"},{"location":"spec/12-stdlib-json/#basic-operations_1","title":"Basic Operations","text":"<pre><code>;; yaml/parse - Parse YAML string\n(yaml/parse \"name: Alice\\nage: 30\\ntags:\\n  - dev\\n  - ops\")\n;; =&gt; {\"name\" \"Alice\" \"age\" 30 \"tags\" [\"dev\" \"ops\"]}\n\n;; yaml/stringify - Stringify value to YAML\n(yaml/stringify {\"name\" \"Bob\" \"age\" 25 \"tags\" [\"backend\" \"devops\"]})\n;; =&gt; \"name: Bob\\nage: 25\\ntags:\\n- backend\\n- devops\\n\"\n\n;; yaml/pretty - Stringify value to formatted YAML (same as yaml/stringify)\n(yaml/pretty {\"server\" {\"host\" \"localhost\" \"port\" 8080}})\n;; =&gt; \"server:\\n  host: localhost\\n  port: 8080\\n\"\n</code></pre>"},{"location":"spec/12-stdlib-json/#configuration-file-processing","title":"Configuration File Processing","text":"<pre><code>;; Parse config file and get port (I/O throws exceptions, so catch with try)\n(match (try\n         (\"config.yaml\"\n          |&gt; io/read-file\n          |&gt;? yaml/parse\n          |&gt;? (fn [conf] (get-in conf [\"server\" \"port\"]))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  port -&gt; port)\n;; =&gt; 8080\n\n;; Data transformation pipeline (JSON \u2192 YAML)\n(match (try\n         (\"data.json\"\n          |&gt; io/read-file\n          |&gt;? json/parse\n          |&gt;? yaml/stringify\n          |&gt;? (fn [yaml] (io/write-file \"data.yaml\" yaml))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  result -&gt; result)\n</code></pre>"},{"location":"spec/12-stdlib-json/#yaml-features","title":"YAML Features","text":"<ul> <li>Optimal for configuration files (more readable than JSON/TOML)</li> <li>Automatic indentation formatting</li> <li>JSON compatible (YAML is a superset of JSON)</li> <li>Error handling: Returns value as-is on success, <code>{:error \"...\"}</code> on failure</li> </ul>"},{"location":"spec/12-stdlib-json/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/12-stdlib-json/#fetching-and-saving-api-data","title":"Fetching and Saving API Data","text":"<pre><code>(defn fetch-and-save [url output-file]\n  (match (try\n           (url\n            |&gt; http/get\n            |&gt;? json/parse\n            |&gt;? json/pretty\n            |&gt;? (fn [json-str] (io/write-file output-file json-str))))\n    {:error e} -&gt; (log/error \"Failed:\" e)\n    result -&gt; result))\n\n(fetch-and-save \"https://api.github.com/users/octocat\" \"user.json\")\n</code></pre>"},{"location":"spec/12-stdlib-json/#loading-configuration-files","title":"Loading Configuration Files","text":"<pre><code>(defn load-config [path]\n  (match (try\n           (path\n            |&gt; io/read-file\n            |&gt;? yaml/parse\n            |&gt;? (fn [config]\n                  ;; Validation\n                  (if (get config \"version\")\n                    config\n                    {:error \"Missing version field\"}))))\n    {:error e} -&gt; {:error e}\n    config -&gt; config))\n\n(match (load-config \"config.yaml\")\n  {:error e} -&gt; (println \"Error:\" e)\n  config -&gt; (println \"Config loaded:\" config))\n</code></pre>"},{"location":"spec/12-stdlib-json/#data-transformation","title":"Data Transformation","text":"<pre><code>;; JSON \u2192 YAML conversion\n(defn json-to-yaml [input-file output-file]\n  (match (try\n           (input-file\n            |&gt; io/read-file\n            |&gt;? json/parse\n            |&gt;? yaml/stringify\n            |&gt;? (fn [yaml-str] (io/write-file output-file yaml-str))))\n    {:error e} -&gt; (log/error \"Failed:\" e)\n    result -&gt; result))\n\n(json-to-yaml \"data.json\" \"data.yaml\")\n\n;; YAML \u2192 JSON conversion\n(defn yaml-to-json [input-file output-file]\n  (match (try\n           (input-file\n            |&gt; io/read-file\n            |&gt;? yaml/parse\n            |&gt;? json/stringify\n            |&gt;? (fn [json-str] (io/write-file output-file json-str))))\n    {:error e} -&gt; (log/error \"Failed:\" e)\n    result -&gt; result))\n\n(yaml-to-json \"config.yaml\" \"config.json\")\n</code></pre>"},{"location":"spec/12-stdlib-json/#batch-processing","title":"Batch Processing","text":"<pre><code>;; Parse multiple JSON files in parallel\n(def files [\"data1.json\" \"data2.json\" \"data3.json\"])\n\n(files\n ||&gt; (fn [f] (try (io/read-file f)))\n ||&gt; (fn [content]\n       (match content\n         {:error e} -&gt; {:error e}\n         c -&gt; (json/parse c)))\n |&gt; (filter (fn [result] (not (error? result)))))\n</code></pre>"},{"location":"spec/12-stdlib-json/#error-handling-patterns","title":"Error Handling Patterns","text":"<pre><code>;; Error handling in pipelines\n(defn process-json [json-str]\n  (match (json/parse json-str)\n    {:error e} -&gt; (do\n                    (log/error \"Parse failed:\" e)\n                    {:error e})\n    data -&gt; (do\n              (println \"Parsed successfully\")\n              (assoc data \"timestamp\" (now)))))\n\n;; Try multiple parsing formats\n(defn try-parse-formats [input-str]\n  (match (json/parse input-str)\n    {:error _} -&gt; (yaml/parse input-str)\n    data -&gt; data))\n</code></pre>"},{"location":"spec/12-stdlib-json/#type-mapping","title":"Type Mapping","text":""},{"location":"spec/12-stdlib-json/#qi-jsonyaml","title":"Qi \u2192 JSON/YAML","text":"Qi Type JSON YAML <code>nil</code> <code>null</code> <code>null</code> <code>true/false</code> <code>true/false</code> <code>true/false</code> Integer/Float Number Number String String String Vector/List Array List Map Object Map Keyword String String"},{"location":"spec/12-stdlib-json/#jsonyaml-qi","title":"JSON/YAML \u2192 Qi","text":"JSON/YAML Qi Type <code>null</code> <code>nil</code> <code>true/false</code> <code>true/false</code> Number Integer or Float String String Array Vector Object/Map Map"},{"location":"spec/13-stdlib-io/","title":"Standard Library - File I/O","text":"<p>File Operations and Encoding Support</p>"},{"location":"spec/13-stdlib-io/#basic-io","title":"Basic I/O","text":""},{"location":"spec/13-stdlib-io/#output","title":"Output","text":"<pre><code>;; print - Standard output (without newline)\n(print \"Hello\")                     ;; Hello (no newline)\n\n;; println - Standard output (with newline)\n(println \"Hello\")                   ;; Hello\\n\n</code></pre>"},{"location":"spec/13-stdlib-io/#standard-input","title":"Standard Input","text":"<pre><code>;; io/stdin-line - Read one line from standard input (nil on EOF)\n(io/stdin-line)                     ;; =&gt; \"user input\"\n(io/stdin-line)                     ;; =&gt; nil (EOF)\n\n;; Usage example: Process line by line\n(defn process []\n  (let [line (io/stdin-line)]\n    (if (some? line)\n      (do\n        (line |&gt; str/trim |&gt; str/upper |&gt; println)\n        (process))\n      nil)))\n\n(process)\n\n;; io/stdin-lines - Read all lines from standard input (for pipeline processing)\n(io/stdin-lines)                    ;; =&gt; [\"line1\" \"line2\" \"line3\"]\n\n;; Usage example: Pipeline processing (most Qi-like approach)\n(io/stdin-lines\n |&gt; (map str/trim)\n |&gt; (filter (fn [s] (not (str/empty? s))))\n |&gt; (map str/upper)\n |&gt; (map println))\n\n;; Combining with Unix pipes\n;; $ cat data.txt | qi process.qi\n</code></pre>"},{"location":"spec/13-stdlib-io/#file-reading","title":"File Reading","text":"<pre><code>;; io/read-file - Read entire file\n(io/read-file \"data.txt\")           ;; =&gt; \"file content...\"\n\n;; io/read-lines - Read line by line (memory efficient)\n(io/read-lines \"data.txt\")          ;; =&gt; [\"line1\" \"line2\" \"line3\"]\n</code></pre>"},{"location":"spec/13-stdlib-io/#file-writing","title":"File Writing","text":"<pre><code>;; io/write-file - Write to file (overwrite)\n(io/write-file \"Hello, Qi!\" \"/tmp/test.txt\")\n\n;; io/append-file - Append to file\n(io/append-file \"\\nSecond line\" \"/tmp/test.txt\")\n</code></pre>"},{"location":"spec/13-stdlib-io/#file-existence-check","title":"File Existence Check","text":"<pre><code>;; io/file-exists? - Check file existence\n(io/file-exists? \"/tmp/test.txt\")   ;; =&gt; true\n</code></pre>"},{"location":"spec/13-stdlib-io/#encoding-support","title":"Encoding Support","text":""},{"location":"spec/13-stdlib-io/#unicode","title":"Unicode","text":"<pre><code>;; :utf-8 (default, automatic BOM removal)\n(io/read-file \"data.txt\")\n\n;; :utf-8-bom (UTF-8 with BOM, for Excel compatibility)\n(io/write-file data \"excel.csv\" :encoding :utf-8-bom)\n\n;; :utf-16le (UTF-16LE with BOM, Excel multilingual support)\n(io/write-file data \"multilang_excel.csv\" :encoding :utf-16le)\n\n;; :utf-16be (UTF-16BE with BOM)\n(io/write-file data \"data.txt\" :encoding :utf-16be)\n</code></pre>"},{"location":"spec/13-stdlib-io/#japanese","title":"Japanese","text":"<pre><code>;; :sjis / :shift-jis (Shift_JIS/Windows-31J, Japanese Windows/Excel)\n(io/read-file \"legacy.csv\" :encoding :sjis)\n(io/write-file data \"for_excel.csv\" :encoding :sjis)\n\n;; :euc-jp (EUC-JP, Unix systems)\n(io/read-file \"unix_text.txt\" :encoding :euc-jp)\n\n;; :iso-2022-jp (JIS, email)\n(io/read-file \"mail.txt\" :encoding :iso-2022-jp)\n</code></pre>"},{"location":"spec/13-stdlib-io/#chinese","title":"Chinese","text":"<pre><code>;; :gbk (GBK, mainland China/Singapore, simplified Chinese Windows/Excel)\n(io/write-file data \"china_excel.csv\" :encoding :gbk)\n\n;; :gb18030 (GB18030, Chinese national standard, GBK superset)\n(io/write-file data \"china_official.txt\" :encoding :gb18030)\n\n;; :big5 (Big5, Taiwan/Hong Kong, traditional Chinese Windows/Excel)\n(io/write-file data \"taiwan_excel.csv\" :encoding :big5)\n</code></pre>"},{"location":"spec/13-stdlib-io/#korean","title":"Korean","text":"<pre><code>;; :euc-kr (EUC-KR, Korean Windows/Excel)\n(io/write-file data \"korea_excel.csv\" :encoding :euc-kr)\n</code></pre>"},{"location":"spec/13-stdlib-io/#european","title":"European","text":"<pre><code>;; :windows-1252 / :cp1252 / :latin1 (Western European, US Windows/Excel)\n(io/write-file data \"europe_excel.csv\" :encoding :windows-1252)\n\n;; :windows-1251 / :cp1251 (Russian/Cyrillic Windows/Excel)\n(io/write-file data \"russia_excel.csv\" :encoding :windows-1251)\n</code></pre>"},{"location":"spec/13-stdlib-io/#auto-detection","title":"Auto Detection","text":"<pre><code>;; :auto (BOM detection \u2192 UTF-8 \u2192 try each regional encoding sequentially)\n(io/read-file \"unknown.txt\" :encoding :auto)\n</code></pre>"},{"location":"spec/13-stdlib-io/#write-options","title":"Write Options","text":""},{"location":"spec/13-stdlib-io/#behavior-when-file-exists","title":"Behavior When File Exists","text":"<pre><code>;; :if-exists option\n(io/write-file data \"out.txt\" :if-exists :error)      ;; Error if exists\n(io/write-file data \"out.txt\" :if-exists :skip)       ;; Skip if exists\n(io/write-file data \"out.txt\" :if-exists :append)     ;; Append\n(io/write-file data \"out.txt\" :if-exists :overwrite)  ;; Overwrite (default)\n</code></pre>"},{"location":"spec/13-stdlib-io/#automatic-directory-creation","title":"Automatic Directory Creation","text":"<pre><code>;; :create-dirs option\n(io/write-file data \"path/to/out.txt\" :create-dirs true)\n\n;; Combining multiple options\n(io/write-file data \"backup/data.csv\"\n               :encoding :sjis\n               :if-exists :error\n               :create-dirs true)\n</code></pre>"},{"location":"spec/13-stdlib-io/#filesystem-operations","title":"Filesystem Operations","text":""},{"location":"spec/13-stdlib-io/#directory-listing","title":"Directory Listing","text":"<pre><code>;; io/list-dir - Get directory listing\n(io/list-dir \".\")                                ;; Current directory\n(io/list-dir \"logs\" :pattern \"*.log\")            ;; Log files only\n(io/list-dir \"src\" :pattern \"*.rs\" :recursive true)  ;; Recursive search\n</code></pre>"},{"location":"spec/13-stdlib-io/#directory-operations","title":"Directory Operations","text":"<pre><code>;; io/create-dir - Create directory (auto-creates parent directories)\n(io/create-dir \"data/backup\")\n\n;; io/delete-dir - Delete directory\n(io/delete-dir \"temp\")                           ;; Delete empty directory\n(io/delete-dir \"old_data\" :recursive true)       ;; Delete with contents\n</code></pre>"},{"location":"spec/13-stdlib-io/#file-operations","title":"File Operations","text":"<pre><code>;; io/copy-file - Copy file\n(io/copy-file \"data.txt\" \"data_backup.txt\")\n\n;; io/move-file - Move/rename file\n(io/move-file \"old.txt\" \"new.txt\")\n\n;; io/delete-file - Delete file\n(io/delete-file \"temp.txt\")\n</code></pre>"},{"location":"spec/13-stdlib-io/#metadata-retrieval","title":"Metadata Retrieval","text":"<pre><code>;; io/file-info - Get file information\n(def info (io/file-info \"data.txt\"))\n(get info \"size\")                                ;; File size\n(get info \"modified\")                            ;; Modified time (UNIX timestamp)\n(get info \"is-dir\")                              ;; Is directory\n(get info \"is-file\")                             ;; Is file\n\n;; Predicate functions\n(io/is-file? \"data.txt\")                         ;; true\n(io/is-dir? \"data\")                              ;; true\n(io/file-exists? \"config.json\")                  ;; true/false\n</code></pre>"},{"location":"spec/13-stdlib-io/#temporary-files-and-directories","title":"Temporary Files and Directories","text":""},{"location":"spec/13-stdlib-io/#automatic-deletion-recommended","title":"Automatic Deletion (Recommended)","text":"<pre><code>;; io/temp-file - Create temporary file (auto-deleted on program exit)\n(let [tmp (io/temp-file)]\n  (io/write-file \"temporary data\" tmp)\n  (process-file tmp))\n;; tmp is automatically deleted on program exit\n\n;; io/temp-dir - Create temporary directory (auto-deleted)\n(let [tmpdir (io/temp-dir)]\n  (io/write-file \"data1\" (path/join tmpdir \"file1.txt\"))\n  (io/write-file \"data2\" (path/join tmpdir \"file2.txt\"))\n  (process-directory tmpdir))\n;; tmpdir and its contents are automatically deleted on program exit\n</code></pre>"},{"location":"spec/13-stdlib-io/#manual-deletion-keep-version","title":"Manual Deletion (Keep Version)","text":"<pre><code>;; io/temp-file-keep - Create persistent temporary file\n(let [tmp (io/temp-file-keep)]\n  (io/write-file \"persistent data\" tmp)\n  (println f\"Created: {tmp}\")\n  tmp)\n;; =&gt; \"/tmp/.tmpXXXXXX\" (not deleted, manual deletion required)\n\n;; io/temp-dir-keep - Create persistent temporary directory\n(let [tmpdir (io/temp-dir-keep)]\n  (io/create-dir (path/join tmpdir \"subdir\"))\n  tmpdir)\n;; =&gt; \"/tmp/.tmpXXXXXX\" (not deleted)\n</code></pre>"},{"location":"spec/13-stdlib-io/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/13-stdlib-io/#csv-file-processing","title":"CSV File Processing","text":"<pre><code>;; Read and process CSV\n(io/read-file \"data.csv\")\n  |&gt; (fn [content] (split content \"\\n\"))\n  |&gt; (map (fn [line] (split line \",\")))\n  |&gt; (filter (fn [row] (&gt; (len row) 2)))\n</code></pre>"},{"location":"spec/13-stdlib-io/#combining-with-pipelines","title":"Combining with Pipelines","text":"<pre><code>;; Parallel processing of log files\n(\"logs\"\n |&gt; (io/list-dir :pattern \"*.log\")\n |&gt; (map io/read-file)\n |&gt; (map process-log)\n |&gt; (reduce merge))\n</code></pre>"},{"location":"spec/13-stdlib-io/#encoding-conversion","title":"Encoding Conversion","text":"<pre><code>;; Shift_JIS \u2192 UTF-8 conversion\n(io/read-file \"legacy.csv\" :encoding :sjis)\n |&gt; csv/parse\n |&gt; (map transform)\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"modern_utf8.csv\"))\n</code></pre>"},{"location":"spec/13-stdlib-io/#excel-support-for-different-countries","title":"Excel Support for Different Countries","text":"<pre><code>;; Japan: Excel CSV (Shift_JIS)\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"japan_excel.csv\" :encoding :sjis)))\n\n;; China (simplified): Excel CSV (GBK)\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"china_excel.csv\" :encoding :gbk)))\n\n;; Taiwan/Hong Kong (traditional): Excel CSV (Big5)\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"taiwan_excel.csv\" :encoding :big5)))\n\n;; Multilingual mix: UTF-16LE (Excel recommended, with BOM)\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"multilang_excel.csv\" :encoding :utf-16le)))\n</code></pre>"},{"location":"spec/13-stdlib-io/#data-processing-with-temporary-files","title":"Data Processing with Temporary Files","text":"<pre><code>;; Process large data with temporary file\n(defn process-large-data [url]\n  (let [tmp (io/temp-file)]\n    ;; Download data and save to temporary file\n    (http/get url :output tmp)\n    ;; Process temporary file\n    (let [result (process-file tmp)]\n      ;; tmp is auto-deleted after function exit\n      result)))\n\n;; Using multiple temporary files\n(defn merge-files [files output]\n  (let [tmpdir (io/temp-dir)\n        processed (files\n                   |&gt; (map (fn [f]\n                         (let [tmp (path/join tmpdir (path/basename f))]\n                           (io/copy-file f tmp)\n                           (process-file tmp)\n                           tmp))))]\n    ;; Merge processed files\n    (merge-all processed output)\n    ;; tmpdir and contents are auto-deleted after function exit\n    output))\n</code></pre>"},{"location":"spec/13-stdlib-io/#safe-writing","title":"Safe Writing","text":"<pre><code>;; Protect existing files\n(io/write-file data \"important.txt\"\n               :if-exists :error\n               :create-dirs true)\n\n;; Process file with unknown encoding\n(io/read-file \"unknown.txt\" :encoding :auto)\n |&gt; process\n |&gt; (fn [s] (io/write-file s \"output.txt\" :encoding :utf-8-bom))\n</code></pre>"},{"location":"spec/13-stdlib-io/#function-list","title":"Function List","text":""},{"location":"spec/13-stdlib-io/#file-io","title":"File I/O","text":"<ul> <li><code>io/read-file</code> - Read entire file</li> <li><code>io/read-lines</code> - Read line by line</li> <li><code>io/write-file</code> - Write to file (overwrite)</li> <li><code>io/append-file</code> - Append to file</li> </ul>"},{"location":"spec/13-stdlib-io/#filesystem-operations_1","title":"Filesystem Operations","text":"<ul> <li><code>io/list-dir</code> - Get directory listing (glob pattern support)</li> <li><code>io/create-dir</code> - Create directory</li> <li><code>io/delete-file</code> - Delete file</li> <li><code>io/delete-dir</code> - Delete directory</li> <li><code>io/copy-file</code> - Copy file</li> <li><code>io/move-file</code> - Move/rename file</li> </ul>"},{"location":"spec/13-stdlib-io/#metadata","title":"Metadata","text":"<ul> <li><code>io/file-info</code> - Get file information</li> <li><code>io/file-exists?</code> - Check file existence</li> <li><code>io/is-file?</code> - File predicate</li> <li><code>io/is-dir?</code> - Directory predicate</li> </ul>"},{"location":"spec/13-stdlib-io/#temporary-files","title":"Temporary Files","text":"<ul> <li><code>io/temp-file</code> - Create temporary file (auto-deleted)</li> <li><code>io/temp-file-keep</code> - Create temporary file (not deleted)</li> <li><code>io/temp-dir</code> - Create temporary directory (auto-deleted)</li> <li><code>io/temp-dir-keep</code> - Create temporary directory (not deleted)</li> </ul>"},{"location":"spec/14-stdlib-test/","title":"Standard Library - Test Framework","text":"<p>Simple and Easy-to-Use Test Framework</p>"},{"location":"spec/14-stdlib-test/#overview","title":"Overview","text":"<p>Qi's test framework is designed with a focus on simplicity and ease of learning.</p> <p>Features: - Zero-config (no configuration files required) - Auto-detection (explores <code>tests/</code> directory) - Simple output in Rust/Go style - No special syntax (plain function calls)</p>"},{"location":"spec/14-stdlib-test/#test-execution-functions","title":"Test Execution Functions","text":""},{"location":"spec/14-stdlib-test/#testrun","title":"test/run","text":"<p>Executes a test and records the result.</p> <p>Syntax: <pre><code>(test/run test-name test-fn)\n</code></pre></p> <p>Arguments: - <code>test-name</code> (string): Name of the test - <code>test-fn</code> (function): Function to execute the test (no arguments)</p> <p>Return Value: - <code>true</code>: Test passed - <code>false</code>: Test failed (error occurred)</p> <p>Example: <pre><code>(test/run \"addition\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq 0 (+ 0 0))))\n\n(test/run \"list operations\" (fn []\n  (test/assert-eq 3 (len [1 2 3]))\n  (test/assert-eq 1 (first [1 2 3]))))\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#testrun-all","title":"test/run-all","text":"<p>Displays all recorded test results.</p> <p>Syntax: <pre><code>(test/run-all)\n</code></pre></p> <p>Return Value: - Number of successful tests (integer) - Error if any test failed</p> <p>Output Example: <pre><code>Test results:\n===========\n  \u2713 addition\n  \u2713 list operations\n  \u2717 division by zero\n    Expected: {:error ...}\n    Actual: 42\n\n3 tests, 2 passed, 1 failed\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#testclear","title":"test/clear","text":"<p>Clears test results.</p> <p>Syntax: <pre><code>(test/clear)\n</code></pre></p> <p>Return Value: - <code>nil</code></p> <p>Usage Example: <pre><code>(test/clear)  ;; Reset test results\n;; Run new tests\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#assertion-functions","title":"Assertion Functions","text":""},{"location":"spec/14-stdlib-test/#testassert-eq","title":"test/assert-eq","text":"<p>Asserts that two values are equal.</p> <p>Syntax: <pre><code>(test/assert-eq expected actual)\n</code></pre></p> <p>Arguments: - <code>expected</code>: Expected value - <code>actual</code>: Actual value</p> <p>Success Condition: - <code>expected</code> and <code>actual</code> are equal (compared with <code>=</code>)</p> <p>Example: <pre><code>(test/run \"equality tests\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq \"HELLO\" (str/upper \"hello\"))\n  (test/assert-eq [1 2 3] (map inc [0 1 2]))))\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#testassert","title":"test/assert","text":"<p>Asserts that a value is truthy.</p> <p>Syntax: <pre><code>(test/assert value)\n</code></pre></p> <p>Arguments: - <code>value</code>: Value to check</p> <p>Success Condition: - <code>value</code> is truthy (anything other than <code>nil</code> and <code>false</code>)</p> <p>Example: <pre><code>(test/run \"truthy tests\" (fn []\n  (test/assert (&gt; 5 3))\n  (test/assert (even? 4))\n  (test/assert (some? [1 2 3]))          ;; Vector is not nil\n  (test/assert (list/some? even? [2 4 6]))))\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#testassert-not","title":"test/assert-not","text":"<p>Asserts that a value is falsy.</p> <p>Syntax: <pre><code>(test/assert-not value)\n</code></pre></p> <p>Arguments: - <code>value</code>: Value to check</p> <p>Success Condition: - <code>value</code> is falsy (<code>nil</code> or <code>false</code>)</p> <p>Example: <pre><code>(test/run \"falsy tests\" (fn []\n  (test/assert-not (&lt; 5 3))\n  (test/assert-not (odd? 4))\n  (test/assert-not nil)))\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#testassert-throws","title":"test/assert-throws","text":"<p>Asserts that a function throws an exception.</p> <p>Syntax: <pre><code>(test/assert-throws test-fn)\n</code></pre></p> <p>Arguments: - <code>test-fn</code> (function): Function to execute (no arguments)</p> <p>Success Condition: - An error occurs when executing <code>test-fn</code></p> <p>Example: <pre><code>(test/run \"exception tests\" (fn []\n  (test/assert-throws (fn [] (/ 10 0)))\n  (test/assert-throws (fn [] (first [])))\n  (test/assert-throws (fn [] (get {} :missing)))))\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#cli-command","title":"CLI Command","text":""},{"location":"spec/14-stdlib-test/#qi-test","title":"qi test","text":"<p>Executes test files.</p> <p>Usage: <pre><code># Run all *.qi files in tests/ directory\nqi test\n\n# Run specific test file\nqi test tests/core_test.qi\n\n# Run multiple files\nqi test tests/core_test.qi tests/pipeline_test.qi\n</code></pre></p> <p>Test File Placement: <pre><code>project/\n  tests/\n    core_test.qi\n    pipeline_test.qi\n    http_test.qi\n</code></pre></p> <p>Output: <pre><code>running 3 test files\n\nTest results:\n===========\n  \u2713 addition\n  \u2713 subtraction\n  \u2713 multiplication\n  \u2713 list operations\n  \u2713 pipeline test\n\n5 tests, 5 passed, 0 failed\n\nfinished in 0.08s\n</code></pre></p>"},{"location":"spec/14-stdlib-test/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/14-stdlib-test/#basic-tests","title":"Basic Tests","text":"<pre><code>;; tests/core_test.qi\n(test/run \"addition\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq 0 (+ 0 0))\n  (test/assert-eq -1 (+ 1 -2))))\n\n(test/run \"subtraction\" (fn []\n  (test/assert-eq 1 (- 3 2))\n  (test/assert-eq -5 (- 0 5))))\n\n(test/run \"multiplication\" (fn []\n  (test/assert-eq 6 (* 2 3))\n  (test/assert-eq 0 (* 5 0))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#pipeline-tests","title":"Pipeline Tests","text":"<pre><code>;; tests/pipeline_test.qi\n(test/run \"basic pipeline\" (fn []\n  (test/assert-eq (list 2 3 4) ([1 2 3] |&gt; (map inc)))))\n\n(test/run \"pipeline with multiple steps\" (fn []\n  (test/assert-eq 9 ([1 2 3] |&gt; (map inc) |&gt; sum))))\n\n(test/run \"filter and map\" (fn []\n  (test/assert-eq (list 3 5)\n    ([1 2 3 4 5 6] |&gt; (filter even?) |&gt; (map inc) |&gt; (take 2)))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#string-operation-tests","title":"String Operation Tests","text":"<pre><code>;; tests/string_test.qi\n(test/run \"string upper/lower\" (fn []\n  (test/assert-eq \"HELLO\" (str/upper \"hello\"))\n  (test/assert-eq \"world\" (str/lower \"WORLD\"))))\n\n(test/run \"string trimming\" (fn []\n  (test/assert-eq \"hello\" (str/trim \"  hello  \"))\n  (test/assert-eq \"test\" (str/trim-start \"  test\"))\n  (test/assert-eq \"test\" (str/trim-end \"test  \"))))\n\n(test/run \"string splitting\" (fn []\n  (test/assert-eq (list \"a\" \"b\" \"c\") (str/split \"a,b,c\" \",\"))\n  (test/assert-eq (list \"hello\" \"world\") (str/split \"hello world\" \" \"))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#error-handling-tests","title":"Error Handling Tests","text":"<pre><code>;; tests/error_test.qi\n(test/run \"division by zero\" (fn []\n  (test/assert-throws (fn [] (/ 10 0)))))\n\n(test/run \"empty list operations\" (fn []\n  (test/assert-throws (fn [] (first [])))\n  (test/assert-throws (fn [] (last [])))))\n\n(test/run \"map key not found\" (fn []\n  (test/assert-throws (fn [] (get {} :missing)))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#http-tests","title":"HTTP Tests","text":"<pre><code>;; tests/http_test.qi\n(test/run \"http/get success\" (fn []\n  (def result (http/get! \"https://httpbin.org/get\"))  ;; Detailed version to get status\n  (test/assert (map? result))\n  (test/assert-eq 200 (get result :status))))\n\n(test/run \"railway pipeline with http\" (fn []\n  (def result\n    (match (try\n             (\"https://httpbin.org/get\"\n              |&gt; http/get  ;; Simple version (body only)\n              |&gt;? json/parse))\n      {:error e} -&gt; {:error e}\n      data -&gt; data))\n\n  (match result\n    {:error e} -&gt; (test/assert false)  ;; Should not reach here\n    data -&gt; (test/assert (map? data)))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#data-transformation-tests","title":"Data Transformation Tests","text":"<pre><code>;; tests/transform_test.qi\n(test/run \"json round-trip\" (fn []\n  (def original {\"name\" \"Alice\" \"age\" 30})\n  (def result\n    (original\n     |&gt;? json/stringify\n     |&gt;? json/parse))\n\n  (match result\n    {:error e} -&gt; (test/assert false)\n    data -&gt; (test/assert-eq original data))))\n\n(test/run \"map transformations\" (fn []\n  (def users [{:name \"Alice\" :age 30} {:name \"Bob\" :age 25}])\n  (def result (map (fn [u] (update u :age inc)) users))\n\n  (test/assert-eq 31 (get (first result) :age))\n  (test/assert-eq 26 (get (last result) :age))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#best-practices","title":"Best Practices","text":""},{"location":"spec/14-stdlib-test/#file-organization","title":"File Organization","text":"<pre><code>project/\n  src/\n    core.qi\n    utils.qi\n  tests/\n    core_test.qi      # Tests for src/core.qi\n    utils_test.qi     # Tests for src/utils.qi\n    integration_test.qi  # Integration tests\n</code></pre>"},{"location":"spec/14-stdlib-test/#test-naming","title":"Test Naming","text":"<pre><code>;; \u2705 Good: Clear what is being tested\n(test/run \"addition with positive numbers\" (fn [] ...))\n(test/run \"string upper converts to uppercase\" (fn [] ...))\n(test/run \"http/get returns 200 for valid URL\" (fn [] ...))\n\n;; \u274c Bad: Unclear what is being tested\n(test/run \"test1\" (fn [] ...))\n(test/run \"check\" (fn [] ...))\n</code></pre>"},{"location":"spec/14-stdlib-test/#test-granularity","title":"Test Granularity","text":"<pre><code>;; \u2705 Good: One test for one feature\n(test/run \"addition\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq 0 (+ 0 0))))\n\n(test/run \"subtraction\" (fn []\n  (test/assert-eq 1 (- 3 2))))\n\n;; \u274c Bad: One test for multiple unrelated features\n(test/run \"math\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq \"HELLO\" (str/upper \"hello\"))\n  (test/assert-eq [1 2] (take 2 [1 2 3]))))\n</code></pre>"},{"location":"spec/14-stdlib-test/#error-messages","title":"Error Messages","text":"<pre><code>;; When assertion fails, a clear message is displayed\n(test/run \"example\" (fn []\n  (test/assert-eq 5 (+ 2 2))))\n\n;; Output:\n;;   \u2717 example\n;;     Assertion failed:\n;;   Expected: 5\n;;   Actual: 4\n</code></pre>"},{"location":"spec/14-stdlib-test/#execution-flow","title":"Execution Flow","text":"<ol> <li>Test File Detection: <code>qi test</code> searches for <code>*.qi</code> files in the <code>tests/</code> directory</li> <li>Test Execution: Each file is loaded and executed sequentially</li> <li>Result Collection: Each call to <code>test/run</code> records the result</li> <li>Report Display: <code>test/run-all</code> displays all results</li> <li>Exit Code:</li> <li>All passed: exit code 0</li> <li>Any failure: exit code 1</li> </ol>"},{"location":"spec/14-stdlib-test/#limitations","title":"Limitations","text":"<p>Currently Unimplemented: - Coverage measurement - Test tagging/filtering - <code>--watch</code> mode (auto re-run on file changes) - Setup/teardown (<code>before</code>/<code>after</code>) - Parallel test execution</p> <p>These features may be considered in future versions, but current functionality is sufficient for basic testing.</p>"},{"location":"spec/14-stdlib-test/#design-philosophy","title":"Design Philosophy","text":"<p>Qi's test framework prioritizes simplicity:</p> <ol> <li>Zero-config: No configuration files required. Just place files in <code>tests/</code></li> <li>No special syntax: Write tests with normal function calls</li> <li>Minimal API: Only 5 functions to remember</li> <li>Clear output: Simple and readable output in Rust/Go style</li> </ol> <p>Complex features come later. Being able to write basic tests is what matters most.</p>"},{"location":"spec/15-stdlib-math/","title":"Standard Library: Math Functions","text":"<p>Numeric Operations and Mathematical Functions</p>"},{"location":"spec/15-stdlib-math/#basic-operations","title":"Basic Operations","text":"<p>Qi provides basic arithmetic operators (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>). All operators support both integers and floats, and return a float if at least one operand is a float.</p> <pre><code>(+ 1 2 3)        ;; =&gt; 6\n(+ 1.5 2 3)      ;; =&gt; 6.5 (contains float)\n(- 10 3)         ;; =&gt; 7\n(* 2 3 4)        ;; =&gt; 24\n(/ 10 2)         ;; =&gt; 5\n(% 10 3)         ;; =&gt; 1 (remainder)\n(% 10.5 3)       ;; =&gt; 1.5 (supports floats)\n</code></pre>"},{"location":"spec/15-stdlib-math/#convenient-numeric-functions","title":"Convenient Numeric Functions","text":"<pre><code>;; min - Minimum value\n(min 1 2 3)          ;; =&gt; 1\n(min 1.5 2 3)        ;; =&gt; 1.5 (supports floats)\n\n;; max - Maximum value\n(max 1 2 3)          ;; =&gt; 3\n(max 1.5 2 3)        ;; =&gt; 3 (supports floats)\n\n;; sum - Sum (total of collection elements)\n(sum [1 2 3])        ;; =&gt; 6\n(sum [1.5 2 3])      ;; =&gt; 6.5 (supports floats)\n\n;; inc - Increment (add 1)\n(inc 5)              ;; =&gt; 6\n(inc 5.5)            ;; =&gt; 6.5 (supports floats)\n\n;; dec - Decrement (subtract 1)\n(dec 5)              ;; =&gt; 4\n(dec 5.5)            ;; =&gt; 4.5 (supports floats)\n\n;; abs - Absolute value\n(abs -5)             ;; =&gt; 5\n(abs -5.5)           ;; =&gt; 5.5\n</code></pre>"},{"location":"spec/15-stdlib-math/#mathematical-functions","title":"Mathematical Functions","text":""},{"location":"spec/15-stdlib-math/#power-and-square-root","title":"Power and Square Root","text":"<pre><code>;; math/pow - Power\n(math/pow 2 3)      ;; =&gt; 8 (2^3)\n(math/pow 10 2)     ;; =&gt; 100\n(math/pow 2 -1)     ;; =&gt; 0.5\n\n;; math/sqrt - Square root\n(math/sqrt 4)       ;; =&gt; 2.0\n(math/sqrt 9)       ;; =&gt; 3.0\n(math/sqrt 2)       ;; =&gt; 1.4142135623730951\n</code></pre>"},{"location":"spec/15-stdlib-math/#rounding","title":"Rounding","text":"<pre><code>;; math/round - Round to nearest integer\n(math/round 3.4)    ;; =&gt; 3\n(math/round 3.5)    ;; =&gt; 4\n(math/round -3.5)   ;; =&gt; -4\n\n;; math/floor - Round down (toward negative infinity)\n(math/floor 3.9)    ;; =&gt; 3\n(math/floor -3.1)   ;; =&gt; -4\n\n;; math/ceil - Round up (toward positive infinity)\n(math/ceil 3.1)     ;; =&gt; 4\n(math/ceil -3.9)    ;; =&gt; -3\n</code></pre>"},{"location":"spec/15-stdlib-math/#range-clamping","title":"Range Clamping","text":"<pre><code>;; math/clamp - Clamp value to range\n(math/clamp 5 0 10)     ;; =&gt; 5 (within range)\n(math/clamp -5 0 10)    ;; =&gt; 0 (minimum value)\n(math/clamp 15 0 10)    ;; =&gt; 10 (maximum value)\n(math/clamp -7 -10 -5)  ;; =&gt; -7 (negative range)\n</code></pre>"},{"location":"spec/15-stdlib-math/#random-number-generation-feature-std-math","title":"Random Number Generation (Feature: std-math)","text":"<p>Random number functions are available when the <code>std-math</code> feature is enabled.</p> <pre><code>;; math/rand - Random number between 0.0 and 1.0\n(math/rand)              ;; =&gt; 0.7234...\n\n;; math/rand-int - Random integer (0 to n-1)\n(math/rand-int 10)       ;; =&gt; 0-9 (integer)\n\n;; math/random-range - Random integer in range\n(math/random-range 10 20)  ;; =&gt; 10-20 (integer)\n\n;; math/shuffle - Shuffle list\n(math/shuffle [1 2 3 4 5])  ;; =&gt; [3 1 5 2 4] (random)\n</code></pre>"},{"location":"spec/15-stdlib-math/#pipeline-usage","title":"Pipeline Usage","text":"<p>Math functions can be combined with pipeline operators.</p> <pre><code>;; Range clamping and rounding\n(16.5 |&gt; math/sqrt |&gt; math/round)\n;; =&gt; 4\n\n;; Sequential calculations\n(2 |&gt; (math/pow _ 3) |&gt; (math/clamp _ 0 10))\n;; =&gt; 8\n\n;; Data processing\n(map (fn [x] (x |&gt; math/sqrt |&gt; math/round)) [4 9 16 25])\n;; =&gt; (2 3 4 5)\n</code></pre>"},{"location":"spec/15-stdlib-math/#usage-examples","title":"Usage Examples","text":""},{"location":"spec/15-stdlib-math/#statistical-calculations","title":"Statistical Calculations","text":"<pre><code>;; Root Mean Square (RMS)\n(defn rms [numbers]\n  (let [squares (map (fn [x] (math/pow x 2)) numbers)\n        sum (reduce + 0 squares)\n        mean (/ sum (len numbers))]\n    (math/sqrt mean)))\n\n(rms [1 2 3 4 5])  ;; =&gt; 3.316...\n</code></pre>"},{"location":"spec/15-stdlib-math/#range-clamping_1","title":"Range Clamping","text":"<pre><code>;; Clamp score to 0-100\n(defn normalize-score [score]\n  (math/clamp (math/round score) 0 100))\n\n(map normalize-score [-10 45.7 99.2 150])\n;; =&gt; (0 46 99 100)\n</code></pre>"},{"location":"spec/15-stdlib-math/#random-sampling","title":"Random Sampling","text":"<pre><code>;; Get random samples\n(defn random-sample [n coll]\n  (take n (math/shuffle coll)))\n\n(random-sample 3 [1 2 3 4 5 6 7 8 9 10])\n;; =&gt; (7 2 9) etc.\n</code></pre>"},{"location":"spec/15-stdlib-math/#function-reference","title":"Function Reference","text":""},{"location":"spec/15-stdlib-math/#basic-operations-and-numeric-functions","title":"Basic Operations and Numeric Functions","text":"Function Description Example <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> Basic operations (int/float support) <code>(+ 1.5 2 3)</code> \u2192 <code>6.5</code> <code>min</code> Minimum value (int/float support) <code>(min 1.5 2 3)</code> \u2192 <code>1.5</code> <code>max</code> Maximum value (int/float support) <code>(max 1.5 2 3)</code> \u2192 <code>3</code> <code>sum</code> Sum (int/float support) <code>(sum [1.5 2 3])</code> \u2192 <code>6.5</code> <code>inc</code> Increment (int/float support) <code>(inc 5.5)</code> \u2192 <code>6.5</code> <code>dec</code> Decrement (int/float support) <code>(dec 5.5)</code> \u2192 <code>4.5</code> <code>abs</code> Absolute value <code>(abs -5.5)</code> \u2192 <code>5.5</code>"},{"location":"spec/15-stdlib-math/#mathematical-functions_1","title":"Mathematical Functions","text":"Function Description Example <code>math/pow</code> Power <code>(math/pow 2 3)</code> \u2192 <code>8</code> <code>math/sqrt</code> Square root <code>(math/sqrt 16)</code> \u2192 <code>4.0</code> <code>math/round</code> Round to nearest integer <code>(math/round 3.5)</code> \u2192 <code>4</code> <code>math/floor</code> Round down <code>(math/floor 3.9)</code> \u2192 <code>3</code> <code>math/ceil</code> Round up <code>(math/ceil 3.1)</code> \u2192 <code>4</code> <code>math/clamp</code> Clamp to range <code>(math/clamp 15 0 10)</code> \u2192 <code>10</code>"},{"location":"spec/15-stdlib-math/#random-number-functions-feature-std-math","title":"Random Number Functions (Feature: std-math)","text":"Function Description Example <code>math/rand</code> Random (0.0-1.0) <code>(math/rand)</code> \u2192 <code>0.7234...</code> <code>math/rand-int</code> Random integer <code>(math/rand-int 10)</code> \u2192 <code>0-9</code> <code>math/random-range</code> Random in range <code>(math/random-range 10 20)</code> \u2192 <code>10-20</code> <code>math/shuffle</code> Shuffle <code>(math/shuffle [1 2 3])</code> \u2192 <code>[3 1 2]</code>"},{"location":"spec/15-stdlib-math/#notes","title":"Notes","text":"<ul> <li>Integer and Float: <code>math/pow</code> may return an integer. <code>math/sqrt</code> always returns a float.</li> <li>Feature Gates: Random functions (<code>rand</code>, <code>rand-int</code>, <code>random-range</code>, <code>shuffle</code>) require the <code>std-math</code> feature.</li> <li>Range Clamping: <code>math/clamp</code> argument order is <code>(value, min, max)</code>.</li> </ul>"},{"location":"spec/16-stdlib-auth/","title":"Authentication and Authorization","text":"<p>Authentication with JWT (JSON Web Token) and Password Hashing</p> <p>Qi provides authentication features required for modern web applications as part of its standard library.</p>"},{"location":"spec/16-stdlib-auth/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Overview</li> <li>JWT (JSON Web Token)</li> <li>jwt/sign - Token Generation</li> <li>jwt/verify - Token Verification</li> <li>jwt/decode - Token Decoding</li> <li>Password Hashing</li> <li>password/hash - Password Hashing</li> <li>password/verify - Password Verification</li> <li>Practical Examples</li> </ul>"},{"location":"spec/16-stdlib-auth/#overview","title":"Overview","text":""},{"location":"spec/16-stdlib-auth/#provided-features","title":"Provided Features","text":"<ul> <li>JWT Authentication: Stateless token-based authentication</li> <li>Token generation (jwt/sign)</li> <li>Token verification (jwt/verify)</li> <li>Token decoding (jwt/decode)</li> <li> <p>HS256/HS384/HS512 algorithm support</p> </li> <li> <p>Password Hashing: Secure password management with Argon2</p> </li> <li>Hashing (password/hash)</li> <li>Verification (password/verify)</li> <li>Automatic salt generation</li> </ul>"},{"location":"spec/16-stdlib-auth/#feature-flags","title":"Feature Flags","text":"<pre><code># Cargo.toml\nfeatures = [\"auth-jwt\", \"auth-password\"]\n</code></pre> <p>Enabled by default.</p>"},{"location":"spec/16-stdlib-auth/#jwt-json-web-token","title":"JWT (JSON Web Token)","text":""},{"location":"spec/16-stdlib-auth/#jwtsign-token-generation","title":"jwt/sign - Token Generation","text":"<p>Generates a JWT token from payload and secret key.</p> <pre><code>(jwt/sign payload secret)\n(jwt/sign payload secret algorithm)\n(jwt/sign payload secret algorithm exp)\n</code></pre>"},{"location":"spec/16-stdlib-auth/#arguments","title":"Arguments","text":"<ul> <li><code>payload</code>: Map (data to include in token)</li> <li><code>secret</code>: String (secret key for signing)</li> <li><code>algorithm</code>: String (optional, default: \"HS256\")</li> <li>Supports \"HS256\", \"HS384\", \"HS512\"</li> <li><code>exp</code>: Integer (optional, expiration time in seconds)</li> </ul>"},{"location":"spec/16-stdlib-auth/#return-value","title":"Return Value","text":"<ul> <li>Success: Token string</li> <li>Failure: <code>{:error \"error message\"}</code></li> </ul>"},{"location":"spec/16-stdlib-auth/#usage-examples","title":"Usage Examples","text":"<pre><code>;; Basic usage (default is HS256)\n(def result (jwt/sign {:user_id 123 :name \"Alice\"} \"my-secret\"))\n;; =&gt; \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\"\n\n;; Specify algorithm\n(jwt/sign {:role \"admin\"} \"secret\" \"HS384\")\n\n;; Specify expiration (3600 seconds = 1 hour)\n(jwt/sign {:user_id 42} \"secret\" \"HS256\" 3600)\n\n;; Pipeline usage\n({:user_id 999 :role \"user\"}\n |&gt; (jwt/sign \"my-secret\")\n |&gt;? (fn [token] (println \"Token:\" token)))\n</code></pre>"},{"location":"spec/16-stdlib-auth/#jwtverify-token-verification","title":"jwt/verify - Token Verification","text":"<p>Verifies JWT token and extracts payload.</p> <pre><code>(jwt/verify token secret)\n(jwt/verify token secret algorithm)\n</code></pre>"},{"location":"spec/16-stdlib-auth/#arguments_1","title":"Arguments","text":"<ul> <li><code>token</code>: String (JWT token to verify)</li> <li><code>secret</code>: String (secret key for verification)</li> <li><code>algorithm</code>: String (optional, default: \"HS256\")</li> </ul>"},{"location":"spec/16-stdlib-auth/#return-value_1","title":"Return Value","text":"<ul> <li>Success: Payload map</li> <li>Failure: <code>{:error \"error message\"}</code></li> </ul>"},{"location":"spec/16-stdlib-auth/#usage-examples_1","title":"Usage Examples","text":"<pre><code>;; Verify token and get payload\n(def result (jwt/verify token \"my-secret\"))\n;; =&gt; {:user_id 123 :name \"Alice\"}\n\n;; Verification failure example\n(jwt/verify \"invalid-token\" \"secret\")\n;; =&gt; {:error \"Invalid token\"}\n\n;; Pipeline usage\n(token\n |&gt;? (jwt/verify \"my-secret\")\n |&gt;? (fn [payload] (get payload :user_id)))\n;; =&gt; 123\n</code></pre>"},{"location":"spec/16-stdlib-auth/#jwtdecode-token-decoding","title":"jwt/decode - Token Decoding","text":"<p>Decodes JWT token without verification (no signature verification).</p> <p>This is a debugging function for inspecting token contents.</p> <pre><code>(jwt/decode token)\n</code></pre>"},{"location":"spec/16-stdlib-auth/#arguments_2","title":"Arguments","text":"<ul> <li><code>token</code>: String (JWT token to decode)</li> </ul>"},{"location":"spec/16-stdlib-auth/#return-value_2","title":"Return Value","text":"<ul> <li>Success: <code>{:header header-map :payload payload-map}</code></li> <li>Failure: <code>{:error \"error message\"}</code></li> </ul>"},{"location":"spec/16-stdlib-auth/#usage-examples_2","title":"Usage Examples","text":"<pre><code>;; Decode token (no signature verification)\n(def result (jwt/decode token))\n;; =&gt; {:header {:typ \"JWT\" :alg \"HS256\"}\n;;     :payload {:user_id 123 :name \"Alice\"}}\n\n;; Get header only\n(jwt/decode token\n |&gt;? (fn [data] (get data :header)))\n;; =&gt; {:typ \"JWT\" :alg \"HS256\"}\n</code></pre> <p>\u26a0\ufe0f Warning: This function does not verify signatures. Use only for debugging or testing purposes.</p>"},{"location":"spec/16-stdlib-auth/#password-hashing","title":"Password Hashing","text":""},{"location":"spec/16-stdlib-auth/#passwordhash-password-hashing","title":"password/hash - Password Hashing","text":"<p>Hashes password with Argon2.</p> <p>Argon2 is a faster and more secure password hashing algorithm than bcrypt.</p> <pre><code>(password/hash password)\n</code></pre>"},{"location":"spec/16-stdlib-auth/#arguments_3","title":"Arguments","text":"<ul> <li><code>password</code>: String (password to hash)</li> </ul>"},{"location":"spec/16-stdlib-auth/#return-value_3","title":"Return Value","text":"<ul> <li>Success: Hash string (Value::String)</li> <li>Failure: Error (exception)</li> </ul>"},{"location":"spec/16-stdlib-auth/#usage-examples_3","title":"Usage Examples","text":"<pre><code>;; Hash password\n(def hash (password/hash \"my-password\"))\n;; =&gt; \"$argon2id$v=19$m=19456,t=2,p=1$...\"\n\n;; Same password produces different hashes (automatic salt generation)\n(def hash1 (password/hash \"test\"))\n(def hash2 (password/hash \"test\"))\n(println (= hash1 hash2))  ;; =&gt; false\n</code></pre>"},{"location":"spec/16-stdlib-auth/#passwordverify-password-verification","title":"password/verify - Password Verification","text":"<p>Verifies password against hash.</p> <pre><code>(password/verify password hash)\n</code></pre>"},{"location":"spec/16-stdlib-auth/#arguments_4","title":"Arguments","text":"<ul> <li><code>password</code>: String (password to verify)</li> <li><code>hash</code>: String (hash generated by password/hash)</li> </ul>"},{"location":"spec/16-stdlib-auth/#return-value_4","title":"Return Value","text":"<ul> <li><code>true</code>: Password matches</li> <li><code>false</code>: Password does not match</li> </ul>"},{"location":"spec/16-stdlib-auth/#usage-examples_4","title":"Usage Examples","text":"<pre><code>;; Verify password\n(def hash (password/hash \"my-password\"))\n\n(password/verify \"my-password\" hash)  ;; =&gt; true\n(password/verify \"wrong-password\" hash)  ;; =&gt; false\n\n;; Invalid hash format returns false\n(password/verify \"test\" \"invalid-hash\")  ;; =&gt; false\n</code></pre>"},{"location":"spec/16-stdlib-auth/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/16-stdlib-auth/#user-login-feature","title":"User Login Feature","text":"<pre><code>;; User registration\n(defn register-user [username password]\n  (let [hash (password/hash password)]\n    {:username username\n     :password_hash hash}))\n\n;; User login\n(defn login [username password stored-hash]\n  (if (password/verify password stored-hash)\n    (jwt/sign {:username username} \"app-secret\" \"HS256\" 3600)\n    {:error \"Invalid credentials\"}))\n\n;; Usage example\n(def user (register-user \"alice\" \"secret123\"))\n;; =&gt; {:username \"alice\" :password_hash \"$argon2id$...\"}\n\n(def token-result (login \"alice\" \"secret123\" (get user :password_hash)))\n;; =&gt; \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\"\n</code></pre>"},{"location":"spec/16-stdlib-auth/#api-authentication-middleware","title":"API Authentication Middleware","text":"<pre><code>;; Extract authentication info from token\n(defn authenticate [token]\n  (token\n   |&gt;? (jwt/verify \"app-secret\")\n   |&gt;? (fn [payload] (get payload :username))))\n\n;; Protected endpoint\n(defn protected-endpoint [request]\n  (let [auth-header (get-in request [:headers :authorization])\n        token (string/replace-first auth-header \"Bearer \" \"\")\n        auth-result (authenticate token)]\n    (match auth-result\n      {:error _} -&gt; {:status 401 :body \"Unauthorized\"}\n      username -&gt; {:status 200 :body (str \"Hello, \" username)})))\n</code></pre>"},{"location":"spec/16-stdlib-auth/#password-change-flow","title":"Password Change Flow","text":"<pre><code>;; Change password\n(defn change-password [old-password new-password stored-hash]\n  (if (password/verify old-password stored-hash)\n    (password/hash new-password)\n    {:error \"Current password is incorrect\"}))\n\n;; Usage example\n(def current-hash \"$argon2id$v=19$m=19456,t=2,p=1$...\")\n(def new-hash (change-password \"old-pass\" \"new-pass\" current-hash))\n;; =&gt; \"$argon2id$v=19$m=19456,t=2,p=1$...\" (new hash)\n</code></pre>"},{"location":"spec/16-stdlib-auth/#security-best-practices","title":"Security Best Practices","text":""},{"location":"spec/16-stdlib-auth/#jwt","title":"JWT","text":"<ol> <li>Secret Key Management</li> <li>Manage secret keys with environment variables</li> <li> <p>Use sufficiently long and random strings</p> </li> <li> <p>Expiration Time</p> </li> <li>Always set expiration time for tokens</li> <li> <p>Short expiration (within 1 hour) recommended</p> </li> <li> <p>HTTPS Required</p> </li> <li>Always transmit tokens over HTTPS</li> <li>HTTP has eavesdropping risks</li> </ol>"},{"location":"spec/16-stdlib-auth/#password-hashing_1","title":"Password Hashing","text":"<ol> <li>Automatic Salt Generation</li> <li><code>password/hash</code> automatically generates salts</li> <li> <p>Same password produces different hashes</p> </li> <li> <p>Advantages of Argon2</p> </li> <li>Faster and more secure than bcrypt</li> <li>Memory-hard function (resistant to GPU attacks)</li> <li> <p>Winner of 2015 Password Hashing Competition</p> </li> <li> <p>Hash Storage</p> </li> <li>Hashes can be stored directly in database</li> <li>Includes algorithm, parameters, salt, and hash</li> </ol>"},{"location":"spec/16-stdlib-auth/#related-documentation","title":"Related Documentation","text":"<ul> <li>11-stdlib-http.md - Integration with HTTP server</li> <li>12-stdlib-json.md - Handling JSON data</li> <li>08-error-handling.md - Result type patterns</li> <li>17-stdlib-database.md - Database integration</li> </ul>"},{"location":"spec/16-stdlib-auth/#implementation-details","title":"Implementation Details","text":""},{"location":"spec/16-stdlib-auth/#crates-used","title":"Crates Used","text":"<ul> <li>jsonwebtoken (v9.2) - JWT generation/verification</li> <li>argon2 (v0.5) - Password hashing</li> </ul>"},{"location":"spec/16-stdlib-auth/#feature-flags_1","title":"Feature Flags","text":"<pre><code># Enabled by default\ndefault = [\"auth-jwt\", \"auth-password\", ...]\n\n# Can be disabled individually\nminimal = []  # No authentication features\n</code></pre>"},{"location":"spec/16-stdlib-auth/#summary","title":"Summary","text":"<p>Qi's authentication library provides simple and secure authentication features.</p> <ul> <li>JWT: Stateless token authentication</li> <li>Argon2: Modern and secure password hashing</li> <li>Result Type: Unified error handling</li> </ul> <p>By combining these features, you can easily build authentication systems for modern web applications.</p>"},{"location":"spec/17-stdlib-database/","title":"Database","text":"<p>Unified Interface for Databases (PostgreSQL/MySQL/SQLite)</p> <p>Qi provides unified access to relational databases.</p>"},{"location":"spec/17-stdlib-database/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Overview</li> <li>Unified Database Interface</li> <li>db/connect - Connection</li> <li>db/query - Query Execution</li> <li>db/exec - Command Execution</li> <li>Practical Examples</li> <li>Error Handling</li> <li>Performance</li> <li>Connection String Format</li> <li>Implementation Details</li> </ul>"},{"location":"spec/17-stdlib-database/#overview","title":"Overview","text":""},{"location":"spec/17-stdlib-database/#provided-features","title":"Provided Features","text":"<p>Database: - Unified Interface (db/*): PostgreSQL/MySQL/SQLite support   - Connection management (<code>db/connect</code>)   - Query execution (<code>db/query</code>)   - Command execution (<code>db/exec</code>)   - Transactions (<code>db/begin</code>, <code>db/commit</code>, <code>db/rollback</code>)   - Parameterized queries   - Backend-agnostic switching (only connection URL changes)</p>"},{"location":"spec/17-stdlib-database/#feature-flags","title":"Feature Flags","text":"<pre><code># Cargo.toml\nfeatures = [\"db-sqlite\", \"db-postgres\", \"db-mysql\"]\n</code></pre> <p>Enabled by default.</p>"},{"location":"spec/17-stdlib-database/#dependencies","title":"Dependencies","text":"<p>Database: - rusqlite (v0.32) - Pure Rust SQLite client - tokio-postgres (v0.7) - Pure Rust PostgreSQL client - mysql_async (v0.34) - Pure Rust MySQL client - tokio - Async runtime</p>"},{"location":"spec/17-stdlib-database/#unified-database-interface","title":"Unified Database Interface","text":""},{"location":"spec/17-stdlib-database/#unified-interface-design","title":"Unified Interface Design","text":"<p>Database is designed with unified interface pattern. This is the same approach as Go's <code>database/sql</code> package, allowing transparent backend handling.</p> <pre><code>;; Unified interface (backend auto-detection)\n(def conn (db/connect \"postgresql://localhost/mydb\"))\n(def conn (db/connect \"mysql://root:pass@localhost/mydb\"))\n(def conn (db/connect \"sqlite:path/to/db.db\"))\n\n;; Code is backend-agnostic\n(db/query conn \"SELECT * FROM users\" [])\n(db/exec conn \"INSERT INTO users (name) VALUES (?)\" [\"Alice\"])\n\n;; Transactions\n(def tx (db/begin conn))\n(db/exec tx \"UPDATE accounts SET balance = balance - 100 WHERE id = 1\" [])\n(db/exec tx \"UPDATE accounts SET balance = balance + 100 WHERE id = 2\" [])\n(db/commit tx)\n</code></pre> <p>Backend Switching: Change only the connection URL to migrate between PostgreSQL\u2194MySQL\u2194SQLite.</p> <p>No Public-Specific Functions: Functions like <code>db/pg-*</code>, <code>db/my-*</code> are for internal use only. Add only when unified interface cannot express functionality (PostgreSQL COPY, MySQL LOAD DATA, etc.).</p>"},{"location":"spec/17-stdlib-database/#dbconnect-connection","title":"db/connect - Connection","text":"<p>Connects to database and returns connection ID.</p> <pre><code>(db/connect url)\n</code></pre>"},{"location":"spec/17-stdlib-database/#arguments","title":"Arguments","text":"<ul> <li><code>url</code>: String (connection URL)</li> <li>PostgreSQL: <code>\"postgresql://user:password@host:port/dbname\"</code></li> <li>MySQL: <code>\"mysql://user:password@host:port/dbname\"</code></li> <li>SQLite: <code>\"sqlite:path/to/db.db\"</code></li> </ul>"},{"location":"spec/17-stdlib-database/#return-value","title":"Return Value","text":"<ul> <li>Connection ID (string)</li> <li>Error case: <code>{:error \"message\"}</code></li> </ul>"},{"location":"spec/17-stdlib-database/#usage-examples","title":"Usage Examples","text":"<pre><code>;; PostgreSQL connection\n(def db-conn (db/connect \"postgresql://admin:secret@localhost:5432/myapp\"))\n\n;; MySQL connection\n(def db-conn (db/connect \"mysql://root:pass@localhost:3306/mydb\"))\n\n;; SQLite connection\n(def db-conn (db/connect \"sqlite:/path/to/database.db\"))\n\n;; Connection error\n(def conn (db/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported database URL: invalid-url\"}\n</code></pre>"},{"location":"spec/17-stdlib-database/#dbquery-query-execution","title":"db/query - Query Execution","text":"<p>Executes SELECT query and returns rows.</p> <pre><code>(db/query conn sql params)\n</code></pre>"},{"location":"spec/17-stdlib-database/#arguments_1","title":"Arguments","text":"<ul> <li><code>conn</code>: Connection ID (returned from <code>db/connect</code>)</li> <li><code>sql</code>: SQL string</li> <li><code>params</code>: Vector of parameters</li> </ul>"},{"location":"spec/17-stdlib-database/#return-value_1","title":"Return Value","text":"<ul> <li>Vector of result rows (each row is a map)</li> <li>Error case: <code>{:error \"message\"}</code></li> </ul>"},{"location":"spec/17-stdlib-database/#usage-examples_1","title":"Usage Examples","text":"<pre><code>;; Get all users\n(db/query db-conn \"SELECT * FROM users\" [])\n;; =&gt; [{:id 1 :name \"Alice\" :email \"alice@example.com\"}\n;;     {:id 2 :name \"Bob\" :email \"bob@example.com\"}]\n\n;; Parameterized query\n(db/query db-conn \"SELECT * FROM users WHERE id = $1\" [1])\n;; =&gt; [{:id 1 :name \"Alice\" :email \"alice@example.com\"}]\n\n;; WHERE IN clause\n(db/query db-conn \"SELECT * FROM users WHERE id IN ($1, $2, $3)\" [1 2 3])\n\n;; LIMIT/OFFSET (pagination)\n(db/query db-conn \"SELECT * FROM users LIMIT $1 OFFSET $2\" [10 20])\n</code></pre>"},{"location":"spec/17-stdlib-database/#dbexec-command-execution","title":"db/exec - Command Execution","text":"<p>Executes INSERT/UPDATE/DELETE and returns affected rows.</p> <pre><code>(db/exec conn sql params)\n</code></pre>"},{"location":"spec/17-stdlib-database/#arguments_2","title":"Arguments","text":"<ul> <li><code>conn</code>: Connection ID</li> <li><code>sql</code>: SQL string</li> <li><code>params</code>: Vector of parameters</li> </ul>"},{"location":"spec/17-stdlib-database/#return-value_2","title":"Return Value","text":"<ul> <li>Number of affected rows (integer)</li> <li>Error case: <code>{:error \"message\"}</code></li> </ul>"},{"location":"spec/17-stdlib-database/#usage-examples_2","title":"Usage Examples","text":"<pre><code>;; INSERT\n(db/exec db-conn \"INSERT INTO users (name, email) VALUES ($1, $2)\" [\"Alice\" \"alice@example.com\"])\n;; =&gt; 1\n\n;; UPDATE\n(db/exec db-conn \"UPDATE users SET name = $1 WHERE id = $2\" [\"Bob\" 1])\n;; =&gt; 1\n\n;; DELETE\n(db/exec db-conn \"DELETE FROM users WHERE id = $1\" [1])\n;; =&gt; 1\n\n;; Multiple row INSERT\n(db/exec db-conn \"INSERT INTO users (name, email) VALUES ($1, $2), ($3, $4)\" [\"Alice\" \"alice@example.com\" \"Bob\" \"bob@example.com\"])\n;; =&gt; 2\n</code></pre>"},{"location":"spec/17-stdlib-database/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/17-stdlib-database/#user-management-system","title":"User Management System","text":"<pre><code>;; Database connection (unified interface)\n(def db-conn (db/connect \"postgresql://admin:secret@localhost:5432/myapp\"))\n\n;; Create user\n(defn create-user [name email password-hash]\n  (db/exec db-conn\n    \"INSERT INTO users (name, email, password_hash, created_at)\n     VALUES ($1, $2, $3, NOW()) RETURNING id\"\n    [name email password-hash]))\n\n;; Find user\n(defn find-user-by-email [email]\n  (db/query db-conn\n    \"SELECT id, name, email, created_at FROM users WHERE email = $1\"\n    [email]))\n\n;; Update user\n(defn update-user [user-id name email]\n  (db/exec db-conn\n    \"UPDATE users SET name = $1, email = $2, updated_at = NOW()\n     WHERE id = $3\"\n    [name email user-id]))\n\n;; Delete user\n(defn delete-user [user-id]\n  (db/exec db-conn\n    \"DELETE FROM users WHERE id = $1\"\n    [user-id]))\n\n;; Usage example\n(def result (create-user \"Alice\" \"alice@example.com\" \"$argon2id$...\"))\n;; =&gt; 1\n\n(find-user-by-email \"alice@example.com\")\n;; =&gt; [{:id 1 :name \"Alice\" :email \"alice@example.com\" :created_at \"...\"}]\n</code></pre>"},{"location":"spec/17-stdlib-database/#pagination","title":"Pagination","text":"<pre><code>;; Get paginated results\n(defn get-users-page [page per-page]\n  (let [offset (* (- page 1) per-page)]\n    (db/query db-conn\n      \"SELECT id, name, email FROM users\n       ORDER BY created_at DESC\n       LIMIT $1 OFFSET $2\"\n      [per-page offset])))\n\n;; Usage example\n(get-users-page 1 10)  ;; Page 1, 10 items\n;; =&gt; [{:id 100 :name \"Zara\" ...} ...]\n\n(get-users-page 2 10)  ;; Page 2, 10 items\n;; =&gt; [{:id 90 :name \"Yuki\" ...} ...]\n</code></pre>"},{"location":"spec/17-stdlib-database/#transactions-manual","title":"Transactions (Manual)","text":"<pre><code>;; Transaction example (manual commit)\n(defn transfer-money [from-id to-id amount]\n  (let [conn db-conn]\n    ;; BEGIN\n    (db/exec conn \"BEGIN\" [])\n\n    ;; Debit\n    (def debit-result\n      (db/exec conn\n        \"UPDATE accounts SET balance = balance - $1 WHERE id = $2\"\n        [amount from-id]))\n\n    ;; Credit\n    (def credit-result\n      (db/exec conn\n        \"UPDATE accounts SET balance = balance + $1 WHERE id = $2\"\n        [amount to-id]))\n\n    ;; Commit or rollback\n    (match [debit-result credit-result]\n      [1 1] -&gt; (do\n                 (db/exec conn \"COMMIT\" [])\n                 \"Transfer successful\")\n      _ -&gt; (do\n             (db/exec conn \"ROLLBACK\" [])\n             {:error \"Transfer failed\"}))))\n</code></pre>"},{"location":"spec/17-stdlib-database/#aggregation-queries","title":"Aggregation Queries","text":"<pre><code>;; Count users\n(defn count-users []\n  (db/query db-conn \"SELECT COUNT(*) as count FROM users\" [])\n  |&gt;? (fn [rows] (get (first rows) :count)))\n\n;; Group by\n(defn count-users-by-status []\n  (db/query db-conn\n    \"SELECT status, COUNT(*) as count\n     FROM users\n     GROUP BY status\"\n    []))\n\n;; Usage example\n(count-users)\n;; =&gt; 1523\n\n(count-users-by-status)\n;; =&gt; [{:status \"active\" :count 1200}\n;;     {:status \"inactive\" :count 323}]\n</code></pre>"},{"location":"spec/17-stdlib-database/#error-handling","title":"Error Handling","text":""},{"location":"spec/17-stdlib-database/#error-handling_1","title":"Error Handling","text":"<p>Database functions return raw data on success and <code>{:error \"message\"}</code> on failure.</p> <pre><code>;; Basic error handling\n(def result (db/query db-conn \"SELECT * FROM users\" []))\n(if (error? result)\n  (println \"Error:\" (get result :error))\n  (println \"Found\" (count result) \"users\"))\n\n;; Pipeline error handling (short-circuit with |&gt;?)\n(defn get-user-email [user-id]\n  (db/query db-conn \"SELECT email FROM users WHERE id = $1\" [user-id])\n  |&gt;? (fn [rows]\n        (if (empty? rows)\n          {:error \"User not found\"}\n          (get (first rows) \"email\"))))\n\n;; match error handling\n(match (db/query db-conn \"SELECT * FROM users\" [])\n  {:error e} -&gt; (println \"Database error:\" e)\n  rows -&gt; (println \"Found\" (count rows) \"users\"))\n</code></pre>"},{"location":"spec/17-stdlib-database/#connection-errors","title":"Connection Errors","text":"<pre><code>;; Invalid connection string\n(def conn (db/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported database URL: invalid-url\"}\n\n;; Connection timeout\n(def conn (db/connect \"postgresql://localhost:9999/db\"))\n;; =&gt; {:error \"Connection failed: connection refused\"}\n</code></pre>"},{"location":"spec/17-stdlib-database/#query-errors","title":"Query Errors","text":"<pre><code>;; Syntax error\n(db/query db-conn \"SELEC * FROM users\" [])\n;; =&gt; {:error \"Query error: syntax error at or near \\\"SELEC\\\"\"}\n\n;; Table doesn't exist\n(db/query db-conn \"SELECT * FROM nonexistent_table\" [])\n;; =&gt; {:error \"Query error: relation \\\"nonexistent_table\\\" does not exist\"}\n</code></pre>"},{"location":"spec/17-stdlib-database/#performance","title":"Performance","text":""},{"location":"spec/17-stdlib-database/#connection-pooling-not-implemented","title":"Connection Pooling (Not Implemented)","text":"<p>Current implementation establishes a new connection per query.</p> <p>Future plan to support connection pooling:</p> <pre><code>;; Future plan\n(def pool (db/create-pool \"postgresql://...\" {:max-connections 10}))\n(db/with-connection pool (fn [conn]\n  (db/query conn \"SELECT * FROM users\" [])))\n</code></pre>"},{"location":"spec/17-stdlib-database/#parameterized-queries","title":"Parameterized Queries","text":"<p>Always use parameterized queries to prevent SQL injection attacks:</p> <pre><code>;; \u274c Dangerous: SQL injection vulnerability\n(def user-input \"1 OR 1=1\")\n(db/query db-conn (str \"SELECT * FROM users WHERE id = \" user-input) [])\n\n;; \u2705 Safe: Parameterized query\n(db/query db-conn \"SELECT * FROM users WHERE id = $1\" [user-input])\n</code></pre>"},{"location":"spec/17-stdlib-database/#connection-string-format","title":"Connection String Format","text":""},{"location":"spec/17-stdlib-database/#postgresql","title":"PostgreSQL","text":"<pre><code>postgresql://[user[:password]@][host][:port][/dbname][?param1=value1&amp;...]\n</code></pre> <p>Examples: <pre><code>;; Basic\n\"postgresql://localhost/mydb\"\n\n;; Username and password\n\"postgresql://admin:secret@localhost/mydb\"\n\n;; Port specified\n\"postgresql://admin:secret@localhost:5433/mydb\"\n\n;; SSL mode\n\"postgresql://admin:secret@localhost/mydb?sslmode=require\"\n</code></pre></p>"},{"location":"spec/17-stdlib-database/#mysql","title":"MySQL","text":"<pre><code>mysql://[user[:password]@][host][:port][/dbname][?param1=value1&amp;...]\n</code></pre> <p>Examples: <pre><code>;; Basic\n\"mysql://root@localhost/mydb\"\n\n;; Username and password\n\"mysql://root:pass@localhost/mydb\"\n\n;; Port specified\n\"mysql://root:pass@localhost:3307/mydb\"\n</code></pre></p>"},{"location":"spec/17-stdlib-database/#sqlite","title":"SQLite","text":"<pre><code>sqlite:path/to/database.db\n</code></pre> <p>Examples: <pre><code>;; Relative path\n\"sqlite:mydb.db\"\n\n;; Absolute path\n\"sqlite:/var/lib/myapp/data.db\"\n\n;; In-memory (future support)\n\"sqlite::memory:\"\n</code></pre></p>"},{"location":"spec/17-stdlib-database/#loading-from-environment-variables","title":"Loading from Environment Variables","text":"<pre><code>;; Load connection string from environment variable (future plan)\n(def db-conn (db/connect (env/get \"DATABASE_URL\")))\n</code></pre>"},{"location":"spec/17-stdlib-database/#implementation-details","title":"Implementation Details","text":""},{"location":"spec/17-stdlib-database/#unified-interface-design_1","title":"Unified Interface Design","text":"<p>Database (RDBMS) is designed with unified interface pattern. This is the same approach as Go's <code>database/sql</code> package, allowing transparent backend handling.</p> <pre><code>Unified Interface (user-facing):\n- db/connect, db/query, db/exec      ... RDBMS unified interface\n\nInternal Drivers (not public):\n- SqliteDriver, PostgresDriver, MysqlDriver\n</code></pre>"},{"location":"spec/17-stdlib-database/#driver-pattern","title":"Driver Pattern","text":"<pre><code>// Unified interface trait\npub trait DbDriver: Send + Sync {\n    fn connect(&amp;self, url: &amp;str, opts: &amp;ConnectionOptions)\n        -&gt; DbResult&lt;Arc&lt;dyn DbConnection&gt;&gt;;\n    fn name(&amp;self) -&gt; &amp;str;\n}\n\npub trait DbConnection: Send + Sync {\n    fn query(&amp;self, sql: &amp;str, params: &amp;[Value], opts: &amp;QueryOptions)\n        -&gt; DbResult&lt;Rows&gt;;\n    fn exec(&amp;self, sql: &amp;str, params: &amp;[Value], opts: &amp;QueryOptions)\n        -&gt; DbResult&lt;i64&gt;;\n    fn begin(&amp;self, opts: &amp;TransactionOptions)\n        -&gt; DbResult&lt;Arc&lt;dyn DbTransaction&gt;&gt;;\n    // ...\n}\n\n// Backend implementations (internal only)\npub struct SqliteDriver;\npub struct PostgresDriver;\npub struct MysqlDriver;\n\nimpl DbDriver for SqliteDriver { /* ... */ }\nimpl DbConnection for SqliteConnection { /* ... */ }\n</code></pre>"},{"location":"spec/17-stdlib-database/#async-processing","title":"Async Processing","text":"<p>Internally uses async APIs, but exposed as sync API to Qi users.</p> <pre><code>// Rust implementation (reference)\nlet rt = tokio::runtime::Runtime::new()?;\nrt.block_on(async {\n    let (client, connection) = tokio_postgres::connect(conn_str, NoTls).await?;\n    client.query(query, &amp;params).await\n})\n</code></pre>"},{"location":"spec/17-stdlib-database/#roadmap","title":"Roadmap","text":""},{"location":"spec/17-stdlib-database/#future-features","title":"Future Features","text":"<p>RDBMS: - Connection pooling: Reuse connections for performance - Streaming queries: Efficient processing of large data - Specific functions: Only when unified interface cannot express   - PostgreSQL: <code>COPY</code>, <code>LISTEN/NOTIFY</code>   - MySQL: <code>LOAD DATA</code>   - SQLite: Custom functions, virtual tables</p>"},{"location":"spec/17-stdlib-database/#summary","title":"Summary","text":"<p>Qi's database library provides simple and safe access through unified interface.</p>"},{"location":"spec/17-stdlib-database/#rdbms-db","title":"RDBMS (db/*)","text":"<ul> <li>db/connect: PostgreSQL/MySQL/SQLite auto-detection</li> <li>db/query: Execute SELECT queries</li> <li>db/exec: Execute INSERT/UPDATE/DELETE</li> <li>db/begin/commit/rollback: Transactions</li> <li>Parameterized queries: SQL injection protection</li> <li>Backend-agnostic switching: Change only connection URL</li> </ul> <p>By combining these features, you can easily build database-driven applications.</p>"},{"location":"spec/17-stdlib-database/#related-documentation","title":"Related Documentation","text":"<ul> <li>24-stdlib-kvs.md - Key-Value Store Unified Interface (Redis)</li> <li>16-stdlib-auth.md - Authentication integration</li> <li>08-error-handling.md - Error handling patterns</li> <li>11-stdlib-http.md - Using DB in web applications</li> <li>12-stdlib-json.md - Storing/loading JSON data</li> </ul>"},{"location":"spec/18-stdlib-websocket/","title":"18. WebSocket Communication","text":"<p>Qi provides WebSocket client functionality as part of its standard library. It can be used for applications requiring real-time communication (chat, notifications, live data updates, etc.).</p>"},{"location":"spec/18-stdlib-websocket/#181-basic-usage","title":"18.1 Basic Usage","text":""},{"location":"spec/18-stdlib-websocket/#establishing-websocket-connection","title":"Establishing WebSocket Connection","text":"<pre><code>;; Connect to WebSocket server\n(def conn (ws/connect \"ws://localhost:8080/ws\"))\n\n;; TLS support (wss://)\n(def conn (ws/connect \"wss://echo.websocket.org\"))\n</code></pre> <p><code>ws/connect</code> returns a connection ID. This connection ID is used to send/receive messages and close the connection.</p>"},{"location":"spec/18-stdlib-websocket/#sending-messages","title":"Sending Messages","text":"<pre><code>;; Send text message\n(ws/send conn \"Hello, WebSocket!\")\n\n;; Send JSON message\n(ws/send conn (json/stringify {:type \"chat\" :msg \"Hello\"}))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#receiving-messages","title":"Receiving Messages","text":"<pre><code>;; Receive message (blocking)\n(def msg (ws/receive conn))\n\n;; Process based on message type\n(match (get msg :type)\n  \"message\" -&gt; (println (get msg :data))\n  \"close\" -&gt; (println \"Connection closed\")\n  \"error\" -&gt; (println (get msg :error)))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#closing-connection","title":"Closing Connection","text":"<pre><code>;; Close connection\n(ws/close conn)\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#182-message-types","title":"18.2 Message Types","text":"<p><code>ws/receive</code> returns a message map of one of the following types:</p>"},{"location":"spec/18-stdlib-websocket/#text-message","title":"Text Message","text":"<pre><code>{:type \"message\" :data \"received text\"}\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#binary-message","title":"Binary Message","text":"<pre><code>{:type \"binary\" :data \"base64 encoded data\"}\n</code></pre> <p>Binary data is returned as a base64-encoded string.</p>"},{"location":"spec/18-stdlib-websocket/#close-message","title":"Close Message","text":"<pre><code>{:type \"close\" :code 1000 :reason \"Normal closure\"}\n</code></pre> <p>Received when the server closes the connection.</p>"},{"location":"spec/18-stdlib-websocket/#error","title":"Error","text":"<pre><code>{:type \"error\" :error \"error message\"}\n</code></pre> <p>Received when a communication error occurs.</p>"},{"location":"spec/18-stdlib-websocket/#183-practical-patterns","title":"18.3 Practical Patterns","text":""},{"location":"spec/18-stdlib-websocket/#chat-client","title":"Chat Client","text":"<pre><code>(defn chat-client [url username]\n  (let [conn (ws/connect url)]\n    (if (error? conn)\n      (println f\"Connection error: {conn}\")\n      (do\n        ;; Send join message\n        (ws/send conn (json/stringify {:type \"join\" :user username}))\n\n        ;; Message receive loop\n        (loop []\n          (let [msg (ws/receive conn)]\n            (match (get msg :type)\n              \"message\" -&gt;\n                (do\n                  (let [data (json/parse (get msg :data))]\n                    (println f\"{(get data \\\"user\\\")}: {(get data \\\"msg\\\")}\"))\n                  (recur))\n              \"close\" -&gt; (println \"Connection disconnected\")\n              \"error\" -&gt; (println f\"Error: {(get msg :error)}\")\n              _ -&gt; (recur))))\n\n        (ws/close conn)))))\n\n;; Usage example\n(chat-client \"ws://localhost:8080/chat\" \"Alice\")\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#json-message-sendreceive","title":"JSON Message Send/Receive","text":"<pre><code>;; JSON send helper\n(defn send-json [conn data]\n  (ws/send conn (json/stringify data)))\n\n;; JSON receive helper\n(defn receive-json [conn]\n  (let [response (ws/receive conn)]\n    (match (get response :type)\n      \"message\" -&gt; {:ok (json/parse (get response :data))}\n      _ -&gt; {:error response})))\n\n;; Usage example\n(def conn (ws/connect \"ws://localhost:8080/api\"))\n(send-json conn {:action \"subscribe\" :channel \"news\"})\n(def msg (receive-json conn))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#error-handling","title":"Error Handling","text":"<pre><code>(defn safe-ws-connect [url max-retries]\n  (loop [retries 0]\n    (let [conn (try (ws/connect url))]\n      (if (error? conn)\n        (if (&lt; retries max-retries)\n          (do\n            (println f\"Connection failed. Retry {(+ retries 1)}/{max-retries}\")\n            (recur (+ retries 1)))\n          (do\n            (println \"Reached maximum retry count\")\n            nil))\n        conn))))\n\n;; Usage example\n(def conn (safe-ws-connect \"ws://localhost:8080\" 3))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#receive-with-timeout","title":"Receive with Timeout","text":"<p>WebSocket is blocking by default, but timeout can be implemented using goroutines and channels:</p> <pre><code>(defn ws-receive-timeout [conn timeout-ms]\n  (let [ch (go/chan)\n        timeout-ch (go/timeout timeout-ms)]\n    ;; Execute receive in goroutine\n    (go\n      (let [msg (ws/receive conn)]\n        (go/send ch msg)))\n    ;; Wait for timeout or receive\n    (go/select\n      ch -&gt; (go/recv ch)\n      timeout-ch -&gt; {:error \"timeout\"})))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#184-connection-management","title":"18.4 Connection Management","text":""},{"location":"spec/18-stdlib-websocket/#managing-multiple-connections","title":"Managing Multiple Connections","text":"<p>Connection IDs are integers, so multiple connections can be managed with a map:</p> <pre><code>(def connections (atom {}))\n\n(defn add-connection [name url]\n  (let [conn (ws/connect url)]\n    (if (not (error? conn))\n      (do\n        (swap! connections assoc name conn)\n        {:ok conn})\n      {:error conn})))\n\n(defn send-to [name message]\n  (if-let [conn (get @connections name)]\n    (ws/send conn message)\n    (println f\"Connection {name} not found\")))\n\n;; Usage example\n(add-connection :server1 \"ws://server1.com/ws\")\n(add-connection :server2 \"ws://server2.com/ws\")\n(send-to :server1 \"Hello from server1\")\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#185-server-side-implementation","title":"18.5 Server-Side Implementation","text":"<p>Currently, Qi only provides WebSocket client functionality. Server-side WebSocket functionality is planned for future versions.</p>"},{"location":"spec/18-stdlib-websocket/#186-function-reference","title":"18.6 Function Reference","text":""},{"location":"spec/18-stdlib-websocket/#wsconnect","title":"ws/connect","text":"<pre><code>(ws/connect url) ;=&gt; connection-id\n</code></pre> <p>Connects to a WebSocket server.</p> <ul> <li>Arguments: <code>url</code> - WebSocket URL (ws:// or wss://)</li> <li>Return Value: Connection ID (Integer)</li> <li>Error: Error string on connection failure</li> </ul> <p>Example: <pre><code>(def conn (ws/connect \"wss://echo.websocket.org\"))\n</code></pre></p>"},{"location":"spec/18-stdlib-websocket/#wssend","title":"ws/send","text":"<pre><code>(ws/send conn-id message) ;=&gt; nil\n</code></pre> <p>Sends a message via WebSocket.</p> <ul> <li>Arguments:</li> <li><code>conn-id</code> - Connection ID</li> <li><code>message</code> - Message to send (string)</li> <li>Return Value: nil</li> <li>Error: Throws error on send failure</li> </ul> <p>Example: <pre><code>(ws/send conn \"Hello, WebSocket!\")\n</code></pre></p>"},{"location":"spec/18-stdlib-websocket/#wsreceive","title":"ws/receive","text":"<pre><code>(ws/receive conn-id) ;=&gt; message-map\n</code></pre> <p>Receives a message from WebSocket. Blocks until a message arrives.</p> <ul> <li>Arguments: <code>conn-id</code> - Connection ID</li> <li>Return Value: Message map (<code>:type</code>, <code>:data</code>, <code>:code</code>, <code>:reason</code>, <code>:error</code>)</li> <li>Error: Throws error on receive failure</li> </ul> <p>Example: <pre><code>(def msg (ws/receive conn))\n(println (get msg :type)) ;=&gt; \"message\"\n</code></pre></p>"},{"location":"spec/18-stdlib-websocket/#wsclose","title":"ws/close","text":"<pre><code>(ws/close conn-id) ;=&gt; nil\n</code></pre> <p>Closes the WebSocket connection.</p> <ul> <li>Arguments: <code>conn-id</code> - Connection ID</li> <li>Return Value: nil</li> <li>Error: Throws error on close failure</li> </ul> <p>Example: <pre><code>(ws/close conn)\n</code></pre></p>"},{"location":"spec/18-stdlib-websocket/#187-best-practices","title":"18.7 Best Practices","text":""},{"location":"spec/18-stdlib-websocket/#1-error-handling","title":"1. Error Handling","text":"<p>WebSocket connections can become unstable, so implement proper error handling:</p> <pre><code>(defn handle-ws-message [conn]\n  (try\n    (let [msg (ws/receive conn)]\n      (match (get msg :type)\n        \"message\" -&gt; (process-message msg)\n        \"error\" -&gt; (log-error msg)\n        \"close\" -&gt; (reconnect)))\n    |&gt;? (fn [result]\n          (if (error? result)\n            (handle-error result)\n            result))))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#2-reconnection-logic","title":"2. Reconnection Logic","text":"<p>Implement automatic reconnection when the connection is lost due to network issues:</p> <pre><code>(defn auto-reconnect [url]\n  (loop [delay 1000]\n    (let [conn (try (ws/connect url))]\n      (if (error? conn)\n        (do\n          (println f\"Retrying connection in {delay}ms...\")\n          (go/sleep delay)\n          (recur (min (* delay 2) 30000))) ;; exponential backoff\n        conn))))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#3-resource-cleanup","title":"3. Resource Cleanup","text":"<p>Always close connections after use:</p> <pre><code>(defn with-websocket [url f]\n  (let [conn (ws/connect url)]\n    (if (error? conn)\n      {:error conn}\n      (try\n        (f conn)\n        |&gt; (fn [result]\n             (ws/close conn)\n             result)))))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#188-security","title":"18.8 Security","text":""},{"location":"spec/18-stdlib-websocket/#tlsssl","title":"TLS/SSL","text":"<p>When handling sensitive information, always use <code>wss://</code> (WebSocket Secure):</p> <pre><code>;; \u2705 Good example\n(ws/connect \"wss://api.example.com/secure\")\n\n;; \u274c Bad example (when handling sensitive information)\n(ws/connect \"ws://api.example.com/secure\")\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#authentication","title":"Authentication","text":"<p>When including authentication tokens during WebSocket connection, send them via URL query parameters or the first message:</p> <pre><code>;; Authentication via URL query parameters\n(def conn (ws/connect f\"wss://api.example.com/ws?token={token}\"))\n\n;; Authentication via first message\n(def conn (ws/connect \"wss://api.example.com/ws\"))\n(ws/send conn (json/stringify {:type \"auth\" :token token}))\n</code></pre>"},{"location":"spec/18-stdlib-websocket/#189-performance","title":"18.9 Performance","text":""},{"location":"spec/18-stdlib-websocket/#automatic-pingpong-handling","title":"Automatic Ping/Pong Handling","text":"<p>Qi's WebSocket implementation automatically handles Ping/Pong frames. Users do not need to take special action.</p>"},{"location":"spec/18-stdlib-websocket/#binary-data","title":"Binary Data","text":"<p>Binary messages are returned base64-encoded. When handling large amounts of binary data, be aware of encoding/decoding overhead.</p>"},{"location":"spec/18-stdlib-websocket/#summary","title":"Summary","text":"<p>Qi's WebSocket functionality makes real-time communication easy to implement:</p> <ul> <li><code>ws/connect</code> - Establish connection</li> <li><code>ws/send</code> - Send message</li> <li><code>ws/receive</code> - Receive message (blocking)</li> <li><code>ws/close</code> - Close connection</li> </ul> <p>By properly implementing error handling and reconnection logic, you can build stable real-time applications.</p>"},{"location":"spec/19-stdlib-validation/","title":"Standard Library: Validation","text":"<p>Schema-Based Data Validation</p>"},{"location":"spec/19-stdlib-validation/#overview","title":"Overview","text":"<p>Qi's validation functionality validates data based on schemas (maps). This allows declarative validation of data such as API requests, configuration files, and user input.</p>"},{"location":"spec/19-stdlib-validation/#key-features","title":"Key Features","text":"<ul> <li>Schema-Based: Define schemas with maps</li> <li>Railway Oriented Programming: Return errors as values (<code>{:ok value}</code> or <code>{:error ...}</code>)</li> <li>Type Safety: Support for multiple types (string, integer, number, boolean, map, vector, list, keyword, symbol, nil, any)</li> <li>Nested Data Support: Can validate nested maps and collections</li> <li>Detailed Error Messages: Include error code, message, and field name</li> </ul>"},{"location":"spec/19-stdlib-validation/#basic-usage","title":"Basic Usage","text":""},{"location":"spec/19-stdlib-validation/#type-checking","title":"Type Checking","text":"<pre><code>;; String type check\n(def schema {:type \"string\"})\n(validate schema \"hello\")  ;; =&gt; {:ok \"hello\"}\n(validate schema 123)      ;; =&gt; {:error {:code \"type-mismatch\" :message \"must be string\"}}\n\n;; Integer type check\n(def schema {:type \"integer\"})\n(validate schema 42)    ;; =&gt; {:ok 42}\n(validate schema 3.14)  ;; =&gt; {:error {:code \"type-mismatch\" :message \"must be integer\"}}\n</code></pre>"},{"location":"spec/19-stdlib-validation/#required-field-check","title":"Required Field Check","text":"<pre><code>(def schema {:type \"string\" :required true})\n(validate schema \"test\")  ;; =&gt; {:ok \"test\"}\n(validate schema nil)     ;; =&gt; {:error {:code \"required\" :message \"required field\"}}\n\n;; Optional field (default)\n(def schema {:type \"string\"})\n(validate schema nil)  ;; =&gt; {:ok nil}  ;; Success (optional)\n</code></pre>"},{"location":"spec/19-stdlib-validation/#string-validation","title":"String Validation","text":""},{"location":"spec/19-stdlib-validation/#length-check","title":"Length Check","text":"<pre><code>(def username-schema\n  {:type \"string\"\n   :min-length 3\n   :max-length 20})\n\n(validate username-schema \"user123\")     ;; =&gt; {:ok \"user123\"}\n(validate username-schema \"ab\")          ;; =&gt; {:error {:code \"min-length\" :message \"must be at least 3 characters\"}}\n(validate username-schema \"verylongusernamethatexceedslimit\")\n  ;; =&gt; {:error {:code \"max-length\" :message \"must be at most 20 characters\"}}\n</code></pre>"},{"location":"spec/19-stdlib-validation/#pattern-matching-regex","title":"Pattern Matching (Regex)","text":"<pre><code>;; Email validation\n(def email-schema\n  {:type \"string\"\n   :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"})\n\n(validate email-schema \"user@example.com\")  ;; =&gt; {:ok \"user@example.com\"}\n(validate email-schema \"invalid-email\")     ;; =&gt; {:error {:code \"pattern\" :message \"does not match pattern: ...\"}}\n\n;; Lowercase letters only\n(def lowercase-schema\n  {:type \"string\"\n   :pattern \"^[a-z]+$\"})\n\n(validate lowercase-schema \"hello\")    ;; =&gt; {:ok \"hello\"}\n(validate lowercase-schema \"Hello123\") ;; =&gt; {:error {:code \"pattern\" ...}}\n</code></pre>"},{"location":"spec/19-stdlib-validation/#numeric-validation","title":"Numeric Validation","text":""},{"location":"spec/19-stdlib-validation/#range-check","title":"Range Check","text":"<pre><code>(def age-schema\n  {:type \"integer\"\n   :min 0\n   :max 150})\n\n(validate age-schema 25)   ;; =&gt; {:ok 25}\n(validate age-schema -5)   ;; =&gt; {:error {:code \"min-value\" :message \"must be at least 0\"}}\n(validate age-schema 200)  ;; =&gt; {:error {:code \"max-value\" :message \"must be at most 150\"}}\n</code></pre>"},{"location":"spec/19-stdlib-validation/#positive-number-check","title":"Positive Number Check","text":"<pre><code>(def price-schema\n  {:type \"number\"\n   :positive true})\n\n(validate price-schema 100.0)  ;; =&gt; {:ok 100.0}\n(validate price-schema 0)      ;; =&gt; {:error {:code \"positive\" :message \"must be positive\"}}\n(validate price-schema -10.5)  ;; =&gt; {:error {:code \"positive\" ...}}\n</code></pre>"},{"location":"spec/19-stdlib-validation/#collection-validation","title":"Collection Validation","text":""},{"location":"spec/19-stdlib-validation/#item-count-check","title":"Item Count Check","text":"<pre><code>(def tags-schema\n  {:type \"vector\"\n   :min-items 1\n   :max-items 5})\n\n(validate tags-schema [\"tag1\" \"tag2\" \"tag3\"])  ;; =&gt; {:ok [\"tag1\" \"tag2\" \"tag3\"]}\n(validate tags-schema [])                      ;; =&gt; {:error {:code \"min-items\" :message \"must have at least 1 items\"}}\n(validate tags-schema [\"a\" \"b\" \"c\" \"d\" \"e\" \"f\"])\n  ;; =&gt; {:error {:code \"max-items\" :message \"must have at most 5 items\"}}\n</code></pre>"},{"location":"spec/19-stdlib-validation/#nested-map-validation","title":"Nested Map Validation","text":"<p>You can define schemas for each field in a map using <code>:fields</code>.</p> <pre><code>(def user-schema\n  {:type \"map\"\n   :fields {:name {:type \"string\" :required true :min-length 1}\n            :age {:type \"integer\" :min 0 :max 150}\n            :email {:type \"string\" :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"}}})\n\n;; Valid data\n(validate user-schema\n  {:name \"Taro\" :age 25 :email \"taro@example.com\"})\n;; =&gt; {:ok {:name \"Taro\" :age 25 :email \"taro@example.com\"}}\n\n;; Empty name (min-length error)\n(validate user-schema {:name \"\" :age 25})\n;; =&gt; {:error {:field \":name\" :code \"min-length\" :message \"must be at least 1 characters\"}}\n\n;; Missing name (required error)\n(validate user-schema {:age 25})\n;; =&gt; {:error {:field \":name\" :code \"required\" :message \"required field\"}}\n\n;; Age out of range\n(validate user-schema {:name \"Taro\" :age 200})\n;; =&gt; {:error {:field \":age\" :code \"max-value\" :message \"must be at most 150\"}}\n\n;; Optional field (email) can be omitted\n(validate user-schema {:name \"Taro\"})\n;; =&gt; {:ok {:name \"Taro\"}}  ;; age, email are nil (optional)\n</code></pre>"},{"location":"spec/19-stdlib-validation/#complex-schema-examples","title":"Complex Schema Examples","text":""},{"location":"spec/19-stdlib-validation/#user-registration-form","title":"User Registration Form","text":"<pre><code>(def signup-schema\n  {:type \"map\"\n   :fields {:username {:type \"string\" :required true :min-length 3 :max-length 20}\n            :password {:type \"string\" :required true :min-length 8}\n            :email {:type \"string\" :required true :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"}\n            :age {:type \"integer\" :min 13 :max 150}\n            :bio {:type \"string\" :max-length 500}}})\n\n(validate signup-schema\n  {:username \"newuser\"\n   :password \"securepass123\"\n   :email \"user@example.com\"\n   :age 25})\n;; =&gt; {:ok {...}}\n\n(validate signup-schema\n  {:username \"ab\"        ;; Too short\n   :password \"short\"     ;; Too short\n   :email \"invalid\"})    ;; Pattern mismatch\n;; =&gt; {:error {:field \":username\" :code \"min-length\" ...}}  ;; Returns first error\n</code></pre>"},{"location":"spec/19-stdlib-validation/#schema-options-reference","title":"Schema Options Reference","text":""},{"location":"spec/19-stdlib-validation/#common-options","title":"Common Options","text":"Option Type Description <code>:type</code> string Data type: <code>\"string\"</code>, <code>\"integer\"</code>, <code>\"number\"</code>, <code>\"boolean\"</code>, <code>\"map\"</code>, <code>\"vector\"</code>, <code>\"list\"</code>, <code>\"keyword\"</code>, <code>\"symbol\"</code>, <code>\"nil\"</code>, <code>\"any\"</code> <code>:required</code> bool Whether field is required (default: <code>false</code>)"},{"location":"spec/19-stdlib-validation/#string-specific","title":"String-Specific","text":"Option Type Description <code>:min-length</code> integer Minimum character count <code>:max-length</code> integer Maximum character count <code>:pattern</code> string Regular expression pattern"},{"location":"spec/19-stdlib-validation/#numeric-specific","title":"Numeric-Specific","text":"Option Type Description <code>:min</code> integer/float Minimum value <code>:max</code> integer/float Maximum value <code>:positive</code> bool Must be positive (greater than 0) <code>:integer</code> bool Must be integer (for float type)"},{"location":"spec/19-stdlib-validation/#collection-specific","title":"Collection-Specific","text":"Option Type Description <code>:min-items</code> integer Minimum item count <code>:max-items</code> integer Maximum item count"},{"location":"spec/19-stdlib-validation/#map-specific","title":"Map-Specific","text":"Option Type Description <code>:fields</code> map Schema for nested fields (map)"},{"location":"spec/19-stdlib-validation/#error-code-reference","title":"Error Code Reference","text":"Code Description <code>type-mismatch</code> Type does not match <code>required</code> Required field is missing <code>min-length</code> String is too short <code>max-length</code> String is too long <code>pattern</code> Does not match pattern <code>min-value</code> Number is too small <code>max-value</code> Number is too large <code>positive</code> Not a positive number <code>min-items</code> Too few items <code>max-items</code> Too many items"},{"location":"spec/19-stdlib-validation/#usage-example-validation-in-http-server","title":"Usage Example: Validation in HTTP Server","text":"<pre><code>(def user-create-schema\n  {:type \"map\"\n   :fields {:name {:type \"string\" :required true :min-length 1}\n            :email {:type \"string\" :required true :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"}}})\n\n(server/start 8080\n  (fn [req]\n    (def result (validate user-create-schema (get req :body)))\n    (match result\n      {:ok data}     (server/json {:status \"ok\" :user data})\n      {:error error} (server/json {:status \"error\" :error error} :status 400))))\n</code></pre>"},{"location":"spec/19-stdlib-validation/#notes","title":"Notes","text":"<ul> <li>Optional Fields: If <code>:required</code> is <code>false</code> or unspecified, validation succeeds even if data is <code>nil</code></li> <li>:type \"any\": Accepts any type (no type checking)</li> <li>Nested Maps: Field where error occurred is included in <code>:field</code> (e.g., <code>\":name\"</code>, <code>\":address:city\"</code>)</li> <li>Regular Expressions: Follow ripgrep syntax</li> </ul>"},{"location":"spec/19-stdlib-validation/#related-documentation","title":"Related Documentation","text":"<ul> <li>Error Handling - Railway Oriented Programming</li> <li>Data Structures - Maps and Keywords</li> <li>HTTP Server - Using Validation in Servers</li> </ul>"},{"location":"spec/20-stdlib-debug/","title":"Debug Functionality","text":"<p>Qi provides built-in debugging functionality, including tracing, breakpoints, stack traces, and more.</p>"},{"location":"spec/20-stdlib-debug/#overview","title":"Overview","text":"<p>The debug module provides the following features:</p> <ul> <li>Tracing - Log function calls and returns</li> <li>Breakpoints - Pause execution</li> <li>Stack Traces - Get current call stack</li> <li>Debugger Info - Check debugger state</li> </ul>"},{"location":"spec/20-stdlib-debug/#debug-functions","title":"Debug Functions","text":""},{"location":"spec/20-stdlib-debug/#debugtrace","title":"debug/trace","text":"<p>Enable/disable trace functionality.</p> <pre><code>(debug/trace enabled)\n</code></pre> <p>Arguments: - <code>enabled</code> (boolean) - true=enable, false=disable</p> <p>Return Value: nil</p> <p>Example:</p> <pre><code>(defn fibonacci [n]\n  (if (&lt;= n 1)\n      n\n      (+ (fibonacci (- n 1)) (fibonacci (- n 2)))))\n\n(debug/trace true)\n(fibonacci 5)\n(debug/trace false)\n</code></pre> <p>Output example: <pre><code>[TRACE] -&gt; fibonacci (test.qi:1)\n[TRACE]   -&gt; fibonacci (test.qi:1)\n[TRACE]     -&gt; fibonacci (test.qi:1)\n[TRACE]     &lt;- fibonacci\n[TRACE]     -&gt; fibonacci (test.qi:1)\n[TRACE]     &lt;- fibonacci\n[TRACE]   &lt;- fibonacci\n[TRACE]   -&gt; fibonacci (test.qi:1)\n[TRACE]   &lt;- fibonacci\n[TRACE] &lt;- fibonacci\n</code></pre></p>"},{"location":"spec/20-stdlib-debug/#debugbreak","title":"debug/break","text":"<p>Set a breakpoint. Execution pauses if a debugger is attached.</p> <pre><code>(debug/break)\n</code></pre> <p>Arguments: none</p> <p>Return Value: nil</p> <p>Example:</p> <pre><code>(defn process-data [data]\n  (println \"Processing:\" data)\n  (debug/break)  ;; Pause here\n  (if (&gt; data 100)\n      \"Large\"\n      \"Small\"))\n\n(process-data 150)\n</code></pre>"},{"location":"spec/20-stdlib-debug/#debugstack","title":"debug/stack","text":"<p>Get the current call stack as a string.</p> <pre><code>(debug/stack)\n</code></pre> <p>Arguments: none</p> <p>Return Value: string - stack trace</p> <p>Example:</p> <pre><code>(defn inner []\n  (debug/stack))\n\n(defn middle []\n  (inner))\n\n(defn outer []\n  (middle))\n\n(println (outer))\n</code></pre> <p>Output example: <pre><code>  #0 inner at test.qi:2\n  #1 middle at test.qi:5\n  #2 outer at test.qi:8\n</code></pre></p>"},{"location":"spec/20-stdlib-debug/#debuginfo","title":"debug/info","text":"<p>Get the current state of the debugger.</p> <pre><code>(debug/info)\n</code></pre> <p>Arguments: none</p> <p>Return Value: map - debug information</p> <p>Keys in returned map: - <code>:enabled</code> (boolean) - Whether debugger is enabled - <code>:state</code> (string) - Debugger state (\"Running\", \"Paused\", etc.) - <code>:stack-depth</code> (integer) - Current stack depth</p> <p>Example:</p> <pre><code>(println (debug/info))\n;=&gt; {:enabled false}\n\n;; When debugger is enabled\n;=&gt; {:enabled true :state \"Running\" :stack-depth 0}\n</code></pre>"},{"location":"spec/20-stdlib-debug/#usage-examples","title":"Usage Examples","text":""},{"location":"spec/20-stdlib-debug/#stack-trace-on-error","title":"Stack Trace on Error","text":"<pre><code>(defn error-handler []\n  (println \"Error occurred at:\")\n  (println (debug/stack)))\n\n(defn divide [a b]\n  (if (= b 0)\n      (error-handler)\n      (/ a b)))\n\n(divide 10 0)\n</code></pre>"},{"location":"spec/20-stdlib-debug/#debugging-with-trace","title":"Debugging with Trace","text":"<pre><code>(defn factorial [n]\n  (if (&lt;= n 1)\n      1\n      (* n (factorial (- n 1)))))\n\n(debug/trace true)\n(println \"Result:\" (factorial 5))\n(debug/trace false)\n</code></pre>"},{"location":"spec/20-stdlib-debug/#conditional-breakpoint","title":"Conditional Breakpoint","text":"<pre><code>(defn process-batch [items]\n  (each (fn [item]\n          (when (&gt; item 1000)\n            (debug/break))  ;; Stop only for large values\n          (println \"Processing:\" item))\n        items))\n\n(process-batch [10 50 1200 5])\n</code></pre>"},{"location":"spec/20-stdlib-debug/#vscode-debug-support","title":"VSCode Debug Support","text":"<p>Qi supports VS Code integrated debugger:</p> <ul> <li>GUI-based breakpoint setting</li> <li>Step execution (Step In, Step Over, Step Out)</li> <li>Variable inspection</li> <li>Watch expression evaluation</li> <li>Call stack navigation</li> </ul>"},{"location":"spec/20-stdlib-debug/#enabling-the-debugger","title":"Enabling the Debugger","text":"<p>The debugger can be enabled via startup options:</p> <pre><code># Launch with debug mode\nqi --debug script.qi\n\n# Attachable via DAP (listen on specified port)\nqi --debug-port 5678 script.qi\n</code></pre>"},{"location":"spec/20-stdlib-debug/#performance","title":"Performance","text":"<p>Debug functionality affects performance, so do not use in production environments:</p> <ul> <li>Enabling <code>debug/trace</code> logs every function call, significantly reducing execution speed</li> <li><code>debug/break</code> and <code>debug/stack</code> are relatively lightweight but should not be called frequently</li> <li><code>debug/info</code> is lightweight with minimal performance impact</li> </ul>"},{"location":"spec/20-stdlib-debug/#related-topics","title":"Related Topics","text":"<ul> <li>Test Framework - Testing and Assertions</li> <li>Profiling - Performance Measurement</li> <li>Logging - Structured Logging</li> </ul>"},{"location":"spec/21-stdlib-table/","title":"Standard Library - Table Processing (table/)","text":"<p>SQL/awk-like Table Manipulation Library</p> <p>The <code>table</code> library provides convenient functions for working with tabular data (list of maps) such as CSV, JSON, and database results. Implemented as syntactic sugar over existing collection functions, it enables concise SQL-like operations.</p>"},{"location":"spec/21-stdlib-table/#usage","title":"Usage","text":"<pre><code>(use \"table\" :as table)\n</code></pre>"},{"location":"spec/21-stdlib-table/#grouping","title":"Grouping","text":""},{"location":"spec/21-stdlib-table/#tablegroup-by","title":"table/group-by","text":"<p>Groups a table by key (equivalent to SQL <code>GROUP BY</code>).</p> <pre><code>;; Group by keyword\n(def products [\n  {:id 1 :name \"Laptop\" :category \"electronics\" :price 1000}\n  {:id 2 :name \"Mouse\" :category \"electronics\" :price 25}\n  {:id 3 :name \"Book\" :category \"books\" :price 15}])\n\n(table/group-by products :category)\n;=&gt; {\"electronics\" [{...}, {...}], \"books\" [{...}]}\n\n;; Group by function (custom logic)\n(table/group-by products\n  (fn [p]\n    (if (&lt; (get p :price) 50)\n      \"cheap\"\n      \"expensive\")))\n;=&gt; {\"cheap\" [{...}, {...}], \"expensive\" [{...}]}\n</code></pre> <p>Parameters: - <code>table</code> - Table data (list of maps or arrays) - <code>key-selector</code> - Keyword (<code>:category</code>) or function</p> <p>Returns: Map in the format <code>{group-key: [rows...], ...}</code></p> <p>Implementation: Wrapper around <code>list/group-by</code></p>"},{"location":"spec/21-stdlib-table/#deduplication","title":"Deduplication","text":""},{"location":"spec/21-stdlib-table/#tabledistinct-table","title":"table/distinct-table","text":"<p>Removes duplicate rows from a table (equivalent to SQL <code>DISTINCT</code>).</p> <pre><code>(def products [\n  {:id 1 :name \"Laptop\" :category \"electronics\" :price 1000}\n  {:id 2 :name \"Mouse\" :category \"electronics\" :price 25}\n  {:id 3 :name \"Laptop\" :category \"electronics\" :price 1000}])  ;; Duplicate\n\n;; Remove duplicates (all columns)\n(table/distinct-table products)\n;=&gt; 3 rows \u2192 2 rows (removes exact matches)\n\n;; Remove duplicates (specific keys)\n(table/distinct-table products :name :price)\n;=&gt; Deduplicate by :name + :price combination\n</code></pre> <p>Parameters: - <code>table</code> - Table data - <code>keys...</code> - Keys to compare (variadic, all columns if omitted)</p> <p>Returns: Deduplicated table</p>"},{"location":"spec/21-stdlib-table/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/21-stdlib-table/#group-by-category-aggregation","title":"Group-by Category Aggregation","text":"<pre><code>(use \"table\" :as table)\n\n(def sales-data [\n  {:date \"2024-01-01\" :category \"electronics\" :amount 1000}\n  {:date \"2024-01-01\" :category \"books\" :amount 200}\n  {:date \"2024-01-02\" :category \"electronics\" :amount 1500}\n  {:date \"2024-01-02\" :category \"books\" :amount 300}])\n\n;; Group by category\n(def by-category (table/group-by sales-data :category))\n;=&gt; {\"electronics\" [2 items], \"books\" [2 items]}\n\n;; Aggregate each group\n(def electronics-items (get by-category \"String(\\\"electronics\\\")\"))\n(def total (reduce (fn [sum item] (+ sum (get item :amount))) 0 electronics-items))\n(println f\"Total: {total}\")\n;=&gt; Total: 2500\n</code></pre>"},{"location":"spec/21-stdlib-table/#data-cleaning","title":"Data Cleaning","text":"<pre><code>;; Remove duplicates from CSV data\n(def raw-data (csv/read-file \"users.csv\"))\n(def cleaned (table/distinct-table raw-data :email))\n(println f\"Deduplicated: {(len raw-data)} \u2192 {(len cleaned)} records\")\n</code></pre>"},{"location":"spec/21-stdlib-table/#combined-with-pipelines","title":"Combined with Pipelines","text":"<pre><code>(sales-data\n |&gt; (fn [data] (table/group-by data :date))\n |&gt; (fn [grouped] (println f\"By date: {(len (keys grouped))} days\")))\n</code></pre>"},{"location":"spec/21-stdlib-table/#use-cases","title":"Use Cases","text":"<ol> <li> <p>Aggregate CSV or JSON data <pre><code>(def data (csv/read-file \"sales.csv\"))\n(table/group-by data :date)\n</code></pre></p> </li> <li> <p>Post-process database results <pre><code>(def results (db/query conn \"SELECT * FROM orders\"))\n(table/group-by results :customer_id)\n</code></pre></p> </li> <li> <p>Analyze log files <pre><code>(def logs (json/parse (io/read-file \"app.log\")))\n(table/group-by logs :level)  ;; Aggregate by ERROR, WARN, INFO\n</code></pre></p> </li> <li> <p>Clean duplicate data <pre><code>(def cleaned (table/distinct-table data :email))\n</code></pre></p> </li> <li> <p>awk/SQL-like data manipulation</p> </li> <li>Achieve SQL <code>GROUP BY</code> and <code>DISTINCT</code> operations in Qi</li> </ol>"},{"location":"spec/21-stdlib-table/#function-list","title":"Function List","text":"Function Description SQL Equivalent <code>table/group-by</code> Group by key <code>GROUP BY</code> <code>table/distinct-table</code> Remove duplicates <code>DISTINCT</code>"},{"location":"spec/21-stdlib-table/#references","title":"References","text":"<ul> <li>Sample Code: <code>examples/23-table-processing.qi</code></li> <li>Implementation: <code>std/lib/table.qi</code></li> <li>Related Functions:</li> <li><code>list/group-by</code> - Base grouping function</li> <li><code>distinct</code> - Deduplication (all elements)</li> <li><code>filter</code> - Conditional filtering (SQL <code>WHERE</code> equivalent)</li> <li><code>map</code> - Projection (SQL <code>SELECT</code> equivalent)</li> <li><code>reduce</code> - Aggregation (SQL <code>SUM</code>, <code>AVG</code> equivalent)</li> </ul>"},{"location":"spec/21-stdlib-table/#future-extensions","title":"Future Extensions","text":"<p>Phase 2 and beyond may include:</p> <ul> <li><code>table/select</code> - Column selection (projection)</li> <li><code>table/where</code> - Conditional filtering</li> <li><code>table/order-by</code> - Sorting</li> <li><code>table/join</code> - Table joins</li> <li><code>table/aggregate</code> - Aggregation functions (sum, avg, count, etc.)</li> <li><code>table/pivot</code> - Pivot tables</li> </ul> <p>The current implementation is Phase 1, providing only the most frequently used functions: <code>group-by</code> and <code>distinct-table</code>.</p>"},{"location":"spec/22-stdlib-csv/","title":"Standard Library - CSV Processing (csv/)","text":"<p>RFC 4180 Compliant CSV Processing Library</p> <p>All functions belong to the <code>csv/</code> module.</p>"},{"location":"spec/22-stdlib-csv/#parsing","title":"Parsing","text":""},{"location":"spec/22-stdlib-csv/#csvparse","title":"csv/parse","text":"<p>Parses a CSV string into a list of lists (<code>[[string]]</code>).</p> <pre><code>;; Basic usage\n(def csv-text \"name,age,city\nAlice,30,Tokyo\nBob,25,Osaka\")\n\n(csv/parse csv-text)\n;=&gt; [[\"name\" \"age\" \"city\"]\n;    [\"Alice\" \"30\" \"Tokyo\"]\n;    [\"Bob\" \"25\" \"Osaka\"]]\n\n;; Custom delimiter (TSV)\n(def tsv-text \"name\\tage\\tcity\nAlice\\t30\\tTokyo\")\n\n(csv/parse tsv-text :delimiter \"\\t\")\n;=&gt; [[\"name\" \"age\" \"city\"]\n;    [\"Alice\" \"30\" \"Tokyo\"]]\n\n;; Quoted fields (RFC 4180 compliant)\n(def quoted-csv \"name,description\n\\\"Alice, Bob\\\",\\\"She said \\\"\\\"hello\\\"\\\"\\\"\")\n\n(csv/parse quoted-csv)\n;=&gt; [[\"name\" \"description\"]\n;    [\"Alice, Bob\" \"She said \\\"hello\\\"\"]]\n</code></pre> <p>Arguments: - <code>text</code> - CSV formatted string - <code>:delimiter</code> - Optional. Delimiter character (default: <code>\",\"</code>). Must be a single character</p> <p>Returns: List of lists (<code>[[string]]</code>)</p> <p>RFC 4180 Compliant Features: - Double-quote field enclosing - <code>\"\"</code> escape sequence inside quotes - CRLF / LF newline support - Preserves newlines, commas, and quotes inside quoted fields</p>"},{"location":"spec/22-stdlib-csv/#serialization","title":"Serialization","text":""},{"location":"spec/22-stdlib-csv/#csvstringify","title":"csv/stringify","text":"<p>Converts a list of lists (or vector of vectors) into a CSV string.</p> <pre><code>;; Basic usage\n(def data [\n  [\"name\" \"age\" \"city\"]\n  [\"Alice\" 30 \"Tokyo\"]\n  [\"Bob\" 25 \"Osaka\"]])\n\n(csv/stringify data)\n;=&gt; \"name,age,city\n;    Alice,30,Tokyo\n;    Bob,25,Osaka\"\n\n;; Supports various types\n(def mixed-data [\n  [\"string\" \"number\" \"float\" \"bool\" \"nil\"]\n  [\"text\" 123 3.14 true nil]])\n\n(csv/stringify mixed-data)\n;=&gt; \"string,number,float,bool,nil\n;    text,123,3.14,true,\"\n\n;; Special characters (auto-quoting)\n(def special-data [\n  [\"name\" \"description\"]\n  [\"Alice, Bob\" \"She said \\\"hello\\\"\"]])\n\n(csv/stringify special-data)\n;=&gt; \"name,description\n;    \\\"Alice, Bob\\\",\\\"She said \\\"\\\"hello\\\"\\\"\\\"\"\n</code></pre> <p>Arguments: - <code>data</code> - List of lists or vector of vectors</p> <p>Returns: CSV formatted string</p> <p>Supported Types: - <code>String</code> - Output as-is - <code>Integer</code> - Converted to string - <code>Float</code> - Converted to string - <code>Bool</code> - <code>\"true\"</code> / <code>\"false\"</code> - <code>Nil</code> - Empty string</p> <p>Auto-quoting: Fields containing the following are automatically enclosed in double quotes: - Comma (<code>,</code>) - Double quote (<code>\"</code>) - Newline (<code>\\n</code>, <code>\\r</code>)</p>"},{"location":"spec/22-stdlib-csv/#file-reading","title":"File Reading","text":""},{"location":"spec/22-stdlib-csv/#csvread-file","title":"csv/read-file","text":"<p>Reads and parses a CSV file.</p> <pre><code>;; Read from file\n(def data (csv/read-file \"users.csv\"))\n\n;; Separate headers and data\n(def headers (first data))\n(def rows (rest data))\n\n(println f\"Columns: {(join \\\", \\\" headers)}\")\n(println f\"Rows: {(len rows)}\")\n</code></pre> <p>Arguments: - <code>path</code> - CSV file path (string)</p> <p>Returns: List of lists (<code>[[string]]</code>)</p> <p>Error: Throws error if file doesn't exist or cannot be read</p>"},{"location":"spec/22-stdlib-csv/#csvread-stream","title":"csv/read-stream","text":"<p>Reads a large CSV file as a stream. Processes rows one-by-one in a memory-efficient manner.</p> <pre><code>;; Process large file with stream\n(def stream (csv/read-stream \"large-data.csv\"))\n\n;; Skip header\n(def header (stream/next stream))\n(println f\"Columns: {(join \\\", \\\" header)}\")\n\n;; Process row by row\n(stream/for-each stream\n  (fn [row]\n    (println f\"Processing: {(first row)}\")))\n\n;; Pipeline processing\n(csv/read-stream \"sales.csv\")\n |&gt; (stream/drop 1)  ;; Skip header\n |&gt; (stream/filter (fn [row] (&gt; (parse-int (nth row 2)) 1000)))\n |&gt; (stream/take 10)\n |&gt; stream/to-list\n</code></pre> <p>Arguments: - <code>path</code> - CSV file path (string)</p> <p>Returns: Stream (each element is a list)</p> <p>Use Cases: - Processing large CSV files (tens of MB to GB) - Memory-efficient row-by-row processing - Filtering and transformation via pipelines</p>"},{"location":"spec/22-stdlib-csv/#file-writing","title":"File Writing","text":""},{"location":"spec/22-stdlib-csv/#csvwrite-file","title":"csv/write-file","text":"<p>Writes data to a CSV file. Pipeline-friendly.</p> <pre><code>;; Direct write\n(def data [\n  [\"name\" \"age\" \"city\"]\n  [\"Alice\" 30 \"Tokyo\"]\n  [\"Bob\" 25 \"Osaka\"]])\n\n(csv/write-file data \"output.csv\")\n\n;; Use in pipeline\n(data\n |&gt; (map (fn [row] (map str/upper row)))  ;; Uppercase all\n |&gt; (csv/write-file _ \"output-upper.csv\"))\n\n;; Transform and save\n(csv/read-file \"input.csv\")\n |&gt; (filter (fn [row] (!= (first row) \"name\")))  ;; Exclude header\n |&gt; (filter (fn [row] (&gt; (parse-int (nth row 1)) 25)))  ;; age &gt; 25\n |&gt; (csv/write-file _ \"filtered.csv\")\n</code></pre> <p>Arguments: - <code>data</code> - List of lists or vector of vectors - <code>path</code> - Output file path (string)</p> <p>Returns: <code>nil</code></p> <p>Function: Convenience function combining <code>csv/stringify</code> + <code>io/write-file</code></p>"},{"location":"spec/22-stdlib-csv/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/22-stdlib-csv/#reading-and-transforming-csv-files","title":"Reading and Transforming CSV Files","text":"<pre><code>;; Read CSV and convert to list of maps\n(defn csv-&gt;maps [csv-data]\n  (let [headers (first csv-data)\n        rows (rest csv-data)]\n    (map (fn [row]\n           (zipmap headers row))\n         rows)))\n\n(def users-csv (csv/read-file \"users.csv\"))\n(def users (csv-&gt;maps users-csv))\n;=&gt; [{:name \"Alice\" :age \"30\" :city \"Tokyo\"}\n;    {:name \"Bob\" :age \"25\" :city \"Osaka\"}]\n\n;; Filtering\n(def tokyo-users\n  (filter (fn [u] (= (get u :city) \"Tokyo\"))\n          users))\n</code></pre>"},{"location":"spec/22-stdlib-csv/#data-cleaning-pipeline","title":"Data Cleaning Pipeline","text":"<pre><code>;; Clean CSV data\n(csv/read-file \"raw-data.csv\")\n |&gt; (map (fn [row]\n           (map str/trim row)))  ;; Remove extra whitespace\n |&gt; (filter (fn [row]\n              (not (str/blank? (first row)))))  ;; Exclude empty rows\n |&gt; (fn [data]\n      (let [headers (first data)\n            rows (rest data)]\n        (cons headers\n              (distinct rows))))  ;; Remove duplicate rows\n |&gt; (csv/write-file _ \"cleaned-data.csv\")\n</code></pre>"},{"location":"spec/22-stdlib-csv/#large-file-aggregation","title":"Large File Aggregation","text":"<pre><code>;; Count rows matching condition in 1M+ row CSV file\n(defn count-high-sales [filepath threshold]\n  (let [stream (csv/read-stream filepath)\n        _ (stream/next stream)]  ;; Skip header\n    (stream\n     |&gt; (stream/filter (fn [row]\n                         (&gt; (parse-float (nth row 2)) threshold)))\n     |&gt; stream/count)))\n\n(println f\"High-value sales: {(count-high-sales \\\"sales.csv\\\" 10000)} rows\")\n</code></pre>"},{"location":"spec/22-stdlib-csv/#tsv-processing","title":"TSV Processing","text":"<pre><code>;; Tab-separated values (TSV)\n(def tsv-text (io/read-file \"data.tsv\"))\n(def data (csv/parse tsv-text :delimiter \"\\t\"))\n\n;; Convert to CSV and save\n(csv/write-file data \"data.csv\")\n</code></pre>"},{"location":"spec/22-stdlib-csv/#merging-and-exporting-data","title":"Merging and Exporting Data","text":"<pre><code>;; Merge multiple CSV files\n(defn merge-csv-files [files output]\n  (let [headers (-&gt; files\n                    first\n                    csv/read-file\n                    first)\n        all-rows (files\n                  |&gt; (mapcat (fn [f]\n                               (-&gt; f\n                                   csv/read-file\n                                   rest))))]  ;; Exclude headers from each file\n    (cons headers all-rows)\n     |&gt; (csv/write-file _ output)))\n\n(merge-csv-files [\"jan.csv\" \"feb.csv\" \"mar.csv\"] \"q1-sales.csv\")\n</code></pre>"},{"location":"spec/22-stdlib-csv/#database-import","title":"Database Import","text":"<pre><code>;; Bulk insert CSV data into database\n(defn import-csv-to-db [csv-file table-name conn]\n  (let [data (csv/read-file csv-file)\n        headers (first data)\n        rows (rest data)]\n    (doseq [row rows]\n      (let [values (zipmap (map keyword headers) row)\n            sql (str/format \"INSERT INTO {} VALUES ({})\"\n                           table-name\n                           (join \", \" (repeat (len row) \"?\")))]\n        (db/execute conn sql (vals values))))))\n\n;; Memory-efficient stream import\n(defn stream-import-csv-to-db [csv-file table-name conn]\n  (let [stream (csv/read-stream csv-file)\n        headers (stream/next stream)]  ;; Get headers\n    (stream/for-each stream\n      (fn [row]\n        (let [values (zipmap (map keyword headers) row)]\n          (db/insert conn table-name values))))))\n</code></pre>"},{"location":"spec/22-stdlib-csv/#error-handling","title":"Error Handling","text":"<pre><code>;; File read error handling\n(try\n  (csv/read-file \"data.csv\")\n  (catch e\n    (println f\"CSV read error: {e}\")\n    []))\n\n;; Parse error handling\n(try\n  (csv/parse \"invalid\\ncsv\\ndata\")\n  (catch e\n    (println f\"Parse error: {e}\")\n    []))\n\n;; Write error handling\n(try\n  (csv/write-file data \"/invalid/path/file.csv\")\n  (catch e\n    (println f\"Write error: {e}\")\n    nil))\n</code></pre>"},{"location":"spec/22-stdlib-csv/#performance-guide","title":"Performance Guide","text":""},{"location":"spec/22-stdlib-csv/#small-to-medium-files-10mb","title":"Small to Medium Files (&lt; 10MB)","text":"<pre><code>;; Use csv/read-file (simple)\n(def data (csv/read-file \"data.csv\"))\n(doseq [row data]\n  (process-row row))\n</code></pre>"},{"location":"spec/22-stdlib-csv/#large-files-10mb","title":"Large Files (&gt; 10MB)","text":"<pre><code>;; Use csv/read-stream (memory-efficient)\n(def stream (csv/read-stream \"large-data.csv\"))\n(stream/for-each stream process-row)\n</code></pre>"},{"location":"spec/22-stdlib-csv/#extra-large-files-1gb","title":"Extra Large Files (&gt; 1GB)","text":"<pre><code>;; Stream + pipeline (parallelizable)\n(csv/read-stream \"huge-data.csv\")\n |&gt; (stream/drop 1)  ;; Skip header\n |&gt; (stream/map parse-row)\n |&gt; (stream/filter valid-row?)\n |&gt; (stream/for-each process-row)\n</code></pre>"},{"location":"spec/22-stdlib-csv/#function-reference","title":"Function Reference","text":"Function Description Use Case <code>csv/parse</code> Parse CSV string Parse from text <code>csv/stringify</code> Convert data to CSV string Generate CSV string <code>csv/read-file</code> Read CSV file Small to medium files <code>csv/read-stream</code> Read CSV file as stream Large files <code>csv/write-file</code> Write data to CSV file File output"},{"location":"spec/22-stdlib-csv/#specification-compliance","title":"Specification Compliance","text":"<p>This library is RFC 4180 compliant:</p> <ul> <li>\u2705 CRLF / LF newline support</li> <li>\u2705 Double-quote field enclosing</li> <li>\u2705 <code>\"\"</code> escape for double quotes</li> <li>\u2705 Preserves newlines and commas in quoted fields</li> <li>\u2705 Custom delimiters (TSV, etc.)</li> </ul>"},{"location":"spec/22-stdlib-csv/#references","title":"References","text":"<ul> <li>RFC 4180: Common Format and MIME Type for CSV Files</li> <li>Related Modules:</li> <li><code>io/</code> - File I/O</li> <li><code>str/</code> - String manipulation</li> <li><code>stream/</code> - Stream processing</li> <li><code>table/</code> - Table processing (grouping, aggregation)</li> </ul>"},{"location":"spec/23-stdlib-env/","title":"Standard Library - Environment Variables (env/)","text":"<p>Functions for getting, setting environment variables and loading .env files.</p>"},{"location":"spec/23-stdlib-env/#overview","title":"Overview","text":"<p>The <code>env/</code> module provides the following features:</p> <ul> <li>Environment Variable Retrieval - Read system environment variables</li> <li>Environment Variable Setting - Set environment variables within the process</li> <li>All Environment Variables - Get all environment variables as a map</li> <li>.env File Loading - Bulk set environment variables from dotenv format files</li> </ul>"},{"location":"spec/23-stdlib-env/#getting-environment-variables","title":"Getting Environment Variables","text":""},{"location":"spec/23-stdlib-env/#envget","title":"env/get","text":"<p>Get an environment variable. Optionally return a default value if the variable doesn't exist.</p> <pre><code>(env/get key)\n(env/get key default-value)\n</code></pre> <p>Arguments: - <code>key</code> (string) - Environment variable name - <code>default-value</code> (any, optional) - Return value if variable doesn't exist</p> <p>Return Value: - string - Environment variable value - default-value - If variable doesn't exist and default value is specified - nil - If variable doesn't exist and no default value is specified</p> <p>Examples:</p> <pre><code>;; Get environment variable\n(env/get \"PATH\")\n;; =&gt; \"/usr/local/bin:/usr/bin:/bin\"\n\n;; Non-existent variable (returns nil)\n(env/get \"NONEXISTENT_VAR\")\n;; =&gt; nil\n\n;; Specify default value\n(env/get \"MISSING_VAR\" \"default-value\")\n;; =&gt; \"default-value\"\n\n;; Existing variable (default value is ignored)\n(env/get \"PATH\" \"fallback\")\n;; =&gt; \"/usr/local/bin:/usr/bin:/bin\"\n</code></pre>"},{"location":"spec/23-stdlib-env/#setting-environment-variables","title":"Setting Environment Variables","text":""},{"location":"spec/23-stdlib-env/#envset","title":"env/set","text":"<p>Set an environment variable. Affects the current process and its child processes.</p> <pre><code>(env/set key value)\n</code></pre> <p>Arguments: - <code>key</code> (string) - Environment variable name - <code>value</code> (string | number | boolean) - Value to set (converted to string)</p> <p>Return Value: nil</p> <p>Examples:</p> <pre><code>;; Set string value\n(env/set \"MY_VAR\" \"my-value\")\n(env/get \"MY_VAR\")\n;; =&gt; \"my-value\"\n\n;; Set number (converted to string)\n(env/set \"PORT\" 8080)\n(env/get \"PORT\")\n;; =&gt; \"8080\"\n\n;; Set boolean\n(env/set \"DEBUG\" true)\n(env/get \"DEBUG\")\n;; =&gt; \"true\"\n\n(env/set \"ENABLED\" false)\n(env/get \"ENABLED\")\n;; =&gt; \"false\"\n</code></pre>"},{"location":"spec/23-stdlib-env/#getting-all-environment-variables","title":"Getting All Environment Variables","text":""},{"location":"spec/23-stdlib-env/#envall","title":"env/all","text":"<p>Get all environment variables as a map.</p> <pre><code>(env/all)\n</code></pre> <p>Arguments: none</p> <p>Return Value: map - Keys are variable names, values are variable values</p> <p>Examples:</p> <pre><code>;; Get all environment variables\n(def env-vars (env/all))\n\n;; Get specific variable\n(get env-vars \"HOME\")\n;; =&gt; \"/home/user\"\n\n;; Count environment variables\n(count (env/all))\n;; =&gt; 42\n\n;; Extract variables starting with PATH\n(env/all\n |&gt; keys\n |&gt; (filter (fn [k] (str/starts-with? k \"PATH\"))))\n;; =&gt; [\"PATH\" \"PATHEXT\"]\n</code></pre>"},{"location":"spec/23-stdlib-env/#loading-env-files","title":"Loading .env Files","text":""},{"location":"spec/23-stdlib-env/#envload-dotenv","title":"env/load-dotenv","text":"<p>Load a .env file and set environment variables. Supports dotenv format (<code>KEY=VALUE</code>).</p> <pre><code>(env/load-dotenv)\n(env/load-dotenv path)\n</code></pre> <p>Arguments: - <code>path</code> (string, optional) - Path to .env file (default: \".env\")</p> <p>Return Value: integer - Number of environment variables loaded</p> <p>Examples:</p> <pre><code>;; Load default .env\n(env/load-dotenv)\n;; =&gt; 5\n\n;; Specify custom path\n(env/load-dotenv \".env.local\")\n;; =&gt; 3\n\n;; Development environment settings\n(env/load-dotenv \".env.development\")\n;; =&gt; 8\n</code></pre>"},{"location":"spec/23-stdlib-env/#env-file-format","title":".env File Format","text":"<p><code>.env</code> files support the following format:</p> <pre><code># Comment lines (start with #)\nKEY=VALUE\n\n# Quoted values (double or single quotes)\nDATABASE_URL=\"postgresql://localhost/mydb\"\nAPI_KEY='secret-key-123'\n\n# Unquoted\nPORT=8080\nDEBUG=true\n\n# Whitespace is automatically trimmed\n  TRIM_ME  =  value with spaces\n\n# Empty lines are ignored\n\nNODE_ENV=production\n</code></pre> <p>Supported Features: - \u2705 Basic <code>KEY=VALUE</code> format - \u2705 Comment lines (starting with <code>#</code>) - \u2705 Quoted values (<code>\"...\"</code> or <code>'...'</code>) - \u2705 Automatic trimming of whitespace around keys and values - \u2705 Empty lines ignored</p> <p>Limitations: - \u274c Variable expansion (<code>${VAR}</code> format) not supported - \u274c Multiline values not supported - \u274c Escape sequences (<code>\\n</code>, <code>\\t</code>, etc.) not supported</p>"},{"location":"spec/23-stdlib-env/#usage-examples","title":"Usage Examples","text":""},{"location":"spec/23-stdlib-env/#loading-configuration","title":"Loading Configuration","text":"<pre><code>;; Load .env at application startup\n(defn load-config []\n  (let [count (env/load-dotenv)]\n    (println f\"Loaded {count} environment variables\")\n    {:port (str/parse-int (env/get \"PORT\" \"8080\"))\n     :host (env/get \"HOST\" \"localhost\")\n     :debug (= (env/get \"DEBUG\") \"true\")}))\n\n(def config (load-config))\n;; Loaded 5 environment variables\n;; =&gt; {:port 8080 :host \"localhost\" :debug true}\n</code></pre>"},{"location":"spec/23-stdlib-env/#environment-specific-configuration-files","title":"Environment-specific Configuration Files","text":"<pre><code>;; Load different .env based on NODE_ENV\n(defn load-env-for-node-env []\n  (let [node-env (env/get \"NODE_ENV\" \"development\")\n        env-file (str \".env.\" node-env)]\n    (println f\"Loading {env-file}...\")\n    (env/load-dotenv env-file)))\n\n(load-env-for-node-env)\n</code></pre>"},{"location":"spec/23-stdlib-env/#database-connection-string","title":"Database Connection String","text":"<pre><code>;; Build database configuration from environment variables\n(defn get-db-config []\n  (let [db-url (env/get \"DATABASE_URL\")]\n    (if db-url\n        ;; Use DATABASE_URL if set\n        {:url db-url}\n        ;; Otherwise build from individual variables\n        {:host (env/get \"DB_HOST\" \"localhost\")\n         :port (str/parse-int (env/get \"DB_PORT\" \"5432\"))\n         :database (env/get \"DB_NAME\" \"myapp\")\n         :user (env/get \"DB_USER\" \"postgres\")\n         :password (env/get \"DB_PASSWORD\" \"\")})))\n\n(def db-config (get-db-config))\n</code></pre>"},{"location":"spec/23-stdlib-env/#listing-environment-variables","title":"Listing Environment Variables","text":"<pre><code>;; Display all environment variables formatted\n(defn print-env-vars []\n  (env/all\n   |&gt; (map (fn [[k v]] f\"{k} = {v}\"))\n   |&gt; sort\n   |&gt; (each println)))\n\n(print-env-vars)\n;; HOME = /home/user\n;; PATH = /usr/local/bin:/usr/bin\n;; SHELL = /bin/zsh\n;; ...\n</code></pre>"},{"location":"spec/23-stdlib-env/#security-masking-sensitive-information","title":"Security: Masking Sensitive Information","text":"<pre><code>;; Mask environment variables containing sensitive information\n(def sensitive-keys [\"PASSWORD\" \"SECRET\" \"KEY\" \"TOKEN\"])\n\n(defn mask-value [key value]\n  (if (any? (fn [s] (str/contains? (str/upper key) s)) sensitive-keys)\n      \"********\"\n      value))\n\n(defn print-env-safe []\n  (env/all\n   |&gt; (map (fn [[k v]] [k (mask-value k v)]))\n   |&gt; (each (fn [[k v]] (println f\"{k} = {v}\")))))\n\n(print-env-safe)\n;; API_KEY = ********\n;; DB_PASSWORD = ********\n;; USER = alice\n</code></pre>"},{"location":"spec/23-stdlib-env/#configuration-validation","title":"Configuration Validation","text":"<pre><code>;; Check if required environment variables are set\n(defn validate-env [required-vars]\n  (let [missing (filter (fn [var] (nil? (env/get var))) required-vars)]\n    (if (empty? missing)\n        :ok\n        {:error \"Missing environment variables\" :missing missing})))\n\n(validate-env [\"PORT\" \"DATABASE_URL\" \"API_KEY\"])\n;; =&gt; {:error \"Missing environment variables\" :missing [\"API_KEY\"]}\n</code></pre>"},{"location":"spec/23-stdlib-env/#env-file-backup","title":".env File Backup","text":"<pre><code>;; Save current environment variables to file in .env format\n(defn save-env-to-file [path keys]\n  (let [lines (map (fn [k]\n                     (let [v (env/get k)]\n                       (if v\n                           f\"{k}={v}\"\n                           nil)))\n                   keys)\n        content (join \"\\n\" (filter some? lines))]\n    (io/write path content)))\n\n;; Backup only specific keys\n(save-env-to-file \".env.backup\" [\"PORT\" \"HOST\" \"DEBUG\"])\n</code></pre>"},{"location":"spec/23-stdlib-env/#error-handling","title":"Error Handling","text":""},{"location":"spec/23-stdlib-env/#file-not-found","title":"File Not Found","text":"<pre><code>(try\n  (env/load-dotenv \"nonexistent.env\")\n  :ok\n  (fn [err]\n    (println \"Error:\" err)\n    :error))\n;; Error: Failed to read .env file 'nonexistent.env': No such file or directory\n;; =&gt; :error\n</code></pre>"},{"location":"spec/23-stdlib-env/#invalid-file-format","title":"Invalid File Format","text":"<pre><code>;; If .env file contains lines not in KEY=VALUE format\n;; Error message includes line number and content\n\n;; invalid.env contents:\n;; KEY1=VALUE1\n;; INVALID LINE WITHOUT EQUALS\n;; KEY2=VALUE2\n\n(try\n  (env/load-dotenv \"invalid.env\")\n  :ok\n  (fn [err]\n    (println err)))\n;; Invalid format in .env file at line 2: INVALID LINE WITHOUT EQUALS\n</code></pre>"},{"location":"spec/23-stdlib-env/#performance-and-best-practices","title":"Performance and Best Practices","text":""},{"location":"spec/23-stdlib-env/#load-once-at-startup","title":"Load Once at Startup","text":"<pre><code>;; \u274c Bad: Load on every request\n(defn handle-request [req]\n  (env/load-dotenv)  ;; File I/O every time\n  (let [api-key (env/get \"API_KEY\")]\n    ...))\n\n;; \u2705 Good: Load once at startup\n(env/load-dotenv)\n\n(defn handle-request [req]\n  (let [api-key (env/get \"API_KEY\")]  ;; Get from memory\n    ...))\n</code></pre>"},{"location":"spec/23-stdlib-env/#cache-in-configuration-object","title":"Cache in Configuration Object","text":"<pre><code>;; \u2705 Load and cache configuration at startup\n(env/load-dotenv)\n\n(def config\n  {:port (str/parse-int (env/get \"PORT\" \"8080\"))\n   :host (env/get \"HOST\" \"localhost\")\n   :db-url (env/get \"DATABASE_URL\")\n   :api-key (env/get \"API_KEY\")})\n\n;; Use config afterwards (wrapped in comment)\n(comment\n  (defn start-server []\n    (http/serve (get config :port) (get config :host) handler)))\n</code></pre>"},{"location":"spec/23-stdlib-env/#setting-default-values","title":"Setting Default Values","text":"<pre><code>;; \u274c Bad: Repeated nil checks\n(let [port (env/get \"PORT\")]\n  (if (nil? port)\n      8080\n      (str/parse-int port)))\n\n;; \u2705 Good: Specify default value in env/get\n(str/parse-int (env/get \"PORT\" \"8080\"))\n</code></pre>"},{"location":"spec/23-stdlib-env/#related-topics","title":"Related Topics","text":"<ul> <li>File I/O - File reading and writing</li> <li>String Manipulation - Parsing environment variables</li> <li>Error Handling - Error handling with try/catch</li> <li>Module System - Configuration management</li> </ul>"},{"location":"spec/24-stdlib-kvs/","title":"KVS (Key-Value Store)","text":"<p>Redis Unified Interface - Caching, Session Management, Queues</p> <p>Qi provides unified access to key-value stores. Currently supports Redis with future support planned for Memcached and other backends.</p>"},{"location":"spec/24-stdlib-kvs/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Overview</li> <li>Unified Interface Design</li> <li>kvs/connect - Connection</li> <li>Basic Operations</li> <li>Numeric Operations</li> <li>List Operations</li> <li>Hash Operations</li> <li>Set Operations</li> <li>Batch Operations</li> <li>Practical Examples</li> <li>Error Handling</li> <li>Performance</li> <li>Implementation Details</li> </ul>"},{"location":"spec/24-stdlib-kvs/#overview","title":"Overview","text":""},{"location":"spec/24-stdlib-kvs/#provided-features","title":"Provided Features","text":"<p>Supported Backends: - Redis: Caching, session management, queues, Pub/Sub   - Unified interface (<code>kvs/*</code>)   - Basic operations (get/set/del)   - Numeric operations (incr/decr)   - Data structures (lists, hashes, sets)   - Batch operations (mget/mset)   - Expiration (expire/ttl)</p> <p>Benefits of Unified Interface: - Backend auto-detection (URL parsing) - Backend-agnostic switching (only connection URL changes) - Simple and consistent API - Future extensibility (Memcached, in-memory KVS, etc.)</p>"},{"location":"spec/24-stdlib-kvs/#feature-flag","title":"Feature Flag","text":"<pre><code># Cargo.toml\nfeatures = [\"kvs-redis\"]\n</code></pre> <p>Enabled by default.</p>"},{"location":"spec/24-stdlib-kvs/#dependencies","title":"Dependencies","text":"<ul> <li>redis (v0.27) - Pure Rust Redis client</li> <li>tokio - Async runtime</li> <li>dashmap - Connection pool (thread-safe HashMap)</li> </ul>"},{"location":"spec/24-stdlib-kvs/#unified-interface-design","title":"Unified Interface Design","text":"<p>Like <code>db/connect</code> for databases, KVS backends are handled transparently.</p> <pre><code>;; Backend auto-detected from URL\n(def kvs (kvs/connect \"redis://localhost:6379\"))\n\n;; Code is backend-agnostic\n(kvs/set kvs \"key\" \"value\")\n(kvs/get kvs \"key\")\n\n;; To change backend, only update connection URL\n;; (def kvs (kvs/connect \"memcached://localhost:11211\"))  ;; Future support\n</code></pre> <p>Design Principles: - Unified Interface: Only <code>kvs/*</code> functions are public - Private Specific Functions: <code>kvs/redis-*</code> for internal drivers only - Extensibility: Add specific functions only when unified interface cannot express functionality (Redis Pub/Sub, etc.)</p>"},{"location":"spec/24-stdlib-kvs/#kvsconnect-connection","title":"kvs/connect - Connection","text":"<p>Connects to KVS and returns a connection object.</p> <pre><code>(kvs/connect url)\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#arguments","title":"Arguments","text":"<ul> <li><code>url</code>: String (connection URL)</li> <li>Redis: <code>\"redis://localhost:6379\"</code></li> <li>Redis (with auth): <code>\"redis://:password@localhost:6379\"</code></li> <li>Memcached: <code>\"memcached://localhost:11211\"</code> (future support)</li> </ul>"},{"location":"spec/24-stdlib-kvs/#return-value","title":"Return Value","text":"<ul> <li>Connection ID (string) - Format: <code>\"KvsConnection:kvs:1\"</code></li> <li>Error case: <code>{:error \"message\"}</code></li> </ul>"},{"location":"spec/24-stdlib-kvs/#usage-examples","title":"Usage Examples","text":"<pre><code>;; Redis connection\n(def kvs (kvs/connect \"redis://localhost:6379\"))\n;; =&gt; \"KvsConnection:kvs:1\"\n\n;; Redis with authentication\n(def kvs (kvs/connect \"redis://:my-secret-password@localhost:6379\"))\n\n;; Connection error\n(def kvs (kvs/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported KVS URL: invalid-url\"}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#connection-management","title":"Connection Management","text":"<ul> <li>Automatic connection pool: Multiple connections to same URL are shared internally</li> <li>Automatic reconnection: Automatically retries on connection failure</li> <li>Thread-safe: Safe concurrent access from multiple threads</li> </ul>"},{"location":"spec/24-stdlib-kvs/#basic-operations","title":"Basic Operations","text":""},{"location":"spec/24-stdlib-kvs/#kvsset-set-value","title":"kvs/set - Set Value","text":"<p>Set a value for a key.</p> <pre><code>(kvs/set conn key value)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID (returned from <code>kvs/connect</code>) - <code>key</code>: Key name (string) - <code>value</code>: Value (string, integer, float, boolean)</p> <p>Return Value: - <code>\"OK\"</code> (success) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/set kvs \"user:1\" \"Alice\")\n;; =&gt; \"OK\"\n\n(kvs/set kvs \"counter\" 42)\n;; =&gt; \"OK\"\n\n(kvs/set kvs \"ratio\" 3.14)\n;; =&gt; \"OK\"\n\n(kvs/set kvs \"active\" true)\n;; =&gt; \"OK\"\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvsget-get-value","title":"kvs/get - Get Value","text":"<p>Get the value of a key.</p> <pre><code>(kvs/get conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string)</p> <p>Return Value: - Value (string) - if key exists - <code>nil</code> - if key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/get kvs \"user:1\")\n;; =&gt; \"Alice\"\n\n(kvs/get kvs \"nonexistent\")\n;; =&gt; nil\n\n;; Error handling\n(def value (kvs/get kvs \"user:1\"))\n(if (nil? value)\n  (println \"Key not found\")\n  (println \"Value:\" value))\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvsdel-delete-key","title":"kvs/del - Delete Key","text":"<p>Delete a key (function name is <code>kvs/delete</code>).</p> <pre><code>(kvs/del conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string)</p> <p>Return Value: - Number of keys deleted (integer) - usually <code>1</code>, <code>0</code> if key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/del kvs \"user:1\")\n;; =&gt; 1  ;; Deleted successfully\n\n(kvs/del kvs \"nonexistent\")\n;; =&gt; 0  ;; Nothing to delete\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvsexists-check-existence","title":"kvs/exists - Check Existence","text":"<p>Check if a key exists (function name is <code>kvs/exists?</code>).</p> <pre><code>(kvs/exists conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string)</p> <p>Return Value: - <code>true</code> - key exists - <code>false</code> - key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/set kvs \"user:1\" \"Alice\")\n(kvs/exists kvs \"user:1\")\n;; =&gt; true\n\n(kvs/exists kvs \"nonexistent\")\n;; =&gt; false\n\n;; Conditional logic\n(if (kvs/exists kvs \"cache:data\")\n  (kvs/get kvs \"cache:data\")\n  (do\n    (def data (fetch-from-db))\n    (kvs/set kvs \"cache:data\" data)\n    data))\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvskeys-pattern-match","title":"kvs/keys - Pattern Match","text":"<p>Get list of keys matching a pattern.</p> <pre><code>(kvs/keys conn pattern)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>pattern</code>: Pattern string   - <code>*</code> - any string   - <code>?</code> - single character   - Examples: <code>\"user:*\"</code>, <code>\"cache:2025-*\"</code>, <code>\"session:???\"</code></p> <p>Return Value: - Vector of key names - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/set kvs \"user:1\" \"Alice\")\n(kvs/set kvs \"user:2\" \"Bob\")\n(kvs/set kvs \"user:3\" \"Charlie\")\n\n(kvs/keys kvs \"user:*\")\n;; =&gt; [\"user:1\" \"user:2\" \"user:3\"]\n\n(kvs/keys kvs \"user:?\")\n;; =&gt; [\"user:1\" \"user:2\" \"user:3\"]\n\n(kvs/keys kvs \"cache:*\")\n;; =&gt; []  ;; No matches\n</code></pre></p> <p>Warning: In production with many keys, <code>kvs/keys</code> is a blocking operation that can impact performance. Consider using SCAN commands (future implementation) instead.</p>"},{"location":"spec/24-stdlib-kvs/#kvsexpire-set-expiration","title":"kvs/expire - Set Expiration","text":"<p>Set expiration time for a key (in seconds).</p> <pre><code>(kvs/expire conn key seconds)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string) - <code>seconds</code>: Expiration time (integer, seconds)</p> <p>Return Value: - <code>true</code> - expiration set successfully - <code>false</code> - key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>;; Session with 30-minute expiration\n(kvs/set kvs \"session:abc123\" \"user-data\")\n(kvs/expire kvs \"session:abc123\" 1800)  ;; 30 minutes = 1800 seconds\n;; =&gt; true\n\n;; 1-hour expiration\n(kvs/expire kvs \"cache:data\" 3600)\n;; =&gt; true\n\n;; Non-existent key\n(kvs/expire kvs \"nonexistent\" 60)\n;; =&gt; false\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvsttl-get-remaining-time","title":"kvs/ttl - Get Remaining Time","text":"<p>Get remaining expiration time for a key (in seconds).</p> <pre><code>(kvs/ttl conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string)</p> <p>Return Value: - Remaining seconds (integer) - if expiration is set - <code>-1</code> - key exists but no expiration - <code>-2</code> - key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/set kvs \"session:abc\" \"data\")\n(kvs/expire kvs \"session:abc\" 3600)\n\n(kvs/ttl kvs \"session:abc\")\n;; =&gt; 3599  ;; About 1 hour remaining\n\n;; No expiration\n(kvs/set kvs \"permanent\" \"data\")\n(kvs/ttl kvs \"permanent\")\n;; =&gt; -1\n\n;; Non-existent key\n(kvs/ttl kvs \"nonexistent\")\n;; =&gt; -2\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#numeric-operations","title":"Numeric Operations","text":""},{"location":"spec/24-stdlib-kvs/#kvsincr-increment","title":"kvs/incr - Increment","text":"<p>Increment a key's value by 1. Starts from 0 if key doesn't exist.</p> <pre><code>(kvs/incr conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string)</p> <p>Return Value: - Value after increment (integer) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>;; First time (starts from 0)\n(kvs/incr kvs \"page-views\")\n;; =&gt; 1\n\n(kvs/incr kvs \"page-views\")\n;; =&gt; 2\n\n(kvs/incr kvs \"page-views\")\n;; =&gt; 3\n\n;; Increment from existing value\n(kvs/set kvs \"counter\" 100)\n(kvs/incr kvs \"counter\")\n;; =&gt; 101\n</code></pre></p> <p>Use Cases: Page view counters, user ID generators, rate limiting, etc.</p>"},{"location":"spec/24-stdlib-kvs/#kvsdecr-decrement","title":"kvs/decr - Decrement","text":"<p>Decrement a key's value by 1. Starts from 0 if key doesn't exist.</p> <pre><code>(kvs/decr conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Key name (string)</p> <p>Return Value: - Value after decrement (integer) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/set kvs \"stock\" 10)\n(kvs/decr kvs \"stock\")\n;; =&gt; 9\n\n(kvs/decr kvs \"stock\")\n;; =&gt; 8\n\n;; First time (starts from 0)\n(kvs/decr kvs \"countdown\")\n;; =&gt; -1\n</code></pre></p> <p>Use Cases: Inventory management, countdown timers, etc.</p>"},{"location":"spec/24-stdlib-kvs/#list-operations","title":"List Operations","text":"<p>Redis lists act as double-ended queues (deque). They can be used for both FIFO (queue) and LIFO (stack) operations.</p>"},{"location":"spec/24-stdlib-kvs/#kvslpush-add-to-left","title":"kvs/lpush - Add to Left","text":"<p>Add element to the left (head) of a list.</p> <pre><code>(kvs/lpush conn key value)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: List key name (string) - <code>value</code>: Value to add (string, integer, float, boolean)</p> <p>Return Value: - List length (integer) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/lpush kvs \"mylist\" \"first\")\n;; =&gt; 1\n\n(kvs/lpush kvs \"mylist\" \"second\")\n;; =&gt; 2\n\n;; Result: [\"second\" \"first\"]\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvsrpush-add-to-right","title":"kvs/rpush - Add to Right","text":"<p>Add element to the right (tail) of a list.</p> <pre><code>(kvs/rpush conn key value)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: List key name (string) - <code>value</code>: Value to add (string, integer, float, boolean)</p> <p>Return Value: - List length (integer) - <code>{:error \"message\"}</code> (failure)</p> <p>Example (Queue - FIFO): <pre><code>;; Add tasks\n(kvs/rpush kvs \"tasks\" \"task1\")\n;; =&gt; 1\n(kvs/rpush kvs \"tasks\" \"task2\")\n;; =&gt; 2\n(kvs/rpush kvs \"tasks\" \"task3\")\n;; =&gt; 3\n\n;; Get tasks (from head)\n(kvs/lpop kvs \"tasks\")  ;; =&gt; \"task1\"\n(kvs/lpop kvs \"tasks\")  ;; =&gt; \"task2\"\n(kvs/lpop kvs \"tasks\")  ;; =&gt; \"task3\"\n</code></pre></p> <p>Example (Stack - LIFO): <pre><code>;; Push elements\n(kvs/lpush kvs \"stack\" \"item1\")\n(kvs/lpush kvs \"stack\" \"item2\")\n(kvs/lpush kvs \"stack\" \"item3\")\n\n;; Pop elements (most recent first)\n(kvs/lpop kvs \"stack\")  ;; =&gt; \"item3\"\n(kvs/lpop kvs \"stack\")  ;; =&gt; \"item2\"\n(kvs/lpop kvs \"stack\")  ;; =&gt; \"item1\"\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvslpop-get-from-left","title":"kvs/lpop - Get from Left","text":"<p>Get and remove element from the left (head) of a list.</p> <pre><code>(kvs/lpop conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: List key name (string)</p> <p>Return Value: - Retrieved value (string) - <code>nil</code> - list is empty or key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/rpush kvs \"queue\" \"task1\")\n(kvs/rpush kvs \"queue\" \"task2\")\n\n(kvs/lpop kvs \"queue\")\n;; =&gt; \"task1\"\n\n(kvs/lpop kvs \"queue\")\n;; =&gt; \"task2\"\n\n(kvs/lpop kvs \"queue\")\n;; =&gt; nil  ;; Empty\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvsrpop-get-from-right","title":"kvs/rpop - Get from Right","text":"<p>Get and remove element from the right (tail) of a list.</p> <pre><code>(kvs/rpop conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: List key name (string)</p> <p>Return Value: - Retrieved value (string) - <code>nil</code> - list is empty or key doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/lpush kvs \"stack\" \"a\")\n(kvs/lpush kvs \"stack\" \"b\")\n(kvs/lpush kvs \"stack\" \"c\")\n\n(kvs/rpop kvs \"stack\")\n;; =&gt; \"a\"  ;; First element added\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvslrange-get-range","title":"kvs/lrange - Get Range","text":"<p>Get elements in specified range from a list.</p> <pre><code>(kvs/lrange conn key start stop)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: List key name (string) - <code>start</code>: Start index (integer, 0-based) - <code>stop</code>: End index (integer, -1 for end)</p> <p>Return Value: - Vector of elements - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/rpush kvs \"mylist\" \"a\")\n(kvs/rpush kvs \"mylist\" \"b\")\n(kvs/rpush kvs \"mylist\" \"c\")\n(kvs/rpush kvs \"mylist\" \"d\")\n(kvs/rpush kvs \"mylist\" \"e\")\n\n;; Get all elements\n(kvs/lrange kvs \"mylist\" 0 -1)\n;; =&gt; [\"a\" \"b\" \"c\" \"d\" \"e\"]\n\n;; First 3 elements\n(kvs/lrange kvs \"mylist\" 0 2)\n;; =&gt; [\"a\" \"b\" \"c\"]\n\n;; Elements 2 to 4\n(kvs/lrange kvs \"mylist\" 1 3)\n;; =&gt; [\"b\" \"c\" \"d\"]\n\n;; Last 2 elements\n(kvs/lrange kvs \"mylist\" -2 -1)\n;; =&gt; [\"d\" \"e\"]\n</code></pre></p> <p>Use Cases: Pagination, history display, latest N items, etc.</p>"},{"location":"spec/24-stdlib-kvs/#hash-operations","title":"Hash Operations","text":"<p>Redis hashes are maps with field-value pairs. Suitable for storing structured data like user information, configuration values, etc.</p>"},{"location":"spec/24-stdlib-kvs/#kvshset-set-field","title":"kvs/hset - Set Field","text":"<p>Set a field value in a hash.</p> <pre><code>(kvs/hset conn key field value)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Hash key name (string) - <code>field</code>: Field name (string) - <code>value</code>: Value (string, integer, float, boolean)</p> <p>Return Value: - <code>true</code> - created new field - <code>false</code> - updated existing field - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>;; Store user information\n(kvs/hset kvs \"user:1\" \"name\" \"Alice\")\n;; =&gt; true  ;; New field\n\n(kvs/hset kvs \"user:1\" \"email\" \"alice@example.com\")\n;; =&gt; true\n\n(kvs/hset kvs \"user:1\" \"age\" 30)\n;; =&gt; true\n\n;; Update existing field\n(kvs/hset kvs \"user:1\" \"name\" \"Alice Smith\")\n;; =&gt; false  ;; Updated\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvshget-get-field","title":"kvs/hget - Get Field","text":"<p>Get a field value from a hash.</p> <pre><code>(kvs/hget conn key field)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Hash key name (string) - <code>field</code>: Field name (string)</p> <p>Return Value: - Value (string) - <code>nil</code> - field doesn't exist - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/hset kvs \"user:1\" \"name\" \"Alice\")\n(kvs/hset kvs \"user:1\" \"email\" \"alice@example.com\")\n\n(kvs/hget kvs \"user:1\" \"name\")\n;; =&gt; \"Alice\"\n\n(kvs/hget kvs \"user:1\" \"email\")\n;; =&gt; \"alice@example.com\"\n\n(kvs/hget kvs \"user:1\" \"nonexistent\")\n;; =&gt; nil\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvshgetall-get-all-hash","title":"kvs/hgetall - Get All Hash","text":"<p>Get all fields and values from a hash.</p> <pre><code>(kvs/hgetall conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Hash key name (string)</p> <p>Return Value: - Map (field-value pairs) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/hset kvs \"user:1\" \"name\" \"Alice\")\n(kvs/hset kvs \"user:1\" \"email\" \"alice@example.com\")\n(kvs/hset kvs \"user:1\" \"age\" \"30\")\n\n(kvs/hgetall kvs \"user:1\")\n;; =&gt; {\"name\" \"Alice\" \"email\" \"alice@example.com\" \"age\" \"30\"}\n\n;; Map operations\n(def user (kvs/hgetall kvs \"user:1\"))\n(get user \"name\")\n;; =&gt; \"Alice\"\n</code></pre></p> <p>Warning: For hashes with many fields, this can impact performance. Consider using <code>kvs/hget</code> to retrieve only needed fields.</p>"},{"location":"spec/24-stdlib-kvs/#set-operations","title":"Set Operations","text":"<p>Redis sets are collections of unique strings. Suitable for tags, unique value management, etc.</p>"},{"location":"spec/24-stdlib-kvs/#kvssadd-add-member","title":"kvs/sadd - Add Member","text":"<p>Add a member to a set.</p> <pre><code>(kvs/sadd conn key member)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Set key name (string) - <code>member</code>: Member (string, integer, float, boolean)</p> <p>Return Value: - Number of members added (integer) - usually <code>1</code>, <code>0</code> if already exists - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/sadd kvs \"tags\" \"redis\")\n;; =&gt; 1  ;; New member\n\n(kvs/sadd kvs \"tags\" \"cache\")\n;; =&gt; 1\n\n(kvs/sadd kvs \"tags\" \"nosql\")\n;; =&gt; 1\n\n;; Existing member\n(kvs/sadd kvs \"tags\" \"redis\")\n;; =&gt; 0  ;; Not added (duplicate)\n</code></pre></p>"},{"location":"spec/24-stdlib-kvs/#kvssmembers-get-all-members","title":"kvs/smembers - Get All Members","text":"<p>Get all members from a set.</p> <pre><code>(kvs/smembers conn key)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>key</code>: Set key name (string)</p> <p>Return Value: - Vector of members (order is undefined) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/sadd kvs \"tags\" \"redis\")\n(kvs/sadd kvs \"tags\" \"cache\")\n(kvs/sadd kvs \"tags\" \"nosql\")\n\n(kvs/smembers kvs \"tags\")\n;; =&gt; [\"redis\" \"cache\" \"nosql\"]  ;; Order is undefined\n\n;; Empty set\n(kvs/smembers kvs \"nonexistent\")\n;; =&gt; []\n</code></pre></p> <p>Use Cases: Tag lists, user permission lists, unique visitors, etc.</p>"},{"location":"spec/24-stdlib-kvs/#batch-operations","title":"Batch Operations","text":""},{"location":"spec/24-stdlib-kvs/#kvsmget-get-multiple-keys","title":"kvs/mget - Get Multiple Keys","text":"<p>Get values of multiple keys at once.</p> <pre><code>(kvs/mget conn keys)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>keys</code>: Vector of key names</p> <p>Return Value: - Vector of values (nil for non-existent keys) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/set kvs \"key1\" \"value1\")\n(kvs/set kvs \"key2\" \"value2\")\n(kvs/set kvs \"key3\" \"value3\")\n\n(kvs/mget kvs [\"key1\" \"key2\" \"key3\"])\n;; =&gt; [\"value1\" \"value2\" \"value3\"]\n\n(kvs/mget kvs [\"key1\" \"nonexistent\" \"key3\"])\n;; =&gt; [\"value1\" nil \"value3\"]\n\n;; Empty vector\n(kvs/mget kvs [])\n;; =&gt; []\n</code></pre></p> <p>Performance Benefits: - Get multiple keys in one network round trip - Faster than loops</p> <pre><code>;; \u274c Inefficient (3 network round trips)\n(def v1 (kvs/get kvs \"key1\"))\n(def v2 (kvs/get kvs \"key2\"))\n(def v3 (kvs/get kvs \"key3\"))\n\n;; \u2705 Efficient (1 network round trip)\n(def [v1 v2 v3] (kvs/mget kvs [\"key1\" \"key2\" \"key3\"]))\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#kvsmset-set-multiple-keys","title":"kvs/mset - Set Multiple Keys","text":"<p>Set multiple key-value pairs at once.</p> <pre><code>(kvs/mset conn pairs)\n</code></pre> <p>Arguments: - <code>conn</code>: Connection ID - <code>pairs</code>: Map of keys and values</p> <p>Return Value: - <code>\"OK\"</code> (success) - <code>{:error \"message\"}</code> (failure)</p> <p>Examples: <pre><code>(kvs/mset kvs {\"key1\" \"value1\" \"key2\" \"value2\" \"key3\" \"value3\"})\n;; =&gt; \"OK\"\n\n;; Set many keys at once\n(kvs/mset kvs {\n  \"user:1\" \"Alice\"\n  \"user:2\" \"Bob\"\n  \"user:3\" \"Charlie\"\n  \"cache:1\" \"data1\"\n  \"cache:2\" \"data2\"\n})\n;; =&gt; \"OK\"\n</code></pre></p> <p>Performance Benefits: - Set multiple keys in one network round trip - Faster than loops - Executed atomically (all succeed or all fail)</p> <pre><code>;; \u274c Inefficient (3 network round trips)\n(kvs/set kvs \"key1\" \"value1\")\n(kvs/set kvs \"key2\" \"value2\")\n(kvs/set kvs \"key3\" \"value3\")\n\n;; \u2705 Efficient (1 network round trip)\n(kvs/mset kvs {\"key1\" \"value1\" \"key2\" \"value2\" \"key3\" \"value3\"})\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/24-stdlib-kvs/#session-cache","title":"Session Cache","text":"<p>Use KVS for web application session management.</p> <pre><code>(def kvs (kvs/connect \"redis://localhost:6379\"))\n\n;; Create session\n(defn create-session [user-id]\n  (def session-id (str \"session:\" user-id))\n  (def session-data (json/stringify {\n    :user_id user-id\n    :created_at (now)\n    :ip_address \"192.168.1.1\"\n  }))\n  (kvs/set kvs session-id session-data)\n  (kvs/expire kvs session-id 1800)  ;; 30 minute expiration\n  session-id)\n\n;; Get session\n(defn get-session [session-id]\n  (kvs/get kvs session-id)\n  |&gt; (fn [data]\n       (if (nil? data)\n         {:error \"Session not found or expired\"}\n         (json/parse data))))\n\n;; Delete session (logout)\n(defn destroy-session [session-id]\n  (kvs/del kvs session-id))\n\n;; Usage example\n(def sid (create-session 42))\n;; =&gt; \"session:42\"\n\n(get-session sid)\n;; =&gt; {:user_id 42 :created_at \"2025-01-22T10:30:00Z\" :ip_address \"192.168.1.1\"}\n\n;; After 30 minutes\n(get-session sid)\n;; =&gt; {:error \"Session not found or expired\"}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#page-view-counter","title":"Page View Counter","text":"<p>Track web page access counts.</p> <pre><code>;; Track page view\n(defn track-page-view [page-url]\n  (kvs/incr kvs (str \"page-views:\" page-url)))\n\n;; Get page views\n(defn get-page-views [page-url]\n  (def count-str (kvs/get kvs (str \"page-views:\" page-url)))\n  (if (nil? count-str)\n    0\n    (parse-int count-str)))\n\n;; Popular pages ranking\n(defn get-popular-pages []\n  (def keys (kvs/keys kvs \"page-views:*\"))\n  (def counts (kvs/mget kvs keys))\n  (map (fn [key count]\n         {:url (str/replace key \"page-views:\" \"\")\n          :views (parse-int count)})\n       keys counts)\n  |&gt; (sort-by (fn [item] (get item :views)))\n  |&gt; reverse\n  |&gt; (take 10))\n\n;; Usage example\n(track-page-view \"/home\")     ;; =&gt; 1\n(track-page-view \"/home\")     ;; =&gt; 2\n(track-page-view \"/about\")    ;; =&gt; 1\n(track-page-view \"/home\")     ;; =&gt; 3\n\n(get-page-views \"/home\")      ;; =&gt; 3\n(get-page-views \"/about\")     ;; =&gt; 1\n(get-page-views \"/contact\")   ;; =&gt; 0\n\n(get-popular-pages)\n;; =&gt; [{:url \"/home\" :views 3} {:url \"/about\" :views 1}]\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#task-queue-job-queue","title":"Task Queue (Job Queue)","text":"<p>Manage background tasks with a queue.</p> <pre><code>;; Add task\n(defn enqueue-task [task-type task-data]\n  (def task (json/stringify {\n    :type task-type\n    :data task-data\n    :created_at (now)\n  }))\n  (kvs/rpush kvs \"task-queue\" task))\n\n;; Get task\n(defn dequeue-task []\n  (kvs/lpop kvs \"task-queue\")\n  |&gt; (fn [data]\n       (if (nil? data)\n         nil\n         (json/parse data))))\n\n;; Task worker\n(defn process-tasks []\n  (loop []\n    (def task (dequeue-task))\n    (if (nil? task)\n      (do\n        (println \"No tasks, waiting...\")\n        (sleep 1000)  ;; Wait 1 second\n        (recur))\n      (do\n        (println \"Processing task:\" task)\n        (match (get task :type)\n          \"send-email\" -&gt; (send-email (get task :data))\n          \"generate-report\" -&gt; (generate-report (get task :data))\n          _ -&gt; (println \"Unknown task type\"))\n        (recur)))))\n\n;; Usage example\n(enqueue-task \"send-email\" {:to \"user@example.com\" :subject \"Hello\"})\n(enqueue-task \"generate-report\" {:user_id 42})\n\n(dequeue-task)\n;; =&gt; {:type \"send-email\" :data {:to \"user@example.com\" :subject \"Hello\"} :created_at \"...\"}\n\n(dequeue-task)\n;; =&gt; {:type \"generate-report\" :data {:user_id 42} :created_at \"...\"}\n\n(dequeue-task)\n;; =&gt; nil  ;; Queue is empty\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#rate-limiting","title":"Rate Limiting","text":"<p>Implement API rate limiting.</p> <pre><code>;; Rate limit check (max 10 requests per minute)\n(defn check-rate-limit [user-id]\n  (def key (str \"rate-limit:\" user-id))\n  (def count (kvs/incr kvs key))\n\n  ;; Set 1-minute expiration on first access\n  (if (= count 1)\n    (kvs/expire kvs key 60))\n\n  ;; Limit if exceeds 10\n  (if (&gt; count 10)\n    {:allowed false :remaining 0}\n    {:allowed true :remaining (- 10 count)}))\n\n;; Usage example\n(check-rate-limit 42)\n;; =&gt; {:allowed true :remaining 9}\n\n;; After 10 requests\n(check-rate-limit 42)\n;; =&gt; {:allowed true :remaining 0}\n\n;; 11th request\n(check-rate-limit 42)\n;; =&gt; {:allowed false :remaining 0}\n\n;; After 1 minute (TTL expires)\n(check-rate-limit 42)\n;; =&gt; {:allowed true :remaining 9}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#cache-database-query-results","title":"Cache (Database Query Results)","text":"<p>Cache database query results for performance.</p> <pre><code>;; Get user with cache\n(defn get-user-with-cache [user-id]\n  (def cache-key (str \"cache:user:\" user-id))\n\n  ;; Check cache\n  (def cached (kvs/get kvs cache-key))\n  (if (not (nil? cached))\n    (do\n      (println \"Cache hit!\")\n      (json/parse cached))\n    (do\n      (println \"Cache miss, fetching from DB...\")\n      ;; Fetch from DB\n      (def user (db/query db-conn \"SELECT * FROM users WHERE id = $1\" [user-id])\n                 |&gt; first)\n      ;; Save to cache (5 minutes)\n      (kvs/set kvs cache-key (json/stringify user))\n      (kvs/expire kvs cache-key 300)\n      user)))\n\n;; Invalidate cache\n(defn invalidate-user-cache [user-id]\n  (kvs/del kvs (str \"cache:user:\" user-id)))\n\n;; Usage example\n(get-user-with-cache 1)\n;; =&gt; Cache miss, fetching from DB...\n;; =&gt; {:id 1 :name \"Alice\" ...}\n\n(get-user-with-cache 1)\n;; =&gt; Cache hit!\n;; =&gt; {:id 1 :name \"Alice\" ...}\n\n;; Delete cache on user update\n(update-user 1 \"Alice Smith\")\n(invalidate-user-cache 1)\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#error-handling","title":"Error Handling","text":""},{"location":"spec/24-stdlib-kvs/#error-handling_1","title":"Error Handling","text":"<p>KVS functions return raw data on success and <code>{:error \"message\"}</code> on failure.</p> <pre><code>;; Basic error handling\n(def result (kvs/get kvs \"user:1\"))\n(if (error? result)\n  (println \"Error:\" (get result :error))\n  (println \"Value:\" result))\n\n;; Pipeline error handling (short-circuit with |&gt;?)\n(defn get-cached-data [key]\n  (kvs/get kvs key)\n  |&gt;? (fn [data]\n        (if (nil? data)\n          {:error \"Cache miss\"}\n          (json/parse data))))\n\n;; match error handling\n(match (kvs/get kvs \"user:1\")\n  {:error e} -&gt; (println \"KVS error:\" e)\n  nil -&gt; (println \"Key not found\")\n  value -&gt; (println \"Value:\" value))\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#connection-errors","title":"Connection Errors","text":"<pre><code>;; Invalid connection string\n(def kvs (kvs/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported KVS URL: invalid-url\"}\n\n;; Connection timeout\n(def kvs (kvs/connect \"redis://localhost:9999\"))\n;; =&gt; {:error \"Connection error: ...\"}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#operation-errors","title":"Operation Errors","text":"<pre><code>;; Type error (non-string key)\n(kvs/get kvs 123)\n;; =&gt; Error: kvs/get (key) expects strings\n\n;; Invalid argument count\n(kvs/set kvs \"key\")\n;; =&gt; Error: kvs/set expects 3 arguments\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#performance","title":"Performance","text":""},{"location":"spec/24-stdlib-kvs/#connection-pool","title":"Connection Pool","text":"<p>Qi's kvs implementation automatically pools connections. Multiple <code>kvs/connect</code> calls to the same URL share the same connection internally.</p> <pre><code>;; These share the same connection internally\n(def kvs1 (kvs/connect \"redis://localhost:6379\"))\n(def kvs2 (kvs/connect \"redis://localhost:6379\"))\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#automatic-reconnection","title":"Automatic Reconnection","text":"<p>Automatically retries reconnection when connection is lost.</p> <pre><code>// Rust implementation (reference)\nasync fn execute_with_retry&lt;T, F, Fut&gt;(url: &amp;str, operation: F) -&gt; redis::RedisResult&lt;T&gt;\nwhere\n    F: Fn(MultiplexedConnection) -&gt; Fut,\n    Fut: std::future::Future&lt;Output = redis::RedisResult&lt;T&gt;&gt;,\n{\n    // First attempt\n    let conn = get_or_create_connection(url).await?;\n    let result = operation(conn).await;\n\n    // On error, reconnect and retry\n    if let Err(ref e) = result {\n        if is_connection_error(e) {\n            if let Ok(new_conn) = reconnect(url).await {\n                return operation(new_conn).await;\n            }\n        }\n    }\n\n    result\n}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#batch-operations-recommended","title":"Batch Operations Recommended","text":"<p>For multiple keys, use <code>mget</code>/<code>mset</code>.</p> <pre><code>;; \u274c Inefficient (N network round trips)\n(def keys [\"key1\" \"key2\" \"key3\" \"key4\" \"key5\"])\n(map (fn [k] (kvs/get kvs k)) keys)\n\n;; \u2705 Efficient (1 network round trip)\n(kvs/mget kvs [\"key1\" \"key2\" \"key3\" \"key4\" \"key5\"])\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#implementation-details","title":"Implementation Details","text":""},{"location":"spec/24-stdlib-kvs/#unified-interface-design_1","title":"Unified Interface Design","text":"<p>KVS is designed with unified interface pattern. This is the same approach as Go's <code>database/sql</code> package, allowing transparent backend handling.</p> <pre><code>Unified Interface (user-facing):\n- kvs/connect, kvs/get, kvs/set, kvs/del, ...\n\nInternal Drivers (not public):\n- RedisDriver, MemcachedDriver (future)\n</code></pre> <p>Design Principles: - Backend auto-detection: Determine connection from URL (<code>redis://</code>, <code>memcached://</code>, etc.) - Private specific functions: <code>kvs/redis-*</code> for internal drivers only - Extensibility: Add specific functions only when unified interface cannot express functionality (Redis Pub/Sub, Lua scripting, etc.)</p>"},{"location":"spec/24-stdlib-kvs/#driver-pattern","title":"Driver Pattern","text":"<pre><code>// KVS driver trait (unified interface)\npub trait KvsDriver: Send + Sync {\n    fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;String&gt;, String&gt;;\n    fn set(&amp;self, key: &amp;str, value: &amp;str) -&gt; Result&lt;String, String&gt;;\n    fn delete(&amp;self, key: &amp;str) -&gt; Result&lt;i64, String&gt;;\n    fn exists(&amp;self, key: &amp;str) -&gt; Result&lt;bool, String&gt;;\n    fn keys(&amp;self, pattern: &amp;str) -&gt; Result&lt;Vec&lt;String&gt;, String&gt;;\n    fn expire(&amp;self, key: &amp;str, seconds: i64) -&gt; Result&lt;bool, String&gt;;\n    fn ttl(&amp;self, key: &amp;str) -&gt; Result&lt;i64, String&gt;;\n    // ... other methods\n}\n\n// Redis driver (internal implementation)\n#[cfg(feature = \"kvs-redis\")]\nstruct RedisDriver {\n    url: String,\n}\n\nimpl KvsDriver for RedisDriver {\n    fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;String&gt;, String&gt; {\n        crate::builtins::redis::native_redis_get(&amp;[\n            Value::String(self.url.clone()),\n            Value::String(key.to_string()),\n        ])\n        // ... error conversion\n    }\n    // ... other method implementations\n}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#async-processing","title":"Async Processing","text":"<p>Internally uses async APIs, but exposed as sync API to Qi users.</p> <pre><code>// Rust implementation (reference)\nuse tokio::runtime::Runtime;\n\nstatic TOKIO_RT: LazyLock&lt;Runtime&gt; =\n    LazyLock::new(|| Runtime::new().expect(\"Failed to create tokio runtime for Redis\"));\n\npub fn native_redis_get(args: &amp;[Value]) -&gt; Result&lt;Value, String&gt; {\n    // ... argument checking\n\n    // Execute async code synchronously\n    TOKIO_RT.block_on(async {\n        let result = execute_with_retry(url, |mut conn| async move {\n            conn.get(key).await\n        }).await;\n\n        match result {\n            Ok(Some(value)) =&gt; Ok(Value::String(value)),\n            Ok(None) =&gt; Ok(Value::Nil),\n            Err(e) =&gt; Ok(Value::error(format!(\"Get error: {}\", e))),\n        }\n    })\n}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#connection-management_1","title":"Connection Management","text":"<pre><code>use dashmap::DashMap;\nuse redis::aio::MultiplexedConnection;\nuse std::sync::LazyLock;\n\n// Redis connection pool (URL \u2192 Connection mapping)\nstatic REDIS_POOL: LazyLock&lt;DashMap&lt;String, MultiplexedConnection&gt;&gt; =\n    LazyLock::new(DashMap::new);\n\n// Get or create connection\nasync fn get_or_create_connection(url: &amp;str) -&gt; Result&lt;MultiplexedConnection, String&gt; {\n    // Get existing connection\n    if let Some(conn) = REDIS_POOL.get(url) {\n        return Ok(conn.clone());\n    }\n\n    // Create new connection\n    let client = Client::open(url)?;\n    let conn = client.get_multiplexed_async_connection().await?;\n\n    // Save to pool\n    REDIS_POOL.insert(url.to_string(), conn.clone());\n\n    Ok(conn)\n}\n</code></pre>"},{"location":"spec/24-stdlib-kvs/#roadmap","title":"Roadmap","text":""},{"location":"spec/24-stdlib-kvs/#future-features","title":"Future Features","text":"<p>Backend Extensions: - Memcached support: <code>kvs/connect \"memcached://localhost:11211\"</code> - In-memory KVS: <code>kvs/connect \":memory:\"</code> (Pure Rust, no dependencies, for testing)</p> <p>Specific Functions (only when unified interface cannot express): - Redis Pub/Sub: <code>kvs/subscribe</code>, <code>kvs/publish</code> - Redis Lua scripting: <code>kvs/eval</code>, <code>kvs/evalsha</code> - Redis Sorted Sets: <code>kvs/zadd</code>, <code>kvs/zrange</code> - Redis Streams: <code>kvs/xadd</code>, <code>kvs/xread</code> - Redis HyperLogLog: <code>kvs/pfadd</code>, <code>kvs/pfcount</code></p> <p>Performance Optimizations: - Pipelining: Execute multiple commands in one network round trip - Transactions: <code>kvs/multi</code>, <code>kvs/exec</code> - Streaming SCAN: <code>kvs/scan</code> (for large key sets)</p>"},{"location":"spec/24-stdlib-kvs/#summary","title":"Summary","text":"<p>Qi's key-value store library provides simple and safe access through unified interface.</p>"},{"location":"spec/24-stdlib-kvs/#main-features","title":"Main Features","text":"<ul> <li>kvs/connect: Redis auto-connect (Memcached, etc. in future)</li> <li>Basic operations: get/set/del/exists/keys/expire/ttl</li> <li>Numeric operations: incr/decr</li> <li>Lists: lpush/rpush/lpop/rpop/lrange (queues, stacks)</li> <li>Hashes: hset/hget/hgetall (structured data)</li> <li>Sets: sadd/smembers (unique value collections)</li> <li>Batch operations: mget/mset (batch processing)</li> <li>Automatic reconnection: Auto-retry on connection failure</li> <li>Connection pooling: Efficient connection management</li> <li>Backend-agnostic switching: Change only connection URL</li> </ul> <p>By combining these features, you can easily implement caching, session management, task queues, rate limiting, etc.</p>"},{"location":"spec/24-stdlib-kvs/#related-documentation","title":"Related Documentation","text":"<ul> <li>17-stdlib-database.md - Database unified interface</li> <li>11-stdlib-http.md - Using KVS in web applications</li> <li>12-stdlib-json.md - JSON data serialization</li> <li>08-error-handling.md - Error handling patterns</li> </ul>"},{"location":"spec/25-stdlib-log/","title":"Standard Library - Logging (log/)","text":"<p>Structured Logging with Multiple Formats</p> <p>All functions belong to the <code>log/</code> module.</p>"},{"location":"spec/25-stdlib-log/#overview","title":"Overview","text":"<p>The <code>log/</code> module provides:</p> <ul> <li>4 log levels - DEBUG, INFO, WARN, ERROR</li> <li>Structured logging - Add context information with maps</li> <li>Multiple formats - Text and JSON formats</li> <li>Automatic timestamps - ISO8601 format (UTC)</li> <li>Level filtering - Logs below the configured level are not output</li> </ul> <p>All logs are output to standard error (stderr).</p>"},{"location":"spec/25-stdlib-log/#log-levels","title":"Log Levels","text":""},{"location":"spec/25-stdlib-log/#4-levels","title":"4 Levels","text":"<pre><code>;; DEBUG - Debug information (development only)\n(log/debug \"Processing started\")\n\n;; INFO - General information (normal operation logs)\n(log/info \"Server started\")\n\n;; WARN - Warnings (potential issues)\n(log/warn \"Connection timeout\")\n\n;; ERROR - Errors (critical issues)\n(log/error \"Database connection failed\")\n</code></pre>"},{"location":"spec/25-stdlib-log/#level-priority","title":"Level Priority","text":"<pre><code>DEBUG (0) &lt; INFO (1) &lt; WARN (2) &lt; ERROR (3)\n</code></pre> <p>Logs below the configured level are not output.</p> <p>Default: <code>INFO</code> (only INFO and above are output)</p>"},{"location":"spec/25-stdlib-log/#log-output","title":"Log Output","text":""},{"location":"spec/25-stdlib-log/#logdebug","title":"log/debug","text":"<p>Output DEBUG level log. Used for debug information during development.</p> <pre><code>(log/debug message)\n(log/debug message context-map)\n</code></pre> <p>Arguments: - <code>message</code> (string) - Log message - <code>context-map</code> (map, optional) - Context information</p> <p>Returns: nil</p> <p>Examples:</p> <pre><code>;; Simple message\n(log/debug \"Function started\")\n;; [2025-01-15T10:30:45.123+0000] DEBUG Function started\n\n;; With context\n(log/debug \"Variable values\" {:x 10 :y 20})\n;; [2025-01-15T10:30:45.456+0000] DEBUG Variable values | x=10 y=20\n\n;; In a pipeline\n(defn process-data [data]\n  (log/debug \"Data processing started\" {:count (len data)})\n  (data\n   |&gt; (map transform)\n   |&gt; (filter valid?)))\n</code></pre>"},{"location":"spec/25-stdlib-log/#loginfo","title":"log/info","text":"<p>Output INFO level log. Used for normal operation logs.</p> <pre><code>(log/info message)\n(log/info message context-map)\n</code></pre> <p>Arguments: - <code>message</code> (string) - Log message - <code>context-map</code> (map, optional) - Context information</p> <p>Returns: nil</p> <p>Examples:</p> <pre><code>;; Server startup\n(log/info \"HTTP server started\" {:port 8080 :host \"localhost\"})\n;; [2025-01-15T10:30:45.789+0000] INFO HTTP server started | port=8080 host=localhost\n\n;; Request processing\n(defn handle-request [req]\n  (log/info \"Request received\" {:method (get req :method) :path (get req :path)})\n  (process req))\n\n;; Batch processing progress\n(doseq [item items]\n  (log/info \"Processing item\" {:id (get item :id) :status \"processing\"})\n  (process-item item))\n</code></pre>"},{"location":"spec/25-stdlib-log/#logwarn","title":"log/warn","text":"<p>Output WARN level log. Used for potential issues.</p> <pre><code>(log/warn message)\n(log/warn message context-map)\n</code></pre> <p>Arguments: - <code>message</code> (string) - Log message - <code>context-map</code> (map, optional) - Context information</p> <p>Returns: nil</p> <p>Examples:</p> <pre><code>;; Timeout warning\n(log/warn \"Connection timeout\" {:timeout-ms 5000 :retry-count 3})\n;; [2025-01-15T10:30:46.012+0000] WARN Connection timeout | timeout-ms=5000 retry-count=3\n\n;; Retryable errors\n(defn fetch-with-retry [url max-retries]\n  (loop [retries 0]\n    (try\n      (http/get url)\n      (fn [err]\n        (if (&lt; retries max-retries)\n            (do\n              (log/warn \"Request failed, retrying\" {:url url :retry retries :error err})\n              (recur (+ retries 1)))\n            (log/error \"Max retries reached\" {:url url :error err}))))))\n\n;; Deprecated feature usage\n(defn old-api [data]\n  (log/warn \"Deprecated API used\" {:function \"old-api\"})\n  (process-legacy data))\n</code></pre>"},{"location":"spec/25-stdlib-log/#logerror","title":"log/error","text":"<p>Output ERROR level log. Used for critical issues.</p> <pre><code>(log/error message)\n(log/error message context-map)\n</code></pre> <p>Arguments: - <code>message</code> (string) - Log message - <code>context-map</code> (map, optional) - Context information</p> <p>Returns: nil</p> <p>Examples:</p> <pre><code>;; Database connection error\n(log/error \"Database connection failed\" {:error \"connection refused\" :host \"localhost\"})\n;; [2025-01-15T10:30:46.345+0000] ERROR Database connection failed | error=connection refused host=localhost\n\n;; Error handling\n(try\n  (db/connect db-config)\n  (fn [err]\n    (log/error \"DB connection error\" {:config db-config :error (str err)})\n    (exit 1)))\n\n;; Validation error\n(defn validate-user [user]\n  (if (not (get user :email))\n      (do\n        (log/error \"Validation error\" {:field \"email\" :user-id (get user :id)})\n        false)\n      true))\n</code></pre>"},{"location":"spec/25-stdlib-log/#configuration","title":"Configuration","text":""},{"location":"spec/25-stdlib-log/#logset-level","title":"log/set-level","text":"<p>Set the log level. Logs below this level will not be output.</p> <pre><code>(log/set-level level-string)\n</code></pre> <p>Arguments: - <code>level-string</code> (string) - Log level (<code>\"debug\"</code>, <code>\"info\"</code>, <code>\"warn\"</code>, <code>\"error\"</code>)</p> <p>Returns: nil</p> <p>Examples:</p> <pre><code>;; Development: output all logs\n(log/set-level \"debug\")\n(log/debug \"This will be shown\")\n(log/info \"This will also be shown\")\n\n;; Production: INFO and above only\n(log/set-level \"info\")\n(log/debug \"This will NOT be shown\")\n(log/info \"This will be shown\")\n\n;; Errors only\n(log/set-level \"error\")\n(log/warn \"This will NOT be shown\")\n(log/error \"This will be shown\")\n\n;; Configure from environment variable\n(log/set-level (env/get \"LOG_LEVEL\" \"info\"))\n\n;; Warning level (\"warning\" is also accepted)\n(log/set-level \"warning\")\n</code></pre>"},{"location":"spec/25-stdlib-log/#logset-format","title":"log/set-format","text":"<p>Set the log format.</p> <pre><code>(log/set-format format-string)\n</code></pre> <p>Arguments: - <code>format-string</code> (string) - Format (<code>\"text\"</code>, <code>\"plain\"</code>, <code>\"json\"</code>)</p> <p>Returns: nil</p> <p>Formats:</p>"},{"location":"spec/25-stdlib-log/#text-format-default","title":"Text format (default)","text":"<pre><code>(log/set-format \"text\")\n(log/info \"Server started\" {:port 8080})\n;; [2025-01-15T10:30:45.123+0000] INFO Server started | port=8080\n</code></pre> <p>Format: <code>[timestamp] level message | key1=value1 key2=value2</code></p>"},{"location":"spec/25-stdlib-log/#json-format","title":"JSON format","text":"<pre><code>(log/set-format \"json\")\n(log/info \"Server started\" {:port 8080})\n;; {\"timestamp\":\"2025-01-15T10:30:45.123+0000\",\"level\":\"INFO\",\"message\":\"Server started\",\"port\":\"8080\"}\n</code></pre> <p>Use cases: - text: Human-readable (development, debugging) - json: For log aggregation tools (Elasticsearch, Splunk, etc.)</p> <p>Examples:</p> <pre><code>;; Change format based on environment\n(let [env (env/get \"ENV\" \"development\")]\n  (if (= env \"production\")\n      (log/set-format \"json\")\n      (log/set-format \"text\")))\n\n;; Structured logging with JSON\n(log/set-format \"json\")\n(log/info \"Request completed\"\n  {:request-id \"req-123\"\n   :user-id 456\n   :duration-ms 234\n   :status 200})\n;; {\"timestamp\":\"2025-01-15T10:30:45.567+0000\",\"level\":\"INFO\",\"message\":\"Request completed\",\"request-id\":\"req-123\",\"user-id\":\"456\",\"duration-ms\":\"234\",\"status\":\"200\"}\n</code></pre>"},{"location":"spec/25-stdlib-log/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/25-stdlib-log/#application-startup-configuration","title":"Application Startup Configuration","text":"<pre><code>;; Initialize logging at startup\n(defn init-logging []\n  (let [level (env/get \"LOG_LEVEL\" \"info\")\n        format (env/get \"LOG_FORMAT\" \"text\")]\n    (log/set-level level)\n    (log/set-format format)\n    (log/info \"Logging configured\" {:level level :format format})))\n\n(init-logging)\n</code></pre>"},{"location":"spec/25-stdlib-log/#http-server-logging","title":"HTTP Server Logging","text":"<pre><code>;; Request/response logging\n(defn log-request [req]\n  (log/info \"Request received\"\n    {:method (get req :method)\n     :path (get req :path)\n     :user-agent (get-in req [:headers \"User-Agent\"])}))\n\n(defn log-response [req res duration-ms]\n  (log/info \"Response sent\"\n    {:method (get req :method)\n     :path (get req :path)\n     :status (get res :status)\n     :duration-ms duration-ms}))\n\n;; Middleware\n(defn logging-middleware [handler]\n  (fn [req]\n    (let [start (time/now-ms)]\n      (log-request req)\n      (let [res (handler req)\n            duration (- (time/now-ms) start)]\n        (log-response req res duration)\n        res))))\n</code></pre>"},{"location":"spec/25-stdlib-log/#error-tracking","title":"Error Tracking","text":"<pre><code>;; Record error details in log\n(defn process-with-error-tracking [data]\n  (try\n    (do\n      (log/debug \"Processing started\" {:data-size (len data)})\n      (let [result (process data)]\n        (log/info \"Processing succeeded\" {:result-size (len result)})\n        result))\n    (fn [err]\n      (log/error \"Processing failed\"\n        {:error (str err)\n         :data-size (len data)\n         :stack-trace (get err :stack)})\n      (throw err))))\n</code></pre>"},{"location":"spec/25-stdlib-log/#batch-processing-progress","title":"Batch Processing Progress","text":"<pre><code>;; Progress logging for large data processing\n(defn process-batch [items]\n  (let [total (len items)]\n    (log/info \"Batch processing started\" {:total total})\n    (loop [i 0\n           processed 0\n           failed 0]\n      (if (&lt; i total)\n          (let [item (nth items i)\n                result (try\n                         (do\n                           (process-item item)\n                           :ok)\n                         (fn [err]\n                           (log/warn \"Item processing failed\"\n                             {:index i :item-id (get item :id) :error (str err)})\n                           :error))]\n            (when (= (mod i 100) 0)\n              (log/info \"Progress\"\n                {:processed i :total total :percent (/ (* i 100) total)}))\n            (recur\n              (+ i 1)\n              (if (= result :ok) (+ processed 1) processed)\n              (if (= result :error) (+ failed 1) failed)))\n          (log/info \"Batch processing completed\"\n            {:total total :processed processed :failed failed})))))\n</code></pre>"},{"location":"spec/25-stdlib-log/#debug-logging","title":"Debug Logging","text":"<pre><code>;; Debugging during development\n(defn complex-calculation [x y z]\n  (log/debug \"Calculation started\" {:x x :y y :z z})\n\n  (let [step1 (+ x y)]\n    (log/debug \"Step 1 completed\" {:step1 step1})\n\n    (let [step2 (* step1 z)]\n      (log/debug \"Step 2 completed\" {:step2 step2})\n\n      (let [result (/ step2 2)]\n        (log/debug \"Calculation completed\" {:result result})\n        result))))\n\n;; In production, DEBUG logs are not output\n(log/set-level \"info\")\n(complex-calculation 10 20 5)  ;; Debug logs won't be shown\n</code></pre>"},{"location":"spec/25-stdlib-log/#structured-logging","title":"Structured Logging","text":"<pre><code>;; Unified log structure with JSON format\n(log/set-format \"json\")\n\n;; Track user actions\n(defn track-user-action [user-id action details]\n  (log/info \"User action\"\n    {:user-id user-id\n     :action action\n     :timestamp (time/now-iso)\n     :details (json/stringify details)}))\n\n(track-user-action 123 \"login\" {:ip \"192.168.1.1\" :device \"mobile\"})\n;; {\"timestamp\":\"2025-01-15T10:30:45.890+0000\",\"level\":\"INFO\",\"message\":\"User action\",\"user-id\":\"123\",\"action\":\"login\",\"details\":\"{\\\"ip\\\":\\\"192.168.1.1\\\",\\\"device\\\":\\\"mobile\\\"}\"}\n\n;; Easy to search and analyze with log aggregation tools (Elasticsearch, etc.)\n</code></pre>"},{"location":"spec/25-stdlib-log/#conditional-logging","title":"Conditional Logging","text":"<pre><code>;; Log only under certain conditions\n(defn process-with-conditional-log [data]\n  (when (&gt; (len data) 1000)\n    (log/warn \"Processing large data\" {:size (len data)}))\n\n  (let [result (process data)]\n    (when (empty? result)\n      (log/warn \"Processing result is empty\" {:input-size (len data)}))\n    result))\n\n;; Detailed logs only in debug mode\n(def debug-mode (= (env/get \"DEBUG\") \"true\"))\n\n(defn debug-log [msg ctx]\n  (when debug-mode\n    (log/debug msg ctx)))\n\n(debug-log \"Detailed info\" {:var1 x :var2 y})\n</code></pre>"},{"location":"spec/25-stdlib-log/#log-level-best-practices","title":"Log Level Best Practices","text":""},{"location":"spec/25-stdlib-log/#debug-level","title":"DEBUG Level","text":"<p>Use case: Debug information during development</p> <pre><code>;; Variable values\n(log/debug \"Variable values\" {:x x :y y})\n\n;; Function entry/exit\n(log/debug \"Function started\" {:function \"process-data\" :args args})\n(log/debug \"Function completed\" {:function \"process-data\" :result result})\n\n;; Internal state\n(log/debug \"Loop state\" {:iteration i :current-value val})\n</code></pre>"},{"location":"spec/25-stdlib-log/#info-level","title":"INFO Level","text":"<p>Use case: Normal operation logs, important events</p> <pre><code>;; Server start/stop\n(log/info \"Server started\" {:port 8080})\n(log/info \"Server stopped\")\n\n;; Request processing\n(log/info \"Request completed\" {:path \"/api/users\" :status 200})\n\n;; Batch processing start/completion\n(log/info \"Batch processing started\" {:job-id \"batch-001\"})\n(log/info \"Batch processing completed\" {:job-id \"batch-001\" :processed 1000})\n</code></pre>"},{"location":"spec/25-stdlib-log/#warn-level","title":"WARN Level","text":"<p>Use case: Potential issues, deprecated usage</p> <pre><code>;; Retryable errors\n(log/warn \"Connection failed, retrying\" {:retry-count 2 :max-retries 5})\n\n;; Performance issues\n(log/warn \"Long processing time\" {:duration-ms 5000 :threshold-ms 1000})\n\n;; Deprecated features\n(log/warn \"Deprecated API usage\" {:api \"old-api\" :alternative \"new-api\"})\n\n;; Data issues\n(log/warn \"Skipping invalid data\" {:line 123 :reason \"invalid format\"})\n</code></pre>"},{"location":"spec/25-stdlib-log/#error-level","title":"ERROR Level","text":"<p>Use case: Critical issues, processing failures</p> <pre><code>;; Connection errors\n(log/error \"Database connection failed\" {:error err :host db-host})\n\n;; Validation errors\n(log/error \"Data validation failed\" {:field \"email\" :value invalid-email})\n\n;; System errors\n(log/error \"File write failed\" {:path file-path :error err})\n\n;; Unexpected errors\n(log/error \"Unexpected error\" {:error err :context ctx :stack-trace stack})\n</code></pre>"},{"location":"spec/25-stdlib-log/#error-handling","title":"Error Handling","text":""},{"location":"spec/25-stdlib-log/#logging-on-errors","title":"Logging on Errors","text":"<pre><code>;; Combined with try/catch\n(try\n  (risky-operation)\n  (fn [err]\n    (log/error \"Operation failed\" {:operation \"risky-operation\" :error (str err)})\n    (default-value)))\n\n;; Errors in pipelines\n(data\n |&gt; (map (fn [x]\n           (try\n             (process x)\n             (fn [err]\n               (log/warn \"Skipping item\" {:item x :error (str err)})\n               nil))))\n |&gt; (filter some?))\n</code></pre>"},{"location":"spec/25-stdlib-log/#performance-considerations","title":"Performance Considerations","text":""},{"location":"spec/25-stdlib-log/#filtering-by-log-level","title":"Filtering by Log Level","text":"<pre><code>;; \u274c Bad: always construct string\n(log/debug (str \"Large data: \" (json/stringify large-data)))\n;; String construction cost even when DEBUG level is not active\n\n;; \u2705 Good: construct only when needed\n(when (&gt;= (log/current-level) :debug)  ;; hypothetical function\n  (log/debug \"Large data\" {:data large-data}))\n</code></pre>"},{"location":"spec/25-stdlib-log/#production-environment-settings","title":"Production Environment Settings","text":"<pre><code>;; Production environment\n(log/set-level \"info\")    ;; Don't output DEBUG logs\n(log/set-format \"json\")   ;; Structured logs for aggregation/analysis\n\n;; Development environment\n(log/set-level \"debug\")   ;; Output all logs\n(log/set-format \"text\")   ;; Human-readable format\n</code></pre>"},{"location":"spec/25-stdlib-log/#function-reference","title":"Function Reference","text":"Function Description Use Case <code>log/debug</code> Output DEBUG level log Debug information <code>log/info</code> Output INFO level log Normal operation logs <code>log/warn</code> Output WARN level log Warnings <code>log/error</code> Output ERROR level log Errors <code>log/set-level</code> Set log level Control filtering <code>log/set-format</code> Set log format Control output format"},{"location":"spec/25-stdlib-log/#log-format-details","title":"Log Format Details","text":""},{"location":"spec/25-stdlib-log/#text-format","title":"Text Format","text":"<pre><code>[2025-01-15T10:30:45.123+0000] INFO Server started | port=8080 host=localhost\n</code></pre> <p>Components: - <code>[...]</code> - Timestamp (ISO8601 format, UTC) - <code>INFO</code> - Log level - <code>Server started</code> - Message - <code>| key=value ...</code> - Context (optional)</p>"},{"location":"spec/25-stdlib-log/#json-format_1","title":"JSON Format","text":"<pre><code>{\"timestamp\":\"2025-01-15T10:30:45.123+0000\",\"level\":\"INFO\",\"message\":\"Server started\",\"port\":\"8080\",\"host\":\"localhost\"}\n</code></pre> <p>Fields: - <code>timestamp</code> - Timestamp (ISO8601 format, UTC) - <code>level</code> - Log level - <code>message</code> - Message - Others - Keys and values from context map</p>"},{"location":"spec/25-stdlib-log/#see-also","title":"See Also","text":"<ul> <li>Error Handling - Error handling with try/catch</li> <li>Environment Variables - Configuration management</li> <li>HTTP Server - Request logging</li> <li>Debugging - Debug features</li> </ul>"},{"location":"spec/26-stdlib-markdown/","title":"Standard Library - Markdown Processing (markdown/)","text":"<p>Markdown Generation and Parsing Library</p> <p>All functions belong to the <code>markdown/</code> module.</p>"},{"location":"spec/26-stdlib-markdown/#overview","title":"Overview","text":"<p>The <code>markdown/</code> module provides the following features:</p> <ul> <li>Markdown Generation - Generate headers, lists, tables, code blocks, etc.</li> <li>Markdown Parsing - Convert Markdown strings to AST</li> <li>Code Block Extraction - Extract code blocks from Markdown</li> <li>AST Manipulation - Convert AST back to Markdown strings</li> </ul>"},{"location":"spec/26-stdlib-markdown/#generation-functions","title":"Generation Functions","text":""},{"location":"spec/26-stdlib-markdown/#markdownheader","title":"markdown/header","text":"<p>Generate a Markdown header.</p> <pre><code>(markdown/header level text)\n</code></pre> <p>Arguments: - <code>level</code> (integer) - Header level (1-6) - <code>text</code> (string) - Header text</p> <p>Returns: string - Markdown header string</p> <p>Examples:</p> <pre><code>(markdown/header 1 \"Title\")\n;; =&gt; \"# Title\"\n\n(markdown/header 2 \"Subtitle\")\n;; =&gt; \"## Subtitle\"\n\n(markdown/header 3 \"Section\")\n;; =&gt; \"### Section\"\n\n;; Use in pipeline\n([\"Introduction\" \"Getting Started\" \"Examples\"]\n |&gt; (map-indexed (fn [i text] (markdown/header (+ i 1) text)))\n |&gt; (join \"\\n\\n\"))\n;; =&gt; \"# Introduction\\n\\n## Getting Started\\n\\n### Examples\"\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownlist","title":"markdown/list","text":"<p>Generate a Markdown unordered list (bullet list).</p> <pre><code>(markdown/list items)\n</code></pre> <p>Arguments: - <code>items</code> (list | vector) - List or vector of items</p> <p>Returns: string - Markdown list string</p> <p>Examples:</p> <pre><code>(markdown/list [\"Apple\" \"Banana\" \"Cherry\"])\n;; =&gt; \"- Apple\\n- Banana\\n- Cherry\"\n\n;; Numbers and mixed types are auto-converted\n(markdown/list [1 2 3])\n;; =&gt; \"- 1\\n- 2\\n- 3\"\n\n;; Use in pipeline\n([\"Task 1\" \"Task 2\" \"Task 3\"]\n |&gt; markdown/list\n |&gt; println)\n;; - Task 1\n;; - Task 2\n;; - Task 3\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownordered-list","title":"markdown/ordered-list","text":"<p>Generate a Markdown ordered list.</p> <pre><code>(markdown/ordered-list items)\n</code></pre> <p>Arguments: - <code>items</code> (list | vector) - List or vector of items</p> <p>Returns: string - Markdown ordered list string</p> <p>Examples:</p> <pre><code>(markdown/ordered-list [\"First\" \"Second\" \"Third\"])\n;; =&gt; \"1. First\\n2. Second\\n3. Third\"\n\n;; Generate step-by-step instructions\n(def steps [\"Install Qi\" \"Write code\" \"Run program\"])\n(markdown/ordered-list steps)\n;; =&gt; \"1. Install Qi\\n2. Write code\\n3. Run program\"\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdowntable","title":"markdown/table","text":"<p>Generate a Markdown table. The first row is treated as the header.</p> <pre><code>(markdown/table rows)\n</code></pre> <p>Arguments: - <code>rows</code> (list | vector) - List or vector of rows. Each row is also a list or vector</p> <p>Returns: string - Markdown table string</p> <p>Examples:</p> <pre><code>;; Basic table\n(def data [\n  [\"Name\" \"Age\" \"City\"]\n  [\"Alice\" 30 \"Tokyo\"]\n  [\"Bob\" 25 \"Osaka\"]])\n\n(markdown/table data)\n;; =&gt; \"| Name | Age | City |\n;;     | --- | --- | --- |\n;;     | Alice | 30 | Tokyo |\n;;     | Bob | 25 | Osaka |\"\n\n;; Convert CSV data to table\n(csv/read-file \"users.csv\"\n |&gt; markdown/table\n |&gt; io/write \"users.md\")\n</code></pre> <p>Errors: - Table is empty - Row is not a list or vector - Column count mismatch</p>"},{"location":"spec/26-stdlib-markdown/#markdowncode-block","title":"markdown/code-block","text":"<p>Generate a Markdown code block.</p> <pre><code>(markdown/code-block lang code)\n</code></pre> <p>Arguments: - <code>lang</code> (string | nil) - Programming language name (nil for no language specification) - <code>code</code> (string) - Code string</p> <p>Returns: string - Markdown code block string</p> <p>Examples:</p> <pre><code>;; Qi code block\n(markdown/code-block \"qi\" \"(+ 1 2)\")\n;; =&gt; \"```qi\\n(+ 1 2)\\n```\"\n\n;; JavaScript code block\n(markdown/code-block \"js\" \"console.log('Hello')\")\n;; =&gt; \"```js\\nconsole.log('Hello')\\n```\"\n\n;; No language specified\n(markdown/code-block nil \"plain text\")\n;; =&gt; \"```\\nplain text\\n```\"\n\n;; Read from file and create code block\n(io/read \"example.qi\"\n |&gt; (markdown/code-block \"qi\" _)\n |&gt; println)\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownlink","title":"markdown/link","text":"<p>Generate a Markdown link.</p> <pre><code>(markdown/link text url)\n</code></pre> <p>Arguments: - <code>text</code> (string) - Link text - <code>url</code> (string) - Link URL</p> <p>Returns: string - Markdown link string</p> <p>Examples:</p> <pre><code>(markdown/link \"GitHub\" \"https://github.com\")\n;; =&gt; \"[GitHub](https://github.com)\"\n\n(markdown/link \"Documentation\" \"/docs\")\n;; =&gt; \"[Documentation](/docs)\"\n\n;; Generate list of links\n(def links [\n  {:name \"Home\" :url \"/\"}\n  {:name \"About\" :url \"/about\"}\n  {:name \"Contact\" :url \"/contact\"}])\n\n(links\n |&gt; (map (fn [l] (markdown/link (get l :name) (get l :url))))\n |&gt; markdown/list)\n;; =&gt; \"- [Home](/)\\n- [About](/about)\\n- [Contact](/contact)\"\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownimage","title":"markdown/image","text":"<p>Generate Markdown image syntax.</p> <pre><code>(markdown/image alt src)\n</code></pre> <p>Arguments: - <code>alt</code> (string) - Alternative text - <code>src</code> (string) - Image path or URL</p> <p>Returns: string - Markdown image string</p> <p>Examples:</p> <pre><code>(markdown/image \"Logo\" \"logo.png\")\n;; =&gt; \"![Logo](logo.png)\"\n\n(markdown/image \"Screenshot\" \"https://example.com/img.jpg\")\n;; =&gt; \"![Screenshot](https://example.com/img.jpg)\"\n\n;; Generate image gallery\n(def images [\"img1.png\" \"img2.png\" \"img3.png\"])\n(images\n |&gt; (map-indexed (fn [i src]\n                   (markdown/image f\"Image {(+ i 1)}\" src)))\n |&gt; (join \"\\n\\n\"))\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownjoin","title":"markdown/join","text":"<p>Join multiple Markdown elements with double newlines.</p> <pre><code>(markdown/join parts)\n</code></pre> <p>Arguments: - <code>parts</code> (list | vector) - List or vector of Markdown strings</p> <p>Returns: string - Joined Markdown string</p> <p>Examples:</p> <pre><code>;; Join multiple elements\n(markdown/join [\n  (markdown/header 1 \"Report\")\n  (markdown/header 2 \"Summary\")\n  \"This is a summary.\"\n  (markdown/list [\"Item 1\" \"Item 2\"])])\n;; =&gt; \"# Report\\n\\n## Summary\\n\\nThis is a summary.\\n\\n- Item 1\\n- Item 2\"\n\n;; Use in pipeline\n([\"# Title\" \"Content here\" \"More content\"]\n |&gt; markdown/join\n |&gt; io/write \"document.md\")\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#parsing-functions","title":"Parsing Functions","text":""},{"location":"spec/26-stdlib-markdown/#markdownparse","title":"markdown/parse","text":"<p>Convert a Markdown string to an AST.</p> <pre><code>(markdown/parse text)\n</code></pre> <p>Arguments: - <code>text</code> (string) - Markdown string</p> <p>Returns: list - List of block elements. Each element is a map</p> <p>Supported block elements: - <code>header</code> - Header (<code>:type \"header\"</code>, <code>:level</code>, <code>:text</code>) - <code>paragraph</code> - Paragraph (<code>:type \"paragraph\"</code>, <code>:text</code>) - <code>list</code> - List (<code>:type \"list\"</code>, <code>:ordered</code>, <code>:items</code>) - <code>code-block</code> - Code block (<code>:type \"code-block\"</code>, <code>:lang</code>, <code>:code</code>)</p> <p>Examples:</p> <pre><code>(def md-text \"# Title\n\nHello, world!\n\n- Item 1\n- Item 2\n\n```qi\n(+ 1 2)\n```\")\n\n(markdown/parse md-text)\n;; =&gt; [{:type \"header\" :level 1 :text \"Title\"}\n;;     {:type \"paragraph\" :text \"Hello, world!\"}\n;;     {:type \"list\" :ordered false :items [\"Item 1\" \"Item 2\"]}\n;;     {:type \"code-block\" :lang \"qi\" :code \"(+ 1 2)\"}]\n\n;; Extract headers only\n(markdown/parse md-text\n |&gt; (filter (fn [block] (= (get block :type) \"header\")))\n |&gt; (map (fn [h] (get h :text))))\n;; =&gt; [\"Title\"]\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownstringify","title":"markdown/stringify","text":"<p>Convert an AST to a Markdown string. Inverse operation of <code>markdown/parse</code>.</p> <pre><code>(markdown/stringify blocks)\n</code></pre> <p>Arguments: - <code>blocks</code> (list | vector) - List or vector of block elements</p> <p>Returns: string - Markdown string</p> <p>Examples:</p> <pre><code>(def ast [\n  {:type \"header\" :level 1 :text \"Title\"}\n  {:type \"paragraph\" :text \"Hello, world!\"}\n  {:type \"list\" :ordered false :items [\"Item 1\" \"Item 2\"]}])\n\n(markdown/stringify ast)\n;; =&gt; \"# Title\\n\\nHello, world!\\n\\n- Item 1\\n- Item 2\"\n\n;; Parse, edit, and regenerate\n(def modified\n  (markdown/parse original-text\n   |&gt; (map (fn [block]\n             (if (= (get block :type) \"header\")\n                 (assoc block :text (str/upper (get block :text)))\n                 block)))\n   |&gt; markdown/stringify))\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownextract-code-blocks","title":"markdown/extract-code-blocks","text":"<p>Extract only code blocks from Markdown.</p> <pre><code>(markdown/extract-code-blocks text)\n</code></pre> <p>Arguments: - <code>text</code> (string) - Markdown string</p> <p>Returns: list - List of code blocks. Each element is a map with <code>:lang</code> and <code>:code</code></p> <p>Examples:</p> <pre><code>(def md-doc \"# Examples\n\n```qi\n(+ 1 2)\n</code></pre> <p>Some text here.</p> <pre><code>console.log('Hello')\n```\")\n\n(markdown/extract-code-blocks md-doc)\n;; =&gt; [{:lang \"qi\" :code \"(+ 1 2)\"}\n;;     {:lang \"js\" :code \"console.log('Hello')\"}]\n\n;; Execute only Qi code blocks\n(markdown/extract-code-blocks md-doc\n |&gt; (filter (fn [block] (= (get block :lang) \"qi\")))\n |&gt; (each (fn [block] (eval-string (get block :code)))))\n\n;; Save code blocks to files\n(markdown/extract-code-blocks md-doc\n |&gt; (each-indexed (fn [i block]\n                    (io/write f\"code-{i}.{(get block :lang)}\"\n                              (get block :code)))))\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/26-stdlib-markdown/#document-generation","title":"Document Generation","text":"<pre><code>;; Auto-generate function documentation\n(defn gen-function-doc [func-name args desc examples]\n  (markdown/join [\n    (markdown/header 3 func-name)\n    desc\n    (markdown/header 4 \"Arguments\")\n    (markdown/list args)\n    (markdown/header 4 \"Examples\")\n    (markdown/code-block \"qi\" (join \"\\n\\n\" examples))]))\n\n(gen-function-doc\n  \"map\"\n  [\"f - transformation function\" \"coll - collection\"]\n  \"Apply a function to each element of a collection.\"\n  [\"(map inc [1 2 3])\" \"(map str/upper [\\\"a\\\" \\\"b\\\"])\"])\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#readme-generator","title":"README Generator","text":"<pre><code>;; Generate project README\n(defn generate-readme [project]\n  (markdown/join [\n    (markdown/header 1 (get project :name))\n    (get project :description)\n    (markdown/header 2 \"Features\")\n    (markdown/list (get project :features))\n    (markdown/header 2 \"Installation\")\n    (markdown/code-block \"bash\" (:install-cmd project))\n    (markdown/header 2 \"Usage\")\n    (markdown/code-block (get project :lang) (get project :usage-example))\n    (markdown/header 2 \"License\")\n    (get project :license)]))\n\n(def project-info {\n  :name \"My Project\"\n  :description \"A cool project\"\n  :features [\"Fast\" \"Simple\" \"Reliable\"]\n  :install-cmd \"npm install my-project\"\n  :lang \"js\"\n  :usage-example \"const mp = require('my-project');\\nmp.run();\"\n  :license \"MIT\"})\n\n(generate-readme project-info\n |&gt; io/write \"README.md\")\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#static-site-generator","title":"Static Site Generator","text":"<pre><code>;; Convert Markdown files to HTML using a template\n(defn render-page [md-file template]\n  (let [content (io/read md-file)\n        ast (markdown/parse content)\n        title (-&gt; ast\n                  (filter (fn [b] (= (get b :type) \"header\")))\n                  first\n                  :text)\n        body (markdown/stringify ast)]\n    (str/replace template \"{{{title}}}\" title\n     |&gt; (str/replace _ \"{{{body}}}\" body))))\n\n;; Process all Markdown files\n(io/glob \"content/*.md\"\n |&gt; (each (fn [file]\n            (let [html (render-page file (io/read \"template.html\"))\n                  out-file (str/replace file \".md\" \".html\")]\n              (io/write out-file html)))))\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#report-generation","title":"Report Generation","text":"<pre><code>;; Auto-generate reports from data\n(defn generate-sales-report [sales-data]\n  (let [total (reduce + (map :amount sales-data))\n        avg (/ total (count sales-data))\n        top-sales (take 5 (reverse (sort-by :amount sales-data)))]\n    (markdown/join [\n      (markdown/header 1 \"Sales Report\")\n      (markdown/header 2 \"Summary\")\n      f\"Total sales: ${total}\"\n      f\"Average: ${avg}\"\n      (markdown/header 2 \"Top 5 Sales\")\n      (markdown/table\n        (cons [\"Date\" \"Product\" \"Amount\"]\n              (map (fn [s] [(get s :date) (get s :product) (get s :amount)])\n                   top-sales)))])))\n\n(def sales [\n  {:date \"2024-01-01\" :product \"Widget A\" :amount 1500}\n  {:date \"2024-01-02\" :product \"Widget B\" :amount 2000}\n  {:date \"2024-01-03\" :product \"Widget A\" :amount 1200}])\n\n(generate-sales-report sales\n |&gt; io/write \"report.md\")\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#blog-post-conversion","title":"Blog Post Conversion","text":"<pre><code>;; Parse Markdown with frontmatter\n(defn parse-blog-post [md-text]\n  (let [lines (str/lines md-text)\n        frontmatter-end (index-of lines \"---\" 1)\n        frontmatter (take frontmatter-end (drop 1 lines))\n        content (drop (+ frontmatter-end 1) lines |&gt; (join \"\\n\"))\n        metadata (frontmatter\n                  |&gt; (map (fn [line] (str/split line \":\")))\n                  |&gt; (reduce (fn [acc [k v]]\n                               (assoc acc (keyword (str/trim k))\n                                         (str/trim v)))\n                             {}))]\n    {:metadata metadata\n     :content content\n     :ast (markdown/parse content)}))\n\n(def blog-post \"---\ntitle: My First Post\ndate: 2024-01-01\ntags: qi, programming\n---\n\n# Introduction\n\nThis is my first blog post!\")\n\n(parse-blog-post blog-post)\n;; =&gt; {:metadata {:title \"My First Post\"\n;;                :date \"2024-01-01\"\n;;                :tags \"qi, programming\"}\n;;     :content \"# Introduction\\n\\nThis is my first blog post!\"\n;;     :ast [...]}\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#test-case-extraction","title":"Test Case Extraction","text":"<pre><code>;; Extract and run test cases from documentation\n(defn extract-and-run-tests [md-file]\n  (let [content (io/read md-file)\n        code-blocks (markdown/extract-code-blocks content)\n        qi-tests (filter (fn [b] (= (get b :lang) \"qi\")) code-blocks)]\n    (doseq [test qi-tests]\n      (try\n        (eval-string (get test :code))\n        (println \"\u2713 Test passed\")\n        (catch e\n          (println f\"\u2717 Test failed: {e}\"))))))\n\n(extract-and-run-tests \"docs/examples.md\")\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#markdownpdf-conversion-pipeline","title":"Markdown\u2192PDF Conversion Pipeline","text":"<pre><code>;; Convert Markdown to HTML and generate PDF\n(defn md-to-pdf [md-file pdf-file]\n  (io/read md-file\n   |&gt; markdown/parse\n   |&gt; markdown/stringify\n   |&gt; (str/replace _ \"# \" \"&lt;h1&gt;\" _)  ;; Simple HTML conversion\n   |&gt; (str/replace _ \"## \" \"&lt;h2&gt;\" _)\n   |&gt; (fn [html]\n        (sh/exec f\"wkhtmltopdf - {pdf-file}\" :stdin html))))\n\n(md-to-pdf \"document.md\" \"document.pdf\")\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#pipeline-integration-examples","title":"Pipeline Integration Examples","text":"<pre><code>;; Convert CSV data to Markdown table and generate report\n(csv/read-file \"sales.csv\"\n |&gt; markdown/table\n |&gt; (fn [table]\n      (markdown/join [\n        (markdown/header 1 \"Sales Data\")\n        table]))\n |&gt; io/write \"sales-report.md\")\n\n;; Generate table of contents from all Markdown files in directory\n(io/glob \"docs/*.md\"\n |&gt; (map (fn [file]\n           (let [content (io/read file)\n                 title (-&gt; content\n                           markdown/parse\n                           (filter (fn [b] (= (get b :type) \"header\")))\n                           first\n                           :text)]\n             (markdown/link title file))))\n |&gt; markdown/list\n |&gt; (fn [toc]\n      (markdown/join [\n        (markdown/header 1 \"Table of Contents\")\n        toc]))\n |&gt; io/write \"TOC.md\")\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#error-handling","title":"Error Handling","text":"<pre><code>;; Table generation error handling\n(try\n  (markdown/table [])  ;; Empty table\n  (catch e\n    (println f\"Error: {e}\")))\n;; Error: Table cannot be empty\n\n;; Invalid header level\n(try\n  (markdown/header 7 \"Invalid\")  ;; Level must be 1-6\n  (catch e\n    (println f\"Error: {e}\")))\n;; Error: Header level must be between 1 and 6\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#performance-and-best-practices","title":"Performance and Best Practices","text":""},{"location":"spec/26-stdlib-markdown/#processing-large-documents","title":"Processing Large Documents","text":"<pre><code>;; \u274c Bad: Repeated string concatenation\n(defn generate-large-doc-bad [items]\n  (reduce (fn [acc item]\n            (str acc (markdown/header 3 item) \"\\n\\n\"))\n          \"\"\n          items))\n\n;; \u2705 Good: Build list then join once\n(defn generate-large-doc-good [items]\n  (items\n   |&gt; (map (fn [item] (markdown/header 3 item)))\n   |&gt; markdown/join))\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#caching","title":"Caching","text":"<pre><code>;; \u2705 Cache parse results\n(def parsed-doc (markdown/parse (io/read \"large-doc.md\")))\n\n;; Multiple filtering operations\n(def headers (filter (fn [b] (= (get b :type) \"header\")) parsed-doc))\n(def lists (filter (fn [b] (= (get b :type) \"list\")) parsed-doc))\n(def code-blocks (filter (fn [b] (= (get b :type) \"code-block\")) parsed-doc))\n</code></pre>"},{"location":"spec/26-stdlib-markdown/#function-reference","title":"Function Reference","text":"Function Description Use Case <code>markdown/header</code> Generate header <code># Title</code> <code>markdown/list</code> Generate bullet list <code>- Item</code> <code>markdown/ordered-list</code> Generate ordered list <code>1. Item</code> <code>markdown/table</code> Generate table Table syntax <code>markdown/code-block</code> Generate code block <code>```lang\\ncode\\n```</code> <code>markdown/link</code> Generate link <code>[text](url)</code> <code>markdown/image</code> Generate image <code>![alt](src)</code> <code>markdown/join</code> Join elements Join with double newlines <code>markdown/parse</code> Markdown\u2192AST Structure parsing <code>markdown/stringify</code> AST\u2192Markdown AST reconstruction <code>markdown/extract-code-blocks</code> Extract code blocks Extract <code>```...```</code>"},{"location":"spec/26-stdlib-markdown/#related-topics","title":"Related Topics","text":"<ul> <li>String Manipulation - Text processing</li> <li>File I/O - File reading and writing</li> <li>CSV Processing - Data conversion</li> </ul>"},{"location":"spec/27-stdlib-path/","title":"Standard Library - Path Operations (path/)","text":"<p>Cross-platform path manipulation</p> <p>All functions belong to the <code>path/</code> module.</p>"},{"location":"spec/27-stdlib-path/#path-joining","title":"Path Joining","text":""},{"location":"spec/27-stdlib-path/#pathjoin","title":"path/join","text":"<p>Joins multiple path elements to create a platform-appropriate path.</p> <pre><code>;; Basic usage\n(path/join \"dir\" \"subdir\" \"file.txt\")\n;; Unix: =&gt; \"dir/subdir/file.txt\"\n;; Windows: =&gt; \"dir\\\\subdir\\\\file.txt\"\n\n;; Joining with absolute path\n(path/join \"/usr\" \"local\" \"bin\")\n;; =&gt; \"/usr/local/bin\"\n\n;; Variable arguments\n(path/join \"a\" \"b\" \"c\" \"d\" \"e\")\n;; =&gt; \"a/b/c/d/e\"\n\n;; With pipeline\n([\"logs\" \"2024\" \"01\" \"app.log\"]\n |&gt; (apply path/join))\n;; =&gt; \"logs/2024/01/app.log\"\n</code></pre> <p>Arguments: - <code>parts...</code> - Path elements to join (variadic, minimum 1)</p> <p>Returns: Joined path string</p> <p>Cross-platform: - Unix/Linux/macOS: <code>/</code> separator - Windows: <code>\\</code> separator</p>"},{"location":"spec/27-stdlib-path/#path-parsing","title":"Path Parsing","text":""},{"location":"spec/27-stdlib-path/#pathbasename","title":"path/basename","text":"<p>Extracts the file name part (last element) from a path.</p> <pre><code>;; Get file name\n(path/basename \"/path/to/file.txt\")\n;; =&gt; \"file.txt\"\n\n;; Get directory name\n(path/basename \"/path/to/dir\")\n;; =&gt; \"dir\"\n\n;; Windows path\n(path/basename \"C:\\\\Users\\\\Alice\\\\Document.docx\")\n;; =&gt; \"Document.docx\"\n\n;; Root directory\n(path/basename \"/\")\n;; =&gt; \"\"\n\n;; Use in pipeline\n(io/list-dir \"downloads\")\n |&gt; (map path/basename)\n;; =&gt; [\"file1.txt\" \"file2.pdf\" \"image.png\"]\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: File name string (empty string if not available)</p>"},{"location":"spec/27-stdlib-path/#pathdirname","title":"path/dirname","text":"<p>Extracts the directory part (parent directory) from a path.</p> <pre><code>;; Get directory part\n(path/dirname \"/path/to/file.txt\")\n;; =&gt; \"/path/to\"\n\n;; Multiple levels\n(path/dirname \"/a/b/c/d.txt\")\n;; =&gt; \"/a/b/c\"\n\n;; Windows path\n(path/dirname \"C:\\\\Users\\\\Alice\\\\file.txt\")\n;; =&gt; \"C:\\\\Users\\\\Alice\"\n\n;; Root level\n(path/dirname \"/file.txt\")\n;; =&gt; \"/\"\n\n;; Relative path\n(path/dirname \"dir/file.txt\")\n;; =&gt; \"dir\"\n\n;; Get parent directory in pipeline\n(file-path\n |&gt; path/dirname\n |&gt; io/create-dir)\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: Directory part string (empty string if not available)</p>"},{"location":"spec/27-stdlib-path/#pathextension","title":"path/extension","text":"<p>Extracts the file extension.</p> <pre><code>;; Get extension\n(path/extension \"file.txt\")\n;; =&gt; \"txt\"\n\n(path/extension \"archive.tar.gz\")\n;; =&gt; \"gz\"\n\n;; No extension\n(path/extension \"README\")\n;; =&gt; \"\"\n\n;; Dot file\n(path/extension \".gitignore\")\n;; =&gt; \"\"\n\n;; Path included\n(path/extension \"/path/to/document.pdf\")\n;; =&gt; \"pdf\"\n\n;; Filter by extension\n(io/list-dir \"src\")\n |&gt; (filter (fn [f] (= (path/extension f) \"rs\")))\n;; =&gt; [\"/path/to/main.rs\" \"/path/to/lib.rs\"]\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: Extension without dot (empty string if no extension)</p> <p>Note: Returns only the part after the last dot (<code>file.tar.gz</code> \u2192 <code>\"gz\"</code>)</p>"},{"location":"spec/27-stdlib-path/#pathstem","title":"path/stem","text":"<p>Extracts the file name without extension.</p> <pre><code>;; File name without extension\n(path/stem \"file.txt\")\n;; =&gt; \"file\"\n\n(path/stem \"document.pdf\")\n;; =&gt; \"document\"\n\n;; Multiple dots\n(path/stem \"archive.tar.gz\")\n;; =&gt; \"archive.tar\"\n\n;; No extension\n(path/stem \"README\")\n;; =&gt; \"README\"\n\n;; Path included\n(path/stem \"/path/to/report.docx\")\n;; =&gt; \"report\"\n\n;; Transform file name in pipeline\n(\"data.csv\"\n |&gt; path/stem\n |&gt; (fn [s] (str s \"_processed.json\")))\n;; =&gt; \"data_processed.json\"\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: File name without extension (empty string if not available)</p>"},{"location":"spec/27-stdlib-path/#path-conversion","title":"Path Conversion","text":""},{"location":"spec/27-stdlib-path/#pathabsolute","title":"path/absolute","text":"<p>Converts a relative path to an absolute path.</p> <pre><code>;; Convert relative to absolute path\n(path/absolute \"data/file.txt\")\n;; =&gt; \"/Users/alice/project/data/file.txt\"\n\n;; Already absolute path\n(path/absolute \"/usr/local/bin\")\n;; =&gt; \"/usr/local/bin\"\n\n;; Current directory\n(path/absolute \".\")\n;; =&gt; \"/Users/alice/project\"\n\n;; Parent directory reference\n(path/absolute \"../other\")\n;; =&gt; \"/Users/alice/other\"\n\n;; Use in pipeline\n(relative-paths\n |&gt; (map path/absolute))\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: Absolute path string</p> <p>Note: Resolves relative to current working directory</p>"},{"location":"spec/27-stdlib-path/#pathnormalize","title":"path/normalize","text":"<p>Normalizes a path by resolving <code>.</code> and <code>..</code> components.</p> <pre><code>;; Resolve . and ..\n(path/normalize \"a/./b/../c\")\n;; =&gt; \"a/c\"\n\n(path/normalize \"/path/to/../other/./file.txt\")\n;; =&gt; \"/path/other/file.txt\"\n\n;; Merge consecutive slashes\n(path/normalize \"a//b///c\")\n;; =&gt; \"a/b/c\"\n\n;; Complex path\n(path/normalize \"/a/b/c/../../d/./e/../f\")\n;; =&gt; \"/a/d/f\"\n\n;; Use in pipeline\n(user-input-path\n |&gt; path/normalize\n |&gt; path/absolute)\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: Normalized path string</p> <p>Note: - <code>.</code> components are ignored - <code>..</code> components move to parent directory (stack-based) - Does not move above root</p>"},{"location":"spec/27-stdlib-path/#path-validation","title":"Path Validation","text":""},{"location":"spec/27-stdlib-path/#pathis-absolute","title":"path/is-absolute?","text":"<p>Checks if a path is absolute.</p> <pre><code>;; Check absolute path\n(path/is-absolute? \"/usr/bin\")\n;; =&gt; true\n\n(path/is-absolute? \"relative/path\")\n;; =&gt; false\n\n;; Windows path\n(path/is-absolute? \"C:\\\\Program Files\")\n;; =&gt; true\n\n(path/is-absolute? \"Documents\\\\file.txt\")\n;; =&gt; false\n\n;; Use in pipeline\n(paths\n |&gt; (filter path/is-absolute?))\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: <code>true</code> or <code>false</code></p> <p>Platform-specific detection: - Unix/Linux/macOS: starts with <code>/</code> - Windows: starts with <code>C:\\</code> or <code>\\\\server\\</code></p>"},{"location":"spec/27-stdlib-path/#pathis-relative","title":"path/is-relative?","text":"<p>Checks if a path is relative.</p> <pre><code>;; Check relative path\n(path/is-relative? \"data/file.txt\")\n;; =&gt; true\n\n(path/is-relative? \"/usr/local\")\n;; =&gt; false\n\n;; Current directory\n(path/is-relative? \".\")\n;; =&gt; true\n\n(path/is-relative? \"..\")\n;; =&gt; true\n\n;; Use in pipeline\n(paths\n |&gt; (filter path/is-relative?)\n |&gt; (map path/absolute))\n</code></pre> <p>Arguments: - <code>path</code> - Path string</p> <p>Returns: <code>true</code> or <code>false</code></p> <p>Note: Opposite of <code>path/is-absolute?</code></p>"},{"location":"spec/27-stdlib-path/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/27-stdlib-path/#file-path-construction","title":"File Path Construction","text":"<pre><code>;; Project structure construction\n(def project-root \"/Users/alice/project\")\n(def src-dir (path/join project-root \"src\"))\n(def test-dir (path/join project-root \"tests\"))\n(def main-file (path/join src-dir \"main.qi\"))\n\n;; User data directory\n(defn user-data-path [username filename]\n  (path/join \"/data\" \"users\" username filename))\n\n(user-data-path \"alice\" \"profile.json\")\n;; =&gt; \"/data/users/alice/profile.json\"\n</code></pre>"},{"location":"spec/27-stdlib-path/#file-name-transformation","title":"File Name Transformation","text":"<pre><code>;; Generate backup file name\n(defn backup-filename [original-path]\n  (let [dir (path/dirname original-path)\n        name (path/stem original-path)\n        ext (path/extension original-path)\n        timestamp (time/now |&gt; time/format \"yyyyMMdd_HHmmss\")]\n    (path/join dir (str name \"_backup_\" timestamp \".\" ext))))\n\n(backup-filename \"/data/document.txt\")\n;; =&gt; \"/data/document_backup_20240115_143025.txt\"\n</code></pre>"},{"location":"spec/27-stdlib-path/#path-analysis-pipeline","title":"Path Analysis Pipeline","text":"<pre><code>;; Get file information\n(defn file-info [filepath]\n  {:path filepath\n   :absolute (path/absolute filepath)\n   :dir (path/dirname filepath)\n   :name (path/basename filepath)\n   :stem (path/stem filepath)\n   :ext (path/extension filepath)\n   :is-absolute (path/is-absolute? filepath)})\n\n(file-info \"src/main.qi\")\n;; =&gt; {:path \"src/main.qi\"\n;;     :absolute \"/Users/alice/project/src/main.qi\"\n;;     :dir \"src\"\n;;     :name \"main.qi\"\n;;     :stem \"main\"\n;;     :ext \"qi\"\n;;     :is-absolute false}\n</code></pre>"},{"location":"spec/27-stdlib-path/#directory-traversal","title":"Directory Traversal","text":"<pre><code>;; Get all Qi files in directory\n(defn find-qi-files [dir]\n  (io/list-dir dir :recursive true)\n   |&gt; (filter (fn [f] (= (path/extension f) \"qi\")))\n   |&gt; (map path/absolute))\n\n(find-qi-files \"src\")\n;; =&gt; [\"/project/src/main.qi\"\n;;     \"/project/src/lib.qi\"\n;;     \"/project/src/utils/helpers.qi\"]\n</code></pre>"},{"location":"spec/27-stdlib-path/#safe-path-handling","title":"Safe Path Handling","text":"<pre><code>;; Validate user input path\n(defn safe-path [base-dir user-input]\n  (let [full-path (-&gt; user-input\n                      path/normalize\n                      (fn [p] (path/join base-dir p))\n                      path/absolute)]\n    ;; Prevent access outside base directory\n    (if (str/starts-with? full-path base-dir)\n      full-path\n      (throw \"Invalid path: outside base directory\"))))\n\n(safe-path \"/data/users/alice\" \"../bob/secret.txt\")\n;; Error: Invalid path: outside base directory\n\n(safe-path \"/data/users/alice\" \"documents/file.txt\")\n;; =&gt; \"/data/users/alice/documents/file.txt\"\n</code></pre>"},{"location":"spec/27-stdlib-path/#extension-based-processing","title":"Extension-based Processing","text":"<pre><code>;; Process file based on extension\n(defn process-file [filepath]\n  (match (path/extension filepath)\n    \"txt\" (io/read-file filepath)\n    \"json\" (-&gt; filepath io/read-file json/parse)\n    \"csv\" (csv/read-file filepath)\n    \"qi\" (load-file filepath)\n    _ (throw (str \"Unsupported file type: \" filepath))))\n\n;; Batch process files in directory\n(io/list-dir \"data\")\n |&gt; (map process-file)\n |&gt; (filter some?)\n</code></pre>"},{"location":"spec/27-stdlib-path/#cross-platform-support","title":"Cross-platform Support","text":"<pre><code>;; OS-specific config file path\n(defn config-path []\n  (let [home (env/get \"HOME\" (env/get \"USERPROFILE\"))]\n    (if (str/contains? (env/get \"OS\" \"\") \"Windows\")\n      (path/join home \"AppData\" \"Roaming\" \"MyApp\" \"config.json\")\n      (path/join home \".config\" \"myapp\" \"config.json\"))))\n\n;; Log file path generation\n(defn log-path [app-name]\n  (let [log-dir (if (str/contains? (env/get \"OS\" \"\") \"Windows\")\n                  (path/join (env/get \"PROGRAMDATA\") app-name \"logs\")\n                  (path/join \"/var\" \"log\" app-name))]\n    (path/join log-dir (str app-name \".log\"))))\n</code></pre>"},{"location":"spec/27-stdlib-path/#batch-relative-path-conversion","title":"Batch Relative Path Conversion","text":"<pre><code>;; Convert relative paths to absolute in project\n(def project-files [\n  \"src/main.qi\"\n  \"tests/test_main.qi\"\n  \"docs/README.md\"])\n\n(def absolute-files\n  (project-files\n   |&gt; (map path/absolute)\n   |&gt; (map path/normalize)))\n</code></pre>"},{"location":"spec/27-stdlib-path/#cross-platform-support_1","title":"Cross-platform Support","text":""},{"location":"spec/27-stdlib-path/#path-separators","title":"Path Separators","text":"<ul> <li>Unix/Linux/macOS: <code>/</code></li> <li>Windows: <code>\\</code> (display requires <code>\\\\</code> escape)</li> </ul> <p>The <code>path/</code> module automatically uses platform-specific separators.</p>"},{"location":"spec/27-stdlib-path/#absolute-path-formats","title":"Absolute Path Formats","text":"<p>Unix/Linux/macOS: <pre><code>(path/is-absolute? \"/usr/local/bin\")  ;; =&gt; true\n(path/is-absolute? \"~/Documents\")     ;; =&gt; false (~ not expanded)\n</code></pre></p> <p>Windows: <pre><code>(path/is-absolute? \"C:\\\\Program Files\")  ;; =&gt; true\n(path/is-absolute? \"\\\\\\\\server\\\\share\")  ;; =&gt; true (UNC path)\n(path/is-absolute? \"relative\\\\path\")     ;; =&gt; false\n</code></pre></p>"},{"location":"spec/27-stdlib-path/#path-normalization-differences","title":"Path Normalization Differences","text":"<p>Unix/Linux/macOS: <pre><code>(path/normalize \"/usr/./local/../bin\")\n;; =&gt; \"/usr/bin\"\n</code></pre></p> <p>Windows: <pre><code>(path/normalize \"C:\\\\Users\\\\.\\\\Alice\\\\..\\\\Bob\")\n;; =&gt; \"C:\\\\Users\\\\Bob\"\n</code></pre></p>"},{"location":"spec/27-stdlib-path/#function-list","title":"Function List","text":"Function Description Purpose <code>path/join</code> Join path elements Path construction <code>path/basename</code> Get file name File name parsing <code>path/dirname</code> Get directory part Parent directory <code>path/extension</code> Get extension File type detection <code>path/stem</code> Get file name without extension File name transformation <code>path/absolute</code> Convert to absolute path Path resolution <code>path/normalize</code> Normalize path Resolve <code>.</code> and <code>..</code> <code>path/is-absolute?</code> Check if absolute Path validation <code>path/is-relative?</code> Check if relative Path validation"},{"location":"spec/27-stdlib-path/#references","title":"References","text":"<ul> <li>Related Modules:</li> <li><code>io/</code> - File I/O</li> <li><code>env/</code> - Environment variables</li> <li><code>str/</code> - String operations</li> <li>Platforms:</li> <li>Unix/Linux/macOS and Windows support</li> <li>Uses Rust's <code>std::path</code> module</li> </ul>"},{"location":"spec/28-stdlib-stats/","title":"Standard Library: Statistical Functions","text":"<p>Statistical Computation &amp; Data Analysis</p> <p>The <code>stats/</code> module provides functions for statistical calculations. It enables easy computation of basic statistical measures such as mean, median, variance, and standard deviation.</p> <p>This module is compiled with the <code>std-stats</code> feature.</p>"},{"location":"spec/28-stdlib-stats/#overview","title":"Overview","text":"<p>The statistics module provides the following functions:</p> <ul> <li>Measures of Central Tendency: mean, median, mode</li> <li>Measures of Dispersion: variance, stddev (standard deviation)</li> <li>Measures of Position: percentile</li> </ul> <p>All functions accept lists or vectors as arguments and support numeric data (integers and floating-point numbers).</p>"},{"location":"spec/28-stdlib-stats/#measures-of-central-tendency","title":"Measures of Central Tendency","text":""},{"location":"spec/28-stdlib-stats/#statsmean-arithmetic-mean","title":"stats/mean - Arithmetic Mean","text":"<p>Calculates the arithmetic mean (average) of the data.</p> <pre><code>;; Basic usage\n(stats/mean [1 2 3 4 5])              ;; =&gt; 3.0\n\n;; Mixed integers and floats\n(stats/mean [1 2.5 3])                ;; =&gt; 2.166666...\n\n;; Works with lists too\n(stats/mean '(10 20 30))              ;; =&gt; 20.0\n\n;; Pipeline usage\n([1 2 3 4 5] |&gt; stats/mean)           ;; =&gt; 3.0\n</code></pre> <p>Arguments: - Collection (list or vector): Collection containing only numbers</p> <p>Returns: - Float: Arithmetic mean</p> <p>Errors: - Empty collection - Non-numeric elements in collection</p>"},{"location":"spec/28-stdlib-stats/#statsmedian-median","title":"stats/median - Median","text":"<p>Returns the middle value when the data is sorted in ascending order. For an even number of elements, returns the average of the two middle values.</p> <pre><code>;; Odd number of elements\n(stats/median [1 2 3 4 5])            ;; =&gt; 3.0\n\n;; Even number of elements (average of middle two)\n(stats/median [1 2 3 4])              ;; =&gt; 2.5\n\n;; Unsorted data (automatically sorted)\n(stats/median [5 1 3 2 4])            ;; =&gt; 3.0\n\n;; Floating-point numbers\n(stats/median [1.5 2.0 2.5 3.0])      ;; =&gt; 2.25\n</code></pre> <p>Arguments: - Collection (list or vector): Collection containing only numbers</p> <p>Returns: - Float: Median value</p> <p>Errors: - Empty collection - Non-numeric elements in collection</p>"},{"location":"spec/28-stdlib-stats/#statsmode-mode","title":"stats/mode - Mode","text":"<p>Returns the most frequently occurring value.</p> <pre><code>;; Basic usage\n(stats/mode [1 2 2 3 3 3])            ;; =&gt; 3\n\n;; Integers\n(stats/mode [1 1 1 2 2 3])            ;; =&gt; 1\n\n;; Floating-point numbers\n(stats/mode [1.5 1.5 2.0 2.0 2.0])    ;; =&gt; 2.0\n\n;; Pipeline usage\n([1 2 2 3 3 3] |&gt; stats/mode)         ;; =&gt; 3\n</code></pre> <p>Arguments: - Collection (list or vector): Collection containing only numbers</p> <p>Returns: - Number: Most frequent value (preserves original data type)</p> <p>Errors: - Empty collection - Non-numeric elements in collection</p> <p>Note: - If multiple values have the same maximum frequency, one of them is returned (which one is undefined)</p>"},{"location":"spec/28-stdlib-stats/#measures-of-dispersion","title":"Measures of Dispersion","text":""},{"location":"spec/28-stdlib-stats/#statsvariance-variance","title":"stats/variance - Variance","text":"<p>Calculates the variance (population variance) of the data. Variance is a measure of data spread.</p> <pre><code>;; Basic usage\n(stats/variance [1 2 3 4 5])          ;; =&gt; 2.0\n\n;; Floating-point numbers\n(stats/variance [1.0 2.0 3.0])        ;; =&gt; 0.666666...\n\n;; Pipeline usage\n([1 2 3 4 5] |&gt; stats/variance)       ;; =&gt; 2.0\n</code></pre> <p>Formula: <pre><code>variance = \u03a3(xi - mean)\u00b2 / n\n</code></pre></p> <p>Arguments: - Collection (list or vector): Collection containing only numbers</p> <p>Returns: - Float: Variance</p> <p>Errors: - Empty collection - Non-numeric elements in collection</p>"},{"location":"spec/28-stdlib-stats/#statsstddev-standard-deviation","title":"stats/stddev - Standard Deviation","text":"<p>Calculates the standard deviation of the data. Standard deviation is the square root of variance and represents data spread in the original units.</p> <pre><code>;; Basic usage\n(stats/stddev [1 2 3 4 5])            ;; =&gt; 1.414213... (\u221a2)\n\n;; Floating-point numbers\n(stats/stddev [2 4 6 8])              ;; =&gt; 2.236067... (\u221a5)\n\n;; Pipeline usage\n([1 2 3 4 5] |&gt; stats/stddev)         ;; =&gt; 1.414213...\n</code></pre> <p>Formula: <pre><code>stddev = \u221avariance\n</code></pre></p> <p>Arguments: - Collection (list or vector): Collection containing only numbers</p> <p>Returns: - Float: Standard deviation</p> <p>Errors: - Empty collection - Non-numeric elements in collection</p>"},{"location":"spec/28-stdlib-stats/#measures-of-position","title":"Measures of Position","text":""},{"location":"spec/28-stdlib-stats/#statspercentile-percentile","title":"stats/percentile - Percentile","text":"<p>Calculates the value at the specified percentile position using linear interpolation.</p> <pre><code>;; 50th percentile (same as median)\n(stats/percentile [1 2 3 4 5] 50)     ;; =&gt; 3.0\n\n;; 95th percentile\n(stats/percentile [1 2 3 4 5] 95)     ;; =&gt; 4.8\n\n;; 25th percentile (first quartile)\n(stats/percentile [1 2 3 4 5] 25)     ;; =&gt; 2.0\n\n;; 75th percentile (third quartile)\n(stats/percentile [1 2 3 4 5] 75)     ;; =&gt; 4.0\n\n;; Float percentile value\n(stats/percentile [1 2 3 4 5] 50.5)   ;; =&gt; 3.02\n\n;; Pipeline usage\n([1 2 3 4 5] |&gt; (stats/percentile _ 95))  ;; =&gt; 4.8\n</code></pre> <p>Arguments: - Collection (list or vector): Collection containing only numbers - Percentile value (integer or float): Range 0-100</p> <p>Returns: - Float: Value at the specified percentile position</p> <p>Errors: - Empty collection - Non-numeric elements in collection - Percentile value outside 0-100 range</p> <p>Note: - Uses linear interpolation, so values not present in the actual data may be returned</p>"},{"location":"spec/28-stdlib-stats/#pipeline-usage","title":"Pipeline Usage","text":"<p>Statistical functions can be naturally combined with Qi's pipeline operators.</p> <pre><code>;; Data processing pipeline\n(def data [10 20 30 40 50])\n\n(data\n |&gt; stats/mean\n |&gt; (math/round _))\n;; =&gt; 30\n\n;; Calculate multiple statistics\n(defn summary-stats [data]\n  {:mean (stats/mean data)\n   :median (stats/median data)\n   :stddev (stats/stddev data)\n   :min (apply min data)\n   :max (apply max data)})\n\n(summary-stats [1 2 3 4 5])\n;; =&gt; {:mean 3.0, :median 3.0, :stddev 1.414..., :min 1, :max 5}\n\n;; Filter and compute statistics\n([1 2 3 4 5 6 7 8 9 10]\n |&gt; (filter (fn [x] (&gt; x 5)))\n |&gt; stats/mean)\n;; =&gt; 8.0\n</code></pre>"},{"location":"spec/28-stdlib-stats/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/28-stdlib-stats/#data-analysis-pipeline","title":"Data Analysis Pipeline","text":"<pre><code>;; Analyze test scores\n(def test-scores [85 90 78 92 88 76 95 89 84 91])\n\n(defn analyze-scores [scores]\n  (let [sorted (sort scores)\n        n (len scores)]\n    {:count n\n     :mean (stats/mean scores)\n     :median (stats/median scores)\n     :stddev (stats/stddev scores)\n     :min (first sorted)\n     :max (last sorted)\n     :q1 (stats/percentile scores 25)\n     :q3 (stats/percentile scores 75)\n     :p95 (stats/percentile scores 95)}))\n\n(analyze-scores test-scores)\n;; =&gt; {:count 10\n;;     :mean 86.8\n;;     :median 88.5\n;;     :stddev 5.68...\n;;     :min 76\n;;     :max 95\n;;     :q1 83.25\n;;     :q3 91.25\n;;     :p95 94.2}\n</code></pre>"},{"location":"spec/28-stdlib-stats/#outlier-detection","title":"Outlier Detection","text":"<pre><code>;; Outlier detection using standard deviation (3-sigma method)\n(defn detect-outliers [data threshold]\n  (let [m (stats/mean data)\n        sd (stats/stddev data)\n        lower (- m (* threshold sd))\n        upper (+ m (* threshold sd))]\n    (filter (fn [x] (or (&lt; x lower) (&gt; x upper))) data)))\n\n(def data [10 12 11 13 100 12 11 10 12])\n(detect-outliers data 3)\n;; =&gt; [100]  (100 is an outlier)\n</code></pre>"},{"location":"spec/28-stdlib-stats/#normalization-z-score","title":"Normalization (z-score)","text":"<pre><code>;; Transform data to z-scores (mean=0, stddev=1)\n(defn z-score [data]\n  (let [m (stats/mean data)\n        sd (stats/stddev data)]\n    (map (fn [x] (/ (- x m) sd)) data)))\n\n(z-score [1 2 3 4 5])\n;; =&gt; [-1.414... -0.707... 0.0 0.707... 1.414...]\n</code></pre>"},{"location":"spec/28-stdlib-stats/#percentile-ranking","title":"Percentile Ranking","text":"<pre><code>;; Calculate percentile rank of a score\n(defn percentile-rank [data value]\n  (let [sorted (sort data)\n        n (len sorted)\n        below (len (filter (fn [x] (&lt; x value)) sorted))\n        equal (len (filter (fn [x] (= x value)) sorted))]\n    (* 100.0 (/ (+ below (/ equal 2.0)) n))))\n\n(def scores [70 80 85 90 95])\n(percentile-rank scores 85)\n;; =&gt; 50.0  (85 is at the 50th percentile)\n</code></pre>"},{"location":"spec/28-stdlib-stats/#group-statistics","title":"Group Statistics","text":"<pre><code>;; Calculate statistics by category\n(def data\n  [{:category \"A\" :value 10}\n   {:category \"A\" :value 20}\n   {:category \"B\" :value 30}\n   {:category \"B\" :value 40}\n   {:category \"B\" :value 50}])\n\n(defn group-stats [data key-fn value-fn]\n  (let [grouped (group-by key-fn data)]\n    (map-vals\n      (fn [items]\n        (let [values (map value-fn items)]\n          {:mean (stats/mean values)\n           :median (stats/median values)\n           :count (len values)}))\n      grouped)))\n\n(group-stats data\n  (fn [x] (get x :category))\n  (fn [x] (get x :value)))\n;; =&gt; {\"A\" {:mean 15.0, :median 15.0, :count 2}\n;;     \"B\" {:mean 40.0, :median 40.0, :count 3}}\n</code></pre>"},{"location":"spec/28-stdlib-stats/#moving-average","title":"Moving Average","text":"<pre><code>;; Simple moving average\n(defn moving-average [data window-size]\n  (let [windows (partition window-size 1 data)]\n    (map stats/mean windows)))\n\n(moving-average [1 2 3 4 5 6 7 8 9 10] 3)\n;; =&gt; [2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0]\n</code></pre>"},{"location":"spec/28-stdlib-stats/#covariance-calculation","title":"Covariance Calculation","text":"<pre><code>;; Calculate covariance between two datasets\n(defn covariance [x-data y-data]\n  (let [n (len x-data)\n        x-mean (stats/mean x-data)\n        y-mean (stats/mean y-data)\n        products (map (fn [x y] (* (- x x-mean) (- y y-mean)))\n                      x-data y-data)]\n    (/ (reduce + 0 products) n)))\n\n(def x [1 2 3 4 5])\n(def y [2 4 6 8 10])\n(covariance x y)\n;; =&gt; 4.0\n</code></pre>"},{"location":"spec/28-stdlib-stats/#error-handling","title":"Error Handling","text":"<p>Statistical functions return errors in the following cases:</p> <pre><code>;; Empty collection\n(stats/mean [])\n;; =&gt; Error: stats/mean: collection must not be empty\n\n;; Non-numeric elements\n(stats/mean [1 2 \"three\" 4])\n;; =&gt; Error: stats/mean: all elements must be numbers\n\n;; Invalid percentile value\n(stats/percentile [1 2 3] 150)\n;; =&gt; Error: stats/percentile: invalid percentile (must be 0-100)\n\n;; Error handling with try/ok\n(try\n  (stats/mean [])\n  (fn [result]\n    (match result\n      [:ok value] (println f\"Mean: {value}\")\n      [:error msg] (println f\"Error: {msg}\"))))\n</code></pre>"},{"location":"spec/28-stdlib-stats/#function-reference","title":"Function Reference","text":"Function Description Arguments Returns <code>stats/mean</code> Arithmetic mean Collection Float <code>stats/median</code> Median Collection Float <code>stats/mode</code> Mode Collection Number <code>stats/variance</code> Variance Collection Float <code>stats/stddev</code> Standard deviation Collection Float <code>stats/percentile</code> Percentile Collection, Percentile(0-100) Float"},{"location":"spec/28-stdlib-stats/#integration-with-math-functions","title":"Integration with Math Functions","text":"<p>Statistical functions can be combined with the <code>math/</code> module:</p> <pre><code>;; Coefficient of Variation (CV)\n(defn cv [data]\n  (let [m (stats/mean data)\n        sd (stats/stddev data)]\n    (* 100.0 (/ sd m))))\n\n(cv [10 12 11 13 12])\n;; =&gt; 10.5...  (CV: 10.5%)\n\n;; Range of standardized data\n(defn standardized-range [data]\n  (let [z-scores (z-score data)]\n    {:min (apply min z-scores)\n     :max (apply max z-scores)\n     :range (- (apply max z-scores) (apply min z-scores))}))\n</code></pre>"},{"location":"spec/28-stdlib-stats/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Sorting: <code>median</code> and <code>percentile</code> sort the data, resulting in O(n log n) time complexity</li> <li>Multiple Calculations: When computing multiple statistics on the same data, it's more efficient to calculate them together</li> <li>Large Datasets: For very large datasets (1 million+ elements), be mindful of memory usage</li> </ul> <pre><code>;; Efficient multiple statistics calculation\n(defn efficient-stats [data]\n  ;; Calculate mean once and reuse for variance and stddev\n  (let [m (stats/mean data)\n        v (stats/variance data)\n        sd (math/sqrt v)]  ;; Calculate from variance\n    {:mean m\n     :variance v\n     :stddev sd}))\n</code></pre>"},{"location":"spec/28-stdlib-stats/#future-extensions","title":"Future Extensions","text":"<p>The following features may be added in future versions:</p> <ul> <li>Sample variance (unbiased variance) support</li> <li>Skewness and kurtosis</li> <li>Correlation coefficient</li> <li>Basic regression analysis functions</li> <li>Histogram generation</li> <li>Box plot data calculation</li> </ul>"},{"location":"spec/28-stdlib-stats/#see-also","title":"See Also","text":"<ul> <li>Math Functions - Numeric operations and random number generation</li> <li>Collection Operations - filter, map, reduce</li> <li>Error Handling - Error handling with try/ok and match</li> </ul>"},{"location":"spec/29-stdlib-stream/","title":"Standard Library - Streams (stream/)","text":"<p>Efficient Data Processing with Lazy Evaluation - Save Memory and Handle Infinite Data Structures</p> <p>Qi's streams are lazy-evaluated data structures that compute values only when needed. They enable memory-efficient processing of large datasets and support infinite data structures.</p> <p>Implementation: <code>src/builtins/stream.rs</code></p> <p>Features: - Lazy evaluation: compute only what's needed - Infinite data structures support (infinite lists, sequences, etc.) - Perfect integration with pipeline operators (<code>|&gt;</code>) - Streaming I/O support for files and HTTP</p>"},{"location":"spec/29-stdlib-stream/#what-are-streams","title":"What are Streams?","text":""},{"location":"spec/29-stdlib-stream/#difference-from-regular-collections","title":"Difference from Regular Collections","text":"<pre><code>;; Regular list: holds all elements in memory\n(def nums [1 2 3 4 5 6 7 8 9 10])\n(def squares (map (fn [x] (* x x)) nums))\n;; =&gt; [1 4 9 16 25 36 49 64 81 100] (all computed)\n\n;; Stream: computes only what's needed\n(def s (stream/range 1 11))\n(def squares-stream (stream/map (fn [x] (* x x)) s))\n;; =&gt; &lt;Stream&gt; (not yet computed)\n\n;; Get only the first 3 elements\n(stream/realize (stream/take 3 squares-stream))\n;; =&gt; (1 4 9) (only 3 elements computed)\n</code></pre>"},{"location":"spec/29-stdlib-stream/#benefits","title":"Benefits","text":"<ol> <li>Memory Efficiency: Uses memory only for what's needed</li> <li>Infinite Data Structures: Can represent unbounded data</li> <li>Computation Optimization: Skips unnecessary calculations</li> <li>I/O Streaming: Doesn't load large files entirely into memory</li> </ol>"},{"location":"spec/29-stdlib-stream/#stream-creation","title":"Stream Creation","text":""},{"location":"spec/29-stdlib-stream/#streamstream-create-stream-from-collection","title":"stream/stream - Create Stream from Collection","text":"<pre><code>;; From list\n(def s (stream/stream [1 2 3 4 5]))\n(stream/realize s)  ;; =&gt; (1 2 3 4 5)\n\n;; From vector\n(def s (stream/stream [10 20 30]))\n(stream/realize s)  ;; =&gt; (10 20 30)\n</code></pre> <p>Arguments: - <code>coll</code>: List or vector</p> <p>Returns: Stream</p>"},{"location":"spec/29-stdlib-stream/#streamrange-range-stream","title":"stream/range - Range Stream","text":"<pre><code>;; 0 to 9\n(def s (stream/range 0 10))\n(stream/realize s)  ;; =&gt; (0 1 2 3 4 5 6 7 8 9)\n\n;; 1 to 5\n(def s (stream/range 1 6))\n(stream/realize s)  ;; =&gt; (1 2 3 4 5)\n\n;; Empty range\n(def s (stream/range 5 5))\n(stream/realize s)  ;; =&gt; ()\n</code></pre> <p>Arguments: - <code>start</code>: Start value (inclusive) - <code>end</code>: End value (exclusive)</p> <p>Returns: Stream</p>"},{"location":"spec/29-stdlib-stream/#streamiterate-infinite-stream-by-repeated-function-application","title":"stream/iterate - Infinite Stream by Repeated Function Application","text":"<pre><code>;; 1, 2, 4, 8, 16, 32, ... (double each time)\n(def s (stream/iterate (fn [x] (* x 2)) 1))\n(stream/realize (stream/take 6 s))  ;; =&gt; (1 2 4 8 16 32)\n\n;; 1, 2, 3, 4, 5, ... (increment by 1)\n(def s (stream/iterate inc 1))\n(stream/realize (stream/take 5 s))  ;; =&gt; (1 2 3 4 5)\n\n;; Fibonacci sequence\n(def fib-stream (stream/iterate (fn [[a b]] [b (+ a b)]) [0 1]))\n(stream/realize\n  (stream/take 10 fib-stream)\n  |&gt; (map first))\n;; =&gt; (0 1 1 2 3 5 8 13 21 34)\n</code></pre> <p>Arguments: - <code>f</code>: Function to apply to each element - <code>initial</code>: Initial value</p> <p>Returns: Stream (infinite)</p>"},{"location":"spec/29-stdlib-stream/#streamrepeat-infinite-stream-of-same-value","title":"stream/repeat - Infinite Stream of Same Value","text":"<pre><code>;; Repeat 42 infinitely\n(def s (stream/repeat 42))\n(stream/realize (stream/take 5 s))  ;; =&gt; (42 42 42 42 42)\n\n;; Repeat string\n(def s (stream/repeat \"hello\"))\n(stream/realize (stream/take 3 s))  ;; =&gt; (\"hello\" \"hello\" \"hello\")\n</code></pre> <p>Arguments: - <code>value</code>: Value to repeat</p> <p>Returns: Stream (infinite)</p>"},{"location":"spec/29-stdlib-stream/#streamcycle-infinite-stream-by-cycling-list","title":"stream/cycle - Infinite Stream by Cycling List","text":"<pre><code>;; Cycle [1 2 3]\n(def s (stream/cycle [1 2 3]))\n(stream/realize (stream/take 8 s))  ;; =&gt; (1 2 3 1 2 3 1 2)\n\n;; Days of week cycle\n(def days (stream/cycle [\"Mon\" \"Tue\" \"Wed\" \"Thu\" \"Fri\" \"Sat\" \"Sun\"]))\n(stream/realize (stream/take 10 days))\n;; =&gt; (\"Mon\" \"Tue\" \"Wed\" \"Thu\" \"Fri\" \"Sat\" \"Sun\" \"Mon\" \"Tue\" \"Wed\")\n</code></pre> <p>Arguments: - <code>coll</code>: List or vector (must not be empty)</p> <p>Returns: Stream (infinite)</p> <p>Error: - Raises error if collection is empty</p>"},{"location":"spec/29-stdlib-stream/#stream-operations","title":"Stream Operations","text":""},{"location":"spec/29-stdlib-stream/#streammap-apply-function-to-each-element","title":"stream/map - Apply Function to Each Element","text":"<pre><code>;; Double each element\n(def s (stream/range 1 6))\n(def s2 (stream/map (fn [x] (* x 2)) s))\n(stream/realize s2)  ;; =&gt; (2 4 6 8 10)\n\n;; Get string lengths\n(def s (stream/stream [\"hello\" \"world\" \"qi\"]))\n(def s2 (stream/map len s))\n(stream/realize s2)  ;; =&gt; (5 5 2)\n\n;; Works with infinite streams\n(def s (stream/iterate inc 1))\n(def squares (stream/map (fn [x] (* x x)) s))\n(stream/realize (stream/take 5 squares))  ;; =&gt; (1 4 9 16 25)\n</code></pre> <p>Arguments: - <code>f</code>: Function to apply to each element - <code>stream</code>: Stream</p> <p>Returns: Stream</p>"},{"location":"spec/29-stdlib-stream/#streamfilter-keep-elements-matching-predicate","title":"stream/filter - Keep Elements Matching Predicate","text":"<pre><code>;; Even numbers only\n(def s (stream/range 1 11))\n(def evens (stream/filter (fn [x] (= (% x 2) 0)) s))\n(stream/realize evens)  ;; =&gt; (2 4 6 8 10)\n\n;; Numbers greater than 10\n(def s (stream/range 1 21))\n(def large (stream/filter (fn [x] (&gt; x 10)) s))\n(stream/realize large)  ;; =&gt; (11 12 13 14 15 16 17 18 19 20)\n\n;; Multiples of 3 from infinite stream\n(def s (stream/iterate inc 1))\n(def multiples (stream/filter (fn [x] (= (% x 3) 0)) s))\n(stream/realize (stream/take 5 multiples))  ;; =&gt; (3 6 9 12 15)\n</code></pre> <p>Arguments: - <code>pred</code>: Predicate function (keeps elements returning true) - <code>stream</code>: Stream</p> <p>Returns: Stream</p>"},{"location":"spec/29-stdlib-stream/#streamtake-take-first-n-elements","title":"stream/take - Take First n Elements","text":"<pre><code>;; First 5 elements\n(def s (stream/range 0 100))\n(def s2 (stream/take 5 s))\n(stream/realize s2)  ;; =&gt; (0 1 2 3 4)\n\n;; Make infinite stream finite\n(def s (stream/repeat 42))\n(def s2 (stream/take 3 s))\n(stream/realize s2)  ;; =&gt; (42 42 42)\n\n;; Take 0 elements\n(def s (stream/range 1 10))\n(def s2 (stream/take 0 s))\n(stream/realize s2)  ;; =&gt; ()\n</code></pre> <p>Arguments: - <code>n</code>: Number of elements to take (non-negative integer) - <code>stream</code>: Stream</p> <p>Returns: Stream</p>"},{"location":"spec/29-stdlib-stream/#streamdrop-skip-first-n-elements","title":"stream/drop - Skip First n Elements","text":"<pre><code>;; Skip first 5 elements\n(def s (stream/range 0 10))\n(def s2 (stream/drop 5 s))\n(stream/realize s2)  ;; =&gt; (5 6 7 8 9)\n\n;; Skip 0 elements (no-op)\n(def s (stream/range 1 4))\n(def s2 (stream/drop 0 s))\n(stream/realize s2)  ;; =&gt; (1 2 3)\n\n;; Skip all elements\n(def s (stream/range 1 4))\n(def s2 (stream/drop 10 s))\n(stream/realize s2)  ;; =&gt; ()\n</code></pre> <p>Arguments: - <code>n</code>: Number of elements to skip (non-negative integer) - <code>stream</code>: Stream</p> <p>Returns: Stream</p>"},{"location":"spec/29-stdlib-stream/#streamrealize-convert-stream-to-list","title":"stream/realize - Convert Stream to List","text":"<pre><code>;; Execute stream and convert to list\n(def s (stream/range 1 6))\n(stream/realize s)  ;; =&gt; (1 2 3 4 5)\n\n;; Execute complex transformation chain\n(def s (stream/range 1 11))\n(stream/realize\n  (s\n   |&gt; (stream/map (fn [x] (* x x)))\n   |&gt; (stream/filter (fn [x] (&gt; x 20)))))\n;; =&gt; (25 36 49 64 81 100)\n</code></pre> <p>Arguments: - <code>stream</code>: Stream</p> <p>Returns: List</p> <p>Warning: - Realizing an infinite stream causes infinite loop - Always use <code>take</code> to make infinite streams finite before <code>realize</code></p> <pre><code>;; \u274c Bad: infinite loop\n(stream/realize (stream/repeat 42))  ;; Never terminates\n\n;; \u2705 Good: make finite with take\n(stream/realize (stream/take 5 (stream/repeat 42)))  ;; OK\n</code></pre>"},{"location":"spec/29-stdlib-stream/#pipeline-integration","title":"Pipeline Integration","text":"<p>Stream operations can be elegantly composed using Qi's pipeline operator (<code>|&gt;</code>).</p>"},{"location":"spec/29-stdlib-stream/#basic-pipelines","title":"Basic Pipelines","text":"<pre><code>;; From creation to realization\n[1 2 3 4 5]\n  |&gt; stream/stream\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (&gt; x 10)))\n  |&gt; stream/realize\n;; =&gt; (16 25)\n\n;; Range stream\n(stream/range 1 11)\n  |&gt; (stream/map (fn [x] (* x 2)))\n  |&gt; (stream/filter (fn [x] (&gt; x 10)))\n  |&gt; (stream/take 3)\n  |&gt; stream/realize\n;; =&gt; (12 14 16)\n</code></pre>"},{"location":"spec/29-stdlib-stream/#infinite-stream-pipelines","title":"Infinite Stream Pipelines","text":"<pre><code>;; First 10 powers of 2\n1\n  |&gt; (stream/iterate (fn [x] (* x 2)))\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; =&gt; (1 2 4 8 16 32 64 128 256 512)\n\n;; Multiples of 3 less than 100\n1\n  |&gt; (stream/iterate inc)\n  |&gt; (stream/filter (fn [x] (= (% x 3) 0)))\n  |&gt; (stream/take-while (fn [x] (&lt; x 100)))\n  |&gt; stream/realize\n;; =&gt; (3 6 9 12 ... 96 99)\n</code></pre>"},{"location":"spec/29-stdlib-stream/#complex-transformation-chains","title":"Complex Transformation Chains","text":"<pre><code>;; Square numbers from 1-99 that are multiples of 3\n(stream/range 1 100)\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (= (% x 3) 0)))\n  |&gt; (stream/take 5)\n  |&gt; stream/realize\n;; =&gt; (9 36 81 144 225)\n\n;; Even Fibonacci numbers\n(stream/iterate (fn [[a b]] [b (+ a b)]) [0 1])\n  |&gt; (stream/map first)\n  |&gt; (stream/filter (fn [x] (= (% x 2) 0)))\n  |&gt; (stream/take 8)\n  |&gt; stream/realize\n;; =&gt; (0 2 8 34 144 610 2584 10946)\n</code></pre>"},{"location":"spec/29-stdlib-stream/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/29-stdlib-stream/#infinite-prime-stream","title":"Infinite Prime Stream","text":"<pre><code>;; Prime checker\n(defn prime? [n]\n  (if (&lt; n 2)\n    false\n    (not (any? (fn [i] (= (% n i) 0)) (range 2 (+ 1 (sqrt n)))))))\n\n;; Infinite stream of primes\n(def primes\n  (2\n   |&gt; (stream/iterate inc)\n   |&gt; (stream/filter prime?)))\n\n;; First 20 primes\n(stream/realize (stream/take 20 primes))\n;; =&gt; (2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71)\n\n;; Primes less than 100\n(stream/realize\n  (stream/take-while (fn [x] (&lt; x 100)) primes))\n</code></pre>"},{"location":"spec/29-stdlib-stream/#large-data-aggregation","title":"Large Data Aggregation","text":"<pre><code>;; Sum of even numbers from 1 to 1 million (memory efficient)\n(stream/range 1 1000001)\n  |&gt; (stream/filter (fn [x] (= (% x 2) 0)))\n  |&gt; stream/realize\n  |&gt; (reduce + 0)\n;; =&gt; 250000500000\n\n;; With regular list, this would consume memory for 1 million items,\n;; but streams compute only what's needed\n</code></pre>"},{"location":"spec/29-stdlib-stream/#data-processing-pipeline","title":"Data Processing Pipeline","text":"<pre><code>;; Extract errors from log file (conceptual)\n(defn process-logs [data]\n  (data\n   |&gt; stream/stream\n   |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n   |&gt; (stream/map parse-log-line)\n   |&gt; (stream/take 100)  ; First 100 errors\n   |&gt; stream/realize))\n\n;; CSV data transformation\n(defn process-csv [rows]\n  (rows\n   |&gt; stream/stream\n   |&gt; (stream/drop 1)  ; Skip header\n   |&gt; (stream/map (fn [row] (str/split row \",\")))\n   |&gt; (stream/filter (fn [cols] (&gt; (len cols) 3)))\n   |&gt; (stream/map (fn [cols] {:id (first cols) :name (second cols)}))\n   |&gt; (stream/take 1000)\n   |&gt; stream/realize))\n</code></pre>"},{"location":"spec/29-stdlib-stream/#infinite-data-generation","title":"Infinite Data Generation","text":"<pre><code>;; Infinite counter\n(def counter (stream/iterate inc 0))\n\n;; Infinite timestamp sequence (conceptual)\n(def timestamps\n  (now)\n   |&gt; (stream/iterate (fn [t] (+ t 1000))))  ; Every second\n\n;; Infinite random numbers (conceptual)\n(def randoms\n  (stream/iterate (fn [_] (math/rand)) 0))\n</code></pre>"},{"location":"spec/29-stdlib-stream/#advantages-and-disadvantages","title":"Advantages and Disadvantages","text":""},{"location":"spec/29-stdlib-stream/#advantages","title":"Advantages","text":"<ol> <li>Memory Efficiency</li> <li>Can handle huge datasets</li> <li> <p>Uses memory only for what's needed</p> </li> <li> <p>Infinite Data Structures</p> </li> <li>Can represent unbounded data</li> <li> <p>Express mathematical concepts directly</p> </li> <li> <p>Lazy Computation</p> </li> <li>Skips unnecessary calculations</li> <li> <p>Early termination possible (take)</p> </li> <li> <p>Composability</p> </li> <li>Freely combine map/filter/take</li> <li>Express intuitively with pipelines</li> </ol>"},{"location":"spec/29-stdlib-stream/#disadvantages","title":"Disadvantages","text":"<ol> <li>No Random Access</li> <li>Cannot access elements by index</li> <li> <p>Sequential processing only</p> </li> <li> <p>Non-reusable</p> </li> <li>Streams can only be consumed once</li> <li> <p>Must recreate for multiple uses</p> </li> <li> <p>Harder to Debug</p> </li> <li>Lazy evaluation makes it unclear when computation happens</li> <li>Use <code>tap&gt;</code> for observation</li> </ol>"},{"location":"spec/29-stdlib-stream/#performance-guidelines","title":"Performance Guidelines","text":""},{"location":"spec/29-stdlib-stream/#when-to-use-streams","title":"When to Use Streams","text":"<ul> <li>\u2705 Processing large data (files, logs, databases)</li> <li>\u2705 Infinite data structures (sequences, generators)</li> <li>\u2705 Early termination needed (only first n elements)</li> <li>\u2705 Limited memory</li> </ul>"},{"location":"spec/29-stdlib-stream/#when-to-use-regular-collections","title":"When to Use Regular Collections","text":"<ul> <li>\u274c Small datasets (tens to hundreds of elements)</li> <li>\u274c Random access needed</li> <li>\u274c Multiple traversals needed</li> <li>\u274c Need to keep all elements</li> </ul>"},{"location":"spec/29-stdlib-stream/#performance-comparison","title":"Performance Comparison","text":"<pre><code>;; Stream: memory efficient, lazy evaluation\n(stream/range 1 1000001)\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; =&gt; Only 10 elements computed, rest are never calculated\n\n;; Regular list: computes everything\n(range 1 1000001)\n  |&gt; (map (fn [x] (* x x)))\n  |&gt; (take 10)\n;; =&gt; Computes all 1 million, then takes 10 (wasteful)\n</code></pre>"},{"location":"spec/29-stdlib-stream/#summary","title":"Summary","text":"<p>Qi's streams enable lazy evaluation for:</p> <ul> <li>Memory Efficiency: Handle large data</li> <li>Infinite Data Structures: Express mathematical concepts</li> <li>Pipeline Integration: Write intuitively with <code>|&gt;</code></li> <li>Early Termination: Compute only what's needed</li> </ul> <p>Streams are powerful for file I/O, data processing, infinite sequences, and more.</p>"},{"location":"spec/30-stdlib-temp/","title":"Standard Library - Temporary Files and Directories (io/temp)","text":"<p>Safe Temporary Resource Management</p> <p>Provides functions for creating and managing temporary files and directories. Automatic cleanup prevents resource leaks.</p>"},{"location":"spec/30-stdlib-temp/#overview","title":"Overview","text":"<p>Temporary files and directories are used for:</p> <ul> <li>Test data storage - Unit tests, integration tests</li> <li>Intermediate file generation - Data transformation pipelines, build processes</li> <li>Cache files - External API results, computation results</li> <li>Downloaded files - Temporary storage for HTTP-fetched files</li> <li>Working directories - Work areas for multi-file processing</li> </ul> <p>All temporary resources are created in the system's temporary directory (<code>/tmp</code> etc.).</p>"},{"location":"spec/30-stdlib-temp/#temporary-files","title":"Temporary Files","text":""},{"location":"spec/30-stdlib-temp/#auto-delete-recommended","title":"Auto-delete (Recommended)","text":"<pre><code>;; io/temp-file - Create temporary file (auto-deleted on program exit)\n(let [tmp (io/temp-file)]\n  (io/write-file \"temporary data\" tmp)\n  (println f\"Created temp file: {tmp}\")\n  (process-file tmp))\n;; File is automatically deleted when the program exits\n\n;; Example: Download and process data\n(defn download-and-process [url]\n  (let [tmp (io/temp-file)]\n    ;; Download data from URL\n    (http/get url :output tmp)\n    ;; Process temporary file\n    (let [result (io/read-file tmp |&gt; parse-data)]\n      ;; tmp is auto-deleted after function returns\n      result)))\n\n;; Example: Multiple temporary files\n(defn process-with-temp []\n  (let [tmp1 (io/temp-file)\n        tmp2 (io/temp-file)]\n    (io/write-file \"data 1\" tmp1)\n    (io/write-file \"data 2\" tmp2)\n    (merge-files tmp1 tmp2)))\n;; Both files are auto-deleted\n</code></pre>"},{"location":"spec/30-stdlib-temp/#manual-deletion-persist","title":"Manual deletion (Persist)","text":"<pre><code>;; io/temp-file-keep - Create temporary file (not deleted)\n(let [tmp (io/temp-file-keep)]\n  (io/write-file \"persistent data\" tmp)\n  (println f\"Created: {tmp}\")\n  tmp)\n;; =&gt; \"/tmp/qi-12345.tmp\" (not deleted, manual deletion required)\n\n;; Example: Provide result file to user\n(defn export-to-temp [data]\n  (let [tmp (io/temp-file-keep)]\n    (io/write-file (json/stringify data) tmp :encoding :utf-8-bom)\n    (println f\"Export completed: {tmp}\")\n    (println \"Please move or delete this file when done.\")\n    tmp))\n\n;; Manual deletion later\n(io/delete-file tmp)\n</code></pre>"},{"location":"spec/30-stdlib-temp/#temporary-directories","title":"Temporary Directories","text":""},{"location":"spec/30-stdlib-temp/#auto-delete-recommended_1","title":"Auto-delete (Recommended)","text":"<pre><code>;; io/temp-dir - Create temporary directory (auto-deleted on program exit)\n(let [tmpdir (io/temp-dir)]\n  (println f\"Temp directory: {tmpdir}\")\n  (io/write-file \"data1\" (path/join tmpdir \"file1.txt\"))\n  (io/write-file \"data2\" (path/join tmpdir \"file2.txt\"))\n  (process-directory tmpdir))\n;; Directory and contents are automatically deleted when the program exits\n\n;; Example: Process multiple files temporarily\n(defn process-archive [archive-path]\n  (let [tmpdir (io/temp-dir)]\n    ;; Extract archive to temporary directory\n    (archive/extract archive-path tmpdir)\n    ;; Process extracted files\n    (io/list-dir tmpdir :recursive true)\n      |&gt; (map (fn [f] (path/join tmpdir f)))\n      |&gt; (map process-file)\n      |&gt; (reduce merge)\n    ;; tmpdir and contents are auto-deleted after function returns\n    ))\n\n;; Example: Build directory\n(defn build-project []\n  (let [build-dir (io/temp-dir)]\n    ;; Copy source files to temporary directory\n    (io/copy-file \"src/main.qi\" (path/join build-dir \"main.qi\"))\n    (io/copy-file \"src/lib.qi\" (path/join build-dir \"lib.qi\"))\n    ;; Build process\n    (compile-files build-dir)\n    ;; Get output\n    (let [output (io/read-file (path/join build-dir \"output.bin\"))]\n      ;; build-dir is auto-deleted\n      output)))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#manual-deletion-persist_1","title":"Manual deletion (Persist)","text":"<pre><code>;; io/temp-dir-keep - Create temporary directory (not deleted)\n(let [tmpdir (io/temp-dir-keep)]\n  (io/write-file \"file1\" (path/join tmpdir \"data.txt\"))\n  (io/create-dir (path/join tmpdir \"subdir\"))\n  tmpdir)\n;; =&gt; \"/tmp/qi-dir-12345\" (not deleted)\n\n;; Example: Debug output directory\n(defn export-debug-info []\n  (let [debug-dir (io/temp-dir-keep)]\n    (io/write-file (json/stringify state) (path/join debug-dir \"state.json\"))\n    (io/write-file logs (path/join debug-dir \"logs.txt\"))\n    (println f\"Debug info exported to: {debug-dir}\")\n    debug-dir))\n\n;; Manual deletion later\n(io/delete-dir tmpdir :recursive true)\n</code></pre>"},{"location":"spec/30-stdlib-temp/#auto-deletion-mechanism","title":"Auto-deletion Mechanism","text":""},{"location":"spec/30-stdlib-temp/#deletion-timing","title":"Deletion Timing","text":"<p>Auto-deleted (<code>io/temp-file</code>, <code>io/temp-dir</code>): - When the program exits normally - When the program exits with an error - When the REPL session ends</p> <p>Not deleted (<code>io/temp-file-keep</code>, <code>io/temp-dir-keep</code>): - Persists after program exit - Manual deletion required (<code>io/delete-file</code>, <code>io/delete-dir</code>)</p>"},{"location":"spec/30-stdlib-temp/#implementation-details","title":"Implementation Details","text":"<pre><code>;; Auto-delete version holds internal handle\n;; OS automatically deletes on program exit\n(io/temp-file)    ;; =&gt; Handle retained \u2192 auto-deleted\n\n;; Keep version persists\n(io/temp-file-keep)  ;; =&gt; Handle released \u2192 not deleted\n</code></pre>"},{"location":"spec/30-stdlib-temp/#notes","title":"Notes","text":"<ol> <li>Long-running programs: In REPL or daemon programs, temporary files may accumulate</li> <li>Disk space: Be careful when creating many large temporary files</li> <li>Keep version deletion: Always manually delete files created with <code>io/temp-file-keep</code></li> <li>Concurrency: Temporary file names are automatically unique, safe for concurrent processing</li> </ol>"},{"location":"spec/30-stdlib-temp/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/30-stdlib-temp/#test-data-management","title":"Test Data Management","text":"<pre><code>;; Temporary file for unit tests\n(defn test-file-processing []\n  (let [tmp (io/temp-file)]\n    ;; Write test data\n    (io/write-file \"line1\\nline2\\nline3\" tmp)\n    ;; Test function\n    (let [result (process-file tmp)]\n      (assert (= result [\"line1\" \"line2\" \"line3\"]))\n      ;; tmp is auto-deleted\n      true)))\n\n;; Temporary directory for integration tests\n(defn test-directory-processing []\n  (let [tmpdir (io/temp-dir)]\n    ;; Create test file structure\n    (io/write-file \"config\" (path/join tmpdir \"config.txt\"))\n    (io/create-dir (path/join tmpdir \"data\"))\n    (io/write-file \"data1\" (path/join tmpdir \"data\" \"file1.txt\"))\n    ;; Test directory processing\n    (let [result (process-directory tmpdir)]\n      (assert (= (len result) 2))\n      ;; tmpdir and contents are auto-deleted\n      true)))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#data-transformation-pipeline","title":"Data Transformation Pipeline","text":"<pre><code>;; CSV \u2192 JSON conversion (using temporary file)\n(defn csv-to-json [csv-path json-path]\n  (let [tmp (io/temp-file)]\n    ;; Read CSV\n    (io/read-file csv-path)\n      |&gt; csv/parse\n      ;; Transform data\n      |&gt; (map transform-row)\n      ;; Output JSON to temporary file\n      |&gt; json/stringify\n      |&gt; (fn [s] (io/write-file s tmp))\n    ;; Validate\n    (validate-json tmp)\n    ;; Final output\n    (io/copy-file tmp json-path)\n    ;; tmp is auto-deleted\n    json-path))\n\n;; Merge CSV files (using temporary directory)\n(defn merge-csv-files [input-files output-path]\n  (let [tmpdir (io/temp-dir)]\n    ;; Normalize each file and save to temporary directory\n    (input-files\n      |&gt; (map-indexed (fn [i f]\n           (let [normalized (io/read-file f |&gt; normalize-csv)]\n             (io/write-file normalized\n                           (path/join tmpdir f\"file{i}.csv\"))))))\n    ;; Merge files in temporary directory\n    (io/list-dir tmpdir)\n      |&gt; (map (fn [f] (path/join tmpdir f)))\n      |&gt; (map io/read-file)\n      |&gt; (join \"\\n\")\n      |&gt; (fn [s] (io/write-file s output-path))\n    ;; tmpdir is auto-deleted\n    output-path))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#http-download-and-caching","title":"HTTP Download and Caching","text":"<pre><code>;; Download large file\n(defn download-large-file [url output-path]\n  (let [tmp (io/temp-file)]\n    ;; Download to temporary file\n    (http/get url :output tmp :timeout 300)\n    ;; Verify checksum\n    (if (verify-checksum tmp)\n      (do\n        (io/move-file tmp output-path)\n        (println f\"Download completed: {output-path}\")\n        output-path)\n      (do\n        ;; On error, tmp is auto-deleted\n        (error \"Checksum verification failed\")))))\n\n;; API client with cache\n(defn fetch-with-cache [url cache-duration]\n  (let [cache-file (io/temp-file-keep)\n        cache-age (if (io/file-exists? cache-file)\n                    (- (time/now) (get (io/file-info cache-file) \"modified\"))\n                    cache-duration)]\n    (if (&lt; cache-age cache-duration)\n      ;; Cache is valid\n      (io/read-file cache-file)\n      ;; Cache is old, refetch\n      (let [data (http/get url |&gt; get \"body\")]\n        (io/write-file data cache-file)\n        data))))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#batch-processing","title":"Batch Processing","text":"<pre><code>;; Parallel file processing\n(defn parallel-process-files [input-files]\n  (let [tmpdir (io/temp-dir)]\n    ;; Process each file in parallel\n    (input-files\n      |&gt; (pmap (fn [f]\n           (let [tmp (path/join tmpdir (path/basename f))]\n             ;; Save processing result to temporary file\n             (process-file f |&gt; (fn [result] (io/write-file result tmp)))\n             tmp)))\n      ;; Collect results\n      |&gt; (map io/read-file)\n      ;; tmpdir is auto-deleted\n      )))\n\n;; Multi-stage processing with intermediate files\n(defn multi-stage-process [input]\n  (let [stage1-file (io/temp-file)\n        stage2-file (io/temp-file)\n        stage3-file (io/temp-file)]\n    ;; Stage 1: Data cleaning\n    (input\n      |&gt; clean-data\n      |&gt; (fn [s] (io/write-file s stage1-file)))\n    ;; Stage 2: Data transformation\n    (io/read-file stage1-file\n      |&gt; transform-data\n      |&gt; (fn [s] (io/write-file s stage2-file)))\n    ;; Stage 3: Data aggregation\n    (io/read-file stage2-file\n      |&gt; aggregate-data\n      |&gt; (fn [s] (io/write-file s stage3-file)))\n    ;; Return final result\n    (let [result (io/read-file stage3-file)]\n      ;; All temporary files are auto-deleted\n      result)))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#secure-temporary-file-processing","title":"Secure Temporary File Processing","text":"<pre><code>;; Temporary storage of sensitive data (auto-delete guaranteed)\n(defn process-sensitive-data [encrypted-data]\n  (let [tmp (io/temp-file)]\n    ;; Save decrypted data to temporary file\n    (decrypt encrypted-data |&gt; (fn [s] (io/write-file s tmp)))\n    ;; Process\n    (let [result (process-data tmp)]\n      ;; tmp is auto-deleted (sensitive data does not remain)\n      result)))\n\n;; Extract password-protected archive\n(defn extract-protected-archive [archive-path password]\n  (let [tmpdir (io/temp-dir)]\n    ;; Extract\n    (archive/extract archive-path tmpdir :password password)\n    ;; Process\n    (let [result (process-files tmpdir)]\n      ;; tmpdir and contents are auto-deleted\n      result)))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#pipeline-integration","title":"Pipeline Integration","text":"<pre><code>;; Pipeline using temporary file\n(defn download-convert-upload [source-url target-url]\n  (let [tmp (io/temp-file)]\n    (source-url\n      |&gt; (http/get :output tmp)\n      |&gt; (fn [_] (io/read-file tmp))\n      |&gt; convert-format\n      |&gt; (http/post target-url :body _))\n    ;; tmp is auto-deleted\n    ))\n\n;; Complex pipeline using temporary directory\n(defn batch-convert [input-dir output-dir]\n  (let [tmpdir (io/temp-dir)]\n    (input-dir\n      |&gt; (io/list-dir :pattern \"*.txt\")\n      |&gt; (map (fn [f]\n           ;; Process each file in temporary directory\n           (let [tmp (path/join tmpdir (path/basename f))]\n             (io/read-file (path/join input-dir f)\n               |&gt; convert-content\n               |&gt; (fn [s] (io/write-file s tmp)))\n             tmp)))\n      ;; Copy processed files to output directory\n      |&gt; (map (fn [tmp]\n           (io/copy-file tmp (path/join output-dir (path/basename tmp))))))\n    ;; tmpdir is auto-deleted\n    ))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#security-considerations","title":"Security Considerations","text":""},{"location":"spec/30-stdlib-temp/#safe-temporary-file-creation","title":"Safe Temporary File Creation","text":"<p>Qi's temporary file functionality implements the following security measures:</p> <ol> <li>Unique file names: Uses unpredictable random names</li> <li>Proper permissions: Not readable by other users</li> <li>Auto-deletion: Sensitive data does not remain</li> <li>TOCTOU attack prevention: Gets handle at the same time as file creation</li> </ol> <pre><code>;; \u2705 Safe (recommended)\n(let [tmp (io/temp-file)]\n  (io/write-file sensitive-data tmp)\n  (process-file tmp))\n;; Automatically deleted on program exit\n\n;; \u274c Not recommended (manual deletion required, risk of forgetting)\n(let [tmp \"/tmp/myapp-data.txt\"]\n  (io/write-file sensitive-data tmp)\n  (process-file tmp)\n  (io/delete-file tmp))  ;; May not be deleted on error\n</code></pre>"},{"location":"spec/30-stdlib-temp/#best-practices","title":"Best Practices","text":"<ol> <li>Prefer auto-delete version: Use <code>io/temp-file</code> and <code>io/temp-dir</code></li> <li>Process sensitive data in temporary files: Auto-deleted after processing</li> <li>Minimize keep version use: Only when persistence is truly needed</li> <li>Consider disk space: Be careful when handling large files</li> <li>Error handling: Auto-deletion works even with <code>try-catch</code></li> </ol> <pre><code>;; Auto-deleted even on error\n(defn safe-process [data]\n  (let [tmp (io/temp-file)]\n    (try\n      (do\n        (io/write-file data tmp)\n        (risky-operation tmp))\n      (catch e\n        (println f\"Error: {e}\")\n        ;; tmp is auto-deleted\n        nil))))\n</code></pre>"},{"location":"spec/30-stdlib-temp/#function-list","title":"Function List","text":""},{"location":"spec/30-stdlib-temp/#temporary-files_1","title":"Temporary Files","text":"<ul> <li><code>io/temp-file</code> - Create temporary file (auto-deleted)</li> <li><code>io/temp-file-keep</code> - Create temporary file (not deleted)</li> </ul>"},{"location":"spec/30-stdlib-temp/#temporary-directories_1","title":"Temporary Directories","text":"<ul> <li><code>io/temp-dir</code> - Create temporary directory (auto-deleted)</li> <li><code>io/temp-dir-keep</code> - Create temporary directory (not deleted)</li> </ul>"},{"location":"spec/30-stdlib-temp/#summary","title":"Summary","text":"<ul> <li>Prefer auto-delete version: Prevents resource leaks</li> <li>Secure: Ideal for temporary processing of sensitive data</li> <li>Simple: No explicit deletion code required</li> <li>Pipeline integration: Combines with Qi's pipeline operators for powerful data processing</li> </ul>"},{"location":"spec/31-stdlib-time/","title":"Standard Library - Time Operations (time/)","text":"<p>24+ time manipulation functions</p> <p>All functions belong to the <code>time/</code> module.</p>"},{"location":"spec/31-stdlib-time/#current-time-retrieval","title":"Current Time Retrieval","text":""},{"location":"spec/31-stdlib-time/#iso-8601-format","title":"ISO 8601 Format","text":"<pre><code>;; time/now-iso - Get current time in ISO 8601 format\n(time/now-iso)                           ;; =&gt; \"2025-11-10T15:30:45.123456789+00:00\"\n\n;; time/today - Get today's date in YYYY-MM-DD format\n(time/today)                             ;; =&gt; \"2025-11-10\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#unix-timestamp-conversion","title":"Unix Timestamp Conversion","text":"<pre><code>;; time/from-unix - Convert Unix timestamp (seconds) to ISO 8601 format\n(time/from-unix 1699632000)              ;; =&gt; \"2023-11-10T12:00:00+00:00\"\n\n;; time/to-unix - Convert ISO 8601 string to Unix timestamp (seconds)\n(time/to-unix \"2023-11-10T12:00:00+00:00\") ;; =&gt; 1699632000\n</code></pre>"},{"location":"spec/31-stdlib-time/#datetime-formatting","title":"Date/Time Formatting","text":""},{"location":"spec/31-stdlib-time/#format-format-as-arbitrary-string","title":"format - Format as arbitrary string","text":"<pre><code>;; time/format - Format timestamp with specified format string\n;; Arg 1: Unix timestamp (integer) or ISO 8601 string\n;; Arg 2: Format string (strftime format)\n\n(time/format 1699632000 \"%Y-%m-%d\")      ;; =&gt; \"2023-11-10\"\n(time/format 1699632000 \"%Y\u5e74%m\u6708%d\u65e5\")  ;; =&gt; \"2023\u5e7411\u670810\u65e5\"\n(time/format 1699632000 \"%H:%M:%S\")      ;; =&gt; \"12:00:00\"\n\n;; ISO 8601 strings are also accepted\n(time/format \"2023-11-10T12:00:00+00:00\" \"%Y/%m/%d %H:%M\")\n;; =&gt; \"2023/11/10 12:00\"\n\n;; Pipeline usage\n(time/now-iso\n |&gt; (time/format _ \"%Y-%m-%d %H:%M:%S\")) ;; =&gt; \"2025-11-10 15:30:45\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#common-strftime-format-specifiers","title":"Common strftime Format Specifiers","text":"Specifier Meaning Example <code>%Y</code> Year (4 digits) 2025 <code>%m</code> Month (2 digits) 11 <code>%d</code> Day (2 digits) 10 <code>%H</code> Hour (24-hour, 2 digits) 15 <code>%I</code> Hour (12-hour, 2 digits) 03 <code>%M</code> Minute (2 digits) 30 <code>%S</code> Second (2 digits) 45 <code>%p</code> AM/PM PM <code>%A</code> Weekday (full) Sunday <code>%a</code> Weekday (abbr) Sun <code>%B</code> Month name (full) November <code>%b</code> Month name (abbr) Nov"},{"location":"spec/31-stdlib-time/#datetime-parsing","title":"Date/Time Parsing","text":""},{"location":"spec/31-stdlib-time/#parse-parse-with-format-specification","title":"parse - Parse with format specification","text":"<pre><code>;; time/parse - Parse date string using format string\n;; Arg 1: Date string\n;; Arg 2: Format string (strftime format)\n;; Returns: Unix timestamp (integer)\n\n(time/parse \"2023-11-10\" \"%Y-%m-%d\")     ;; =&gt; 1699632000\n(time/parse \"2023\u5e7411\u670810\u65e5\" \"%Y\u5e74%m\u6708%d\u65e5\")\n;; =&gt; 1699632000\n\n(time/parse \"10/11/2023 15:30\" \"%d/%m/%Y %H:%M\")\n;; =&gt; 1699632600\n</code></pre>"},{"location":"spec/31-stdlib-time/#datetime-arithmetic","title":"Date/Time Arithmetic","text":""},{"location":"spec/31-stdlib-time/#addition","title":"Addition","text":"<pre><code>;; time/add-days - Add days to a date\n(time/add-days 1699632000 7)             ;; =&gt; 1700236800 (7 days later)\n\n;; time/add-hours - Add hours to a date\n(time/add-hours 1699632000 24)           ;; =&gt; 1699718400 (24 hours later)\n\n;; time/add-minutes - Add minutes to a date\n(time/add-minutes 1699632000 30)         ;; =&gt; 1699633800 (30 minutes later)\n\n;; ISO 8601 strings are also accepted\n(time/add-days \"2023-11-10T12:00:00+00:00\" 1)\n;; =&gt; 1699718400 (next day)\n\n;; Pipeline usage\n(time/now-iso\n |&gt; time/to-unix\n |&gt; (time/add-days _ 7)\n |&gt; (time/format _ \"%Y-%m-%d\")) ;; =&gt; \"2025-11-17\" (7 days later)\n</code></pre>"},{"location":"spec/31-stdlib-time/#subtraction","title":"Subtraction","text":"<pre><code>;; time/sub-days - Subtract days from a date\n(time/sub-days 1699632000 7)             ;; =&gt; 1699027200 (7 days earlier)\n\n;; time/sub-hours - Subtract hours from a date\n(time/sub-hours 1699632000 24)           ;; =&gt; 1699545600 (24 hours earlier)\n\n;; time/sub-minutes - Subtract minutes from a date\n(time/sub-minutes 1699632000 30)         ;; =&gt; 1699630200 (30 minutes earlier)\n</code></pre>"},{"location":"spec/31-stdlib-time/#difference-calculation","title":"Difference Calculation","text":"<pre><code>;; time/diff-days - Get the difference between two dates in days\n(time/diff-days \"2023-11-17T12:00:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; 7 (days)\n\n;; time/diff-hours - Get the difference between two dates in hours\n(time/diff-hours \"2023-11-10T15:00:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; 3 (hours)\n\n;; time/diff-minutes - Get the difference between two dates in minutes\n(time/diff-minutes \"2023-11-10T12:30:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; 30 (minutes)\n\n;; Negative values are also returned\n(time/diff-days \"2023-11-10T12:00:00+00:00\" \"2023-11-17T12:00:00+00:00\")\n;; =&gt; -7 (date1 is before date2)\n</code></pre>"},{"location":"spec/31-stdlib-time/#datetime-comparison","title":"Date/Time Comparison","text":"<pre><code>;; time/before? - Check if date1 is before date2\n(time/before? \"2023-11-10T12:00:00+00:00\" \"2023-11-17T12:00:00+00:00\")\n;; =&gt; true\n\n;; time/after? - Check if date1 is after date2\n(time/after? \"2023-11-17T12:00:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; true\n\n;; time/between? - Check if date is between start and end (inclusive)\n(time/between? \"2023-11-15T12:00:00+00:00\"\n               \"2023-11-10T12:00:00+00:00\"\n               \"2023-11-20T12:00:00+00:00\")\n;; =&gt; true\n\n;; Unix timestamps can also be used\n(time/before? 1699632000 1700236800)     ;; =&gt; true\n</code></pre>"},{"location":"spec/31-stdlib-time/#datetime-component-extraction","title":"Date/Time Component Extraction","text":"<pre><code>;; time/year - Extract year from date\n(time/year \"2023-11-10T12:00:00+00:00\")  ;; =&gt; 2023\n\n;; time/month - Extract month from date (1-12)\n(time/month \"2023-11-10T12:00:00+00:00\") ;; =&gt; 11\n\n;; time/day - Extract day from date (1-31)\n(time/day \"2023-11-10T12:00:00+00:00\")   ;; =&gt; 10\n\n;; time/hour - Extract hour from date (0-23)\n(time/hour \"2023-11-10T12:00:00+00:00\")  ;; =&gt; 12\n\n;; time/minute - Extract minute from date (0-59)\n(time/minute \"2023-11-10T12:35:00+00:00\") ;; =&gt; 35\n\n;; time/second - Extract second from date (0-59)\n(time/second \"2023-11-10T12:00:45+00:00\") ;; =&gt; 45\n\n;; time/weekday - Extract weekday from date (0=Sunday, 1=Monday, ..., 6=Saturday)\n(time/weekday \"2023-11-10T12:00:00+00:00\") ;; =&gt; 5 (Friday)\n\n;; Unix timestamps can also be used\n(time/year 1699632000)                   ;; =&gt; 2023\n</code></pre>"},{"location":"spec/31-stdlib-time/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/31-stdlib-time/#log-timestamps","title":"Log Timestamps","text":"<pre><code>;; Log with current timestamp\n(defn log [level msg]\n  (println (str/format \"[{}] {} - {}\"\n                       (time/format (time/now-iso) \"%Y-%m-%d %H:%M:%S\")\n                       level\n                       msg)))\n\n(log \"INFO\" \"Application started\")\n;; =&gt; \"[2025-11-10 15:30:45] INFO - Application started\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#datetime-calculation-pipeline","title":"Date/Time Calculation Pipeline","text":"<pre><code>;; Calculate 9:00 AM, 7 days from now\n(time/now-iso\n |&gt; time/to-unix\n |&gt; (time/add-days _ 7)\n |&gt; (time/format _ \"%Y-%m-%d 09:00:00\")\n |&gt; (time/parse _ \"%Y-%m-%d %H:%M:%S\"))\n;; =&gt; 1700467200 (Unix timestamp for 9:00 AM, 7 days later)\n\n;; Business day calculation (excluding weekends, 5 days ahead)\n(defn add-business-days [date days]\n  (let [target (time/add-days date days)]\n    (let [wd (time/weekday target)]\n      (cond\n        (= wd 0) (time/add-days target 1)  ;; Sunday -&gt; Monday\n        (= wd 6) (time/add-days target 2)  ;; Saturday -&gt; Monday\n        :else target))))\n\n(add-business-days (time/to-unix \"2023-11-10T12:00:00+00:00\") 5)\n;; =&gt; 5 business days later, accounting for weekends\n</code></pre>"},{"location":"spec/31-stdlib-time/#deadline-management","title":"Deadline Management","text":"<pre><code>;; Check if task is overdue\n(defn is-overdue? [due-date]\n  (time/before? due-date (time/now-iso)))\n\n(is-overdue? \"2025-11-01T23:59:59+00:00\") ;; =&gt; true\n\n;; Days remaining until deadline\n(defn days-until [due-date]\n  (time/diff-days due-date (time/now-iso)))\n\n(days-until \"2025-12-25T00:00:00+00:00\") ;; =&gt; 45 (45 days remaining)\n\n;; Check if within deadline\n(defn is-within-deadline? [start end]\n  (time/between? (time/now-iso) start end))\n\n(is-within-deadline? \"2025-11-01T00:00:00+00:00\" \"2025-12-31T23:59:59+00:00\")\n;; =&gt; true\n</code></pre>"},{"location":"spec/31-stdlib-time/#data-aggregation","title":"Data Aggregation","text":"<pre><code>;; Extract today's errors from log files\n(defn today-errors [logs]\n  (let [today (time/today)]\n    (logs\n     |&gt; (filter (fn [log]\n              (and\n                (str/contains? log \"ERROR\")\n                (str/starts-with? log today)))))))\n\n(today-errors [\"2025-11-10 10:30 ERROR: DB connection failed\"\n               \"2025-11-09 14:20 ERROR: Timeout\"\n               \"2025-11-10 15:45 ERROR: Invalid input\"])\n;; =&gt; [\"2025-11-10 10:30 ERROR: DB connection failed\"\n;;     \"2025-11-10 15:45 ERROR: Invalid input\"]\n</code></pre>"},{"location":"spec/31-stdlib-time/#time-range-filtering","title":"Time Range Filtering","text":"<pre><code>;; Filter events by time period\n(defn filter-by-period [events start end]\n  (events\n   |&gt; (filter (fn [evt]\n            (time/between? (get evt :timestamp) start end)))))\n\n(def events [{:timestamp \"2023-11-10T10:00:00+00:00\" :type \"login\"}\n             {:timestamp \"2023-11-15T14:30:00+00:00\" :type \"purchase\"}\n             {:timestamp \"2023-11-20T09:00:00+00:00\" :type \"logout\"}])\n\n(filter-by-period events\n                  \"2023-11-10T00:00:00+00:00\"\n                  \"2023-11-16T00:00:00+00:00\")\n;; =&gt; [{:timestamp \"2023-11-10T10:00:00+00:00\" :type \"login\"}\n;;     {:timestamp \"2023-11-15T14:30:00+00:00\" :type \"purchase\"}]\n</code></pre>"},{"location":"spec/31-stdlib-time/#weekday-detection","title":"Weekday Detection","text":"<pre><code>;; Check if weekend\n(defn is-weekend? [date]\n  (let [wd (time/weekday date)]\n    (or (= wd 0) (= wd 6))))\n\n(is-weekend? \"2023-11-11T12:00:00+00:00\") ;; =&gt; true (Saturday)\n(is-weekend? \"2023-11-10T12:00:00+00:00\") ;; =&gt; false (Friday)\n\n;; Get weekday name\n(def weekdays [\"Sun\" \"Mon\" \"Tue\" \"Wed\" \"Thu\" \"Fri\" \"Sat\"])\n\n(defn weekday-name [date]\n  (get weekdays (time/weekday date)))\n\n(weekday-name \"2023-11-10T12:00:00+00:00\") ;; =&gt; \"Fri\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#datetime-batch-processing","title":"Date/Time Batch Processing","text":"<pre><code>;; Generate hourly data points\n(defn hourly-points [start-date hours]\n  (stream/range 0 hours)\n  |&gt; (map (fn [h] (time/add-hours start-date h)))\n  |&gt; (map (fn [ts] (time/format ts \"%Y-%m-%d %H:00:00\")))\n  |&gt; collect)\n\n(hourly-points (time/to-unix \"2023-11-10T00:00:00+00:00\") 24)\n;; =&gt; [\"2023-11-10 00:00:00\" \"2023-11-10 01:00:00\" ... \"2023-11-10 23:00:00\"]\n</code></pre>"},{"location":"spec/31-stdlib-time/#time-zones","title":"Time Zones","text":"<p>Important: All time operations are performed in UTC (Coordinated Universal Time).</p>"},{"location":"spec/31-stdlib-time/#iso-8601-format-times","title":"ISO 8601 Format Times","text":"<ul> <li><code>time/now-iso</code> returns UTC timezone (<code>+00:00</code>)</li> <li><code>time/format</code>, <code>time/parse</code> treat times as UTC</li> <li>For local timezones, manually calculate the offset</li> </ul> <pre><code>;; Current time in UTC\n(time/now-iso)  ;; =&gt; \"2025-11-10T15:30:45+00:00\"\n\n;; Convert to Japan time (UTC+9)\n(time/now-iso\n |&gt; time/to-unix\n |&gt; (time/add-hours _ 9)\n |&gt; (time/format _ \"%Y-%m-%d %H:%M:%S JST\"))\n;; =&gt; \"2025-11-11 00:30:45 JST\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#error-handling","title":"Error Handling","text":""},{"location":"spec/31-stdlib-time/#invalid-datetime-strings","title":"Invalid Date/Time Strings","text":"<pre><code>;; Invalid ISO 8601 format\n(time/to-unix \"invalid-date\")\n;; =&gt; Error: \"time/to-unix: Invalid date format: invalid-date\"\n\n;; Parse failure\n(time/parse \"2023-13-45\" \"%Y-%m-%d\")\n;; =&gt; Error: \"time/parse: Failed to parse date string '2023-13-45' with format '%Y-%m-%d'\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#invalid-timestamps","title":"Invalid Timestamps","text":"<pre><code>;; Out-of-range Unix timestamp\n(time/from-unix 99999999999999)\n;; =&gt; Error: \"time/from-unix: Invalid timestamp\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#type-errors","title":"Type Errors","text":"<pre><code>;; Non-string argument\n(time/to-unix 123)\n;; =&gt; Error: \"time/to-unix: Only accepts strings\"\n\n;; Non-integer days\n(time/add-days \"2023-11-10T12:00:00+00:00\" \"7\")\n;; =&gt; Error: \"time/add-days (days): Only accepts integers\"\n</code></pre>"},{"location":"spec/31-stdlib-time/#function-reference","title":"Function Reference","text":""},{"location":"spec/31-stdlib-time/#current-time-retrieval_1","title":"Current Time Retrieval","text":"<ul> <li><code>time/now-iso</code> - Get current time in ISO 8601 format</li> <li><code>time/today</code> - Get today's date in YYYY-MM-DD format</li> </ul>"},{"location":"spec/31-stdlib-time/#unix-timestamp-conversion_1","title":"Unix Timestamp Conversion","text":"<ul> <li><code>time/from-unix</code> - Unix timestamp \u2192 ISO 8601 format</li> <li><code>time/to-unix</code> - ISO 8601 format \u2192 Unix timestamp</li> </ul>"},{"location":"spec/31-stdlib-time/#formattingparsing","title":"Formatting/Parsing","text":"<ul> <li><code>time/format</code> - Format timestamp with specified format string</li> <li><code>time/parse</code> - Parse date string using format string</li> </ul>"},{"location":"spec/31-stdlib-time/#datetime-arithmetic-addition","title":"Date/Time Arithmetic (Addition)","text":"<ul> <li><code>time/add-days</code> - Add days</li> <li><code>time/add-hours</code> - Add hours</li> <li><code>time/add-minutes</code> - Add minutes</li> </ul>"},{"location":"spec/31-stdlib-time/#datetime-arithmetic-subtraction","title":"Date/Time Arithmetic (Subtraction)","text":"<ul> <li><code>time/sub-days</code> - Subtract days</li> <li><code>time/sub-hours</code> - Subtract hours</li> <li><code>time/sub-minutes</code> - Subtract minutes</li> </ul>"},{"location":"spec/31-stdlib-time/#datetime-arithmetic-difference","title":"Date/Time Arithmetic (Difference)","text":"<ul> <li><code>time/diff-days</code> - Get difference in days</li> <li><code>time/diff-hours</code> - Get difference in hours</li> <li><code>time/diff-minutes</code> - Get difference in minutes</li> </ul>"},{"location":"spec/31-stdlib-time/#datetime-comparison_1","title":"Date/Time Comparison","text":"<ul> <li><code>time/before?</code> - Check if date1 is before date2</li> <li><code>time/after?</code> - Check if date1 is after date2</li> <li><code>time/between?</code> - Check if date is between start and end</li> </ul>"},{"location":"spec/31-stdlib-time/#component-extraction","title":"Component Extraction","text":"<ul> <li><code>time/year</code> - Extract year</li> <li><code>time/month</code> - Extract month (1-12)</li> <li><code>time/day</code> - Extract day (1-31)</li> <li><code>time/hour</code> - Extract hour (0-23)</li> <li><code>time/minute</code> - Extract minute (0-59)</li> <li><code>time/second</code> - Extract second (0-59)</li> <li><code>time/weekday</code> - Extract weekday (0=Sunday, 1=Monday, ..., 6=Saturday)</li> </ul>"},{"location":"spec/31-stdlib-time/#design-notes","title":"Design Notes","text":""},{"location":"spec/31-stdlib-time/#adoption-of-iso-8601-format","title":"Adoption of ISO 8601 Format","text":"<p>All string-based date/time representations use ISO 8601 format (RFC 3339). This provides:</p> <ul> <li>Explicit timezone information: Always includes timezone like <code>+00:00</code></li> <li>International standard: Easy data exchange between programs</li> <li>Sortable: Correct ordering even with string comparison</li> <li>Clarity: No ambiguity in dates (MM/DD vs DD/MM, etc.)</li> </ul>"},{"location":"spec/31-stdlib-time/#unix-timestamp-compatibility","title":"Unix Timestamp Compatibility","text":"<ul> <li>Unix timestamps (integers) are convenient for external system integration and database storage</li> <li><code>time/to-unix</code>, <code>time/from-unix</code> provide bi-directional conversion</li> <li>Calculation results are primarily returned as Unix timestamps (easier for pipeline processing)</li> </ul>"},{"location":"spec/31-stdlib-time/#argument-flexibility","title":"Argument Flexibility","text":"<p>Many functions accept both Unix timestamps and ISO 8601 strings:</p> <pre><code>;; Both are valid\n(time/add-days 1699632000 7)\n(time/add-days \"2023-11-10T12:00:00+00:00\" 7)\n</code></pre> <p>This makes pipeline processing smoother.</p>"},{"location":"spec/32-stdlib-zip/","title":"Standard Library - ZIP Compression/Decompression (zip/)","text":"<p>ZIP/gzip Compression and Decompression Library</p> <p>Supports archive creation/extraction using ZIP format, and single-file compression using gzip.</p> <p>Feature Gate: This module is compiled with the <code>util-zip</code> feature.</p>"},{"location":"spec/32-stdlib-zip/#basic-operations","title":"Basic Operations","text":""},{"location":"spec/32-stdlib-zip/#creating-zip-files","title":"Creating ZIP Files","text":"<pre><code>;; zip/create - Create a ZIP file\n(zip/create \"backup.zip\" \"data.txt\" \"config.json\")\n;; =&gt; \"backup.zip\"\n\n;; Compress multiple files\n(zip/create \"archive.zip\" \"file1.txt\" \"file2.txt\" \"file3.txt\")\n\n;; Compress entire directory\n(zip/create \"logs.zip\" \"logs/\")\n;; =&gt; All files in logs directory are added recursively\n\n;; Mix files and directories\n(zip/create \"backup.zip\" \"README.md\" \"src/\" \"config/\")\n</code></pre>"},{"location":"spec/32-stdlib-zip/#extracting-zip-files","title":"Extracting ZIP Files","text":"<pre><code>;; zip/extract - Extract ZIP file (to current directory)\n(zip/extract \"backup.zip\")\n;; =&gt; \".\"\n\n;; Specify destination directory\n(zip/extract \"archive.zip\" \"output/\")\n;; =&gt; \"output/\"\n\n;; Use in pipeline\n(\"backup.zip\" |&gt; zip/extract)\n</code></pre>"},{"location":"spec/32-stdlib-zip/#listing-zip-contents","title":"Listing ZIP Contents","text":"<pre><code>;; zip/list - Get ZIP contents\n(zip/list \"backup.zip\")\n;; =&gt; [\n;;      {:name \"data.txt\" :size 1234 :compressed-size 567 :is-dir false}\n;;      {:name \"config.json\" :size 456 :compressed-size 123 :is-dir false}\n;;      {:name \"logs/\" :size 0 :compressed-size 0 :is-dir true}\n;;    ]\n\n;; Get only file names\n(zip/list \"backup.zip\"\n |&gt; (map (fn [entry] (get entry \"name\"))))\n;; =&gt; [\"data.txt\" \"config.json\" \"logs/\"]\n\n;; Calculate compression ratios\n(zip/list \"backup.zip\"\n |&gt; (map (fn [entry]\n           (let [original (get entry \"size\")\n                 compressed (get entry \"compressed-size\")\n                 ratio (if (&gt; original 0)\n                         (* 100 (/ compressed original))\n                         0)]\n             {:name (get entry \"name\")\n              :ratio ratio}))))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#adding-to-existing-zip","title":"Adding to Existing ZIP","text":"<pre><code>;; zip/add - Add files to existing ZIP\n(zip/add \"backup.zip\" \"new-file.txt\")\n;; =&gt; \"backup.zip\"\n\n;; Add multiple files\n(zip/add \"backup.zip\" \"file1.txt\" \"file2.txt\" \"dir/\")\n\n;; Use in pipeline\n(\"backup.zip\" |&gt; (zip/add _ \"update.txt\"))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#gzip-compression","title":"gzip Compression","text":""},{"location":"spec/32-stdlib-zip/#basic-operations_1","title":"Basic Operations","text":"<pre><code>;; zip/gzip - Compress file with gzip\n(zip/gzip \"data.txt\")\n;; =&gt; \"data.txt.gz\" (automatically adds .gz extension)\n\n;; Specify output filename\n(zip/gzip \"data.txt\" \"backup.gz\")\n;; =&gt; \"backup.gz\"\n\n;; zip/gunzip - Decompress gzip file\n(zip/gunzip \"data.txt.gz\")\n;; =&gt; \"data.txt\" (automatically removes .gz extension)\n\n;; Specify output filename\n(zip/gunzip \"backup.gz\" \"restored.txt\")\n;; =&gt; \"restored.txt\"\n</code></pre>"},{"location":"spec/32-stdlib-zip/#using-in-pipelines","title":"Using in Pipelines","text":"<pre><code>;; gzip compression pipeline\n(\"data.txt\" |&gt; zip/gzip)\n;; =&gt; \"data.txt.gz\"\n\n;; gzip decompression pipeline\n(\"data.txt.gz\" |&gt; zip/gunzip)\n;; =&gt; \"data.txt\"\n\n;; Chain compress, process, decompress\n(\"large-data.txt\"\n |&gt; zip/gzip\n |&gt; upload-to-server\n |&gt; download-from-server\n |&gt; zip/gunzip)\n</code></pre>"},{"location":"spec/32-stdlib-zip/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/32-stdlib-zip/#backup-system","title":"Backup System","text":"<pre><code>;; Daily backup\n(defn create-backup [date]\n  (let [backup-name f\"backup-{date}.zip\"]\n    (zip/create backup-name \"data/\" \"config/\" \"logs/\")\n    (println f\"Backup created: {backup-name}\")))\n\n(create-backup \"2024-11-10\")\n;; =&gt; \"Backup created: backup-2024-11-10.zip\"\n\n;; Backup multiple directories individually\n(def dirs [\"data\" \"config\" \"logs\"])\n\n(dirs\n |&gt; (map (fn [dir]\n           (let [zip-file f\"{dir}-backup.zip\"]\n             (zip/create zip-file f\"{dir}/\")\n             {:dir dir :file zip-file})))\n |&gt; (map println))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#log-file-rotation","title":"Log File Rotation","text":"<pre><code>;; Archive old logs\n(defn archive-old-logs [days]\n  (let [cutoff (- (time/now) (* days 86400))]\n    (io/list-dir \"logs\" :pattern \"*.log\")\n    |&gt; (filter (fn [file]\n                 (let [info (io/file-info file)\n                       modified (get info \"modified\")]\n                   (&lt; modified cutoff))))\n    |&gt; (map (fn [file]\n              ;; Compress with gzip\n              (let [gz (zip/gzip file)]\n                ;; Delete original\n                (io/delete-file file)\n                gz)))))\n\n;; Compress logs older than 7 days\n(archive-old-logs 7)\n</code></pre>"},{"location":"spec/32-stdlib-zip/#creating-distribution-archives","title":"Creating Distribution Archives","text":"<pre><code>;; Create release ZIP\n(defn create-release [version]\n  (let [archive-name f\"myapp-{version}.zip\"\n        files [\"README.md\"\n               \"LICENSE\"\n               \"bin/\"\n               \"lib/\"\n               \"docs/\"]]\n    ;; Copy necessary files to temporary directory\n    (let [tmpdir (io/temp-dir)\n          dest-dir (path/join tmpdir f\"myapp-{version}\")]\n      (io/create-dir dest-dir)\n\n      ;; Copy files\n      (files\n       |&gt; (map (fn [file]\n                 (let [dest (path/join dest-dir (path/basename file))]\n                   (if (io/is-dir? file)\n                     (copy-dir-recursive file dest)\n                     (io/copy-file file dest))))))\n\n      ;; Create ZIP\n      (zip/create archive-name dest-dir)\n      archive-name)))\n\n(create-release \"1.0.0\")\n;; =&gt; \"myapp-1.0.0.zip\"\n</code></pre>"},{"location":"spec/32-stdlib-zip/#download-and-extract-data","title":"Download and Extract Data","text":"<pre><code>;; Download archive from web and extract\n(defn download-and-extract [url dest-dir]\n  (let [tmpfile (io/temp-file)]\n    ;; Download\n    (http/get url :output tmpfile)\n\n    ;; Extract\n    (zip/extract tmpfile dest-dir)\n\n    ;; Temporary file is automatically deleted\n    (println f\"Extracted to: {dest-dir}\")))\n\n(download-and-extract \"https://example.com/data.zip\" \"data/\")\n</code></pre>"},{"location":"spec/32-stdlib-zip/#processing-large-numbers-of-files","title":"Processing Large Numbers of Files","text":"<pre><code>;; Compress all files in directory individually\n(defn compress-all-files [dir]\n  (io/list-dir dir :pattern \"*.*\")\n  |&gt; (filter io/is-file?)\n  |&gt; (map zip/gzip)\n  |&gt; (map println))\n\n(compress-all-files \"documents/\")\n\n;; Parallel compression (fast processing for many files)\n(defn compress-all-parallel [dir]\n  (io/list-dir dir :pattern \"*.*\")\n  |&gt; (filter io/is-file?)\n  ||&gt; zip/gzip\n  |&gt; (map println))\n\n(compress-all-parallel \"logs/\")\n</code></pre>"},{"location":"spec/32-stdlib-zip/#backup-verification","title":"Backup Verification","text":"<pre><code>;; Check ZIP integrity\n(defn verify-backup [zip-file expected-files]\n  (let [entries (zip/list zip-file)\n        names (entries |&gt; (map (fn [e] (get e \"name\"))))]\n    (expected-files\n     |&gt; (map (fn [file]\n               (let [found (names |&gt; (filter (fn [n] (str/contains? n file))))]\n                 {:file file\n                  :found (not (empty? found))})))\n     |&gt; (filter (fn [result] (not (get result \"found\")))))))\n\n(def expected [\"data.txt\" \"config.json\" \"logs/\"])\n(let [missing (verify-backup \"backup.zip\" expected)]\n  (if (empty? missing)\n    (println \"Backup verified: all files present\")\n    (do\n      (println \"Missing files:\")\n      (missing |&gt; (map (fn [m] (get m \"file\"))) |&gt; (map println)))))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#error-handling","title":"Error Handling","text":""},{"location":"spec/32-stdlib-zip/#file-not-found","title":"File Not Found","text":"<pre><code>;; Catch errors with try-catch\n(try\n  (zip/create \"backup.zip\" \"nonexistent.txt\")\n  (catch e\n    (println f\"Error: {e}\")))\n;; =&gt; \"Error: zip/create: path does not exist: 'nonexistent.txt'\"\n\n;; Pre-check\n(defn safe-create-zip [zip-file files]\n  (let [missing (files |&gt; (filter (fn [f] (not (io/file-exists? f)))))]\n    (if (empty? missing)\n      (zip/create zip-file ..files)\n      (do\n        (println \"Missing files:\")\n        (missing |&gt; (map println))\n        :error))))\n\n(safe-create-zip \"backup.zip\" [\"file1.txt\" \"file2.txt\"])\n</code></pre>"},{"location":"spec/32-stdlib-zip/#protecting-destination","title":"Protecting Destination","text":"<pre><code>;; Skip if destination directory exists\n(defn safe-extract [zip-file dest-dir]\n  (if (io/file-exists? dest-dir)\n    (do\n      (println f\"Destination already exists: {dest-dir}\")\n      :skip)\n    (zip/extract zip-file dest-dir)))\n\n;; Confirm overwrite\n(defn extract-with-confirm [zip-file dest-dir]\n  (if (io/file-exists? dest-dir)\n    (do\n      (print f\"Overwrite {dest-dir}? (y/n): \")\n      (let [answer (io/stdin-line)]\n        (if (= answer \"y\")\n          (do\n            (io/delete-dir dest-dir :recursive true)\n            (zip/extract zip-file dest-dir))\n          (println \"Cancelled\"))))\n    (zip/extract zip-file dest-dir)))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#disk-space-check","title":"Disk Space Check","text":"<pre><code>;; Check space before extraction\n(defn check-space-before-extract [zip-file dest-dir]\n  (let [entries (zip/list zip-file)\n        total-size (entries\n                    |&gt; (map (fn [e] (get e \"size\")))\n                    |&gt; (reduce + 0))]\n    (println f\"Archive size: {total-size} bytes\")\n    ;; TODO: Check available disk space\n    (zip/extract zip-file dest-dir)))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#pipeline-integration","title":"Pipeline Integration","text":""},{"location":"spec/32-stdlib-zip/#file-processing-pipeline","title":"File Processing Pipeline","text":"<pre><code>;; Process files and add to ZIP\n(io/list-dir \"data\" :pattern \"*.txt\")\n|&gt; (map io/read-file)\n|&gt; (map process-text)\n|&gt; (map-indexed (fn [i content]\n                  (let [tmpfile f\"/tmp/processed-{i}.txt\"]\n                    (io/write-file content tmpfile)\n                    tmpfile)))\n|&gt; (fn [files]\n     (zip/create \"processed.zip\" ..files))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#download-compress-pipeline","title":"Download-Compress Pipeline","text":"<pre><code>;; Download from multiple URLs and compress\n(def urls [\"https://example.com/file1.txt\"\n           \"https://example.com/file2.txt\"])\n\n(urls\n ||&gt; (fn [url]\n       (let [tmpfile (io/temp-file)]\n         (http/get url :output tmpfile)\n         tmpfile))\n |&gt; (fn [files]\n      (zip/create \"downloads.zip\" ..files)))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#compression-ratio-comparison","title":"Compression Ratio Comparison","text":"<pre><code>;; Report compression ratios for each file\n(defn compression-report [zip-file]\n  (zip/list zip-file)\n  |&gt; (filter (fn [e] (not (get e \"is-dir\"))))\n  |&gt; (map (fn [entry]\n            (let [name (get entry \"name\")\n                  original (get entry \"size\")\n                  compressed (get entry \"compressed-size\")\n                  ratio (if (&gt; original 0)\n                          (- 100 (* 100 (/ compressed original)))\n                          0)]\n              {:name name\n               :original original\n               :compressed compressed\n               :saved (- original compressed)\n               :ratio ratio})))\n  |&gt; (map (fn [r]\n            (println f\"{(get r \\\"name\\\")}: {(get r \\\"ratio\\\")}% saved\"))))\n\n(compression-report \"backup.zip\")\n;; =&gt; data.txt: 54% saved\n;; =&gt; config.json: 32% saved\n;; =&gt; image.png: 2% saved\n</code></pre>"},{"location":"spec/32-stdlib-zip/#performance-considerations","title":"Performance Considerations","text":""},{"location":"spec/32-stdlib-zip/#processing-large-numbers-of-files_1","title":"Processing Large Numbers of Files","text":"<pre><code>;; Speed up with parallel processing (though zip/create executes sequentially)\n(defn create-zip-fast [zip-file files]\n  ;; Parallel existence check\n  (let [valid (files ||&gt; io/file-exists? |&gt; (filter identity))]\n    (zip/create zip-file ..valid)))\n\n;; Split large directory and compress\n(defn split-archive [dir max-files]\n  (let [all-files (io/list-dir dir :recursive true)\n        chunks (all-files |&gt; (partition max-files))]\n    (chunks\n     |&gt; (map-indexed (fn [i files]\n                       (let [zip-file f\"archive-part{i}.zip\"]\n                         (zip/create zip-file ..files)\n                         zip-file))))))\n\n(split-archive \"large-dir\" 1000)\n;; =&gt; [\"archive-part0.zip\" \"archive-part1.zip\" ...]\n</code></pre>"},{"location":"spec/32-stdlib-zip/#memory-efficiency","title":"Memory Efficiency","text":"<pre><code>;; Compress large files individually with gzip (more memory efficient than ZIP)\n(defn compress-large-files [pattern]\n  (io/list-dir \".\" :pattern pattern)\n  |&gt; (filter (fn [f]\n               (let [info (io/file-info f)]\n                 (&gt; (get info \"size\") 10000000)))) ;; Over 10MB\n  |&gt; (map zip/gzip)\n  |&gt; (map println))\n\n(compress-large-files \"*.log\")\n</code></pre>"},{"location":"spec/32-stdlib-zip/#compression-level-adjustment","title":"Compression Level Adjustment","text":"<p>The current implementation uses the default level of <code>CompressionMethod::Deflated</code>. Support for specifying compression levels may be added in the future.</p> <pre><code>;; Future feature (not implemented)\n;; (zip/create \"backup.zip\" \"data/\" :compression :fast)\n;; (zip/create \"backup.zip\" \"data/\" :compression :best)\n</code></pre>"},{"location":"spec/32-stdlib-zip/#function-list","title":"Function List","text":""},{"location":"spec/32-stdlib-zip/#zip-operations","title":"ZIP Operations","text":"<ul> <li><code>zip/create</code> - Create ZIP file (multiple files/directories supported)</li> <li><code>zip/extract</code> - Extract ZIP file (destination specifiable)</li> <li><code>zip/list</code> - Get ZIP contents (including size/compression info)</li> <li><code>zip/add</code> - Add files to existing ZIP</li> </ul>"},{"location":"spec/32-stdlib-zip/#gzip-operations","title":"gzip Operations","text":"<ul> <li><code>zip/gzip</code> - Compress file with gzip (output filename specifiable)</li> <li><code>zip/gunzip</code> - Decompress gzip file (output filename specifiable)</li> </ul>"},{"location":"spec/32-stdlib-zip/#choosing-between-zip-and-gzip","title":"Choosing Between ZIP and gzip","text":""},{"location":"spec/32-stdlib-zip/#use-zip-format-when","title":"Use ZIP Format When","text":"<ul> <li>Need to bundle multiple files</li> <li>Need to preserve directory structure</li> <li>Need to extract individual files</li> <li>Want to open with double-click on Windows/Mac</li> <li>Creating distribution archives</li> </ul>"},{"location":"spec/32-stdlib-zip/#use-gzip-format-when","title":"Use gzip Format When","text":"<ul> <li>Compressing single files</li> <li>Standard compression on Unix/Linux</li> <li>Streaming compression needed</li> <li>Combining with tar (tar.gz)</li> <li>Log file rotation</li> </ul>"},{"location":"spec/32-stdlib-zip/#common-patterns","title":"Common Patterns","text":""},{"location":"spec/32-stdlib-zip/#backup-and-restore","title":"Backup and Restore","text":"<pre><code>;; Create backup\n(defn backup [name]\n  (let [timestamp (time/format (time/now) \"%Y%m%d-%H%M%S\")\n        zip-file f\"backup-{name}-{timestamp}.zip\"]\n    (zip/create zip-file \"data/\" \"config/\")\n    (println f\"Backup created: {zip-file}\")\n    zip-file))\n\n;; Restore\n(defn restore [zip-file]\n  (let [tmpdir (io/temp-dir)]\n    (zip/extract zip-file tmpdir)\n    ;; Copy to production after verification\n    (println \"Restored to temporary directory\")\n    tmpdir))\n</code></pre>"},{"location":"spec/32-stdlib-zip/#data-distribution","title":"Data Distribution","text":"<pre><code>;; Create release package\n(defn package-release [version files]\n  (let [release-name f\"release-v{version}.zip\"]\n    (zip/create release-name ..files)\n    (println f\"Release package: {release-name}\")\n    release-name))\n\n;; Create multiple distribution formats\n(defn create-distributions [version]\n  {:zip (zip/create f\"dist-{version}.zip\" \"dist/\")\n   :tar-gz (do\n             (zip/create f\"dist-{version}.tar\" \"dist/\")\n             (zip/gzip f\"dist-{version}.tar\"))})\n</code></pre>"},{"location":"spec/32-stdlib-zip/#log-management","title":"Log Management","text":"<pre><code>;; Daily log archiving\n(defn archive-daily-logs []\n  (let [yesterday (time/format (- (time/now) 86400) \"%Y-%m-%d\")\n        log-files (io/list-dir \"logs\" :pattern f\"*{yesterday}*.log\")]\n    (when (not (empty? log-files))\n      (let [archive f\"logs-{yesterday}.zip\"]\n        (zip/create archive ..log-files)\n        ;; Delete originals\n        (log-files |&gt; (map io/delete-file))\n        archive))))\n</code></pre>"},{"location":"spec/33-stdlib-cmd/","title":"Standard Library - Command Execution (cmd/)","text":"<p>Execute external commands and shell scripts</p> <p>All functions belong to the <code>cmd/</code> module.</p>"},{"location":"spec/33-stdlib-cmd/#overview","title":"Overview","text":"<p>The cmd module provides functions for executing external commands and shell scripts from Qi. Integrated with pipeline operators (<code>|&gt;</code>), you can treat command execution as data flow.</p> <p>Key Features: - Command execution with exit code retrieval - Standard input/output control - Pipeline integration (Qi \u2192 Command \u2192 Qi) - Stream processing (line-based &amp; byte-based) - Bidirectional interactive processes</p> <p>Cross-platform Support: - Unix/Linux/macOS: Execute shell commands via <code>/bin/sh</code> - Windows: Execute commands via <code>cmd.exe</code></p> <p>Note: This module is compiled with the <code>cmd-exec</code> feature.</p>"},{"location":"spec/33-stdlib-cmd/#basic-execution","title":"Basic Execution","text":""},{"location":"spec/33-stdlib-cmd/#cmdexec-execute-command-returns-exit-code","title":"cmd/exec - Execute Command (Returns Exit Code)","text":"<p>Arguments: Command (string or vector) Returns: Exit code (integer) Error: When command is not found</p> <pre><code>;; Via shell (string)\n(cmd/exec \"ls -la\")                    ;; =&gt; 0\n(cmd/exec \"false\")                     ;; =&gt; 1\n\n;; Direct execution (vector)\n(cmd/exec [\"ls\" \"-la\"])                ;; =&gt; 0\n(cmd/exec [\"git\" \"status\"])            ;; =&gt; 0\n\n;; Error checking with exit code\n(let [code (cmd/exec \"test -f data.txt\")]\n  (if (= code 0)\n    (println \"File exists\")\n    (println \"File does not exist\")))\n</code></pre> <p>Shell vs Direct Execution: - String: Via shell (pipes, redirects, environment variable expansion available) - Vector: Direct execution (prevents shell injection, faster)</p>"},{"location":"spec/33-stdlib-cmd/#cmdexec-execute-command-detailed-version","title":"cmd/exec! - Execute Command (Detailed Version)","text":"<p>Arguments: Command (string or vector) Returns: <code>{:stdout \"...\" :stderr \"...\" :exit 0}</code> map</p> <pre><code>;; Get stdout, stderr, and exit code via shell\n(cmd/exec! \"cat *.txt | grep pattern | wc -l\")\n;; =&gt; {:stdout \"      42\\n\" :stderr \"\" :exit 0}\n\n;; Same with direct execution\n(cmd/exec! [\"ls\" \"-la\"])\n;; =&gt; {:stdout \"total 48\\ndrwxr-xr-x ...\\n\" :stderr \"\" :exit 0}\n\n;; Detailed error information\n(cmd/exec! \"ls non-existent-file\")\n;; =&gt; {:stdout \"\"\n;;     :stderr \"ls: non-existent-file: No such file or directory\\n\"\n;;     :exit 1}\n\n;; Use results destructured\n(let [result (cmd/exec! \"git status --porcelain\")\n      stdout (get result \"stdout\")\n      exit (get result \"exit\")]\n  (if (= exit 0)\n    (if (str/blank? stdout)\n      (println \"Working directory is clean\")\n      (println f\"Changes detected:\\n{stdout}\"))\n    (println \"Not a git repository\")))\n</code></pre> <p>When to Use: - <code>cmd/exec</code> - When you only need the exit code (simple) - <code>cmd/exec!</code> - When you need stdout or stderr content</p>"},{"location":"spec/33-stdlib-cmd/#pipeline-integration","title":"Pipeline Integration","text":""},{"location":"spec/33-stdlib-cmd/#cmdpipe-pass-input-to-command","title":"cmd/pipe - Pass Input to Command","text":"<p>Arguments: Command, [input data (string or list)] Returns: Standard output (string) Error: When exit code is non-zero</p> <pre><code>;; Execute command alone\n(cmd/pipe \"ls -la\")\n;; =&gt; \"total 48\\ndrwxr-xr-x  5 user  staff  160 Jan  1 12:00 .\\n...\"\n\n;; Pass input via pipeline\n(\"hello\\nworld\\n\" |&gt; (cmd/pipe \"sort\"))\n;; =&gt; \"hello\\nworld\\n\"\n\n;; Pass list (each element becomes a line)\n([\"line1\" \"line2\" \"line3\"] |&gt; (cmd/pipe \"wc -l\"))\n;; =&gt; \"       3\\n\"\n\n;; Practical example: Process JSON with jq\n(http/get \"https://api.example.com/data\")\n  |&gt; (get _ \"body\")\n  |&gt; (cmd/pipe \"jq '.users[] | .name'\")\n  |&gt; str/lines\n  |&gt; (map str/trim)\n;; =&gt; [\"Alice\" \"Bob\" \"Charlie\"]\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#cmdpipe-execute-command-detailed-version","title":"cmd/pipe! - Execute Command (Detailed Version)","text":"<p>Arguments: Command, [input data] Returns: <code>[stdout stderr exitcode]</code> vector</p> <pre><code>;; Get all: stdout, stderr, exit code\n(cmd/pipe! \"cat test.txt\")\n;; =&gt; [\"file content\\n\" \"\" 0]\n\n;; Use with destructuring\n(let [[out err code] (cmd/pipe! \"ls -la\")]\n  (if (= code 0)\n    (println out)\n    (println f\"Error: {err}\")))\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#cmdlines-split-text-into-lines-helper","title":"cmd/lines - Split Text into Lines (Helper)","text":"<p>Arguments: Text Returns: List of lines</p> <pre><code>;; Split command output into lines\n(\"a\\nb\\nc\" |&gt; cmd/lines)\n;; =&gt; [\"a\" \"b\" \"c\"]\n\n;; Practical pipeline example\n(cmd/pipe \"ls -1\")\n  |&gt; cmd/lines\n  |&gt; (filter (fn [f] (str/ends-with? f \".qi\")))\n  |&gt; (map (fn [f] (str/replace f \".qi\" \"\")))\n;; =&gt; [\"main\" \"lib\" \"test\"]\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#stream-processing","title":"Stream Processing","text":""},{"location":"spec/33-stdlib-cmd/#cmdstream-lines-line-based-stream","title":"cmd/stream-lines - Line-based Stream","text":"<p>Arguments: Command (string or vector) Returns: Stream (each element is a line string)</p> <pre><code>;; Process log file as stream\n(def log-stream (cmd/stream-lines \"tail -f /var/log/app.log\"))\n\n;; Get first 10 lines\n(log-stream |&gt; (stream/take 10) |&gt; realize)\n\n;; Filter while processing\n(cmd/stream-lines \"cat large.log\")\n  |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n  |&gt; (stream/take 100)\n  |&gt; realize\n  |&gt; (map println)\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#cmdstream-bytes-byte-based-stream","title":"cmd/stream-bytes - Byte-based Stream","text":"<p>Arguments: Command, [chunk size (default 4096)] Returns: Stream (each element is Base64-encoded bytes)</p> <pre><code>;; Process large file in chunks\n(cmd/stream-bytes \"cat large-file.bin\")\n  |&gt; (stream/take 10)  ;; First 10 chunks (40KB)\n  |&gt; realize\n\n;; Custom chunk size (8KB)\n(cmd/stream-bytes \"curl -L https://example.com/video.mp4\" 8192)\n  |&gt; (stream/each process-chunk)\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#interactive-processes","title":"Interactive Processes","text":""},{"location":"spec/33-stdlib-cmd/#cmdinteractive-launch-bidirectional-process","title":"cmd/interactive - Launch Bidirectional Process","text":"<p>Arguments: Command (string or vector) Returns: Process handle (Map format)</p> <pre><code>;; Launch Python interpreter\n(def py (cmd/interactive \"python3 -i\"))\n\n;; Send command\n(cmd/write py \"print(1+1)\\n\")\n\n;; Read result\n(cmd/read-line py)  ;; =&gt; \"2\"\n\n;; Terminate process\n(cmd/write py \"exit()\\n\")\n(cmd/wait py)       ;; =&gt; {:exit 0 :stderr \"\"}\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#cmdwrite-write-to-process","title":"cmd/write - Write to Process","text":"<p>Arguments: Process handle, data (string) Returns: nil</p> <pre><code>;; Send multiple lines to REPL\n(cmd/write py \"def greet(name):\\n\")\n(cmd/write py \"    return f'Hello, {name}!'\\n\")\n(cmd/write py \"\\n\")\n(cmd/write py \"print(greet('Qi'))\\n\")\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#cmdread-line-read-line-from-process","title":"cmd/read-line - Read Line from Process","text":"<p>Arguments: Process handle Returns: Read line (string), or <code>nil</code> on EOF</p> <pre><code>;; Read result\n(cmd/read-line py)  ;; =&gt; \"Hello, Qi!\"\n\n;; Read all output\n(defn read-all [proc]\n  (loop [lines []]\n    (let [line (cmd/read-line proc)]\n      (if (some? line)\n        (recur (conj lines line))\n        lines))))\n\n(read-all py)  ;; =&gt; [\"line1\" \"line2\" \"line3\"]\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#cmdwait-wait-for-process-termination","title":"cmd/wait - Wait for Process Termination","text":"<p>Arguments: Process handle Returns: <code>{:exit exit_code :stderr \"...\"}</code></p> <pre><code>;; Terminate process and get result\n(cmd/write py \"exit()\\n\")\n(cmd/wait py)\n;; =&gt; {:exit 0 :stderr \"\"}\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/33-stdlib-cmd/#build-tool-integration","title":"Build Tool Integration","text":"<pre><code>;; Execute Cargo build\n(defn cargo-build [target]\n  (let [[out err code] (cmd/pipe! f\"cargo build --release --bin {target}\")]\n    (if (= code 0)\n      (do\n        (println \"Build successful!\")\n        (println out)\n        :ok)\n      (do\n        (println \"Build failed:\")\n        (println err)\n        :error))))\n\n(cargo-build \"qi-lang\")\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#git-operations","title":"Git Operations","text":"<pre><code>;; Check git status\n(defn git-status []\n  (let [result (cmd/exec! \"git status --porcelain\")]\n    (if (= (get result \"exit\") 0)\n      (let [stdout (get result \"stdout\")]\n        (if (str/blank? stdout)\n          {:clean true :files []}\n          {:clean false :files (str/lines stdout)}))\n      {:error (get result \"stderr\")})))\n\n(git-status)\n;; =&gt; {:clean false :files [\"M src/main.rs\" \"?? new-file.txt\"]}\n\n;; Commit changes\n(defn git-commit [message]\n  (do\n    (cmd/exec \"git add .\")\n    (let [code (cmd/exec f\"git commit -m '{message}'\")]\n      (if (= code 0)\n        (println \"Commit successful!\")\n        (println \"Commit failed (no changes?)\")))))\n\n(git-commit \"feat: Add new feature\")\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#error-handling","title":"Error Handling","text":""},{"location":"spec/33-stdlib-cmd/#handle-command-failures","title":"Handle Command Failures","text":"<pre><code>;; Catch errors with try-catch\n(try\n  (cmd/pipe \"grep pattern file.txt\")\n  (catch e\n    (println f\"Search failed: {e}\")\n    nil))\n\n;; Check exit code with pipe!\n(let [[out err code] (cmd/pipe! \"test -f data.txt\")]\n  (if (= code 0)\n    (println \"File exists\")\n    (println \"File does not exist\")))\n\n;; Get error message with exec!\n(let [result (cmd/exec! \"ls non-existent\")]\n  (if (= (get result \"exit\") 0)\n    (get result \"stdout\")\n    (do\n      (println f\"Error: {(get result 'stderr')}\")\n      nil)))\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#security-considerations","title":"Security Considerations","text":""},{"location":"spec/33-stdlib-cmd/#prevent-command-injection","title":"Prevent Command Injection","text":"<pre><code>;; \u274c Dangerous: Pass user input directly to shell\n(defn bad-search [pattern file]\n  (cmd/pipe f\"grep {pattern} {file}\"))  ;; Injection possible!\n\n(bad-search \"test; rm -rf /\" \"data.txt\")  ;; Dangerous!\n\n;; \u2705 Safe: Pass as vector (no shell)\n(defn safe-search [pattern file]\n  (cmd/pipe [\"grep\" pattern file]))\n\n(safe-search \"test; rm -rf /\" \"data.txt\")  ;; Safe (treated as literal string)\n\n;; \u2705 Safe: Escape processing\n(defn escape-shell-arg [s]\n  (str \"'\" (str/replace s \"'\" \"'\\\\''\") \"'\"))\n\n(defn safe-search-shell [pattern file]\n  (cmd/pipe f\"grep {(escape-shell-arg pattern)} {(escape-shell-arg file)}\"))\n\n(safe-search-shell \"test; rm -rf /\" \"data.txt\")  ;; Safe\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#path-validation","title":"Path Validation","text":"<pre><code>;; \u274c Dangerous: Path traversal attack\n(defn bad-read-file [filename]\n  (cmd/pipe f\"cat {filename}\"))\n\n(bad-read-file \"../../../etc/passwd\")  ;; Dangerous!\n\n;; \u2705 Safe: Path validation\n(defn safe-read-file [filename base-dir]\n  (let [fullpath (path/join base-dir filename)\n        canonical (path/canonicalize fullpath)]\n    (if (str/starts-with? canonical base-dir)\n      (cmd/pipe [\"cat\" canonical])\n      (throw \"Invalid path\"))))\n\n(safe-read-file \"../../../etc/passwd\" \"/var/data\")  ;; Error\n(safe-read-file \"file.txt\" \"/var/data\")  ;; OK\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#function-reference","title":"Function Reference","text":""},{"location":"spec/33-stdlib-cmd/#basic-execution_1","title":"Basic Execution","text":"<ul> <li><code>cmd/exec</code> - Execute command (returns exit code)</li> <li><code>cmd/exec!</code> - Execute command (detailed version, returns stdout/stderr/exit)</li> </ul>"},{"location":"spec/33-stdlib-cmd/#pipeline-integration_1","title":"Pipeline Integration","text":"<ul> <li><code>cmd/pipe</code> - Pass stdin to command (returns stdout)</li> <li><code>cmd/pipe!</code> - Execute command (returns [stdout stderr exit])</li> <li><code>cmd/lines</code> - Split text into list of lines</li> </ul>"},{"location":"spec/33-stdlib-cmd/#stream-processing_1","title":"Stream Processing","text":"<ul> <li><code>cmd/stream-lines</code> - Stream command stdout line by line</li> <li><code>cmd/stream-bytes</code> - Stream command stdout byte by byte</li> </ul>"},{"location":"spec/33-stdlib-cmd/#interactive-processes_1","title":"Interactive Processes","text":"<ul> <li><code>cmd/interactive</code> - Launch bidirectional process</li> <li><code>cmd/write</code> - Write to process stdin</li> <li><code>cmd/read-line</code> - Read one line from process stdout</li> <li><code>cmd/wait</code> - Wait for process termination</li> </ul>"},{"location":"spec/33-stdlib-cmd/#performance-optimization","title":"Performance Optimization","text":""},{"location":"spec/33-stdlib-cmd/#executing-many-commands","title":"Executing Many Commands","text":"<pre><code>;; \u274c Slow: Execute via shell each time\n(files |&gt; (map (fn [f] (cmd/exec f\"wc -l {f}\"))))\n\n;; \u2705 Fast: Combine into one command\n(files |&gt; (fn [fs] (join fs \" \")) |&gt; (cmd/pipe \"wc -l\"))\n\n;; \u2705 Fast: Parallel execution\n(files |&gt; (pmap (fn [f] (cmd/exec [\"wc\" \"-l\" f]))))\n</code></pre>"},{"location":"spec/33-stdlib-cmd/#memory-efficient-streaming","title":"Memory-Efficient Streaming","text":"<pre><code>;; \u274c Memory inefficient: Load all data at once\n(cmd/pipe \"cat large-file.txt\")\n  |&gt; str/lines\n  |&gt; (map process-line)\n\n;; \u2705 Memory efficient: Process as stream\n(cmd/stream-lines \"cat large-file.txt\")\n  |&gt; (stream/map process-line)\n  |&gt; (stream/take 1000)\n  |&gt; realize\n</code></pre>"},{"location":"spec/34-stdlib-list/","title":"Standard Library - List Extended Operations (list/)","text":"<p>18 List Extension Functions</p> <p>Provides advanced operations for lists and vectors. Basic operations (map, filter, reduce, etc.) are included in the Core module.</p> <p>Implementation: <code>src/builtins/list.rs</code></p> <p>Related Documentation: 06-data-structures.md - Basic list operations</p>"},{"location":"spec/34-stdlib-list/#overview","title":"Overview","text":"<p>The <code>list/</code> module provides advanced functions that complement the Core module's basic list operations (map, filter, reduce, etc.).</p> <p>Difference from Core: - Core: Basic operations (map, filter, reduce, take, drop, etc.) - Global namespace - list/: Extended operations (grouping, search, transformation, predicates, etc.) - Requires <code>list/</code> prefix</p>"},{"location":"spec/34-stdlib-list/#conditional-takedrop","title":"Conditional Take/Drop","text":""},{"location":"spec/34-stdlib-list/#take-while-take-elements-while-predicate-is-true","title":"take-while - Take elements while predicate is true","text":"<pre><code>;; Basic usage\n(take-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])\n;; =&gt; (1 2 3)\n\n;; Take until blank line\n(def lines [\"Line 1\" \"Line 2\" \"\" \"Line 3\"])\n(take-while (fn [s] (not (str/blank? s))) lines)\n;; =&gt; (\"Line 1\" \"Line 2\")\n\n;; Using in pipeline\n([1 2 3 6 7 4] |&gt; (take-while (fn [x] (&lt; x 5))))\n;; =&gt; (1 2 3)\n</code></pre>"},{"location":"spec/34-stdlib-list/#drop-while-skip-elements-while-predicate-is-true","title":"drop-while - Skip elements while predicate is true","text":"<pre><code>;; Basic usage\n(drop-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])\n;; =&gt; (6 7 4)\n\n;; Skip header lines\n(def lines [\"# Header\" \"---\" \"Content 1\" \"Content 2\"])\n(drop-while (fn [s] (str/starts-with? s \"#\")) lines)\n;; =&gt; (\"---\" \"Content 1\" \"Content 2\")\n\n;; Using in pipeline\n([1 2 3 6 7 4] |&gt; (drop-while (fn [x] (&lt; x 5))))\n;; =&gt; (6 7 4)\n</code></pre>"},{"location":"spec/34-stdlib-list/#splitjoin","title":"Split/Join","text":""},{"location":"spec/34-stdlib-list/#listsplit-at-split-list-at-specified-position","title":"list/split-at - Split list at specified position","text":"<pre><code>;; Basic usage\n(list/split-at 2 [1 2 3 4 5])\n;; =&gt; [(1 2) (3 4 5)]\n\n;; Split into first 3 and rest\n(list/split-at 3 [\"a\" \"b\" \"c\" \"d\" \"e\"])\n;; =&gt; [(\"a\" \"b\" \"c\") (\"d\" \"e\")]\n\n;; Using in pipeline\n([1 2 3 4 5] |&gt; (list/split-at 2))\n;; =&gt; [(1 2) (3 4 5)]\n</code></pre>"},{"location":"spec/34-stdlib-list/#listchunk-split-into-fixed-size-chunks","title":"list/chunk - Split into fixed-size chunks","text":"<pre><code>;; Basic usage\n(list/chunk 2 [1 2 3 4 5 6])\n;; =&gt; ((1 2) (3 4) (5 6))\n\n;; Split into groups of 3\n(list/chunk 3 [1 2 3 4 5 6 7 8])\n;; =&gt; ((1 2 3) (4 5 6) (7 8))\n\n;; Using in pipeline\n([1 2 3 4 5 6] |&gt; (list/chunk 2))\n;; =&gt; ((1 2) (3 4) (5 6))\n</code></pre>"},{"location":"spec/34-stdlib-list/#listinterleave-interleave-two-lists","title":"list/interleave - Interleave two lists","text":"<pre><code>;; Basic usage\n(list/interleave [1 2 3] [4 5 6])\n;; =&gt; (1 4 2 5 3 6)\n\n;; Stops at shorter list\n(list/interleave [1 2] [4 5 6 7])\n;; =&gt; (1 4 2 5)\n\n;; Alternate keys and values\n(list/interleave [:a :b :c] [1 2 3])\n;; =&gt; (:a 1 :b 2 :c 3)\n</code></pre>"},{"location":"spec/34-stdlib-list/#listzipmap-create-map-from-two-lists","title":"list/zipmap - Create map from two lists","text":"<pre><code>;; Basic usage\n(list/zipmap [:a :b :c] [1 2 3])\n;; =&gt; {:a 1, :b 2, :c 3}\n\n;; Combine keys and values into map\n(def keys [:name :age :email])\n(def values [\"Alice\" 30 \"alice@example.com\"])\n(list/zipmap keys values)\n;; =&gt; {:name \"Alice\", :age 30, :email \"alice@example.com\"}\n</code></pre>"},{"location":"spec/34-stdlib-list/#selection","title":"Selection","text":""},{"location":"spec/34-stdlib-list/#listtake-nth-take-every-nth-element","title":"list/take-nth - Take every nth element","text":"<pre><code>;; Basic usage\n(list/take-nth 2 [1 2 3 4 5 6])\n;; =&gt; (1 3 5)\n\n;; Take every 3rd element\n(list/take-nth 3 [0 1 2 3 4 5 6 7 8 9])\n;; =&gt; (0 3 6 9)\n\n;; Using in pipeline\n([1 2 3 4 5 6] |&gt; (list/take-nth 2))\n;; =&gt; (1 3 5)\n</code></pre>"},{"location":"spec/34-stdlib-list/#listdrop-last-drop-last-n-elements","title":"list/drop-last - Drop last n elements","text":"<pre><code>;; Basic usage\n(list/drop-last 2 [1 2 3 4 5])\n;; =&gt; (1 2 3)\n\n;; Drop last element\n(list/drop-last 1 [1 2 3])\n;; =&gt; (1 2)\n\n;; Using in pipeline\n([1 2 3 4 5] |&gt; (list/drop-last 2))\n;; =&gt; (1 2 3)\n</code></pre>"},{"location":"spec/34-stdlib-list/#searchfind","title":"Search/Find","text":""},{"location":"spec/34-stdlib-list/#find-find-first-element-matching-predicate","title":"find - Find first element matching predicate","text":"<pre><code>;; Basic usage\n(find (fn [x] (&gt; x 5)) [1 7 3])\n;; =&gt; 7\n\n;; Find even number\n(find even? [1 3 4 5])\n;; =&gt; 4\n\n;; Returns nil if not found\n(find (fn [x] (&gt; x 10)) [1 2 3])\n;; =&gt; nil\n\n;; Using in pipeline\n([1 7 3] |&gt; (find (fn [x] (&gt; x 5))))\n;; =&gt; 7\n</code></pre>"},{"location":"spec/34-stdlib-list/#listfind-index-find-index-of-first-matching-element","title":"list/find-index - Find index of first matching element","text":"<pre><code>;; Basic usage\n(list/find-index (fn [x] (&gt; x 5)) [1 7 3])\n;; =&gt; 1\n\n;; Find index of even number\n(list/find-index even? [1 3 4 5])\n;; =&gt; 2\n\n;; Returns nil if not found\n(list/find-index (fn [x] (&gt; x 10)) [1 2 3])\n;; =&gt; nil\n</code></pre>"},{"location":"spec/34-stdlib-list/#predicates-collection-wide","title":"Predicates (Collection-wide)","text":""},{"location":"spec/34-stdlib-list/#listevery-check-if-all-elements-satisfy-predicate","title":"list/every? - Check if all elements satisfy predicate","text":"<pre><code>;; Basic usage\n(list/every? (fn [x] (&gt; x 0)) [1 2 3])\n;; =&gt; true\n\n;; Check if all even\n(list/every? even? [2 4 6])\n;; =&gt; true\n\n;; Returns false if any element fails\n(list/every? even? [2 4 5])\n;; =&gt; false\n\n;; Using in pipeline\n([1 2 3] |&gt; (list/every? (fn [x] (&gt; x 0))))\n;; =&gt; true\n</code></pre>"},{"location":"spec/34-stdlib-list/#listsome-check-if-any-element-satisfies-predicate","title":"list/some? - Check if any element satisfies predicate","text":"<pre><code>;; Basic usage\n(list/some? (fn [x] (&gt; x 5)) [1 7 3])\n;; =&gt; true\n\n;; Check if any even\n(list/some? even? [1 3 5])\n;; =&gt; false\n\n;; Using in pipeline\n([1 7 3] |&gt; (list/some? (fn [x] (&gt; x 5))))\n;; =&gt; true\n</code></pre> <p>Note: <code>some?</code> (1 argument) is a Core predicate function that checks if a value is not nil. <code>list/some?</code> takes 2 arguments and checks collection elements.</p>"},{"location":"spec/34-stdlib-list/#sortaggregate","title":"Sort/Aggregate","text":""},{"location":"spec/34-stdlib-list/#listsort-by-sort-by-key-function","title":"list/sort-by - Sort by key function","text":"<pre><code>;; Basic usage\n(list/sort-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; ({:name \"Bob\" :age 25} {:name \"Alice\" :age 30})\n\n;; Sort by string length\n(list/sort-by len [\"zzz\" \"a\" \"bb\"])\n;; =&gt; (\"a\" \"bb\" \"zzz\")\n\n;; Using in pipeline\n([{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}]\n |&gt; (list/sort-by (fn [u] (get u :age))))\n</code></pre>"},{"location":"spec/34-stdlib-list/#listmax-by-get-element-with-maximum-key-value","title":"list/max-by - Get element with maximum key value","text":"<pre><code>;; Basic usage\n(list/max-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; {:name \"Alice\" :age 30}\n\n;; Get longest string\n(list/max-by len [\"a\" \"bbb\" \"cc\"])\n;; =&gt; \"bbb\"\n\n;; Returns nil for empty list\n(list/max-by identity [])\n;; =&gt; nil\n</code></pre>"},{"location":"spec/34-stdlib-list/#listmin-by-get-element-with-minimum-key-value","title":"list/min-by - Get element with minimum key value","text":"<pre><code>;; Basic usage\n(list/min-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; {:name \"Bob\" :age 25}\n\n;; Get shortest string\n(list/min-by len [\"aaa\" \"b\" \"cc\"])\n;; =&gt; \"b\"\n\n;; Returns nil for empty list\n(list/min-by identity [])\n;; =&gt; nil\n</code></pre>"},{"location":"spec/34-stdlib-list/#listsum-by-sum-by-key-function","title":"list/sum-by - Sum by key function","text":"<pre><code>;; Basic usage\n(list/sum-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; 55\n\n;; Sum of string lengths\n(list/sum-by len [\"a\" \"bb\" \"ccc\"])\n;; =&gt; 6\n\n;; Using in pipeline\n([{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}]\n |&gt; (list/sum-by (fn [u] (get u :age))))\n;; =&gt; 55\n</code></pre>"},{"location":"spec/34-stdlib-list/#groupingfrequency","title":"Grouping/Frequency","text":""},{"location":"spec/34-stdlib-list/#listfrequencies-count-occurrences","title":"list/frequencies - Count occurrences","text":"<pre><code>;; Basic usage\n(list/frequencies [1 2 2 3 3 3])\n;; =&gt; {\"1\" 1, \"2\" 2, \"3\" 3}\n\n;; String frequencies\n(list/frequencies [\"a\" \"b\" \"a\" \"c\" \"b\" \"a\"])\n;; =&gt; {\"a\" 3, \"b\" 2, \"c\" 1}\n\n;; Using in pipeline\n([1 2 2 3 3 3] |&gt; list/frequencies)\n;; =&gt; {\"1\" 1, \"2\" 2, \"3\" 3}\n</code></pre>"},{"location":"spec/34-stdlib-list/#listpartition-by-group-consecutive-elements-by-predicate","title":"list/partition-by - Group consecutive elements by predicate","text":"<pre><code>;; Basic usage\n(list/partition-by even? [1 1 2 2 3 3])\n;; =&gt; ((1 1) (2 2) (3 3))\n\n;; Group consecutive identical values\n(list/partition-by identity [1 1 2 2 2 3 3])\n;; =&gt; ((1 1) (2 2 2) (3 3))\n\n;; Group by string length\n(list/partition-by len [\"a\" \"b\" \"cc\" \"dd\" \"eee\"])\n;; =&gt; ((\"a\" \"b\") (\"cc\" \"dd\") (\"eee\"))\n</code></pre>"},{"location":"spec/34-stdlib-list/#transformation","title":"Transformation","text":""},{"location":"spec/34-stdlib-list/#keep-map-and-filter-out-nils","title":"keep - Map and filter out nils","text":"<pre><code>;; Basic usage\n(keep (fn [x] (when (even? x) (* x 2))) [1 2 3 4])\n;; =&gt; (4 8)\n\n;; Elements returning nil are filtered out\n(keep (fn [x] (when (&gt; x 2) x)) [1 2 3 4])\n;; =&gt; (3 4)\n\n;; Using in pipeline\n([1 2 3 4] |&gt; (keep (fn [x] (when (even? x) (* x 2)))))\n;; =&gt; (4 8)\n</code></pre>"},{"location":"spec/34-stdlib-list/#listdedupe-remove-consecutive-duplicates","title":"list/dedupe - Remove consecutive duplicates","text":"<pre><code>;; Basic usage\n(list/dedupe [1 1 2 2 3 3])\n;; =&gt; (1 2 3)\n\n;; Non-consecutive duplicates remain\n(list/dedupe [1 2 1 2])\n;; =&gt; (1 2 1 2)\n\n;; Using in pipeline\n([1 1 2 2 3 3] |&gt; list/dedupe)\n;; =&gt; (1 2 3)\n</code></pre> <p>Difference from distinct: - <code>distinct</code>: Removes all duplicates (<code>[1 2 1 2]</code> \u2192 <code>[1 2]</code>) - <code>list/dedupe</code>: Removes only consecutive duplicates (<code>[1 2 1 2]</code> \u2192 <code>(1 2 1 2)</code>)</p>"},{"location":"spec/34-stdlib-list/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/34-stdlib-list/#data-analysis-pipeline","title":"Data Analysis Pipeline","text":"<pre><code>;; Filter even numbers and sum\n([1 2 3 4 5 6]\n |&gt; (filter even?)\n |&gt; (reduce + 0))\n;; =&gt; 12\n\n;; Group and count\n(def data [1 1 2 2 2 3 3])\n(data\n |&gt; list/frequencies)\n;; =&gt; {\"1\" 2, \"2\" 3, \"3\" 2}\n</code></pre>"},{"location":"spec/34-stdlib-list/#user-search-and-aggregation","title":"User Search and Aggregation","text":"<pre><code>(def users [\n  {:name \"Alice\" :age 30 :dept \"Sales\"}\n  {:name \"Bob\" :age 25 :dept \"Dev\"}\n  {:name \"Carol\" :age 35 :dept \"Sales\"}\n])\n\n;; Get oldest user\n(users |&gt; (list/max-by (fn [u] (get u :age))))\n;; =&gt; {:name \"Carol\" :age 35 :dept \"Sales\"}\n\n;; Sum of ages\n(users |&gt; (list/sum-by (fn [u] (get u :age))))\n;; =&gt; 90\n\n;; Find Sales department user\n(users |&gt; (find (fn [u] (= (get u :dept) \"Sales\"))))\n;; =&gt; {:name \"Alice\" :age 30 :dept \"Sales\"}\n</code></pre>"},{"location":"spec/34-stdlib-list/#data-transformation","title":"Data Transformation","text":"<pre><code>;; Process CSV data in pairs\n(def csv-row [\"Name\" \"Alice\" \"Age\" \"30\" \"City\" \"Tokyo\"])\n(csv-row |&gt; (list/chunk 2))\n;; =&gt; ((\"Name\" \"Alice\") (\"Age\" \"30\") (\"City\" \"Tokyo\"))\n\n;; Create map from keys and values\n(list/zipmap [:name :age :city] [\"Alice\" 30 \"Tokyo\"])\n;; =&gt; {:name \"Alice\", :age 30, :city \"Tokyo\"}\n\n;; Sample every 100th element\n(def large-data (range 1000))\n(large-data |&gt; (list/take-nth 100))\n;; =&gt; (0 100 200 300 400 500 600 700 800 900)\n</code></pre>"},{"location":"spec/34-stdlib-list/#log-analysis","title":"Log Analysis","text":"<pre><code>;; Process log files\n(def logs [\n  \"INFO: Starting...\"\n  \"INFO: Connected\"\n  \"ERROR: Connection lost\"\n  \"INFO: Retrying...\"\n])\n\n;; Find ERROR log\n(logs |&gt; (find (fn [s] (str/starts-with? s \"ERROR:\"))))\n;; =&gt; \"ERROR: Connection lost\"\n\n;; Check if all are INFO\n(logs |&gt; (list/every? (fn [s] (str/starts-with? s \"INFO:\"))))\n;; =&gt; false\n\n;; Check if any ERROR exists\n(logs |&gt; (list/some? (fn [s] (str/starts-with? s \"ERROR:\"))))\n;; =&gt; true\n</code></pre>"},{"location":"spec/34-stdlib-list/#batch-processing","title":"Batch Processing","text":"<pre><code>;; Process large data in batches of 100\n(def data (range 1000))\n\n(data\n |&gt; (list/chunk 100)\n |&gt; (each (fn [batch]\n            (println f\"Processing batch of {(len batch)} items...\")\n            ;; Batch processing logic\n            )))\n</code></pre>"},{"location":"spec/34-stdlib-list/#function-list","title":"Function List","text":""},{"location":"spec/34-stdlib-list/#conditional-takedrop_1","title":"Conditional Take/Drop","text":"<ul> <li><code>take-while</code> - Take elements while predicate is true</li> <li><code>drop-while</code> - Skip elements while predicate is true</li> <li><code>list/drop-last</code> - Drop last n elements</li> </ul>"},{"location":"spec/34-stdlib-list/#splitjoin_1","title":"Split/Join","text":"<ul> <li><code>list/split-at</code> - Split at specified position</li> <li><code>list/chunk</code> - Split into fixed-size chunks</li> <li><code>list/interleave</code> - Interleave two lists</li> <li><code>list/zipmap</code> - Create map from two lists</li> </ul>"},{"location":"spec/34-stdlib-list/#selection_1","title":"Selection","text":"<ul> <li><code>list/take-nth</code> - Take every nth element</li> </ul>"},{"location":"spec/34-stdlib-list/#searchfind_1","title":"Search/Find","text":"<ul> <li><code>find</code> - Find first matching element</li> <li><code>list/find-index</code> - Find index of first matching element</li> </ul>"},{"location":"spec/34-stdlib-list/#predicates","title":"Predicates","text":"<ul> <li><code>list/every?</code> - Check if all elements satisfy predicate</li> <li><code>list/some?</code> - Check if any element satisfies predicate</li> </ul>"},{"location":"spec/34-stdlib-list/#sortaggregate_1","title":"Sort/Aggregate","text":"<ul> <li><code>list/sort-by</code> - Sort by key function</li> <li><code>list/max-by</code> - Get element with maximum key value</li> <li><code>list/min-by</code> - Get element with minimum key value</li> <li><code>list/sum-by</code> - Sum by key function</li> </ul>"},{"location":"spec/34-stdlib-list/#groupingfrequency_1","title":"Grouping/Frequency","text":"<ul> <li><code>list/frequencies</code> - Count occurrences</li> <li><code>list/partition-by</code> - Group consecutive elements by predicate</li> </ul>"},{"location":"spec/34-stdlib-list/#transformation_1","title":"Transformation","text":"<ul> <li><code>keep</code> - Map and filter out nils</li> <li><code>list/dedupe</code> - Remove consecutive duplicates</li> </ul>"},{"location":"spec/35-stdlib-map/","title":"Standard Library - Map Extensions (map/)","text":"<p>Advanced Map Operation Functions</p> <p>Implementation: <code>src/builtins/map.rs</code></p> <p>This module provides advanced map operation features in addition to basic map operations (<code>get</code>, <code>keys</code>, <code>vals</code>, <code>assoc</code>, <code>dissoc</code>, <code>merge</code>, <code>get-in</code>, <code>update</code>, <code>update-in</code>).</p> <p>Difference from Basic Functions: - Basic Functions (<code>src/builtins/core_collections.rs</code>): Always available as core features   - <code>get</code>, <code>keys</code>, <code>vals</code>, <code>assoc</code>, <code>dissoc</code>, <code>merge</code>   - <code>get-in</code>, <code>update</code>, <code>update-in</code> - Extension Functions (this module): Advanced operations for specific use cases   - Modifying nested structures (<code>assoc-in</code>, <code>dissoc-in</code>)   - Bulk transformation of keys/values (<code>update-keys</code>, <code>update-vals</code>)   - Key selection (<code>select-keys</code>)</p>"},{"location":"spec/35-stdlib-map/#key-selection","title":"Key Selection","text":""},{"location":"spec/35-stdlib-map/#select-keys-extract-only-specified-keys","title":"select-keys - Extract Only Specified Keys","text":"<p>Returns a new map containing only the specified keys.</p> <pre><code>;; Basic usage\n(map/select-keys {:a 1 :b 2 :c 3} [:a :c])\n;; =&gt; {:a 1, :c 3}\n\n;; Non-existent keys are ignored\n(map/select-keys {:a 1 :b 2} [:a :x :y])\n;; =&gt; {:a 1}\n\n;; Empty key list returns empty map\n(map/select-keys {:a 1 :b 2} [])\n;; =&gt; {}\n\n;; Can specify with vector or list\n(map/select-keys {:a 1 :b 2 :c 3} (list :b :c))\n;; =&gt; {:b 2, :c 3}\n</code></pre> <p>Use in Pipeline:</p> <pre><code>;; Extract only necessary fields from API response\n(user\n |&gt; (map/select-keys _ [:id :name :email]))\n\n;; Format records retrieved from database\n(records\n |&gt; (map (fn [r] (map/select-keys r [:user_id :created_at :status]))))\n</code></pre>"},{"location":"spec/35-stdlib-map/#modifying-nested-structures","title":"Modifying Nested Structures","text":""},{"location":"spec/35-stdlib-map/#assoc-in-set-value-in-nested-map","title":"assoc-in - Set Value in Nested Map","text":"<p>Sets a value at a path in a nested map. Automatically creates intermediate maps if they don't exist.</p> <pre><code>;; Basic usage\n(map/assoc-in {} [:user :profile :name] \"Alice\")\n;; =&gt; {:user {:profile {:name \"Alice\"}}}\n\n;; Add to existing map\n(map/assoc-in {:user {:age 30}} [:user :name] \"Bob\")\n;; =&gt; {:user {:age 30, :name \"Bob\"}}\n\n;; Deep nesting\n(map/assoc-in {} [:app :config :db :host] \"localhost\")\n;; =&gt; {:app {:config {:db {:host \"localhost\"}}}}\n\n;; Overwrite existing value\n(map/assoc-in {:user {:name \"Alice\"}} [:user :name] \"Bob\")\n;; =&gt; {:user {:name \"Bob\"}}\n</code></pre> <p>Use in Pipeline:</p> <pre><code>;; Incremental configuration building\n({}\n |&gt; (map/assoc-in _ [:server :port] 8080)\n |&gt; (map/assoc-in _ [:server :host] \"0.0.0.0\")\n |&gt; (map/assoc-in _ [:db :host] \"localhost\")\n |&gt; (map/assoc-in _ [:db :port] 5432))\n;; =&gt; {:server {:port 8080, :host \"0.0.0.0\"},\n;;     :db {:host \"localhost\", :port 5432}}\n</code></pre>"},{"location":"spec/35-stdlib-map/#dissoc-in-remove-key-from-nested-map","title":"dissoc-in - Remove Key from Nested Map","text":"<p>Removes a key at a path in a nested map.</p> <pre><code>;; Basic usage\n(map/dissoc-in {:user {:name \"Alice\" :age 30}} [:user :age])\n;; =&gt; {:user {:name \"Alice\"}}\n\n;; Deep nesting\n(map/dissoc-in {:a {:b {:c 1 :d 2}}} [:a :b :c])\n;; =&gt; {:a {:b {:d 2}}}\n\n;; Deleting the last key leaves an empty map\n(map/dissoc-in {:a {:b {:c 1}}} [:a :b :c])\n;; =&gt; {:a {:b {}}}\n\n;; Non-existent path does nothing\n(map/dissoc-in {:a 1} [:x :y :z])\n;; =&gt; {:a 1}\n</code></pre> <p>Use in Pipeline:</p> <pre><code>;; Remove sensitive information\n(user-data\n |&gt; (map/dissoc-in _ [:credentials :password])\n |&gt; (map/dissoc-in _ [:private :ssn]))\n</code></pre>"},{"location":"spec/35-stdlib-map/#bulk-keyvalue-transformation","title":"Bulk Key/Value Transformation","text":""},{"location":"spec/35-stdlib-map/#update-keys-apply-function-to-all-keys","title":"update-keys - Apply Function to All Keys","text":"<p>Applies a function to all keys in a map and returns a new map.</p> <pre><code>;; Basic usage\n(map/update-keys str/upper {:name \"Alice\" :age 30})\n;; =&gt; {\"NAME\" \"Alice\", \"AGE\" 30}\n\n;; Key normalization\n(map/update-keys str/lower {:Name \"Alice\" :AGE 30})\n;; =&gt; {\"name\" \"Alice\", \"age\" 30}\n\n;; Key transformation\n(map/update-keys (fn [k] (str \"prefix_\" k)) {:a 1 :b 2})\n;; =&gt; {\"prefix_a\" 1, \"prefix_b\" 2}\n\n;; Keywords to strings\n(map/update-keys name {:name \"Alice\" :age 30})\n;; =&gt; {\"name\" \"Alice\", \"age\" 30}\n</code></pre> <p>Use in Pipeline:</p> <pre><code>;; JSON key normalization\n(json-data\n |&gt; (map/update-keys _ str/lower)\n |&gt; (map/update-keys _ (fn [k] (str/replace k \"-\" \"_\"))))\n\n;; Database column name conversion\n(db-record\n |&gt; (map/update-keys _ str/snake))\n</code></pre>"},{"location":"spec/35-stdlib-map/#update-vals-apply-function-to-all-values","title":"update-vals - Apply Function to All Values","text":"<p>Applies a function to all values in a map and returns a new map.</p> <pre><code>;; Basic usage\n(map/update-vals inc {:a 1 :b 2})\n;; =&gt; {:a 2, :b 3}\n\n;; Value type conversion\n(map/update-vals str {:a 1 :b 2 :c 3})\n;; =&gt; {:a \"1\", :b \"2\", :c \"3\"}\n\n;; Value normalization\n(map/update-vals str/trim {:name \"  Alice  \" :city \"  Tokyo  \"})\n;; =&gt; {:name \"Alice\", :city \"Tokyo\"}\n\n;; Number transformation\n(map/update-vals (fn [x] (* x 2)) {:a 10 :b 20 :c 30})\n;; =&gt; {:a 20, :b 40, :c 60}\n</code></pre> <p>Use in Pipeline:</p> <pre><code>;; Price calculation\n(prices\n |&gt; (map/update-vals _ (fn [p] (* p 1.1))))  ;; 10% increase\n\n;; Data normalization\n(form-data\n |&gt; (map/update-vals _ str/trim)\n |&gt; (map/update-vals _ str/lower))\n</code></pre>"},{"location":"spec/35-stdlib-map/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/35-stdlib-map/#configuration-merging","title":"Configuration Merging","text":"<pre><code>;; Merge default and user configurations\n(def default-config\n  {:server {:host \"localhost\" :port 8080}\n   :db {:host \"localhost\" :port 5432}\n   :cache {:ttl 3600}})\n\n(def user-config\n  {:server {:port 3000}\n   :db {:host \"db.example.com\"}})\n\n;; Incremental merge\n(default-config\n |&gt; (map/assoc-in _ [:server :port] (get-in user-config [:server :port]))\n |&gt; (map/assoc-in _ [:db :host] (get-in user-config [:db :host])))\n</code></pre>"},{"location":"spec/35-stdlib-map/#api-response-formatting","title":"API Response Formatting","text":"<pre><code>;; Extract only necessary fields and transform keys\n(defn format-user-response [user]\n  (user\n   |&gt; (map/select-keys _ [:id :name :email :created_at])\n   |&gt; (map/update-keys _ str/camel)))\n\n(format-user-response\n  {:id 1 :name \"Alice\" :email \"alice@example.com\"\n   :created_at \"2024-01-01\" :password_hash \"...\" :salt \"...\"})\n;; =&gt; {\"id\" 1, \"name\" \"Alice\", \"email\" \"alice@example.com\",\n;;     \"createdAt\" \"2024-01-01\"}\n</code></pre>"},{"location":"spec/35-stdlib-map/#database-record-transformation","title":"Database Record Transformation","text":"<pre><code>;; Transform database records for frontend\n(defn transform-records [records]\n  (records\n   |&gt; (map (fn [r]\n             (r\n              |&gt; (map/select-keys _ [:user_id :username :status :created_at])\n              |&gt; (map/update-keys _ str/camel)\n              |&gt; (map/update-vals _ (fn [v]\n                                      (if (string? v)\n                                        (str/trim v)\n                                        v))))))))\n\n(transform-records\n  [{:user_id 1 :username \" alice \" :status \"active\" :created_at \"2024-01-01\" :internal_id 999}\n   {:user_id 2 :username \" bob \" :status \"inactive\" :created_at \"2024-01-02\" :internal_id 1000}])\n;; =&gt; [{\"userId\" 1, \"username\" \"alice\", \"status\" \"active\", \"createdAt\" \"2024-01-01\"}\n;;     {\"userId\" 2, \"username\" \"bob\", \"status\" \"inactive\", \"createdAt\" \"2024-01-02\"}]\n</code></pre>"},{"location":"spec/35-stdlib-map/#removing-sensitive-information","title":"Removing Sensitive Information","text":"<pre><code>;; Remove sensitive information before logging\n(defn sanitize-for-log [data]\n  (data\n   |&gt; (map/dissoc-in _ [:user :credentials :password])\n   |&gt; (map/dissoc-in _ [:user :credentials :api_key])\n   |&gt; (map/dissoc-in _ [:payment :card_number])\n   |&gt; (map/dissoc-in _ [:payment :cvv])))\n\n(sanitize-for-log\n  {:user {:name \"Alice\"\n          :credentials {:username \"alice\" :password \"secret\" :api_key \"xyz123\"}}\n   :payment {:card_number \"1234-5678-9012-3456\" :cvv \"123\" :amount 1000}})\n;; =&gt; {:user {:name \"Alice\", :credentials {:username \"alice\"}},\n;;     :payment {:amount 1000}}\n</code></pre>"},{"location":"spec/35-stdlib-map/#dynamic-configuration-building","title":"Dynamic Configuration Building","text":"<pre><code>;; Build configuration from environment variables\n(defn build-config [env]\n  ({}\n   |&gt; (map/assoc-in _ [:server :host] (get env \"SERVER_HOST\" \"localhost\"))\n   |&gt; (map/assoc-in _ [:server :port] (str/parse-int (get env \"SERVER_PORT\" \"8080\")))\n   |&gt; (map/assoc-in _ [:db :host] (get env \"DB_HOST\" \"localhost\"))\n   |&gt; (map/assoc-in _ [:db :port] (str/parse-int (get env \"DB_PORT\" \"5432\")))\n   |&gt; (map/assoc-in _ [:db :name] (get env \"DB_NAME\" \"app\"))\n   |&gt; (map/assoc-in _ [:cache :enabled] (= (get env \"CACHE_ENABLED\" \"true\") \"true\"))\n   |&gt; (map/assoc-in _ [:cache :ttl] (str/parse-int (get env \"CACHE_TTL\" \"3600\")))))\n</code></pre>"},{"location":"spec/35-stdlib-map/#function-list","title":"Function List","text":""},{"location":"spec/35-stdlib-map/#key-selection_1","title":"Key Selection","text":"<ul> <li><code>map/select-keys</code> - Extract only specified keys</li> </ul>"},{"location":"spec/35-stdlib-map/#nested-operations","title":"Nested Operations","text":"<ul> <li><code>map/assoc-in</code> - Set value in nested map</li> <li><code>map/dissoc-in</code> - Remove key from nested map</li> </ul>"},{"location":"spec/35-stdlib-map/#bulk-transformation","title":"Bulk Transformation","text":"<ul> <li><code>map/update-keys</code> - Apply function to all keys</li> <li><code>map/update-vals</code> - Apply function to all values</li> </ul>"},{"location":"spec/35-stdlib-map/#performance-notes","title":"Performance Notes","text":"<ul> <li>All functions return new maps (immutable)</li> <li><code>update-keys</code> and <code>update-vals</code> apply functions to each element, which can be time-consuming for large maps</li> <li><code>assoc-in</code> recursively copies nested structures, so processing cost increases with deep nesting</li> <li>For frequent updates, consider using atoms (<code>atom</code>) or agents (<code>agent</code>)</li> </ul>"},{"location":"spec/36-stdlib-set/","title":"Standard Library - Set Operations (set/)","text":"<p>Mathematical set operations for collections</p> <p>All functions belong to the <code>set/</code> module.</p> <p>Implementation: <code>src/builtins/set.rs</code> Feature: <code>std-set</code></p>"},{"location":"spec/36-stdlib-set/#overview","title":"Overview","text":"<p>A set is a collection of unique elements without duplicates. In Qi, the <code>set/</code> module provides mathematical set operations.</p> <p>Internally using <code>HashSet</code> for fast operations, these functions accept Lists or Vectors as input.</p>"},{"location":"spec/36-stdlib-set/#primary-use-cases","title":"Primary Use Cases","text":"<ul> <li>Deduplication - Remove duplicates from lists</li> <li>Finding Common Elements - Extract elements common to multiple collections</li> <li>Difference Detection - Identify elements that exist in only one collection</li> <li>Set Relationship Testing - Check subset, superset, and disjoint relationships</li> </ul>"},{"location":"spec/36-stdlib-set/#set-operations","title":"Set Operations","text":""},{"location":"spec/36-stdlib-set/#setunion-union","title":"set/union - Union","text":"<p>Returns the union of multiple collections (duplicates are automatically removed).</p> <pre><code>;; Basic usage\n(set/union [1 2] [2 3])\n;; =&gt; [1 2 3]\n\n;; Three or more collections\n(set/union [1 2] [2 3] [3 4])\n;; =&gt; [1 2 3 4]\n\n;; Empty collection\n(set/union)\n;; =&gt; []\n\n;; Mixed List and Vector\n(set/union (list 1 2) [2 3] (list 3 4))\n;; =&gt; [1 2 3 4]\n</code></pre> <p>Parameters: - <code>...collections</code>: Zero or more Lists/Vectors</p> <p>Returns: - List (all elements without duplicates)</p>"},{"location":"spec/36-stdlib-set/#setintersect-intersection","title":"set/intersect - Intersection","text":"<p>Returns only elements common to all collections.</p> <pre><code>;; Basic usage\n(set/intersect [1 2 3] [2 3 4])\n;; =&gt; [2 3]\n\n;; Common elements in three collections\n(set/intersect [1 2 3 4] [2 3 4 5] [3 4 5 6])\n;; =&gt; [3 4]\n\n;; No common elements\n(set/intersect [1 2] [3 4])\n;; =&gt; []\n\n;; Mixed List and Vector\n(set/intersect (list 1 2 3) [2 3 4])\n;; =&gt; [2 3]\n</code></pre> <p>Parameters: - <code>collection1</code>: First List/Vector (required) - <code>collection2</code>: Second List/Vector (required) - <code>...more</code>: Additional Lists/Vectors (optional)</p> <p>Returns: - List (elements common to all collections)</p>"},{"location":"spec/36-stdlib-set/#setdifference-difference","title":"set/difference - Difference","text":"<p>Returns a set with all elements from subsequent arguments removed from the first argument.</p> <pre><code>;; Basic usage\n(set/difference [1 2 3] [2])\n;; =&gt; [1 3]\n\n;; Exclude multiple collections\n(set/difference [1 2 3 4 5] [2 3] [4])\n;; =&gt; [1 5]\n\n;; No elements to exclude\n(set/difference [1 2 3] [4 5])\n;; =&gt; [1 2 3]\n\n;; Mixed List and Vector\n(set/difference (list 1 2 3 4) [2 4])\n;; =&gt; [1 3]\n</code></pre> <p>Parameters: - <code>base</code>: Base List/Vector (required) - <code>exclude1</code>: List/Vector to exclude (required) - <code>...more</code>: Additional Lists/Vectors to exclude (optional)</p> <p>Returns: - List (base with specified elements removed)</p>"},{"location":"spec/36-stdlib-set/#setsymmetric-difference-symmetric-difference","title":"set/symmetric-difference - Symmetric Difference","text":"<p>Returns elements that exist in only one of the two collections (exclusive OR).</p> <pre><code>;; Basic usage\n(set/symmetric-difference [1 2 3] [2 3 4])\n;; =&gt; [1 4]\n\n;; No common elements - all included\n(set/symmetric-difference [1 2] [3 4])\n;; =&gt; [1 2 3 4]\n\n;; All common - empty result\n(set/symmetric-difference [1 2] [1 2])\n;; =&gt; []\n\n;; Mixed List and Vector\n(set/symmetric-difference (list 1 2 3) [2 3 4])\n;; =&gt; [1 4]\n</code></pre> <p>Parameters: - <code>set1</code>: First List/Vector (required) - <code>set2</code>: Second List/Vector (required)</p> <p>Returns: - List (elements in one collection but not both)</p> <p>Mathematical Meaning: <pre><code>A \u25b3 B = (A - B) \u222a (B - A)\n      = (A \u222a B) - (A \u2229 B)\n</code></pre></p>"},{"location":"spec/36-stdlib-set/#set-relationship-testing","title":"Set Relationship Testing","text":""},{"location":"spec/36-stdlib-set/#setsubset-subset-test","title":"set/subset? - Subset Test","text":"<p>Tests whether the first argument is a subset of the second argument.</p> <pre><code>;; Basic usage\n(set/subset? [1 2] [1 2 3])\n;; =&gt; true\n\n;; Identical sets are subsets\n(set/subset? [1 2] [1 2])\n;; =&gt; true\n\n;; Not a subset\n(set/subset? [1 2 3] [1 2])\n;; =&gt; false\n\n;; Empty set is a subset of all sets\n(set/subset? [] [1 2 3])\n;; =&gt; true\n\n;; Mixed List and Vector\n(set/subset? (list 1 2) [1 2 3 4])\n;; =&gt; true\n</code></pre> <p>Parameters: - <code>subset</code>: Candidate subset List/Vector (required) - <code>superset</code>: Candidate superset List/Vector (required)</p> <p>Returns: - <code>true</code>: All elements of subset are in superset - <code>false</code>: Otherwise</p> <p>Mathematical Meaning: <pre><code>A \u2286 B \u21d4 \u2200x \u2208 A, x \u2208 B\n</code></pre></p>"},{"location":"spec/36-stdlib-set/#setsuperset-superset-test","title":"set/superset? - Superset Test","text":"<p>Tests whether the first argument is a superset of the second argument.</p> <pre><code>;; Basic usage\n(set/superset? [1 2 3] [1 2])\n;; =&gt; true\n\n;; Identical sets are supersets\n(set/superset? [1 2] [1 2])\n;; =&gt; true\n\n;; Not a superset\n(set/superset? [1 2] [1 2 3])\n;; =&gt; false\n\n;; All sets are supersets of the empty set\n(set/superset? [1 2 3] [])\n;; =&gt; true\n\n;; Mixed List and Vector\n(set/superset? (list 1 2 3 4) [1 2])\n;; =&gt; true\n</code></pre> <p>Parameters: - <code>superset</code>: Candidate superset List/Vector (required) - <code>subset</code>: Candidate subset List/Vector (required)</p> <p>Returns: - <code>true</code>: All elements of subset are in superset - <code>false</code>: Otherwise</p> <p>Note: <code>set/superset?(A, B)</code> is equivalent to <code>set/subset?(B, A)</code>.</p> <p>Mathematical Meaning: <pre><code>A \u2287 B \u21d4 B \u2286 A\n</code></pre></p>"},{"location":"spec/36-stdlib-set/#setdisjoint-disjoint-test","title":"set/disjoint? - Disjoint Test","text":"<p>Tests whether two collections have no common elements.</p> <pre><code>;; Basic usage\n(set/disjoint? [1 2] [3 4])\n;; =&gt; true\n\n;; Has common elements\n(set/disjoint? [1 2 3] [3 4 5])\n;; =&gt; false\n\n;; Empty set is disjoint with all sets\n(set/disjoint? [] [1 2 3])\n;; =&gt; true\n\n;; Mixed List and Vector\n(set/disjoint? (list 1 2) [3 4])\n;; =&gt; true\n</code></pre> <p>Parameters: - <code>set1</code>: First List/Vector (required) - <code>set2</code>: Second List/Vector (required)</p> <p>Returns: - <code>true</code>: No common elements - <code>false</code>: At least one common element</p> <p>Mathematical Meaning: <pre><code>A \u2229 B = \u2205\n</code></pre></p>"},{"location":"spec/36-stdlib-set/#practical-examples","title":"Practical Examples","text":""},{"location":"spec/36-stdlib-set/#deduplication","title":"Deduplication","text":"<pre><code>;; Remove duplicates from a list\n(def items [1 2 2 3 3 3 4])\n\n;; Union with itself = deduplication\n(set/union items)\n;; =&gt; [1 2 3 4]\n\n;; Difference from distinct (set/union order is undefined)\n(distinct items)\n;; =&gt; [1 2 3 4] (preserves input order)\n</code></pre>"},{"location":"spec/36-stdlib-set/#user-permission-management","title":"User Permission Management","text":"<pre><code>;; User's permissions\n(def user-permissions [:read :write :delete])\n\n;; Required permissions\n(def required-permissions [:read :write])\n\n;; Does user have all required permissions?\n(set/subset? required-permissions user-permissions)\n;; =&gt; true\n\n;; Does user have admin permission?\n(set/superset? user-permissions [:admin])\n;; =&gt; false\n</code></pre>"},{"location":"spec/36-stdlib-set/#tag-search","title":"Tag Search","text":"<pre><code>;; Article tags\n(def article1-tags [:programming :rust :web])\n(def article2-tags [:programming :python :cli])\n(def article3-tags [:rust :systems])\n\n;; Search for articles with \"programming\" or \"rust\" tags\n(def search-tags [:programming :rust])\n\n;; Does article1 have any common tags with search-tags?\n(not (set/disjoint? article1-tags search-tags))\n;; =&gt; true (:programming and :rust are common)\n\n;; Collect all unique tags\n(set/union article1-tags article2-tags article3-tags)\n;; =&gt; [:programming :rust :web :python :cli :systems]\n</code></pre>"},{"location":"spec/36-stdlib-set/#data-comparison-and-diff-detection","title":"Data Comparison and Diff Detection","text":"<pre><code>;; Old version user IDs\n(def old-users [101 102 103 104 105])\n\n;; New version user IDs\n(def new-users [103 104 105 106 107])\n\n;; Deleted users\n(set/difference old-users new-users)\n;; =&gt; [101 102]\n\n;; Added users\n(set/difference new-users old-users)\n;; =&gt; [106 107]\n\n;; Changed users (deleted + added)\n(set/symmetric-difference old-users new-users)\n;; =&gt; [101 102 106 107]\n\n;; Unchanged users\n(set/intersect old-users new-users)\n;; =&gt; [103 104 105]\n</code></pre>"},{"location":"spec/36-stdlib-set/#multi-condition-filtering","title":"Multi-Condition Filtering","text":"<pre><code>;; Filter IDs by condition\n(def active-users [1 2 3 4 5])\n(def premium-users [3 4 5 6])\n(def verified-users [2 3 5 7])\n\n;; Active AND premium users\n(set/intersect active-users premium-users)\n;; =&gt; [3 4 5]\n\n;; Active but NOT premium users\n(set/difference active-users premium-users)\n;; =&gt; [1 2]\n\n;; Premium OR verified users\n(set/union premium-users verified-users)\n;; =&gt; [3 4 5 6 2 7]\n\n;; Users satisfying all three conditions\n(set/intersect active-users premium-users verified-users)\n;; =&gt; [3 5]\n</code></pre>"},{"location":"spec/36-stdlib-set/#pipeline-integration","title":"Pipeline Integration","text":"<pre><code>;; Extract users with specific roles from user data\n(def users [\n  {:id 1 :roles [:admin :user]}\n  {:id 2 :roles [:user :guest]}\n  {:id 3 :roles [:admin :moderator]}\n  {:id 4 :roles [:user]}\n])\n\n;; Extract IDs of admins or moderators\n(users\n |&gt; (filter (fn [u]\n              (not (set/disjoint? (get u :roles) [:admin :moderator]))))\n |&gt; (map :id))\n;; =&gt; [1 3]\n\n;; Extract users with all required permissions\n(def required-perms [:read :write :execute])\n\n(users\n |&gt; (filter (fn [u]\n              (set/subset? required-perms (get u :roles))))\n |&gt; (map :id))\n;; =&gt; (returns if any user satisfies condition)\n</code></pre>"},{"location":"spec/36-stdlib-set/#performance-considerations","title":"Performance Considerations","text":""},{"location":"spec/36-stdlib-set/#internal-implementation","title":"Internal Implementation","text":"<ul> <li>All set operations use <code>HashSet</code> for fast performance</li> <li>Element lookup is O(1) average time complexity</li> <li>Overall set operations are O(n) complexity (n = number of elements)</li> </ul>"},{"location":"spec/36-stdlib-set/#usage-with-large-data","title":"Usage with Large Data","text":"<pre><code>;; Fast even with tens of thousands of IDs\n(def old-ids (range 100000))\n(def new-ids (range 50000 150000))\n\n;; Calculate difference in O(n)\n(set/difference old-ids new-ids)\n;; =&gt; (0 1 2 ... 49999)\n\n;; Cache when performing frequent checks\n(def common-ids (set/intersect old-ids new-ids))\n\n;; Fast membership test (combined with external functions)\n(contains? (to-vector common-ids) 75000)\n;; =&gt; true\n</code></pre>"},{"location":"spec/36-stdlib-set/#comparison-with-existing-collection-functions","title":"Comparison with Existing Collection Functions","text":""},{"location":"spec/36-stdlib-set/#distinct-vs-setunion","title":"distinct vs set/union","text":"<pre><code>;; distinct - preserves order and removes duplicates\n(distinct [3 1 2 1 3])\n;; =&gt; [3 1 2]\n\n;; set/union - order is undefined (hash-based)\n(set/union [3 1 2 1 3])\n;; =&gt; [3 1 2] or [1 2 3] (implementation-dependent)\n</code></pre> <p>When to use: - Order matters \u2192 <code>distinct</code> - Order doesn't matter, speed matters \u2192 <code>set/union</code></p>"},{"location":"spec/36-stdlib-set/#filter-vs-setintersect","title":"filter vs set/intersect","text":"<pre><code>(def allowed-ids [1 2 3])\n(def all-items [{:id 1} {:id 2} {:id 4}])\n\n;; filter - allows complex conditions\n(all-items |&gt; (filter (fn [item] (some? (find (fn [id] (= id (get item :id))) allowed-ids)))))\n\n;; For simple ID matching, set/intersect is more concise\n(def item-ids (all-items |&gt; (map :id)))\n(set/intersect item-ids allowed-ids)\n;; =&gt; [1 2]\n</code></pre>"},{"location":"spec/36-stdlib-set/#summary","title":"Summary","text":"Function Description Math Symbol <code>set/union</code> Union A \u222a B <code>set/intersect</code> Intersection A \u2229 B <code>set/difference</code> Difference A - B <code>set/symmetric-difference</code> Symmetric difference A \u25b3 B <code>set/subset?</code> Subset test A \u2286 B <code>set/superset?</code> Superset test A \u2287 B <code>set/disjoint?</code> Disjoint test A \u2229 B = \u2205 <p>Features of Qi's Set Operations: - Supports both Lists and Vectors - Always returns a List - Fast <code>HashSet</code>-based operations - Pipeline integration ready - Supports zero or single arguments (union, difference, etc.)</p>"},{"location":"spec/QUICK-REFERENCE/","title":"Qi Language Quick Reference","text":"<p>Learn Qi Basics in One Page</p>"},{"location":"spec/QUICK-REFERENCE/#basic-syntax","title":"\ud83d\udccc Basic Syntax","text":""},{"location":"spec/QUICK-REFERENCE/#data-types","title":"Data Types","text":"<pre><code>42                ;; Integer\n3.14              ;; Float\n\"hello\"           ;; String\nf\"Hello, {name}\"  ;; f-string (string interpolation)\ntrue / false      ;; Boolean\nnil               ;; nil\n:keyword          ;; Keyword\n[1 2 3]           ;; Vector\n'(1 2 3)          ;; List (quote required)\n{:name \"Alice\"}   ;; Map\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#definitions","title":"Definitions","text":"<pre><code>(def x 42)                          ;; Variable definition\n(defn greet [name] (str \"Hello, \" name))  ;; Function definition\n(let [x 10 y 20] (+ x y))          ;; Local binding\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#control-structures","title":"Control Structures","text":"<pre><code>(if (&gt; x 10) \"big\" \"small\")        ;; if\n(do (println \"1\") (println \"2\"))   ;; Sequential execution\n(loop [i 0] (if (&lt; i 10) (recur (inc i)) i))  ;; Loop\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#pipeline-operators-key-feature","title":"\u26a1 Pipeline Operators (\u2605Key Feature)","text":"<pre><code>;; |&gt; - Sequential pipeline\n(data |&gt; parse |&gt; transform |&gt; save)\n\n;; |&gt;? - Railway Pipeline (error handling)\n(input |&gt;? validate |&gt;? parse |&gt;? process)\n;; Short-circuits on {:error ...}, otherwise success\n\n;; ||&gt; - Parallel pipeline (automatically uses pmap)\n([1 2 3 4] ||&gt; heavy-process)  ;; Parallel execution\n\n;; ~&gt; - Async pipeline (goroutine-style)\n(def result (data ~&gt; transform))\n(go/recv! result)\n\n;; tap&gt; - Side-effect tap (for debugging)\n(data |&gt; parse |&gt; (tap print) |&gt; save)\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#pattern-matching-key-feature","title":"\ud83d\udd00 Pattern Matching (\u2605Key Feature)","text":"<pre><code>(match value\n  {:ok data} -&gt; (process data)\n  {:error e} -&gt; (log e)\n  _ -&gt; \"default\")\n\n;; Guard conditions\n(match x\n  n when (&gt; n 0) -&gt; \"positive\"\n  n when (&lt; n 0) -&gt; \"negative\"\n  _ -&gt; \"zero\")\n\n;; Vector destructuring\n(match [1 2 3]\n  [a b c] -&gt; (+ a b c))  ;; =&gt; 6\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#concurrency-and-parallelism-key-feature","title":"\ud83d\ude80 Concurrency and Parallelism (\u2605Key Feature)","text":""},{"location":"spec/QUICK-REFERENCE/#goroutine-style","title":"Goroutine-style","text":"<pre><code>;; Channel creation\n(def ch (go/chan))\n\n;; Send/receive\n(go/send! ch 42)\n(def val (go/recv! ch))  ;; =&gt; 42\n\n;; Execute in goroutine\n(go/run (println \"async!\"))\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#parallel-mapfilterreduce","title":"Parallel map/filter/reduce","text":"<pre><code>(pmap (fn [x] (* x 2)) [1 2 3 4])     ;; Parallel map\n(pfilter even? [1 2 3 4])              ;; Parallel filter\n(preduce + [1 2 3 4] 0)                ;; Parallel reduce (fn collection init)\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#atom-thread-safe-state-management","title":"Atom (thread-safe state management)","text":"<pre><code>(def counter (atom 0))\n(swap! counter inc)        ;; =&gt; 1\n(reset! counter 0)         ;; =&gt; 0\n(deref counter)            ;; =&gt; 0 or @counter\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#collection-operations","title":"\ud83d\udce6 Collection Operations","text":""},{"location":"spec/QUICK-REFERENCE/#access","title":"Access","text":"<pre><code>(first [1 2 3])            ;; =&gt; 1\n(rest [1 2 3])             ;; =&gt; (2 3)\n(last [1 2 3])             ;; =&gt; 3\n(nth [10 20 30] 1)         ;; =&gt; 20\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#transformation","title":"Transformation","text":"<pre><code>(map inc [1 2 3])          ;; =&gt; [2 3 4]\n(filter even? [1 2 3 4])   ;; =&gt; [2 4]\n(reduce + 0 [1 2 3])       ;; =&gt; 6\n(take 2 [1 2 3 4])         ;; =&gt; [1 2]\n(drop 2 [1 2 3 4])         ;; =&gt; [3 4]\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#concatenation-sorting","title":"Concatenation &amp; Sorting","text":"<pre><code>(concat [1 2] [3 4])       ;; =&gt; [1 2 3 4]\n(cons 0 [1 2 3])           ;; =&gt; [0 1 2 3]\n(sort [3 1 4])             ;; =&gt; [1 3 4]\n(reverse [1 2 3])          ;; =&gt; [3 2 1]\n(distinct [1 2 2 3])       ;; =&gt; [1 2 3]\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#predicate-functions","title":"\ud83d\udd0d Predicate Functions","text":"<pre><code>;; Type checking\n(nil? x) (number? x) (string? x) (list? x) (vector? x) (map? x)\n\n;; State checking\n(some? x)      ;; Not nil\n(empty? coll)  ;; Empty collection\n(error? x)     ;; {:error ...} format\n\n;; Numeric predicates\n(even? 2) (odd? 3) (positive? 1) (negative? -1) (zero? 0)\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#error-handling","title":"\u26a0\ufe0f Error Handling","text":""},{"location":"spec/QUICK-REFERENCE/#railway-pipeline-recommended","title":"Railway Pipeline (Recommended)","text":"<pre><code>(defn divide [x y]\n  (if (= y 0)\n    {:error \"division by zero\"}\n    (/ x y)))\n\n(10 |&gt;? (fn [x] (divide 100 x)))  ;; =&gt; 10\n(0 |&gt;? (fn [x] (divide 100 x)))   ;; =&gt; {:error \"division by zero\"}\n\n;; Check with error? predicate\n(if (error? result)\n  (log \"Error\")\n  (process result))\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#trycatch","title":"try/catch","text":"<pre><code>(match (try (risky-operation))\n  {:error e} -&gt; (log e)\n  result -&gt; result)\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#defer-resource-management","title":"defer (Resource management)","text":"<pre><code>(defn process-file [path]\n  (let [f (open path)]\n    (do\n      (defer (close f))  ;; Always executed when function exits\n      (read f))))\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#http-json","title":"\ud83c\udf10 HTTP &amp; JSON","text":""},{"location":"spec/QUICK-REFERENCE/#http-client","title":"HTTP Client","text":"<pre><code>;; Simple version (body only)\n(def resp (http/get \"https://api.example.com/data\"))\n(def data (json/parse resp))\n\n;; Detailed version (status, headers, body)\n(def resp (http/get! \"https://api.example.com/data\"))\n(def data (json/parse (get resp :body)))\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#http-server","title":"HTTP Server","text":"<pre><code>(defn handler [req]\n  (server/json {:message \"Hello, World!\"}))\n\n(comment\n  (server/serve handler {:port 3000}))\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#json","title":"JSON","text":"<pre><code>(json/parse \"{\\\"name\\\":\\\"Alice\\\"}\")  ;; =&gt; {:name \"Alice\"}\n(json/stringify {:name \"Bob\"})       ;; =&gt; \"{\\\"name\\\":\\\"Bob\\\"}\"\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#file-io","title":"\ud83d\udcc1 File I/O","text":"<pre><code>(io/read-file \"data.txt\")                ;; Read file\n(io/write-file \"output.txt\" \"content\")   ;; Write file\n(io/read-lines \"data.txt\")               ;; Read by lines\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#math-functions","title":"\ud83e\uddee Math Functions","text":"<pre><code>(math/pow 2 3)      ;; =&gt; 8\n(math/sqrt 16)      ;; =&gt; 4.0\n(math/round 3.14)   ;; =&gt; 3.0\n(math/rand)         ;; Random [0.0, 1.0)\n(math/rand-int 10)  ;; Random integer [0, 10)\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#testing","title":"\ud83e\uddea Testing","text":"<pre><code>(test/assert-eq (+ 1 2) 3)\n(test/assert (&gt; 5 3))\n(test/assert-throws (fn [] (error \"test\")))\n\n;; Run tests\n(test/run)\n</code></pre>"},{"location":"spec/QUICK-REFERENCE/#tips","title":"\ud83d\udca1 Tips","text":""},{"location":"spec/QUICK-REFERENCE/#when-to-use-lists-vs-vectors","title":"When to Use Lists vs Vectors","text":"<ul> <li>Vectors <code>[...]</code>: Default (JSON-compatible, fast)</li> <li>Lists <code>'(...)</code>: Recursive processing, Lisp-style operations</li> </ul>"},{"location":"spec/QUICK-REFERENCE/#parallelization-guidelines","title":"Parallelization Guidelines","text":"<ul> <li>Use when: CPU-intensive, I/O-heavy, 100+ elements</li> <li>Don't use when: Lightweight operations, fewer than 10 elements</li> </ul>"},{"location":"spec/QUICK-REFERENCE/#error-handling-selection","title":"Error Handling Selection","text":"<ul> <li>Railway Pipeline (<code>|&gt;?</code>): API calls, file I/O, parsing</li> <li>try/catch: Unexpected errors, third-party libraries</li> </ul>"},{"location":"spec/QUICK-REFERENCE/#detailed-documentation","title":"\ud83d\udcda Detailed Documentation","text":"<p>For complete reference, see docs/spec/ directory.</p> <ul> <li>02-flow-pipes.md - Pipeline operators</li> <li>03-concurrency.md - Concurrency &amp; parallelism</li> <li>04-match.md - Pattern matching</li> <li>06-data-structures.md - Data structures</li> <li>08-error-handling.md - Error handling</li> </ul>"},{"location":"tutorial/","title":"Qi Tutorial","text":"<p>Learn Qi from Zero - Hands-On with Practical Code Examples</p> <p>This tutorial is structured to help you learn Qi's key features step by step. Each chapter is independent, so you can start with the parts that interest you most.</p>"},{"location":"tutorial/#tutorial-list","title":"\ud83d\udcda Tutorial List","text":""},{"location":"tutorial/#1-getting-started-must-read","title":"1. Getting Started \u2b50 Must Read","text":"<ul> <li>Installation and environment setup</li> <li>Running your first program</li> <li>Using the REPL</li> <li>Basic data types and operations</li> </ul> <p>Time Required: 15 minutes</p>"},{"location":"tutorial/#2-thinking-in-pipelines-the-essence-of-qi","title":"2. Thinking in Pipelines \u2b50 The Essence of Qi","text":"<ul> <li>Pipeline operator (<code>|&gt;</code>)</li> <li>Designing data flow</li> <li>Function composition and chaining</li> <li>Practical examples: Text processing, data transformation</li> </ul> <p>Time Required: 20 minutes</p>"},{"location":"tutorial/#3-mastering-pattern-matching","title":"3. Mastering Pattern Matching","text":"<ul> <li><code>match</code> expression basics</li> <li>Destructuring data structures</li> <li>Guard conditions</li> <li>Practical examples: Command processing, message handling</li> </ul> <p>Time Required: 25 minutes</p>"},{"location":"tutorial/#4-handling-errors-gracefully-important","title":"4. Handling Errors Gracefully \u2b50 Important","text":"<ul> <li>Railway Pipeline (<code>|&gt;?</code>)</li> <li><code>try</code> and <code>error?</code> predicate</li> <li>Error propagation design</li> <li>Practical examples: File processing, API calls</li> </ul> <p>Time Required: 30 minutes</p>"},{"location":"tutorial/#5-easy-concurrency-and-parallelism-qis-strength","title":"5. Easy Concurrency and Parallelism \u2b50 Qi's Strength","text":"<ul> <li>Parallel pipeline (<code>||&gt;</code>)</li> <li>Goroutine-style concurrency</li> <li>Channel communication</li> <li>Practical examples: Parallel downloads, data processing</li> </ul> <p>Time Required: 35 minutes</p>"},{"location":"tutorial/#6-web-applications-and-apis","title":"6. Web Applications and APIs","text":"<ul> <li>Building HTTP servers</li> <li>JSON APIs</li> <li>Routing and middleware</li> <li>Practical examples: RESTful API, CRUD operations</li> </ul> <p>Time Required: 40 minutes</p>"},{"location":"tutorial/#learning-paths","title":"\ud83c\udfaf Learning Paths","text":""},{"location":"tutorial/#for-beginners-1-hour","title":"For Beginners (1 hour)","text":"<ol> <li>Getting Started (15 min)</li> <li>Thinking in Pipelines (20 min)</li> <li>Mastering Pattern Matching (25 min)</li> </ol>"},{"location":"tutorial/#for-practitioners-2-hours","title":"For Practitioners (2 hours)","text":"<p>In addition to the above: 4. Handling Errors Gracefully (30 min) 5. Easy Concurrency and Parallelism (35 min)</p>"},{"location":"tutorial/#for-web-developers-3-hours","title":"For Web Developers (3 hours)","text":"<p>All tutorials</p>"},{"location":"tutorial/#learning-tips","title":"\ud83d\udca1 Learning Tips","text":"<ol> <li> <p>Try in the REPL: All code examples can be tested in the REPL    <pre><code>qi  # Launch REPL\n</code></pre></p> </li> <li> <p>Modify the code: Don't just copy-paste examples; experiment by changing numbers and data</p> </li> <li> <p>Don't fear errors: Error messages are displayed in Japanese (<code>QI_LANG=ja</code>)</p> </li> <li> <p>Start small: Don't try to write complex code from the start; begin with small functions</p> </li> </ol>"},{"location":"tutorial/#additional-resources","title":"\ud83d\udcd6 Additional Resources","text":"<ul> <li>Quick Reference - All features on one page</li> <li>Complete Language Specification - Detailed specification</li> <li>Function Index - Reference for 200+ functions</li> <li>Style Guide - Coding conventions</li> </ul>"},{"location":"tutorial/#next-steps","title":"\ud83d\ude80 Next Steps","text":"<p>After completing the tutorials:</p> <ol> <li>Browse the examples/ directory for practical code</li> <li>Start your own project</li> <li>Join the community (GitHub Issues, Discussions)</li> </ol> <p>Let's begin with Getting Started!</p>"},{"location":"tutorial/00-lisp-basics/","title":"Lisp Language Basics","text":"<p>Qi is a Lisp-family language. This tutorial explains how to read parentheses and basic concepts for those new to Lisp-family languages.</p>"},{"location":"tutorial/00-lisp-basics/#table-of-contents","title":"Table of Contents","text":"<ul> <li>What is a Lisp-family Language</li> <li>How to Read Parentheses</li> <li>Function Calls</li> <li>Comparison with Other Languages</li> <li>Nested Expressions</li> <li>Why This Syntax</li> <li>Next Steps</li> </ul>"},{"location":"tutorial/00-lisp-basics/#what-is-a-lisp-family-language","title":"What is a Lisp-family Language","text":"<p>Lisp (List Processing) is a historic programming language family created in 1958.</p> <p>Characteristics: - Expressions enclosed in parentheses: Everything is a list (expression enclosed in parentheses) - Prefix notation: Operators come first - Simple syntax: Less to memorize - Code is data: Programs themselves are data structures</p> <p>Representative Lisp-family languages: - Common Lisp - Scheme - Clojure (Lisp on JVM) - Racket - And Qi!</p>"},{"location":"tutorial/00-lisp-basics/#how-to-read-parentheses","title":"How to Read Parentheses","text":""},{"location":"tutorial/00-lisp-basics/#basic-rule","title":"Basic Rule","text":"<pre><code>(function-name arg1 arg2 arg3)\n</code></pre> <p>The first element inside the parentheses is the function name, and the rest are arguments.</p>"},{"location":"tutorial/00-lisp-basics/#example-addition","title":"Example: Addition","text":"<pre><code>(+ 1 2 3)\n;; =&gt; 6\n</code></pre> <p>This means \"add 1, 2, and 3\".</p> <p>Comparison with other languages:</p> Language Syntax JavaScript <code>1 + 2 + 3</code> Python <code>1 + 2 + 3</code> Qi (Lisp) <code>(+ 1 2 3)</code>"},{"location":"tutorial/00-lisp-basics/#function-calls","title":"Function Calls","text":""},{"location":"tutorial/00-lisp-basics/#simple-examples","title":"Simple Examples","text":"<pre><code>;; Multiplication\n(* 2 3)\n;; =&gt; 6\n\n;; Division\n(/ 10 2)\n;; =&gt; 5\n\n;; Print string\n(println \"Hello, World!\")\n;; =&gt; Hello, World!\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#multiple-arguments","title":"Multiple Arguments","text":"<p>In Lisp, many functions can take multiple arguments.</p> <pre><code>;; Add multiple numbers\n(+ 1 2 3 4 5)\n;; =&gt; 15\n\n;; Multiply multiple numbers\n(* 2 3 4)\n;; =&gt; 24\n\n;; Find maximum value\n(max 10 5 8 20 3)\n;; =&gt; 20\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#comparison-with-other-languages","title":"Comparison with Other Languages","text":""},{"location":"tutorial/00-lisp-basics/#example-1-addition","title":"Example 1: Addition","text":"<p>JavaScript: <pre><code>1 + 2 + 3\n</code></pre></p> <p>Python: <pre><code>1 + 2 + 3\n</code></pre></p> <p>Qi: <pre><code>(+ 1 2 3)\n</code></pre></p>"},{"location":"tutorial/00-lisp-basics/#example-2-function-calls","title":"Example 2: Function Calls","text":"<p>JavaScript: <pre><code>Math.max(10, 5, 8)\n</code></pre></p> <p>Python: <pre><code>max(10, 5, 8)\n</code></pre></p> <p>Qi: <pre><code>(max 10 5 8)\n</code></pre></p> <p>In Qi, no commas are needed!</p>"},{"location":"tutorial/00-lisp-basics/#nested-expressions","title":"Nested Expressions","text":"<p>You can put parentheses inside parentheses (nesting).</p>"},{"location":"tutorial/00-lisp-basics/#example-nested-calculations","title":"Example: Nested Calculations","text":"<pre><code>(+ 1 (* 2 3))\n;; =&gt; 7\n</code></pre> <p>How to read: 1. Read from the inside: <code>(* 2 3)</code> \u2192 <code>6</code> 2. Calculate the outside: <code>(+ 1 6)</code> \u2192 <code>7</code></p> <p>Comparison with other languages:</p> Language Syntax JavaScript/Python <code>1 + (2 * 3)</code> Qi (Lisp) <code>(+ 1 (* 2 3))</code>"},{"location":"tutorial/00-lisp-basics/#a-more-complex-example","title":"A More Complex Example","text":"<pre><code>(* (+ 1 2) (+ 3 4))\n;; =&gt; 21\n</code></pre> <p>How to read: 1. <code>(+ 1 2)</code> \u2192 <code>3</code> 2. <code>(+ 3 4)</code> \u2192 <code>7</code> 3. <code>(* 3 7)</code> \u2192 <code>21</code></p> <p>Comparison with other languages:</p> Language Syntax JavaScript/Python <code>(1 + 2) * (3 + 4)</code> Qi (Lisp) <code>(* (+ 1 2) (+ 3 4))</code>"},{"location":"tutorial/00-lisp-basics/#why-this-syntax","title":"Why This Syntax","text":""},{"location":"tutorial/00-lisp-basics/#benefits","title":"Benefits","text":""},{"location":"tutorial/00-lisp-basics/#1-consistency","title":"1. Consistency","text":"<p>Everything follows the same pattern: <code>(function args...)</code></p> <pre><code>(+ 1 2)           ;; Operator\n(println \"Hi\")    ;; Function\n(if true 1 2)     ;; Conditional\n(def x 10)        ;; Variable definition\n</code></pre> <p>All written the same way!</p>"},{"location":"tutorial/00-lisp-basics/#2-extensible","title":"2. Extensible","text":"<p>Adding new operators doesn't change the syntax.</p> <pre><code>;; Existing operator\n(+ 1 2 3)\n\n;; Custom operator (hypothetical)\n(my-operator 1 2 3)\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#3-parentheses-eliminate-ambiguity","title":"3. Parentheses eliminate ambiguity","text":"<p>No need to memorize operator precedence.</p> <p>Other languages (ambiguous): <pre><code>1 + 2 * 3  ;; 7? 9? Which one?\n</code></pre></p> <p>Qi (clear): <pre><code>(+ 1 (* 2 3))  ;; 7\n(* (+ 1 2) 3)  ;; 9\n</code></pre></p>"},{"location":"tutorial/00-lisp-basics/#4-powerful-macros","title":"4. Powerful macros","text":"<p>Since code is data, it's easy to write code that generates code (for advanced users).</p>"},{"location":"tutorial/00-lisp-basics/#practice-try-in-the-repl","title":"Practice: Try in the REPL","text":"<p>Let's launch the REPL and try it out:</p> <pre><code>qi\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#basic-calculations","title":"Basic Calculations","text":"<pre><code>qi:1&gt; (+ 1 2)\n3\n\nqi:2&gt; (* 5 6)\n30\n\nqi:3&gt; (+ 1 (* 2 3))\n7\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#define-variables","title":"Define Variables","text":"<pre><code>qi:4&gt; (def x 10)\n10\n\nqi:5&gt; (def y 5)\n5\n\nqi:6&gt; (+ x y)\n15\n\nqi:7&gt; (* x y)\n50\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#define-functions","title":"Define Functions","text":"<pre><code>qi:8&gt; (defn square [n] (* n n))\nFunction(square)\n\nqi:9&gt; (square 5)\n25\n\nqi:10&gt; (square 10)\n100\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#nested-calculations","title":"Nested Calculations","text":"<pre><code>qi:11&gt; (square (+ 2 3))\n25\n\nqi:12&gt; (+ (square 3) (square 4))\n25\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#frequently-asked-questions","title":"Frequently Asked Questions","text":""},{"location":"tutorial/00-lisp-basics/#q-arent-there-too-many-parentheses","title":"Q: Aren't there too many parentheses?","text":"<p>A: It might seem like a lot at first, but you'll get used to it quickly! With your editor's parenthesis matching feature, it's no problem.</p> <p>Also, Qi has pipeline operators that can reduce parentheses:</p> <pre><code>;; Many parentheses\n(reduce + 0 (filter (fn [x] (&gt; x 5)) (map (fn [x] (* x 2)) [1 2 3 4 5 6 7 8 9 10])))\n\n;; Clean with pipeline\n([1 2 3 4 5 6 7 8 9 10]\n |&gt; (map (fn [x] (* x 2)))\n |&gt; (filter (fn [x] (&gt; x 5)))\n |&gt; (reduce + 0))\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#q-why-is-at-the-front","title":"Q: Why is <code>+</code> at the front?","text":"<p>A: This is called prefix notation. Benefits include:</p> <ol> <li>Naturally write multiple arguments: <code>(+ 1 2 3 4 5)</code></li> <li>Clear precedence: Enclosed in parentheses</li> <li>Consistency: Functions and operators follow the same rule</li> </ol>"},{"location":"tutorial/00-lisp-basics/#q-where-are-the-commas","title":"Q: Where are the commas?","text":"<p>A: In Lisp, commas are unnecessary. Spaces are sufficient.</p> <pre><code>;; \u2713 OK\n(max 10 5 8)\n\n;; \u2717 Don't write commas\n(max 10, 5, 8)  ;; Not an error, but commas are interpreted as variable names\n</code></pre>"},{"location":"tutorial/00-lisp-basics/#summary","title":"Summary","text":"<p>You've learned the basics of Lisp-family languages:</p> <ul> <li>\u2705 Enclose expressions in parentheses: <code>(function args...)</code></li> <li>\u2705 Prefix notation: Operators come first</li> <li>\u2705 Nesting: Parentheses inside parentheses</li> <li>\u2705 Consistency: Everything follows the same pattern</li> <li>\u2705 No commas needed: Separate with spaces</li> </ul> <p>Once you get used to it, this consistency becomes comfortable!</p>"},{"location":"tutorial/00-lisp-basics/#next-steps","title":"Next Steps","text":"<p>Now that you understand the basics of Lisp-family languages, let's actually use Qi:</p> <p>\u27a1\ufe0f Tutorial: Getting Started with Qi</p>"},{"location":"tutorial/00-lisp-basics/#reference-other-lisp-family-languages","title":"Reference: Other Lisp-family Languages","text":"<p>If you're interested, try other Lisp-family languages:</p> <ul> <li>Clojure - Modern Lisp on the JVM, popular for web development</li> <li>Racket - Lisp designed for education, excellent documentation</li> <li>Common Lisp - Classic Lisp, powerful but steep learning curve</li> <li>Scheme - Simple and beautiful Lisp, academically popular</li> </ul> <p>Qi is influenced by these Lisps while evolving uniquely with a focus on pipelines and concurrency.</p> <p>Happy Lisping with Qi! \ud83d\ude80</p>"},{"location":"tutorial/01-getting-started/","title":"Tutorial: Getting Started with Qi","text":"<p>This tutorial will teach you from project creation to execution through hands-on practice.</p> <p>\ud83d\udcda New to Lisp-family languages? Qi is a Lisp-family language. If you're not familiar with parentheses syntax, please check this first: \u27a1\ufe0f Lisp Language Basics - How to read parentheses and basic concepts (5-minute read)</p>"},{"location":"tutorial/01-getting-started/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Environment Check</li> <li>Your First Project</li> <li>Writing Code</li> <li>Creating an HTTP Server</li> <li>Try the REPL</li> <li>Next Steps</li> </ul>"},{"location":"tutorial/01-getting-started/#environment-check","title":"Environment Check","text":"<p>First, let's verify that Qi is properly installed.</p> <pre><code>qi --version\n</code></pre> <p>If version information is displayed, you're good to go.</p> <pre><code>Qi Programming Language v0.1.0\n</code></pre> <p>Let's also check the help:</p> <pre><code>qi --help\n</code></pre>"},{"location":"tutorial/01-getting-started/#your-first-project","title":"Your First Project","text":""},{"location":"tutorial/01-getting-started/#creating-a-project","title":"Creating a Project","text":"<p>Use the <code>qi new</code> command to create a new project.</p> <pre><code>qi new hello-qi\n</code></pre> <p>You'll be asked a few questions. Press Enter to use default values.</p> <pre><code>Creating new Qi project\n\nProject name [hello-qi]:\nVersion [0.1.0]:\nDescription (optional): My first Qi project\nAuthor (optional): Your Name\nLicense [MIT]:\n\nNew Qi project created: hello-qi\n\nNext steps:\n  cd hello-qi\n  qi main.qi\n</code></pre>"},{"location":"tutorial/01-getting-started/#project-structure","title":"Project Structure","text":"<p>Let's check the created project:</p> <pre><code>cd hello-qi\nls -la\n</code></pre> <p>The following files and directories have been created:</p> <pre><code>hello-qi/\n\u251c\u2500\u2500 qi.toml         # Project configuration\n\u251c\u2500\u2500 main.qi         # Main file\n\u251c\u2500\u2500 src/            # Library code\n\u2502   \u2514\u2500\u2500 lib.qi\n\u251c\u2500\u2500 examples/       # Sample code\n\u2502   \u2514\u2500\u2500 example.qi\n\u2514\u2500\u2500 tests/          # Test code\n    \u2514\u2500\u2500 test.qi\n</code></pre>"},{"location":"tutorial/01-getting-started/#examining-qitoml","title":"Examining qi.toml","text":"<p>Let's open the project configuration file:</p> <pre><code>cat qi.toml\n</code></pre> <pre><code>[project]\nname = \"hello-qi\"\nversion = \"0.1.0\"\ndescription = \"My first Qi project\"\nauthors = [\"Your Name\"]\nlicense = \"MIT\"\nqi-version = \"0.1.0\"\n\n[dependencies]\n\n[features]\ndefault = []\n</code></pre> <p>This is the project metadata. You can edit it as needed.</p>"},{"location":"tutorial/01-getting-started/#running-it","title":"Running It","text":"<p>Let's run it right away:</p> <pre><code>qi main.qi\n</code></pre> <p>Output: <pre><code>Hello, Qi!\n\u3053\u3093\u306b\u3061\u306f\u3001hello-qi\u3055\u3093\uff01\nVector([Integer(16), Integer(25)])\n</code></pre></p> <p>Success! The sample code generated by the template has been executed.</p>"},{"location":"tutorial/01-getting-started/#writing-code","title":"Writing Code","text":""},{"location":"tutorial/01-getting-started/#editing-mainqi","title":"Editing main.qi","text":"<p>Open <code>main.qi</code> and check the contents:</p> <pre><code>;; main.qi - Entry point\n\n(println \"Hello, Qi!\")\n\n;; Greeting function\n(defn greet [name]\n  (str \"\u3053\u3093\u306b\u3061\u306f\u3001\" name \"\u3055\u3093\uff01\"))\n\n;; Using the function\n(println (greet \"hello-qi\"))\n\n;; Pipeline example\n(println ([1 2 3 4 5]\n          |&gt; (map (fn [x] (* x x)))\n          |&gt; (filter (fn [x] (&gt; x 10)))))\n</code></pre>"},{"location":"tutorial/01-getting-started/#adding-your-own-code","title":"Adding Your Own Code","text":"<p>Try adding the following to the end of the file:</p> <pre><code>;; My own code\n(println \"\\n=== My Own Code ===\")\n\n;; Filter even numbers and sum\n(def numbers [1 2 3 4 5 6 7 8 9 10])\n(def sum-of-evens\n  (numbers\n   |&gt; (filter (fn [x] (= (% x 2) 0)))\n   |&gt; (reduce + 0)))\n\n(println f\"Sum of evens: {sum-of-evens}\")\n\n;; Map data processing\n(def users [\n  {:name \"Alice\" :age 30}\n  {:name \"Bob\" :age 25}\n  {:name \"Charlie\" :age 35}\n])\n\n(def adult-names\n  (users\n   |&gt; (filter (fn [u] (&gt;= (get u :age) 30)))\n   |&gt; (map (fn [u] (get u :name)))))\n\n(println f\"Age 30+: {adult-names}\")\n</code></pre> <p>Run it:</p> <pre><code>qi main.qi\n</code></pre> <p>Output: <pre><code>...\n=== My Own Code ===\nSum of evens: 30\nAge 30+: Vector([String(\"Alice\"), String(\"Charlie\")])\n</code></pre></p>"},{"location":"tutorial/01-getting-started/#experience-qis-features","title":"Experience Qi's Features","text":"<p>Pipeline operator <code>|&gt;</code>: <pre><code>[1 2 3 4 5]\n|&gt; (map (fn [x] (* x 2)))\n|&gt; (filter (fn [x] (&gt; x 5)))\n|&gt; (reduce + 0)\n</code></pre></p> <p>You can write it as if data flows from left to right!</p>"},{"location":"tutorial/01-getting-started/#creating-an-http-server","title":"Creating an HTTP Server","text":"<p>Next, let's create an HTTP server.</p>"},{"location":"tutorial/01-getting-started/#creating-the-project","title":"Creating the Project","text":"<p>Use the <code>http-server</code> template:</p> <pre><code>cd ..\nqi new myapi --template http-server\ncd myapi\n</code></pre>"},{"location":"tutorial/01-getting-started/#checking-the-structure","title":"Checking the Structure","text":"<pre><code>cat qi.toml\n</code></pre> <p>Note the <code>[features]</code>: <pre><code>[features]\ndefault = [\"http-server\", \"format-json\"]\n</code></pre></p> <p>HTTP and JSON features are enabled.</p>"},{"location":"tutorial/01-getting-started/#viewing-the-server-code","title":"Viewing the Server Code","text":"<pre><code>cat main.qi\n</code></pre> <pre><code>;; myapi - HTTP Server\n;;\n;; JSON API server\n;; Run: qi main.qi\n\n(println \"=== myapi HTTP Server ===\")\n\n;; Root handler\n(defn handle-root [req]\n  (server/json {:message \"Welcome to myapi!\"\n                :version \"0.1.0\"\n                :endpoints [\"/api/hello\" \"/api/users\"]}))\n\n;; Hello API handler\n(defn handle-hello [req]\n  (let [name (get (get req :params) \"name\" \"World\")]\n    (server/json {:message (str \"Hello, \" name \"!\")})))\n\n;; Users API handler\n(defn handle-users [req]\n  (server/json {:users [{:id 1 :name \"Alice\"}\n                        {:id 2 :name \"Bob\"}\n                        {:id 3 :name \"Charlie\"}]}))\n\n;; Main handler (routing)\n(defn handler [req]\n  (let [path (get req :path)]\n    (match path\n      \"/\" -&gt; (handle-root req)\n      \"/api/hello\" -&gt; (handle-hello req)\n      \"/api/users\" -&gt; (handle-users req)\n      _ -&gt; (server/json {:error \"Not Found\"} 404))))\n\n;; Start server\n(def port 3000)\n(println f\"Starting server on http://localhost:{port}\")\n(println \"Press Ctrl+C to stop\")\n\n(server/serve port handler)\n</code></pre>"},{"location":"tutorial/01-getting-started/#starting-the-server","title":"Starting the Server","text":"<pre><code>qi main.qi\n</code></pre> <p>Output: <pre><code>=== myapi HTTP Server ===\nStarting server on http://localhost:3000\nPress Ctrl+C to stop\nListening on http://0.0.0.0:3000\n</code></pre></p>"},{"location":"tutorial/01-getting-started/#testing-the-api","title":"Testing the API","text":"<p>In another terminal:</p> <pre><code># Root\ncurl http://localhost:3000/\n\n# Hello API\ncurl http://localhost:3000/api/hello\ncurl http://localhost:3000/api/hello?name=Alice\n\n# Users API\ncurl http://localhost:3000/api/users\n</code></pre>"},{"location":"tutorial/01-getting-started/#customizing","title":"Customizing","text":"<p>Let's add a new endpoint to <code>main.qi</code>:</p> <pre><code>;; Status API handler (added)\n(defn handle-status [req]\n  (server/json {:status \"ok\"\n                :uptime 123\n                :version \"0.1.0\"}))\n\n;; Add to handler\n(defn handler [req]\n  (let [path (get req :path)]\n    (match path\n      \"/\" -&gt; (handle-root req)\n      \"/api/hello\" -&gt; (handle-hello req)\n      \"/api/users\" -&gt; (handle-users req)\n      \"/api/status\" -&gt; (handle-status req)  ; Added\n      _ -&gt; (server/json {:error \"Not Found\"} 404))))\n</code></pre> <p>Restart the server (stop with Ctrl+C and re-run) and test:</p> <pre><code>curl http://localhost:3000/api/status\n</code></pre>"},{"location":"tutorial/01-getting-started/#try-the-repl","title":"Try the REPL","text":""},{"location":"tutorial/01-getting-started/#starting-the-repl","title":"Starting the REPL","text":"<pre><code>qi\n</code></pre> <pre><code>Qi Programming Language v0.1.0\nPress Ctrl+C to interrupt, Ctrl+D to exit\nType :help for available commands\n\nqi:1&gt;\n</code></pre>"},{"location":"tutorial/01-getting-started/#basic-calculations","title":"Basic Calculations","text":"<pre><code>qi:1&gt; (+ 1 2 3)\n6\n\nqi:2&gt; (* 2 (+ 3 4))\n14\n\nqi:3&gt; (/ 10 3)\n3\n</code></pre>"},{"location":"tutorial/01-getting-started/#defining-variables-and-functions","title":"Defining Variables and Functions","text":"<pre><code>qi:4&gt; (def x 10)\n10\n\nqi:5&gt; (defn square [n] (* n n))\nFunction(square)\n\nqi:6&gt; (square x)\n100\n</code></pre>"},{"location":"tutorial/01-getting-started/#trying-pipelines","title":"Trying Pipelines","text":"<pre><code>qi:7&gt; ([1 2 3 4 5] |&gt; (map (fn [x] (* x 2))))\nVector([Integer(2), Integer(4), Integer(6), Integer(8), Integer(10)])\n\nqi:8&gt; ([1 2 3 4 5]\n        |&gt; (map (fn [x] (* x 2)))\n        |&gt; (filter (fn [x] (&gt; x 5)))\n        |&gt; (reduce + 0))\n30\n</code></pre>"},{"location":"tutorial/01-getting-started/#repl-commands","title":"REPL Commands","text":"<pre><code>qi:9&gt; :help\nAvailable commands:\n  :help                    Show help\n  :doc &lt;name&gt;              Show documentation for a function\n  :vars                    Show defined variables\n  ...\n\nqi:10&gt; :vars\nDefined variables:\n  x\n\nqi:11&gt; :funcs\nDefined functions:\n  square\n\nqi:12&gt; :doc map\n(Documentation will be displayed)\n</code></pre>"},{"location":"tutorial/01-getting-started/#loading-files","title":"Loading Files","text":"<pre><code>qi:13&gt; :load src/lib.qi\nLoading src/lib.qi...\nLoaded\n\nqi:14&gt; (greet \"REPL\")\n\"\u3053\u3093\u306b\u3061\u306f\u3001REPL\u3055\u3093\uff01\"\n</code></pre>"},{"location":"tutorial/01-getting-started/#next-steps","title":"Next Steps","text":"<p>Congratulations! You've now mastered the basics of using Qi.</p>"},{"location":"tutorial/01-getting-started/#learn-more","title":"Learn More","text":"<ul> <li>Language Specification - Learn all Qi language features</li> <li>Pipeline Operators - <code>|&gt;</code>, <code>|&gt;?</code>, <code>||&gt;</code>, <code>~&gt;</code></li> <li>Concurrency and Parallelism - <code>go</code>, <code>chan</code></li> <li>Pattern Matching - <code>match</code> expressions</li> <li> <p>Error Handling - <code>try</code>, <code>defer</code></p> </li> <li> <p>Standard Library - 60+ built-in functions</p> </li> <li>String manipulation</li> <li>HTTP client/server</li> <li>JSON/YAML processing</li> <li> <p>File I/O</p> </li> <li> <p>CLI Reference - Details of the <code>qi</code> command</p> </li> <li> <p>Project Management - qi.toml, templates, customization</p> </li> </ul>"},{"location":"tutorial/01-getting-started/#project-ideas","title":"Project Ideas","text":"<ul> <li>CLI Tools: File processing, data transformation</li> <li>Web APIs: RESTful APIs, microservices</li> <li>Data Pipelines: Log analysis, ETL processing</li> <li>Automation Scripts: Task automation, batch processing</li> </ul>"},{"location":"tutorial/01-getting-started/#community","title":"Community","text":"<ul> <li>GitHub Repository - Issue reports and PRs welcome!</li> <li>Documentation improvement suggestions are also very welcome</li> </ul> <p>Happy coding with Qi! \ud83d\ude80</p>"},{"location":"tutorial/02-pipelines/","title":"Chapter 2: Thinking in Pipelines","text":"<p>Time Required: 20 minutes</p> <p>Pipelines are one of Qi's most powerful features. They allow you to describe data flow intuitively.</p>"},{"location":"tutorial/02-pipelines/#why-pipelines","title":"Why Pipelines?","text":"<p>Traditional nested function calls tend to become hard to read.</p>"},{"location":"tutorial/02-pipelines/#nested-style-hard-to-read","title":"Nested Style (Hard to Read)","text":"<pre><code>(str/upper (str/reverse (str/trim \"  hello  \")))\n; =&gt; \"OLLEH\"\n</code></pre> <p>You need to read from inside out, making the data flow unclear.</p>"},{"location":"tutorial/02-pipelines/#pipeline-style-easy-to-read","title":"Pipeline Style (Easy to Read)","text":"<pre><code>(\"  hello  \"\n |&gt; str/trim\n |&gt; str/reverse\n |&gt; str/upper)\n; =&gt; \"OLLEH\"\n</code></pre> <p>Data flows from left to right, making the processing order immediately clear!</p>"},{"location":"tutorial/02-pipelines/#pipeline-operator","title":"Pipeline Operator <code>|&gt;</code>","text":"<p><code>|&gt;</code> passes the left value to the right function.</p> <pre><code>qi&gt; (10 |&gt; inc)\n; =&gt; 11\n\nqi&gt; (5 |&gt; (* 2))\n; =&gt; 10\n\nqi&gt; (5 |&gt; (fn [x] (* x 2)))\n; =&gt; 10\n</code></pre>"},{"location":"tutorial/02-pipelines/#practical-example-1-numeric-processing","title":"Practical Example 1: Numeric Processing","text":"<pre><code>qi&gt; (10\n     |&gt; (+ 5)        ; 10 + 5 = 15\n     |&gt; (* 2)        ; 15 * 2 = 30\n     |&gt; (- 10))      ; 30 - 10 = 20\n; =&gt; 20\n</code></pre> <p>Data flow: <pre><code>10 \u2192 15 \u2192 30 \u2192 20\n</code></pre></p>"},{"location":"tutorial/02-pipelines/#practical-example-2-string-processing","title":"Practical Example 2: String Processing","text":"<pre><code>qi&gt; (\"hello world\"\n     |&gt; str/upper        ; \"HELLO WORLD\"\n     |&gt; (str/replace \" \" \"-\")  ; \"HELLO-WORLD\"\n     |&gt; (str/concat \"!\"))      ; \"HELLO-WORLD!\"\n; =&gt; \"HELLO-WORLD!\"\n</code></pre>"},{"location":"tutorial/02-pipelines/#practical-example-3-list-processing","title":"Practical Example 3: List Processing","text":"<pre><code>qi&gt; ([1 2 3 4 5 6 7 8 9 10]\n     |&gt; (filter even?)           ; [2 4 6 8 10]\n     |&gt; (map (fn [x] (* x x)))   ; [4 16 36 64 100]\n     |&gt; (reduce + 0))            ; 220\n; =&gt; 220\n</code></pre> <p>Processing flow: 1. Extract even numbers: <code>[2 4 6 8 10]</code> 2. Square each element: <code>[4 16 36 64 100]</code> 3. Sum all: <code>220</code></p>"},{"location":"tutorial/02-pipelines/#pipelines-and-debugging-tap","title":"Pipelines and Debugging: <code>tap&gt;</code>","text":"<p><code>tap&gt;</code> executes side effects (like print) without modifying the data. Useful for debugging.</p> <pre><code>qi&gt; ([1 2 3 4 5]\n     |&gt; (tap println)              ; Debug output\n     |&gt; (map (fn [x] (* x 2)))\n     |&gt; (tap println)              ; Debug output\n     |&gt; (reduce + 0))\n; =&gt; Output: [1 2 3 4 5]\n; =&gt; Output: [2 4 6 8 10]\n; =&gt; 30\n</code></pre> <p><code>tap&gt;</code> lets you inspect data state in the middle of a pipeline.</p>"},{"location":"tutorial/02-pipelines/#defining-functions-with-pipelines","title":"Defining Functions with Pipelines","text":"<p>You can write readable functions using pipelines.</p>"},{"location":"tutorial/02-pipelines/#example-text-formatting-function","title":"Example: Text Formatting Function","text":"<pre><code>(defn format-title [text]\n  (text\n   |&gt; str/trim\n   |&gt; str/lower\n   |&gt; (str/replace \" \" \"-\")\n   |&gt; (str/concat \"title-\")))\n\nqi&gt; (format-title \"  Hello World  \")\n; =&gt; \"title-hello-world\"\n</code></pre>"},{"location":"tutorial/02-pipelines/#example-data-aggregation-function","title":"Example: Data Aggregation Function","text":"<pre><code>(defn sum-of-squares [numbers]\n  (numbers\n   |&gt; (map (fn [x] (* x x)))\n   |&gt; (reduce + 0)))\n\nqi&gt; (sum-of-squares [1 2 3 4 5])\n; =&gt; 55  (1 + 4 + 9 + 16 + 25)\n</code></pre>"},{"location":"tutorial/02-pipelines/#practical-example-4-csv-data-processing-mock","title":"Practical Example 4: CSV Data Processing (Mock)","text":"<pre><code>(def csv-data\n  \"Alice,25,Engineer\nBob,30,Designer\nCarol,28,Manager\")\n\n(defn parse-csv-line [line]\n  (let [parts (str/split line \",\")]\n    {:name (first parts)\n     :age (nth parts 1)\n     :role (nth parts 2)}))\n\n(csv-data\n |&gt; (str/split \"\\n\")\n |&gt; (map parse-csv-line))\n; =&gt; [{:name \"Alice\" :age \"25\" :role \"Engineer\"}\n;     {:name \"Bob\" :age \"30\" :role \"Designer\"}\n;     {:name \"Carol\" :age \"28\" :role \"Manager\"}]\n</code></pre>"},{"location":"tutorial/02-pipelines/#practical-example-5-statistical-processing","title":"Practical Example 5: Statistical Processing","text":"<pre><code>(defn analyze-scores [scores]\n  {:count (len scores)\n   :sum (reduce + 0 scores)\n   :average (/ (reduce + 0 scores) (len scores))\n   :max (reduce max 0 scores)\n   :min (reduce min 100 scores)})\n\n(def test-scores [85 92 78 90 88])\n\n(test-scores |&gt; analyze-scores)\n; =&gt; {:count 5 :sum 433 :average 86.6 :max 92 :min 78}\n</code></pre>"},{"location":"tutorial/02-pipelines/#benefits-of-pipelines","title":"Benefits of Pipelines","text":""},{"location":"tutorial/02-pipelines/#1-readable","title":"1. Readable","text":"<p>Data flow is immediately clear:</p> <pre><code>; \u274c Hard to read\n(reduce + 0 (map (fn [x] (* x x)) (filter even? [1 2 3 4 5 6])))\n\n; \u2705 Easy to read\n([1 2 3 4 5 6]\n |&gt; (filter even?)\n |&gt; (map (fn [x] (* x x)))\n |&gt; (reduce + 0))\n</code></pre>"},{"location":"tutorial/02-pipelines/#2-easy-to-debug","title":"2. Easy to Debug","text":"<p>Check intermediate results with <code>tap&gt;</code>:</p> <pre><code>([1 2 3 4 5 6]\n |&gt; (filter even?)\n |&gt; (tap println)  ; \u2190 Check here\n |&gt; (map (fn [x] (* x x)))\n |&gt; (tap println)  ; \u2190 Check here\n |&gt; (reduce + 0))\n</code></pre>"},{"location":"tutorial/02-pipelines/#3-easy-to-extend","title":"3. Easy to Extend","text":"<p>Adding processing steps in the middle is easy:</p> <pre><code>(data\n |&gt; step1\n |&gt; step2\n |&gt; new-step  ; \u2190 Easy to add\n |&gt; step3)\n</code></pre>"},{"location":"tutorial/02-pipelines/#pipelines-and-function-composition","title":"Pipelines and Function Composition","text":"<p>Pipelines combine multiple functions to create new ones.</p> <pre><code>(defn double [x] (* x 2))\n(defn add-ten [x] (+ x 10))\n(defn square [x] (* x x))\n\n; Compose with pipeline\n(defn transform [x]\n  (x\n   |&gt; double\n   |&gt; add-ten\n   |&gt; square))\n\nqi&gt; (transform 5)\n; =&gt; 400  ((5 * 2 + 10) ^ 2 = 20 ^ 2 = 400)\n</code></pre>"},{"location":"tutorial/02-pipelines/#practice-problems","title":"Practice Problems","text":""},{"location":"tutorial/02-pipelines/#problem-1-url-slug-generation","title":"Problem 1: URL Slug Generation","text":"<p>Write a function that generates a URL slug from a blog title.</p> <pre><code>(defn make-slug [title]\n  ; Fill this in\n  ; Hint: Use str/trim, str/lower, (str/replace \" \" \"-\")\n  )\n\n; Tests\n(make-slug \"  Hello World  \")  ; =&gt; \"hello-world\"\n(make-slug \"Qi Programming Language\")  ; =&gt; \"qi-programming-language\"\n</code></pre> Solution <pre><code>(defn make-slug [title]\n  (title\n   |&gt; str/trim\n   |&gt; str/lower\n   |&gt; (str/replace \" \" \"-\")))\n</code></pre>"},{"location":"tutorial/02-pipelines/#problem-2-sum-of-even-squares","title":"Problem 2: Sum of Even Squares","text":"<p>Write a function that extracts even numbers from a list, squares each, and sums them all.</p> <pre><code>(defn sum-even-squares [numbers]\n  ; Fill this in\n  )\n\n; Test\n(sum-even-squares [1 2 3 4 5 6])  ; =&gt; 56  (4 + 16 + 36)\n</code></pre> Solution <pre><code>(defn sum-even-squares [numbers]\n  (numbers\n   |&gt; (filter even?)\n   |&gt; (map (fn [x] (* x x)))\n   |&gt; (reduce + 0)))\n</code></pre>"},{"location":"tutorial/02-pipelines/#problem-3-name-list-formatting","title":"Problem 3: Name List Formatting","text":"<p>Write a function that takes a list of names, converts them all to uppercase, and sorts alphabetically.</p> <pre><code>(defn format-names [names]\n  ; Fill this in\n  )\n\n; Test\n(format-names [\"charlie\" \"alice\" \"bob\"])\n; =&gt; [\"ALICE\" \"BOB\" \"CHARLIE\"]\n</code></pre> Solution <pre><code>(defn format-names [names]\n  (names\n   |&gt; (map str/upper)\n   |&gt; sort))\n</code></pre>"},{"location":"tutorial/02-pipelines/#summary","title":"Summary","text":"<p>What you learned in this chapter:</p> <ul> <li>\u2705 How to use the pipeline operator <code>|&gt;</code></li> <li>\u2705 Thinking about designing data flow</li> <li>\u2705 Debugging with <code>tap&gt;</code></li> <li>\u2705 Practical pipeline examples (strings, numbers, lists)</li> <li>\u2705 Pipelines and function composition</li> </ul>"},{"location":"tutorial/02-pipelines/#next-steps","title":"Next Steps","text":"<p>Now that you can freely handle data flow with pipelines, let's learn pattern matching next!</p> <p>\u27a1\ufe0f Chapter 3: Mastering Pattern Matching</p> <p>Pattern matching is a powerful feature for branching processing based on data structure.</p>"},{"location":"tutorial/03-pattern-matching/","title":"Chapter 3: Mastering Pattern Matching","text":"<p>Time Required: 25 minutes</p> <p>Pattern matching is a powerful feature for branching processing based on data structure. It produces much more readable and maintainable code than nesting multiple <code>if</code> statements.</p>"},{"location":"tutorial/03-pattern-matching/#match-expression-basics","title":"<code>match</code> Expression Basics","text":"<p><code>match</code> matches a value against patterns and returns the result of the matched pattern.</p> <pre><code>(match value\n  pattern1 -&gt; result1\n  pattern2 -&gt; result2\n  _ -&gt; default)\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#example-simple-matching","title":"Example: Simple Matching","text":"<pre><code>qi&gt; (match 42\n      42 -&gt; \"The answer!\"\n      _ -&gt; \"Something else\")\n; =&gt; \"The answer!\"\n\nqi&gt; (match \"hello\"\n      \"hello\" -&gt; \"Hi!\"\n      \"bye\" -&gt; \"Goodbye!\"\n      _ -&gt; \"Unknown\")\n; =&gt; \"Hi!\"\n</code></pre> <p>Key point: <code>_</code> is a wildcard (matches anything).</p>"},{"location":"tutorial/03-pattern-matching/#list-pattern-matching","title":"List Pattern Matching","text":"<p>You can destructure lists to extract the first element or remaining elements.</p> <pre><code>qi&gt; (match [1 2 3]\n      [] -&gt; \"Empty\"\n      [x] -&gt; f\"Single: {x}\"\n      [first second] -&gt; f\"Pair: {first}, {second}\"\n      [a b c] -&gt; f\"Three: {a}, {b}, {c}\")\n; =&gt; \"Three: 1, 2, 3\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#firstrest-pattern","title":"first/rest Pattern","text":"<pre><code>qi&gt; (defn describe-list [lst]\n      (match lst\n        [] -&gt; \"Empty list\"\n        [x] -&gt; f\"Single element: {x}\"\n        [first &amp; rest] -&gt; f\"First: {first}, Rest: {rest}\"))\n\nqi&gt; (describe-list [])\n; =&gt; \"Empty list\"\n\nqi&gt; (describe-list [10])\n; =&gt; \"Single element: 10\"\n\nqi&gt; (describe-list [1 2 3 4 5])\n; =&gt; \"First: 1, Rest: [2 3 4 5]\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#map-pattern-matching","title":"Map Pattern Matching","text":"<p>You can destructure maps to extract values.</p> <pre><code>qi&gt; (def person {:name \"Alice\" :age 25 :city \"Tokyo\"})\n\nqi&gt; (match person\n      {:name n :age a} -&gt; f\"{n} is {a} years old\")\n; =&gt; \"Alice is 25 years old\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#practical-example-http-response-processing","title":"Practical Example: HTTP Response Processing","text":"<pre><code>(defn handle-response [resp]\n  (match resp\n    {:status 200 :body body} -&gt; f\"Success: {body}\"\n    {:status 404} -&gt; \"Not Found\"\n    {:status 500 :message msg} -&gt; f\"Server Error: {msg}\"\n    _ -&gt; \"Unknown response\"))\n\nqi&gt; (handle-response {:status 200 :body \"OK\"})\n; =&gt; \"Success: OK\"\n\nqi&gt; (handle-response {:status 404})\n; =&gt; \"Not Found\"\n\nqi&gt; (handle-response {:status 500 :message \"Database error\"})\n; =&gt; \"Server Error: Database error\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#guard-conditions","title":"Guard Conditions","text":"<p>You can add conditions to patterns using <code>when</code>.</p> <pre><code>(defn classify-number [n]\n  (match n\n    x when (&gt; x 0) -&gt; \"Positive\"\n    x when (&lt; x 0) -&gt; \"Negative\"\n    _ -&gt; \"Zero\"))\n\nqi&gt; (classify-number 10)\n; =&gt; \"Positive\"\n\nqi&gt; (classify-number -5)\n; =&gt; \"Negative\"\n\nqi&gt; (classify-number 0)\n; =&gt; \"Zero\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#complex-guards","title":"Complex Guards","text":"<pre><code>(defn describe-age [age]\n  (match age\n    n when (&lt; n 13) -&gt; \"Child\"\n    n when (and (&gt;= n 13) (&lt; n 20)) -&gt; \"Teenager\"\n    n when (and (&gt;= n 20) (&lt; n 65)) -&gt; \"Adult\"\n    _ -&gt; \"Senior\"))\n\nqi&gt; (describe-age 10)\n; =&gt; \"Child\"\n\nqi&gt; (describe-age 15)\n; =&gt; \"Teenager\"\n\nqi&gt; (describe-age 30)\n; =&gt; \"Adult\"\n\nqi&gt; (describe-age 70)\n; =&gt; \"Senior\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#or-patterns","title":"or Patterns","text":"<p>Multiple patterns can be grouped together (separated by <code>|</code>).</p> <pre><code>(defn weekday-or-weekend [day]\n  (match day\n    \"Monday\" | \"Tuesday\" | \"Wednesday\" | \"Thursday\" | \"Friday\" -&gt; \"Weekday\"\n    \"Saturday\" | \"Sunday\" -&gt; \"Weekend\"\n    _ -&gt; \"Unknown\"))\n\nqi&gt; (weekday-or-weekend \"Monday\")\n; =&gt; \"Weekday\"\n\nqi&gt; (weekday-or-weekend \"Saturday\")\n; =&gt; \"Weekend\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#practical-example-1-command-processing","title":"Practical Example 1: Command Processing","text":"<pre><code>(defn handle-command [cmd]\n  (match cmd\n    {:type \"add\" :a a :b b} -&gt; (+ a b)\n    {:type \"sub\" :a a :b b} -&gt; (- a b)\n    {:type \"mul\" :a a :b b} -&gt; (* a b)\n    {:type \"div\" :a a :b b} -&gt; (/ a b)\n    _ -&gt; {:error \"Unknown command\"}))\n\nqi&gt; (handle-command {:type \"add\" :a 10 :b 20})\n; =&gt; 30\n\nqi&gt; (handle-command {:type \"mul\" :a 5 :b 6})\n; =&gt; 30\n\nqi&gt; (handle-command {:type \"unknown\"})\n; =&gt; {:error \"Unknown command\"}\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#practical-example-2-state-machine","title":"Practical Example 2: State Machine","text":"<pre><code>(defn process-state [state event]\n  (match [state event]\n    [\"idle\" \"start\"] -&gt; \"running\"\n    [\"running\" \"pause\"] -&gt; \"paused\"\n    [\"running\" \"stop\"] -&gt; \"stopped\"\n    [\"paused\" \"resume\"] -&gt; \"running\"\n    [\"paused\" \"stop\"] -&gt; \"stopped\"\n    _ -&gt; state))\n\nqi&gt; (process-state \"idle\" \"start\")\n; =&gt; \"running\"\n\nqi&gt; (process-state \"running\" \"pause\")\n; =&gt; \"paused\"\n\nqi&gt; (process-state \"paused\" \"resume\")\n; =&gt; \"running\"\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#practical-example-3-json-data-validation","title":"Practical Example 3: JSON Data Validation","text":"<pre><code>(defn validate-user [data]\n  (match data\n    {:name n :email e} when (and (string? n) (string? e)) -&gt;\n      {:valid true :user {:name n :email e}}\n    _ -&gt;\n      {:valid false :error \"Invalid user data\"}))\n\nqi&gt; (validate-user {:name \"Alice\" :email \"alice@example.com\"})\n; =&gt; {:valid true :user {:name \"Alice\" :email \"alice@example.com\"}}\n\nqi&gt; (validate-user {:name \"Bob\"})\n; =&gt; {:valid false :error \"Invalid user data\"}\n\nqi&gt; (validate-user {:name 123 :email \"test@test.com\"})\n; =&gt; {:valid false :error \"Invalid user data\"}\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#practical-example-4-tree-traversal","title":"Practical Example 4: Tree Traversal","text":"<pre><code>; Binary tree node\n; {:value value :left left-child :right right-child}\n\n(defn tree-sum [tree]\n  (match tree\n    nil -&gt; 0\n    {:value v :left nil :right nil} -&gt; v\n    {:value v :left l :right nil} -&gt; (+ v (tree-sum l))\n    {:value v :left nil :right r} -&gt; (+ v (tree-sum r))\n    {:value v :left l :right r} -&gt; (+ v (tree-sum l) (tree-sum r))))\n\n(def my-tree\n  {:value 10\n   :left {:value 5 :left nil :right nil}\n   :right {:value 15 :left nil :right nil}})\n\nqi&gt; (tree-sum my-tree)\n; =&gt; 30  (10 + 5 + 15)\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#comparing-match-and-if","title":"Comparing match and if","text":""},{"location":"tutorial/03-pattern-matching/#using-if-hard-to-read","title":"Using if (Hard to Read)","text":"<pre><code>(defn classify-response [resp]\n  (if (and (map? resp) (= (get resp :status) 200))\n    (get resp :body)\n    (if (and (map? resp) (= (get resp :status) 404))\n      \"Not Found\"\n      (if (and (map? resp) (= (get resp :status) 500))\n        \"Server Error\"\n        \"Unknown\"))))\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#using-match-easy-to-read","title":"Using match (Easy to Read)","text":"<pre><code>(defn classify-response [resp]\n  (match resp\n    {:status 200 :body body} -&gt; body\n    {:status 404} -&gt; \"Not Found\"\n    {:status 500} -&gt; \"Server Error\"\n    _ -&gt; \"Unknown\"))\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#benefits-of-pattern-matching","title":"Benefits of Pattern Matching","text":""},{"location":"tutorial/03-pattern-matching/#1-readability","title":"1. Readability","text":"<p>Data structure is immediately clear:</p> <pre><code>; \u2705 Easy to read\n(match user\n  {:name n :age a} -&gt; f\"{n} is {a}\"\n  _ -&gt; \"Unknown\")\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#2-exhaustiveness","title":"2. Exhaustiveness","text":"<p>Easy to verify that all cases are handled:</p> <pre><code>(match status\n  \"pending\" -&gt; handle-pending\n  \"approved\" -&gt; handle-approved\n  \"rejected\" -&gt; handle-rejected\n  _ -&gt; handle-unknown)  ; Don't forget!\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#3-maintainability","title":"3. Maintainability","text":"<p>Adding new cases is easy:</p> <pre><code>(match command\n  \"start\" -&gt; start-process\n  \"stop\" -&gt; stop-process\n  \"restart\" -&gt; restart-process  ; \u2190 Easy to add\n  _ -&gt; unknown-command)\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#practice-problems","title":"Practice Problems","text":""},{"location":"tutorial/03-pattern-matching/#problem-1-grade-classification","title":"Problem 1: Grade Classification","text":"<p>Write a function that takes a score and returns a grade (A/B/C/D/F).</p> <pre><code>(defn get-grade [score]\n  ; Fill this in\n  ; 90+: A, 80+: B, 70+: C, 60+: D, below: F\n  )\n\n; Tests\n(get-grade 95)  ; =&gt; \"A\"\n(get-grade 85)  ; =&gt; \"B\"\n(get-grade 75)  ; =&gt; \"C\"\n(get-grade 65)  ; =&gt; \"D\"\n(get-grade 50)  ; =&gt; \"F\"\n</code></pre> Solution <pre><code>(defn get-grade [score]\n  (match score\n    s when (&gt;= s 90) -&gt; \"A\"\n    s when (&gt;= s 80) -&gt; \"B\"\n    s when (&gt;= s 70) -&gt; \"C\"\n    s when (&gt;= s 60) -&gt; \"D\"\n    _ -&gt; \"F\"))\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#problem-2-get-first-two-elements-of-list","title":"Problem 2: Get First Two Elements of List","text":"<p>Write a function that takes a list and returns the first two elements.</p> <pre><code>(defn first-two [lst]\n  ; Fill this in\n  )\n\n; Tests\n(first-two [1 2 3 4 5])  ; =&gt; [1 2]\n(first-two [10])         ; =&gt; [10]\n(first-two [])           ; =&gt; []\n</code></pre> Solution <pre><code>(defn first-two [lst]\n  (match lst\n    [] -&gt; []\n    [x] -&gt; [x]\n    [a b &amp; _] -&gt; [a b]))\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#problem-3-option-type-processing","title":"Problem 3: Option Type Processing","text":"<p>Write a function that takes a map with <code>:some</code> or <code>:none</code> and processes it if a value exists.</p> <pre><code>(defn process-option [opt]\n  ; Fill this in\n  ; {:type :some :value v} =&gt; v * 2\n  ; {:type :none} =&gt; 0\n  )\n\n; Tests\n(process-option {:type :some :value 10})  ; =&gt; 20\n(process-option {:type :none})            ; =&gt; 0\n</code></pre> Solution <pre><code>(defn process-option [opt]\n  (match opt\n    {:type :some :value v} -&gt; (* v 2)\n    {:type :none} -&gt; 0))\n</code></pre>"},{"location":"tutorial/03-pattern-matching/#summary","title":"Summary","text":"<p>What you learned in this chapter:</p> <ul> <li>\u2705 <code>match</code> expression basics</li> <li>\u2705 List and map pattern matching</li> <li>\u2705 Guard conditions (<code>when</code>)</li> <li>\u2705 or patterns (<code>|</code>)</li> <li>\u2705 Practical pattern matching examples</li> </ul>"},{"location":"tutorial/03-pattern-matching/#next-steps","title":"Next Steps","text":"<p>Now that you can freely handle data structures with pattern matching, let's learn error handling next!</p> <p>\u27a1\ufe0f Chapter 4: Handling Errors Gracefully</p> <p>Error handling and Railway Pipeline are essential for building robust applications.</p>"},{"location":"tutorial/04-error-handling/","title":"Chapter 4: Handling Errors Gracefully","text":"<p>Time Required: 30 minutes</p> <p>Error handling is essential for building robust applications. Qi provides a powerful error handling pattern called Railway Pipeline.</p>"},{"location":"tutorial/04-error-handling/#error-handling-basics-try","title":"Error Handling Basics: <code>try</code>","text":"<p><code>try</code> safely executes code that might produce errors.</p>"},{"location":"tutorial/04-error-handling/#basic-usage","title":"Basic Usage","text":"<pre><code>qi&gt; (try (+ 1 2))\n; =&gt; 3  (On success, returns the raw value)\n\nqi&gt; (try (/ 1 0))\n; =&gt; {:error \"Division by zero\"}  (On error, returns {:error} format)\n</code></pre> <p>Important: In Qi's new specification, <code>try</code> returns the raw value on success (not <code>{:ok value}</code>). Only errors are in <code>{:error ...}</code> format.</p>"},{"location":"tutorial/04-error-handling/#checking-for-errors-with-error-predicate","title":"Checking for Errors with <code>error?</code> Predicate","text":"<p>Use <code>error?</code> to determine if a value is an error.</p> <pre><code>qi&gt; (error? {:error \"Something went wrong\"})\n; =&gt; true\n\nqi&gt; (error? 42)\n; =&gt; false\n\nqi&gt; (error? {:ok 10})\n; =&gt; false\n</code></pre>"},{"location":"tutorial/04-error-handling/#practical-example","title":"Practical Example","text":"<pre><code>(defn safe-divide [a b]\n  (try (/ a b)))\n\n(defn process [a b]\n  (let [result (safe-divide a b)]\n    (if (error? result)\n      (println \"Error occurred!\")\n      (println f\"Result: {result}\"))))\n\nqi&gt; (process 10 2)\n; =&gt; \"Result: 5\"\n\nqi&gt; (process 10 0)\n; =&gt; \"Error occurred!\"\n</code></pre>"},{"location":"tutorial/04-error-handling/#railway-pipeline","title":"Railway Pipeline: <code>|&gt;?</code>","text":"<p>Railway Pipeline is a powerful pattern that automatically propagates errors.</p>"},{"location":"tutorial/04-error-handling/#basic-concept","title":"Basic Concept","text":"<p>With normal pipelines (<code>|&gt;</code>), each step always executes. However, with Railway Pipeline (<code>|&gt;?</code>), when an error occurs, all subsequent processing is skipped.</p> <pre><code>      Success     Success     Success\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\n |          |          |          |\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; X Error!  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\n      Success     \u2193        Skipped\n                Error returned\n</code></pre>"},{"location":"tutorial/04-error-handling/#example-simple-railway-pipeline","title":"Example: Simple Railway Pipeline","text":"<pre><code>(defn validate-positive [x]\n  (if (&gt; x 0)\n    x                          ; Success: return value as-is\n    {:error \"Must be positive\"}))  ; Error\n\n(defn double [x]\n  (* x 2))\n\n(defn add-ten [x]\n  (+ x 10))\n\n; Success case\nqi&gt; (10\n     |&gt;? validate-positive\n     |&gt;? double\n     |&gt;? add-ten)\n; =&gt; 30  (10 -&gt; 10 -&gt; 20 -&gt; 30)\n\n; Error case\nqi&gt; (-5\n     |&gt;? validate-positive  ; Error here\n     |&gt;? double             ; Skipped\n     |&gt;? add-ten)           ; Skipped\n; =&gt; {:error \"Must be positive\"}\n</code></pre> <p>Key point: Everything except <code>{:error}</code> is treated as success!</p>"},{"location":"tutorial/04-error-handling/#strengths-of-railway-pipeline","title":"Strengths of Railway Pipeline","text":""},{"location":"tutorial/04-error-handling/#1-errors-propagate-automatically","title":"1. Errors Propagate Automatically","text":"<pre><code>(defn validate-age [age]\n  (if (and (&gt;= age 0) (&lt;= age 150))\n    age\n    {:error \"Invalid age\"}))\n\n(defn validate-name [name]\n  (if (&gt; (len name) 0)\n    name\n    {:error \"Name cannot be empty\"}))\n\n(defn create-user [name age]\n  ({:name name :age age}\n   |&gt;? (fn [u] (if (&gt; (len (get u :name)) 0)\n                  u\n                  {:error \"Name cannot be empty\"}))\n   |&gt;? (fn [u] (if (and (&gt;= (get u :age) 0) (&lt;= (get u :age) 150))\n                  u\n                  {:error \"Invalid age\"}))))\n\nqi&gt; (create-user \"Alice\" 25)\n; =&gt; {:name \"Alice\" :age 25}\n\nqi&gt; (create-user \"\" 25)\n; =&gt; {:error \"Name cannot be empty\"}\n\nqi&gt; (create-user \"Bob\" 200)\n; =&gt; {:error \"Invalid age\"}\n</code></pre>"},{"location":"tutorial/04-error-handling/#2-readable","title":"2. Readable","text":"<p>Error handling is naturally integrated into data flow:</p> <pre><code>; \u274c Traditional error handling (hard to read)\n(defn process-data [data]\n  (let [result1 (step1 data)]\n    (if (error? result1)\n      result1\n      (let [result2 (step2 result1)]\n        (if (error? result2)\n          result2\n          (step3 result2))))))\n\n; \u2705 Railway Pipeline (easy to read)\n(defn process-data [data]\n  (data\n   |&gt;? step1\n   |&gt;? step2\n   |&gt;? step3))\n</code></pre>"},{"location":"tutorial/04-error-handling/#practical-example-1-file-processing","title":"Practical Example 1: File Processing","text":"<pre><code>(defn read-file [path]\n  (try (io/read-file path)))\n\n(defn parse-json [text]\n  (try (json/parse text)))\n\n(defn validate-data [data]\n  (if (map? data)\n    data\n    {:error \"Data must be a map\"}))\n\n(defn extract-field [data field]\n  (if (contains? data field)\n    (get data field)\n    {:error f\"Missing field: {field}\"}))\n\n; Connect with Railway Pipeline\n(defn load-config [path]\n  (path\n   |&gt;? read-file\n   |&gt;? parse-json\n   |&gt;? validate-data\n   |&gt;? (fn [d] (extract-field d :database))))\n\n; Usage example\nqi&gt; (load-config \"config.json\")\n; =&gt; \"postgresql://localhost/mydb\"  (On success)\n; =&gt; {:error \"File not found\"}  (No file)\n; =&gt; {:error \"JSON parse failed\"}  (Invalid JSON)\n; =&gt; {:error \"Missing field: database\"}  (Missing field)\n</code></pre>"},{"location":"tutorial/04-error-handling/#practical-example-2-api-call","title":"Practical Example 2: API Call","text":"<pre><code>(defn fetch-user [id]\n  ; Mock HTTP request\n  (if (&gt; id 0)\n    {:status 200 :body f\"{{\"id\":{id},\"name\":\"User{id}\"}}\"}\n    {:status 404}))\n\n(defn check-response [resp]\n  (match resp\n    {:status 200 :body body} -&gt; body\n    {:status 404} -&gt; {:error \"User not found\"}\n    _ -&gt; {:error \"Unknown error\"}))\n\n(defn parse-user [json-str]\n  (try (json/parse json-str)))\n\n(defn extract-name [user]\n  (if (contains? user :name)\n    (get user :name)\n    {:error \"Missing name\"}))\n\n; Connect with Railway Pipeline\n(defn get-user-name [id]\n  (id\n   |&gt; fetch-user\n   |&gt;? check-response\n   |&gt;? parse-user\n   |&gt;? extract-name))\n\nqi&gt; (get-user-name 1)\n; =&gt; \"User1\"\n\nqi&gt; (get-user-name -1)\n; =&gt; {:error \"User not found\"}\n</code></pre>"},{"location":"tutorial/04-error-handling/#combining-try-and-railway-pipeline","title":"Combining <code>try</code> and Railway Pipeline","text":"<p>Combining <code>try</code> and Railway Pipeline enables powerful error handling.</p> <pre><code>(defn safe-parse-int [s]\n  (try (string/to-int s)))\n\n(defn validate-range [n]\n  (if (and (&gt;= n 0) (&lt;= n 100))\n    n\n    {:error \"Number must be between 0 and 100\"}))\n\n(defn double [n]\n  (* n 2))\n\n; Pipeline\n(defn process-input [input]\n  (input\n   |&gt;? safe-parse-int\n   |&gt;? validate-range\n   |&gt;? double))\n\nqi&gt; (process-input \"25\")\n; =&gt; 50\n\nqi&gt; (process-input \"abc\")\n; =&gt; {:error \"Parse error\"}\n\nqi&gt; (process-input \"150\")\n; =&gt; {:error \"Number must be between 0 and 100\"}\n</code></pre>"},{"location":"tutorial/04-error-handling/#error-handling-best-practices","title":"Error Handling Best Practices","text":""},{"location":"tutorial/04-error-handling/#1-standardize-error-format","title":"1. Standardize <code>{:error}</code> Format","text":"<pre><code>; \u2705 Good example\n{:error \"User not found\"}\n{:error \"Invalid input\"}\n{:error \"Database connection failed\"}\n\n; \u274c Bad example (not standardized)\n\"error\"\n{:err \"...\"}\n{:failed true}\n</code></pre>"},{"location":"tutorial/04-error-handling/#2-make-error-messages-specific","title":"2. Make Error Messages Specific","text":"<pre><code>; \u2705 Good example\n{:error f\"User with ID {id} not found\"}\n{:error f\"Age must be between 0 and 150, got {age}\"}\n\n; \u274c Bad example\n{:error \"Error\"}\n{:error \"Invalid\"}\n</code></pre>"},{"location":"tutorial/04-error-handling/#3-return-errors-early","title":"3. Return Errors Early","text":"<pre><code>; \u2705 Good example: Early return\n(defn process [x]\n  (if (&lt; x 0)\n    {:error \"Negative not allowed\"}\n    (do-something x)))\n\n; \u274c Bad example: Deep nesting\n(defn process [x]\n  (if (&gt;= x 0)\n    (do-something x)\n    {:error \"Negative not allowed\"}))\n</code></pre>"},{"location":"tutorial/04-error-handling/#practice-problems","title":"Practice Problems","text":""},{"location":"tutorial/04-error-handling/#problem-1-safe-division-function","title":"Problem 1: Safe Division Function","text":"<p>Write a function that prevents division by zero.</p> <pre><code>(defn safe-divide [a b]\n  ; Fill this in\n  )\n\n; Tests\n(safe-divide 10 2)  ; =&gt; 5\n(safe-divide 10 0)  ; =&gt; {:error \"Division by zero\"}\n</code></pre> Solution <pre><code>(defn safe-divide [a b]\n  (if (= b 0)\n    {:error \"Division by zero\"}\n    (/ a b)))\n</code></pre>"},{"location":"tutorial/04-error-handling/#problem-2-numeric-validation-pipeline","title":"Problem 2: Numeric Validation Pipeline","text":"<p>Write a function that takes a string, converts it to a number, and checks if it's in the 0-100 range.</p> <pre><code>(defn validate-score [input]\n  ; Fill this in\n  ; Hint: Use safe-parse-int and validate-range\n  )\n\n; Tests\n(validate-score \"75\")   ; =&gt; 75\n(validate-score \"abc\")  ; =&gt; {:error \"Parse error\"}\n(validate-score \"150\")  ; =&gt; {:error \"Range error\"}\n</code></pre> Solution <pre><code>(defn safe-parse-int [s]\n  (try (string/to-int s)))\n\n(defn validate-range [n]\n  (if (and (&gt;= n 0) (&lt;= n 100))\n    n\n    {:error \"Range error\"}))\n\n(defn validate-score [input]\n  (input\n   |&gt;? safe-parse-int\n   |&gt;? validate-range))\n</code></pre>"},{"location":"tutorial/04-error-handling/#problem-3-multiple-validations","title":"Problem 3: Multiple Validations","text":"<p>Write a function that takes user data and validates name and age.</p> <pre><code>(defn validate-user [user]\n  ; Fill this in\n  ; Name: At least 1 character\n  ; Age: 0-150 range\n  )\n\n; Tests\n(validate-user {:name \"Alice\" :age 25})\n; =&gt; {:name \"Alice\" :age 25}\n\n(validate-user {:name \"\" :age 25})\n; =&gt; {:error \"Name cannot be empty\"}\n\n(validate-user {:name \"Bob\" :age 200})\n; =&gt; {:error \"Invalid age\"}\n</code></pre> Solution <pre><code>(defn validate-user [user]\n  (user\n   |&gt;? (fn [u] (if (&gt; (len (get u :name)) 0)\n                  u\n                  {:error \"Name cannot be empty\"}))\n   |&gt;? (fn [u] (if (and (&gt;= (get u :age) 0) (&lt;= (get u :age) 150))\n                  u\n                  {:error \"Invalid age\"}))))\n</code></pre>"},{"location":"tutorial/04-error-handling/#summary","title":"Summary","text":"<p>What you learned in this chapter:</p> <ul> <li>\u2705 Safely catching errors with <code>try</code></li> <li>\u2705 Checking for errors with the <code>error?</code> predicate</li> <li>\u2705 Automatic error propagation with Railway Pipeline (<code>|&gt;?</code>)</li> <li>\u2705 Error handling best practices</li> <li>\u2705 Practical error handling patterns</li> </ul>"},{"location":"tutorial/04-error-handling/#next-steps","title":"Next Steps","text":"<p>Now that you've mastered error handling, let's learn concurrency and parallelism next!</p> <p>\u27a1\ufe0f Chapter 5: Easy Concurrency and Parallelism</p> <p>Concurrency and parallelism are among Qi's most powerful features.</p>"},{"location":"tutorial/05-concurrency/","title":"Chapter 5: Easy Concurrency and Parallelism","text":"<p>Time Required: 35 minutes</p> <p>Concurrency and parallelism are among Qi's most powerful features. You can achieve easy, safe, and fast parallel processing.</p>"},{"location":"tutorial/05-concurrency/#why-concurrency-and-parallelism","title":"Why Concurrency and Parallelism?","text":""},{"location":"tutorial/05-concurrency/#sequential-processing-slow","title":"Sequential Processing (Slow)","text":"<pre><code>(def urls [\"https://api1.com\" \"https://api2.com\" \"https://api3.com\"])\n\n; Process sequentially (takes 3 seconds total)\n(map http/get urls)\n</code></pre>"},{"location":"tutorial/05-concurrency/#parallel-processing-fast","title":"Parallel Processing (Fast)","text":"<pre><code>; Process in parallel (completes in about 1 second!)\n(urls ||&gt; http/get)\n</code></pre>"},{"location":"tutorial/05-concurrency/#parallel-pipeline","title":"Parallel Pipeline: <code>||&gt;</code>","text":"<p><code>||&gt;</code> processes each element of a collection in parallel.</p>"},{"location":"tutorial/05-concurrency/#basic-usage","title":"Basic Usage","text":"<pre><code>qi&gt; ([1 2 3 4 5]\n     ||&gt; (fn [x] (* x x)))\n; =&gt; [1 4 9 16 25]\n</code></pre> <p>Internally, <code>pmap</code> (parallel map) is automatically used.</p>"},{"location":"tutorial/05-concurrency/#practical-example-1-fetching-multiple-urls","title":"Practical Example 1: Fetching Multiple URLs","text":"<pre><code>(def urls\n  [\"https://api.example.com/users/1\"\n   \"https://api.example.com/users/2\"\n   \"https://api.example.com/users/3\"])\n\n; Fetch in parallel\n(urls\n ||&gt; http/get\n ||&gt; (fn [resp] (get resp :body))\n ||&gt; json/parse)\n</code></pre>"},{"location":"tutorial/05-concurrency/#parallel-map-pmap","title":"Parallel map: <code>pmap</code>","text":"<p><code>pmap</code> is the parallel version of map.</p> <pre><code>qi&gt; (pmap (fn [x] (* x 2)) [1 2 3 4 5])\n; =&gt; [2 4 6 8 10]\n\nqi&gt; (defn heavy-process [x]\n      (do\n        (sleep 1000)  ; Wait 1 second\n        (* x x)))\n\n; Sequential processing (takes 5 seconds)\nqi&gt; (map heavy-process [1 2 3 4 5])\n; =&gt; [1 4 9 16 25]\n\n; Parallel processing (completes in about 1 second)\nqi&gt; (pmap heavy-process [1 2 3 4 5])\n; =&gt; [1 4 9 16 25]\n</code></pre>"},{"location":"tutorial/05-concurrency/#parallel-filter-gopfilter","title":"Parallel filter: <code>go/pfilter</code>","text":"<p><code>go/pfilter</code> is the parallel version of filter.</p> <pre><code>qi&gt; (go/pfilter even? [1 2 3 4 5 6 7 8 9 10])\n; =&gt; [2 4 6 8 10]\n\n(defn is-prime? [n]\n  ; Prime number test (heavy processing)\n  (if (&lt;= n 1)\n    false\n    (loop [i 2]\n      (if (&gt;= (* i i) n)\n        true\n        (if (= (% n i) 0)\n          false\n          (recur (inc i)))))))\n\n; Extract primes in parallel\nqi&gt; (go/pfilter is-prime? (range 1 100))\n; =&gt; [2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97]\n</code></pre>"},{"location":"tutorial/05-concurrency/#goroutine-style-concurrency","title":"Goroutine-Style Concurrency","text":"<p>Qi supports Go-language-style concurrency.</p>"},{"location":"tutorial/05-concurrency/#creating-channels","title":"Creating Channels","text":"<pre><code>qi&gt; (def ch (go/chan))\n</code></pre>"},{"location":"tutorial/05-concurrency/#sendreceive","title":"Send/Receive","text":"<pre><code>; Send\nqi&gt; (go/send! ch 42)\n\n; Receive\nqi&gt; (go/recv! ch)\n; =&gt; 42\n</code></pre>"},{"location":"tutorial/05-concurrency/#execute-in-goroutine","title":"Execute in Goroutine","text":"<pre><code>; Run in background\nqi&gt; (go/run (println \"Hello from goroutine!\"))\n; =&gt; \"Hello from goroutine!\"\n</code></pre>"},{"location":"tutorial/05-concurrency/#practical-example-1-parallel-downloads","title":"Practical Example 1: Parallel Downloads","text":"<pre><code>(defn download-file [url]\n  (println f\"Downloading: {url}\")\n  (let [resp (http/get url)]\n    (get resp :body)))\n\n(def urls\n  [\"https://example.com/file1.txt\"\n   \"https://example.com/file2.txt\"\n   \"https://example.com/file3.txt\"])\n\n; Parallel download\n(def results (urls ||&gt; download-file))\n\n; Or use pmap\n(def results (pmap download-file urls))\n</code></pre>"},{"location":"tutorial/05-concurrency/#practical-example-2-parallel-data-processing","title":"Practical Example 2: Parallel Data Processing","text":"<pre><code>(defn process-chunk [chunk]\n  ; Heavy processing\n  (chunk\n   |&gt; (filter even?)\n   |&gt; (map (fn [x] (* x x)))\n   |&gt; (reduce + 0)))\n\n; Split large data\n(def data (range 1 1000))\n(def chunks\n  [(take 250 data)\n   (take 250 (drop 250 data))\n   (take 250 (drop 500 data))\n   (take 250 (drop 750 data))])\n\n; Process each chunk in parallel\n(def results (chunks ||&gt; process-chunk))\n\n; Aggregate results\n(reduce + 0 results)\n</code></pre>"},{"location":"tutorial/05-concurrency/#practical-example-3-goroutines-and-channels","title":"Practical Example 3: Goroutines and Channels","text":"<pre><code>(def ch (go/chan))\n\n; Producer\n(go/run\n  (do\n    (go/send! ch 1)\n    (go/send! ch 2)\n    (go/send! ch 3)\n    (go/close! ch)))\n\n; Consumer\n(loop [acc []]\n  (let [val (go/try-recv! ch)]\n    (if (nil? val)\n      acc\n      (recur (conj acc val)))))\n; =&gt; [1 2 3]\n</code></pre>"},{"location":"tutorial/05-concurrency/#practical-example-4-worker-pool","title":"Practical Example 4: Worker Pool","text":"<pre><code>(defn worker [id ch]\n  (loop []\n    (let [task (go/try-recv! ch)]\n      (if (nil? task)\n        (println f\"Worker {id} done\")\n        (do\n          (println f\"Worker {id} processing: {task}\")\n          ; Process\n          (sleep 100)\n          (recur))))))\n\n(def ch (go/chan))\n\n; Start workers\n(go/run (worker 1 ch))\n(go/run (worker 2 ch))\n(go/run (worker 3 ch))\n\n; Submit tasks\n(go/send! ch \"Task 1\")\n(go/send! ch \"Task 2\")\n(go/send! ch \"Task 3\")\n(go/send! ch \"Task 4\")\n(go/send! ch \"Task 5\")\n\n; Close channel\n(go/close! ch)\n</code></pre>"},{"location":"tutorial/05-concurrency/#atom-thread-safe-state-management","title":"Atom: Thread-Safe State Management","text":"<p>With Atoms, you can safely update state from multiple goroutines.</p>"},{"location":"tutorial/05-concurrency/#basic-usage_1","title":"Basic Usage","text":"<pre><code>qi&gt; (def counter (atom 0))\n\n; Get value\nqi&gt; (deref counter)\n; =&gt; 0\n\nqi&gt; @counter  ; Short form\n; =&gt; 0\n\n; Update value\nqi&gt; (swap! counter inc)\n; =&gt; 1\n\nqi&gt; @counter\n; =&gt; 1\n</code></pre>"},{"location":"tutorial/05-concurrency/#practical-example-parallel-counter","title":"Practical Example: Parallel Counter","text":"<pre><code>(def counter (atom 0))\n\n; Safely increment from multiple goroutines\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n\n(sleep 100)  ; Wait for completion\n\nqi&gt; @counter\n; =&gt; 5\n</code></pre>"},{"location":"tutorial/05-concurrency/#parallel-processing-best-practices","title":"Parallel Processing Best Practices","text":""},{"location":"tutorial/05-concurrency/#1-when-to-parallelize","title":"1. When to Parallelize?","text":"<p>Should parallelize when: - CPU-intensive processing (computation, transformation) - I/O-heavy processing (HTTP, file reading) - Large number of elements (rule of thumb: 100+ elements)</p> <p>Should NOT parallelize when: - Lightweight processing (per-element processing under 1ms) - Small number of elements (rule of thumb: under 10 elements) - Order-dependent processing</p>"},{"location":"tutorial/05-concurrency/#2-performance-comparison","title":"2. Performance Comparison","text":"<pre><code>; Lightweight processing - map is faster\n(map inc [1 2 3 4 5])  ; Fast\n\n; Heavy processing - pmap is faster\n(pmap heavy-process [1 2 3 ... 100])  ; Fast\n</code></pre>"},{"location":"tutorial/05-concurrency/#3-debugging-tips","title":"3. Debugging Tips","text":"<p>Parallel processing is hard to debug, so verify with sequential processing first:</p> <pre><code>; \u2705 Verify with sequential processing first\n(data |&gt; (map process) |&gt; verify)\n\n; \u2705 Parallelize after verification\n(data ||&gt; process |&gt; verify)\n</code></pre>"},{"location":"tutorial/05-concurrency/#practice-problems","title":"Practice Problems","text":""},{"location":"tutorial/05-concurrency/#problem-1-parallel-square-calculation","title":"Problem 1: Parallel Square Calculation","text":"<p>Write a function that squares each element of a list and calculates the sum in parallel.</p> <pre><code>(defn parallel-sum-squares [numbers]\n  ; Fill this in\n  )\n\n; Test\n(parallel-sum-squares [1 2 3 4 5])  ; =&gt; 55\n</code></pre> Solution <pre><code>(defn parallel-sum-squares [numbers]\n  (numbers\n   ||&gt; (fn [x] (* x x))\n   |&gt; (reduce + 0)))\n\n; Or use pmap\n(defn parallel-sum-squares [numbers]\n  (pmap (fn [x] (* x x)) numbers)\n  |&gt; (reduce + 0))\n</code></pre>"},{"location":"tutorial/05-concurrency/#problem-2-parallel-filter-and-transform","title":"Problem 2: Parallel Filter and Transform","text":"<p>Write a function that extracts even numbers in parallel and doubles them.</p> <pre><code>(defn parallel-process [numbers]\n  ; Fill this in\n  )\n\n; Test\n(parallel-process [1 2 3 4 5 6])  ; =&gt; [4 8 12]\n</code></pre> Solution <pre><code>(defn parallel-process [numbers]\n  (numbers\n   |&gt; (go/pfilter even?)\n   ||&gt; (fn [x] (* x 2))))\n</code></pre>"},{"location":"tutorial/05-concurrency/#problem-3-access-count-with-atom","title":"Problem 3: Access Count with Atom","text":"<p>Write a function that safely updates an access count from multiple goroutines using Atoms.</p> <pre><code>(def access-count (atom 0))\n\n(defn record-access []\n  ; Fill this in\n  )\n\n; Test\n(go/run (record-access))\n(go/run (record-access))\n(go/run (record-access))\n\n(sleep 100)\n@access-count  ; =&gt; 3\n</code></pre> Solution <pre><code>(def access-count (atom 0))\n\n(defn record-access []\n  (swap! access-count inc))\n</code></pre>"},{"location":"tutorial/05-concurrency/#summary","title":"Summary","text":"<p>What you learned in this chapter:</p> <ul> <li>\u2705 Parallel pipeline (<code>||&gt;</code>)</li> <li>\u2705 Parallel map/filter/reduce (<code>pmap</code>, <code>go/pfilter</code>, <code>go/preduce</code>)</li> <li>\u2705 Goroutine-style concurrency (<code>go/run</code>, <code>go/chan</code>)</li> <li>\u2705 Atom (thread-safe state management)</li> <li>\u2705 Parallel processing best practices</li> </ul>"},{"location":"tutorial/05-concurrency/#next-steps","title":"Next Steps","text":"<p>Now that you've mastered concurrency and parallelism, let's learn about Web Applications and APIs as the final chapter!</p> <p>\u27a1\ufe0f Chapter 6: Web Applications and APIs</p> <p>Learn how to build HTTP servers and JSON APIs.</p>"},{"location":"tutorial/06-web-api/","title":"Chapter 6: Web Applications and APIs","text":"<p>Time Required: 40 minutes</p> <p>Learn how to build HTTP servers and JSON APIs with Qi. You can create production-ready web applications with simple, readable code.</p>"},{"location":"tutorial/06-web-api/#minimal-http-server","title":"Minimal HTTP Server","text":"<p>Let's start by creating the simplest HTTP server.</p> <pre><code>(defn handler [req]\n  (server/text \"Hello, World!\"))\n\n(server/serve handler {:port 3000})\n; =&gt; Server started: http://localhost:3000\n</code></pre> <p>Access <code>http://localhost:3000</code> in your browser to see <code>Hello, World!</code>.</p>"},{"location":"tutorial/06-web-api/#requests-and-responses","title":"Requests and Responses","text":""},{"location":"tutorial/06-web-api/#request-structure","title":"Request Structure","text":"<p>The handler receives a request map like this:</p> <pre><code>{:method :get\n :path \"/users/123\"\n :headers {\"content-type\" \"application/json\"}\n :body \"...\"}\n</code></pre>"},{"location":"tutorial/06-web-api/#response-types","title":"Response Types","text":"<p>Qi provides convenient response helpers.</p> <pre><code>; Text response\n(server/text \"Hello\")\n; =&gt; {:status 200 :headers {\"Content-Type\" \"text/plain\"} :body \"Hello\"}\n\n; JSON response\n(server/json {\"message\" \"Success\" \"data\" [1 2 3]})\n; =&gt; {:status 200 :headers {\"Content-Type\" \"application/json\"} :body \"...\"}\n\n; HTML response\n(server/html \"&lt;h1&gt;Welcome&lt;/h1&gt;\")\n; =&gt; {:status 200 :headers {\"Content-Type\" \"text/html\"} :body \"...\"}\n\n; Custom status\n(server/response 201 {\"message\" \"Created\"})\n; =&gt; {:status 201 ...}\n</code></pre>"},{"location":"tutorial/06-web-api/#routing","title":"Routing","text":"<p>Branch processing based on the path.</p> <pre><code>(defn handler [req]\n  (match (get req :path)\n    \"/\" -&gt; (server/text \"Home\")\n    \"/about\" -&gt; (server/text \"About\")\n    \"/api/status\" -&gt; (server/json {:status \"ok\"})\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#combining-method-and-path","title":"Combining Method and Path","text":"<pre><code>(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/\"] -&gt; (server/text \"Home\")\n    [\"GET\" \"/users\"] -&gt; (server/json {:users []})\n    [\"POST\" \"/users\"] -&gt; (server/json {:message \"User created\"})\n    [\"GET\" \"/users/123\"] -&gt; (server/json {:id 123 :name \"Alice\"})\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#json-api","title":"JSON API","text":""},{"location":"tutorial/06-web-api/#get-retrieve-data","title":"GET: Retrieve Data","text":"<pre><code>(def users\n  [{:id 1 :name \"Alice\" :age 25}\n   {:id 2 :name \"Bob\" :age 30}\n   {:id 3 :name \"Carol\" :age 28}])\n\n(defn get-users [req]\n  (server/json {:users users}))\n\n(defn get-user [req id]\n  (let [user (first (filter (fn [u] (= (get u :id) id)) users))]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (server/json user))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/users\"] -&gt; (get-users req)\n    [\"GET\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id-str (str/replace path \"/api/users/\" \"\")\n            id (string/to-int id-str)]\n        (get-user req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>Testing: <pre><code>curl http://localhost:3000/api/users\n# =&gt; {\"users\":[{\"id\":1,\"name\":\"Alice\",\"age\":25},...]}\n\ncurl http://localhost:3000/api/users/1\n# =&gt; {\"id\":1,\"name\":\"Alice\",\"age\":25}\n\ncurl http://localhost:3000/api/users/999\n# =&gt; {\"error\":\"User not found\"}\n</code></pre></p>"},{"location":"tutorial/06-web-api/#post-create-data","title":"POST: Create Data","text":"<pre><code>(def users (atom []))\n\n(defn create-user [req]\n  (let [body (get req :body)\n        user (json/parse body)]\n    (if (error? user)\n      (server/response 400 {:error \"Invalid JSON\"})\n      (do\n        (swap! users conj user)\n        (server/response 201 {:message \"User created\" :user user})))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/users\"] -&gt; (server/json {:users @users})\n    [\"POST\" \"/api/users\"] -&gt; (create-user req)\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>Testing: <pre><code>curl -X POST http://localhost:3000/api/users \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"Alice\",\"age\":25}'\n# =&gt; {\"message\":\"User created\",\"user\":{\"name\":\"Alice\",\"age\":25}}\n</code></pre></p>"},{"location":"tutorial/06-web-api/#error-handling","title":"Error Handling","text":"<p>Use Railway Pipeline to handle errors gracefully.</p> <pre><code>(defn parse-body [req]\n  (let [body (get req :body)]\n    (if (nil? body)\n      {:error \"No body\"}\n      (json/parse body))))\n\n(defn validate-user [user]\n  (if (error? user)\n    user\n    (match user\n      {:name n :age a} when (and (string? n) (number? a)) -&gt; user\n      _ -&gt; {:error \"Invalid user data\"})))\n\n(defn save-user [user]\n  (if (error? user)\n    user\n    (do\n      (swap! users conj user)\n      user)))\n\n(defn create-user [req]\n  (let [result (req\n                |&gt; parse-body\n                |&gt;? validate-user\n                |&gt;? save-user)]\n    (if (error? result)\n      (server/response 400 result)\n      (server/response 201 {:message \"User created\" :user result}))))\n</code></pre>"},{"location":"tutorial/06-web-api/#practical-example-crud-api","title":"Practical Example: CRUD API","text":"<p>Create a complete CRUD (Create, Read, Update, Delete) API.</p> <pre><code>(def users (atom {}))\n(def next-id (atom 1))\n\n; Create\n(defn create-user [req]\n  (req\n   |&gt; (get :body)\n   |&gt; json/parse\n   |&gt;? (fn [user]\n         (let [id @next-id\n               new-user (assoc user :id id)]\n           (do\n             (swap! next-id inc)\n             (swap! users assoc id new-user)\n             new-user)))\n   |&gt; (fn [result]\n        (if (error? result)\n          (server/response 400 result)\n          (server/response 201 result)))))\n\n; Read (all)\n(defn list-users [req]\n  (server/json {:users (vals @users)}))\n\n; Read (one)\n(defn get-user [req id]\n  (let [user (get @users id)]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (server/json user))))\n\n; Update\n(defn update-user [req id]\n  (let [user (get @users id)]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (req\n       |&gt; (get :body)\n       |&gt; json/parse\n       |&gt;? (fn [updates]\n             (let [updated (merge user updates)]\n               (do\n                 (swap! users assoc id updated)\n                 updated)))\n       |&gt; (fn [result]\n            (if (error? result)\n              (server/response 400 result)\n              (server/json result)))))))\n\n; Delete\n(defn delete-user [req id]\n  (let [user (get @users id)]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (do\n        (swap! users dissoc id)\n        (server/response 204 nil)))))\n\n; Routing\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/users\"] -&gt; (list-users req)\n    [\"POST\" \"/api/users\"] -&gt; (create-user req)\n    [\"GET\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/users/\" \"\"))]\n        (get-user req id))\n    [\"PUT\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/users/\" \"\"))]\n        (update-user req id))\n    [\"DELETE\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/users/\" \"\"))]\n        (delete-user req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>Testing: <pre><code># Create\ncurl -X POST http://localhost:3000/api/users \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"Alice\",\"age\":25}'\n\n# Read all\ncurl http://localhost:3000/api/users\n\n# Read one\ncurl http://localhost:3000/api/users/1\n\n# Update\ncurl -X PUT http://localhost:3000/api/users/1 \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"age\":26}'\n\n# Delete\ncurl -X DELETE http://localhost:3000/api/users/1\n</code></pre></p>"},{"location":"tutorial/06-web-api/#middleware","title":"Middleware","text":"<p>Functions that perform pre-processing and post-processing of requests.</p>"},{"location":"tutorial/06-web-api/#logger-middleware","title":"Logger Middleware","text":"<pre><code>(defn logger [handler]\n  (fn [req]\n    (do\n      (println f\"{(get req :method)} {(get req :path)}\")\n      (let [resp (handler req)]\n        (do\n          (println f\"  -&gt; {(get resp :status)}\")\n          resp)))))\n\n(defn my-handler [req]\n  (server/text \"Hello\"))\n\n(def app (logger my-handler))\n\n(server/serve app {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#cors-middleware","title":"CORS Middleware","text":"<pre><code>(defn cors [handler]\n  (fn [req]\n    (let [resp (handler req)]\n      (assoc resp :headers\n        (merge (get resp :headers)\n               {:access-control-allow-origin \"*\"\n                :access-control-allow-methods \"GET, POST, PUT, DELETE\"})))))\n\n(def app (cors my-handler))\n\n(server/serve app {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#middleware-composition","title":"Middleware Composition","text":"<pre><code>(def app\n  (-&gt; my-handler\n      logger\n      cors))\n\n(server/serve app {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#authentication-middleware-jwt","title":"Authentication Middleware (JWT)","text":"<p>Example implementation of JWT (JSON Web Token) authentication middleware.</p> <pre><code>;; Extract token from Authorization header\n(defn extract-auth-token [request]\n  (let [auth-header (get-in request [:headers :authorization])]\n    (if (nil? auth-header)\n      nil\n      (if (string/starts-with? auth-header \"Bearer \")\n        (string/replace-first auth-header \"Bearer \" \"\")\n        nil))))\n\n;; Middleware for protected endpoints\n(defn require-auth [handler]\n  (fn [request]\n    (let [token (extract-auth-token request)]\n      (if (nil? token)\n        {:status 401\n         :headers {:content-type \"application/json\"}\n         :body (json/stringify {:error \"Missing authorization token\"})}\n        (match (jwt/verify token \"my-secret-key\")\n          {:error _} -&gt; {:status 401\n                        :headers {:content-type \"application/json\"}\n                        :body (json/stringify {:error \"Invalid token\"})}\n          payload -&gt; (handler (assoc request :user payload)))))))\n\n;; Protected endpoint\n(defn handle-profile [request]\n  (let [user (get request :user)]\n    (server/json {:user user :message \"This is a protected resource\"})))\n\n;; Routing\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"POST\" \"/api/login\"] -&gt; (handle-login req)\n    [\"GET\" \"/api/profile\"] -&gt; ((require-auth handle-profile) req)\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>Authentication flow example: <pre><code># 1. Login and get token\ncurl -X POST http://localhost:3000/api/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"username\":\"alice\",\"password\":\"secret123\"}'\n# =&gt; {\"token\":\"eyJ0eXAi...\"}\n\n# 2. Access protected resource with token\ncurl http://localhost:3000/api/profile \\\n  -H \"Authorization: Bearer eyJ0eXAi...\"\n# =&gt; {\"user\":{\"user_id\":1,\"username\":\"alice\"},\"message\":\"This is a protected resource\"}\n\n# 3. Access without token (401 error)\ncurl http://localhost:3000/api/profile\n# =&gt; {\"error\":\"Missing authorization token\"}\n</code></pre></p> <p>Detailed implementation examples: See <code>examples/17-jwt-auth.qi</code> and <code>examples/19-auth-api.qi</code>.</p>"},{"location":"tutorial/06-web-api/#practical-example-simple-blog-api","title":"Practical Example: Simple Blog API","text":"<pre><code>(def posts (atom {}))\n(def next-id (atom 1))\n\n(defn create-post [req]\n  (req\n   |&gt; (get :body)\n   |&gt; json/parse\n   |&gt;? (fn [post]\n         (let [id @next-id\n               new-post (assoc post :id id :created-at (now))]\n           (do\n             (swap! next-id inc)\n             (swap! posts assoc id new-post)\n             new-post)))\n   |&gt; (fn [result]\n        (if (error? result)\n          (server/response 400 result)\n          (server/response 201 result)))))\n\n(defn list-posts [req]\n  (server/json {:posts (vals @posts)}))\n\n(defn get-post [req id]\n  (let [post (get @posts id)]\n    (if (nil? post)\n      (server/response 404 {:error \"Post not found\"})\n      (server/json post))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/posts\"] -&gt; (list-posts req)\n    [\"POST\" \"/api/posts\"] -&gt; (create-post req)\n    [\"GET\" path] when (str/starts-with? path \"/api/posts/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/posts/\" \"\"))]\n        (get-post req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve (logger (cors handler)) {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#practice-problems","title":"Practice Problems","text":""},{"location":"tutorial/06-web-api/#problem-1-simple-counter-api","title":"Problem 1: Simple Counter API","text":"<p>Create an access counter API.</p> <pre><code>; GET /api/count - Return current count\n; POST /api/count/increment - Increment count by 1\n; POST /api/count/reset - Reset count to 0\n</code></pre> Solution <pre><code>(def count (atom 0))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/count\"] -&gt; (server/json {:count @count})\n    [\"POST\" \"/api/count/increment\"] -&gt;\n      (do\n        (swap! count inc)\n        (server/json {:count @count}))\n    [\"POST\" \"/api/count/reset\"] -&gt;\n      (do\n        (reset! count 0)\n        (server/json {:count @count}))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#problem-2-todo-api","title":"Problem 2: ToDo API","text":"<p>Create a simple ToDo API.</p> <pre><code>; GET /api/todos - Get all ToDos\n; POST /api/todos - Create new ToDo\n; PUT /api/todos/:id/complete - Mark ToDo as complete\n</code></pre> Solution <pre><code>(def todos (atom {}))\n(def next-id (atom 1))\n\n(defn create-todo [req]\n  (let [body (json/parse (get req :body))\n        id @next-id\n        todo {:id id :title (get body :title) :completed false}]\n    (do\n      (swap! next-id inc)\n      (swap! todos assoc id todo)\n      (server/response 201 todo))))\n\n(defn complete-todo [req id]\n  (let [todo (get @todos id)]\n    (if (nil? todo)\n      (server/response 404 {:error \"Todo not found\"})\n      (let [updated (assoc todo :completed true)]\n        (do\n          (swap! todos assoc id updated)\n          (server/json updated))))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/todos\"] -&gt; (server/json {:todos (vals @todos)})\n    [\"POST\" \"/api/todos\"] -&gt; (create-todo req)\n    [\"PUT\" path] when (str/starts-with? path \"/api/todos/\") -&gt;\n      (let [parts (str/split path \"/\")\n            id (string/to-int (nth parts 3))]\n        (complete-todo req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"tutorial/06-web-api/#summary","title":"Summary","text":"<p>What you learned in this chapter:</p> <ul> <li>\u2705 HTTP server basics</li> <li>\u2705 Routing and request handling</li> <li>\u2705 JSON API construction</li> <li>\u2705 CRUD endpoint implementation</li> <li>\u2705 Middleware patterns</li> <li>\u2705 JWT authentication middleware</li> <li>\u2705 Error handling</li> </ul>"},{"location":"tutorial/06-web-api/#tutorial-complete","title":"\ud83c\udf89 Tutorial Complete!","text":"<p>Congratulations! You've now learned all the main features of Qi.</p>"},{"location":"tutorial/06-web-api/#what-youve-learned","title":"What You've Learned","text":"<ol> <li>\u2705 Basic syntax and data types</li> <li>\u2705 Pipeline operators</li> <li>\u2705 Pattern matching</li> <li>\u2705 Error handling (Railway Pipeline)</li> <li>\u2705 Concurrency and parallelism</li> <li>\u2705 Web applications and APIs</li> </ol>"},{"location":"tutorial/06-web-api/#next-steps","title":"Next Steps","text":"<ol> <li>Start Your Own Project</li> <li>Small CLI tool</li> <li>Web API</li> <li> <p>Data processing script</p> </li> <li> <p>Explore the examples/ Directory</p> </li> <li>Practical code examples</li> <li> <p>Best practices</p> </li> <li> <p>Deep Dive into Documentation</p> </li> <li>Complete Language Specification</li> <li> <p>Function Index</p> </li> <li> <p>Join the Community</p> </li> <li>GitHub Issues</li> <li>Discussions</li> </ol> <p>Happy coding with Qi! \ud83d\ude80</p>"},{"location":"tutorial/openapi-tutorial/","title":"OpenAPI Library Tutorial","text":"<p>This tutorial teaches you how to build REST APIs with automatic OpenAPI specification generation using Qi's <code>std/lib/openapi.qi</code> library.</p>"},{"location":"tutorial/openapi-tutorial/#prerequisites","title":"Prerequisites","text":"<ul> <li>Qi installed</li> <li>Basic knowledge of HTTP servers</li> <li>Basic knowledge of REST APIs</li> </ul>"},{"location":"tutorial/openapi-tutorial/#step-1-create-a-simple-api-server","title":"Step 1: Create a Simple API Server","text":"<p>First, create a normal API server without using the OpenAPI library.</p> <pre><code>;; simple-api.qi\n\n;; Get users list\n(defn api-get-users [req]\n  (server/json {:users [{:id 1 :name \"Alice\"} {:id 2 :name \"Bob\"}]}))\n\n;; Create user\n(defn api-create-user [req]\n  (let [body (json/parse (get req :body))]\n    (server/json {:success true :user body} 201)))\n\n;; Router\n(defn router [req]\n  (match [(get req :method) (get req :path)]\n    [:get \"/api/users\"] -&gt; (api-get-users req)\n    [:post \"/api/users\"] -&gt; (api-create-user req)\n    _ -&gt; (server/json {:error \"Not Found\"} 404)))\n\n;; Start server\n(server/serve router {:port 3000})\n(println \"Server started on http://localhost:3000\")\n</code></pre> <p>This works, but there's no API specification documentation.</p>"},{"location":"tutorial/openapi-tutorial/#step-2-introduce-the-openapi-library","title":"Step 2: Introduce the OpenAPI Library","text":"<p>Use the OpenAPI library to add documentation to the same API.</p> <pre><code>;; openapi-demo.qi\n\n;; Import OpenAPI library (simple import)\n(use \"openapi\" :as openapi)\n\n;; ========================================\n;; API Endpoint Definitions (OpenAPI-enabled)\n;; ========================================\n\n;; Get users list\n(openapi/defapi :get \"/api/users\"\n  {:summary \"Get users list\"\n   :tags [\"users\"]\n   :responses {\n     200 {:description \"Success\"\n          :content {\"application/json\" {\n            :schema {\n              :type \"object\"\n              :properties {\n                \"users\" {\n                  :type \"array\"\n                  :items {\n                    :type \"object\"\n                    :properties {\n                      \"id\" {:type \"integer\"}\n                      \"name\" {:type \"string\"}}}}}}}}}}}\n  api-get-users\n\n  (server/json {:users [{:id 1 :name \"Alice\"} {:id 2 :name \"Bob\"}]}))\n\n;; Create user\n(openapi/defapi :post \"/api/users\"\n  {:summary \"Create a new user\"\n   :tags [\"users\"]\n   :requestBody {\n     :required true\n     :content {\"application/json\" {\n       :schema {\n         :type \"object\"\n         :properties {\n           \"name\" {:type \"string\"}\n           \"email\" {:type \"string\" :format \"email\"}}\n         :required [\"name\" \"email\"]}}}}\n   :responses {\n     201 {:description \"Created successfully\"}\n     400 {:description \"Invalid request\"}}}\n  api-create-user\n\n  (let [body (json/parse (get req :body))]\n    (server/json {:success true :user body} 201)))\n\n;; ========================================\n;; Router Configuration\n;; ========================================\n\n;; API router\n(defn api-router [req]\n  (match [(get req :method) (get req :path)]\n    [:get \"/api/users\"] -&gt; (api-get-users req)\n    [:post \"/api/users\"] -&gt; (api-create-user req)\n    _ -&gt; (server/json {:error \"Not Found\"} 404)))\n\n;; Integrate Swagger endpoint\n(def router\n  (openapi/with-swagger\n    api-router\n    {:title \"User Management API\"\n     :version \"1.0.0\"\n     :description \"REST API for user management\"}))\n\n;; Start server\n(server/serve router {:port 3000})\n(println \"Server started on http://localhost:3000\")\n(println \"Swagger JSON: http://localhost:3000/api/swagger.json\")\n</code></pre>"},{"location":"tutorial/openapi-tutorial/#step-3-verify-functionality","title":"Step 3: Verify Functionality","text":"<p>Start the server:</p> <pre><code>QI_LANG=ja qi openapi-demo.qi\n</code></pre> <p>Get Swagger JSON:</p> <pre><code>curl http://localhost:3000/api/swagger.json | jq .\n</code></pre> <p>Example output:</p> <pre><code>{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"User Management API\",\n    \"version\": \"1.0.0\",\n    \"description\": \"REST API for user management\"\n  },\n  \"paths\": {\n    \"/api/users\": {\n      \"get\": {\n        \"summary\": \"Get users list\",\n        \"tags\": [\"users\"],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Success\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {...}\n              }\n            }\n          }\n        }\n      },\n      \"post\": {\n        \"summary\": \"Create a new user\",\n        \"tags\": [\"users\"],\n        \"requestBody\": {...},\n        \"responses\": {...}\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"tutorial/openapi-tutorial/#step-4-add-path-parameters","title":"Step 4: Add Path Parameters","text":"<p>Add an endpoint to get individual user information.</p> <pre><code>;; Get user information\n(openapi/defapi :get \"/api/users/{id}\"\n  {:summary \"Get specific user information\"\n   :tags [\"users\"]\n   :parameters [{\n     :name \"id\"\n     :in \"path\"\n     :required true\n     :description \"User ID\"\n     :schema {:type \"integer\"}}]\n   :responses {\n     200 {:description \"Success\"\n          :content {\"application/json\" {\n            :schema {\n              :type \"object\"\n              :properties {\n                \"user\" {\n                  :type \"object\"\n                  :properties {\n                    \"id\" {:type \"integer\"}\n                    \"name\" {:type \"string\"}\n                    \"email\" {:type \"string\"}}}}}}}}\n     404 {:description \"User not found\"}}}\n  api-get-user\n\n  (let [id-str (last (str/split (get req :path) \"/\"))\n        id (to-int id-str)]\n    (if (= id 1)\n      (server/json {:user {:id 1 :name \"Alice\" :email \"alice@example.com\"}})\n      (server/json {:error \"User not found\"} 404))))\n\n;; Update router\n(defn api-router [req]\n  (let [path (get req :path)]\n    (match [(get req :method) path]\n      [:get \"/api/users\"] -&gt; (api-get-users req)\n      [:post \"/api/users\"] -&gt; (api-create-user req)\n      [:get (re-matches #\"/api/users/\\d+\" _)] -&gt; (api-get-user req)\n      _ -&gt; (server/json {:error \"Not Found\"} 404))))\n</code></pre> <p>Test:</p> <pre><code>curl http://localhost:3000/api/users/1 | jq .\n</code></pre>"},{"location":"tutorial/openapi-tutorial/#step-5-add-query-parameters","title":"Step 5: Add Query Parameters","text":"<p>Add pagination to the user list endpoint.</p> <pre><code>(openapi/defapi :get \"/api/users\"\n  {:summary \"Get users list (with pagination)\"\n   :tags [\"users\"]\n   :parameters [\n     {:name \"limit\"\n      :in \"query\"\n      :required false\n      :description \"Number of items to retrieve\"\n      :schema {:type \"integer\" :default 10 :minimum 1 :maximum 100}}\n     {:name \"offset\"\n      :in \"query\"\n      :required false\n      :description \"Offset\"\n      :schema {:type \"integer\" :default 0 :minimum 0}}]\n   :responses {\n     200 {:description \"Success\"}}}\n  api-get-users\n\n  (let [query-params (parse-query-string (get req :query))\n        limit (or (to-int (get query-params \"limit\")) 10)\n        offset (or (to-int (get query-params \"offset\")) 0)]\n    (server/json\n      {:users [{:id 1 :name \"Alice\"} {:id 2 :name \"Bob\"}]\n       :limit limit\n       :offset offset})))\n</code></pre> <p>Test:</p> <pre><code>curl \"http://localhost:3000/api/users?limit=5&amp;offset=10\" | jq .\n</code></pre>"},{"location":"tutorial/openapi-tutorial/#step-6-add-authentication-headers","title":"Step 6: Add Authentication Headers","text":"<p>Add an endpoint that requires authentication.</p> <pre><code>(openapi/defapi :delete \"/api/users/{id}\"\n  {:summary \"Delete user\"\n   :tags [\"users\"]\n   :parameters [\n     {:name \"id\"\n      :in \"path\"\n      :required true\n      :schema {:type \"integer\"}}\n     {:name \"Authorization\"\n      :in \"header\"\n      :required true\n      :description \"Bearer token\"\n      :schema {:type \"string\"}}]\n   :responses {\n     204 {:description \"Deleted successfully\"}\n     401 {:description \"Authentication required\"}\n     404 {:description \"User not found\"}}}\n  api-delete-user\n\n  (let [auth (get (get req :headers) \"authorization\")]\n    (if (and auth (str/starts-with? auth \"Bearer \"))\n      (server/json {} 204)\n      (server/json {:error \"Unauthorized\"} 401))))\n</code></pre> <p>Test:</p> <pre><code># Without authentication (error)\ncurl -X DELETE http://localhost:3000/api/users/1\n\n# With authentication (success)\ncurl -X DELETE http://localhost:3000/api/users/1 \\\n  -H \"Authorization: Bearer token123\"\n</code></pre>"},{"location":"tutorial/openapi-tutorial/#step-7-schema-reusability","title":"Step 7: Schema Reusability","text":"<p>Define common schemas and reuse them.</p> <pre><code>;; Common schema definitions\n(def user-schema\n  {:type \"object\"\n   :properties {\n     \"id\" {:type \"integer\"}\n     \"name\" {:type \"string\"}\n     \"email\" {:type \"string\" :format \"email\"}\n     \"created_at\" {:type \"string\" :format \"date-time\"}}})\n\n(def error-schema\n  {:type \"object\"\n   :properties {\n     \"error\" {:type \"string\"}\n     \"message\" {:type \"string\"}}})\n\n;; Use schemas\n(openapi/defapi :get \"/api/users/{id}\"\n  {:summary \"Get user information\"\n   :responses {\n     200 {:description \"Success\"\n          :content {\"application/json\" {:schema user-schema}}}\n     404 {:description \"Not Found\"\n          :content {\"application/json\" {:schema error-schema}}}}}\n  api-get-user\n  ...)\n</code></pre>"},{"location":"tutorial/openapi-tutorial/#step-8-integrate-swagger-ui","title":"Step 8: Integrate Swagger UI","text":"<p>Use Swagger UI to display API documentation in a browser.</p> <pre><code>&lt;!-- static/swagger-ui.html --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;API Documentation&lt;/title&gt;\n  &lt;link rel=\"stylesheet\" href=\"https://unpkg.com/swagger-ui-dist@5/swagger-ui.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;div id=\"swagger-ui\"&gt;&lt;/div&gt;\n  &lt;script src=\"https://unpkg.com/swagger-ui-dist@5/swagger-ui-bundle.js\"&gt;&lt;/script&gt;\n  &lt;script&gt;\n    SwaggerUIBundle({\n      url: '/api/swagger.json',\n      dom_id: '#swagger-ui',\n    })\n  &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Add to router:</p> <pre><code>(defn router [req]\n  (let [path (get req :path)]\n    (cond\n      ;; Swagger JSON\n      (= path \"/api/swagger.json\")\n        ((openapi/swagger-endpoint api-info) req)\n\n      ;; Swagger UI\n      (= path \"/docs\")\n        {:status 200\n         :headers {\"Content-Type\" \"text/html\"}\n         :body (slurp \"static/swagger-ui.html\")}\n\n      ;; API endpoints\n      (str/starts-with? path \"/api/\")\n        (api-router req)\n\n      :else\n        (server/json {:error \"Not Found\"} 404))))\n</code></pre> <p>Open <code>http://localhost:3000/docs</code> in your browser to see Swagger UI.</p>"},{"location":"tutorial/openapi-tutorial/#next-steps","title":"Next Steps","text":"<ul> <li>OpenAPI Library Reference</li> <li>HTTP Server Documentation</li> <li>Database Integration</li> </ul>"},{"location":"tutorial/openapi-tutorial/#summary","title":"Summary","text":"<p>In this tutorial, you learned:</p> <ol> <li>Basic usage of the OpenAPI library</li> <li>Endpoint definition with the <code>defapi</code> macro</li> <li>Defining path parameters and query parameters</li> <li>Adding authentication headers</li> <li>Schema reusability</li> <li>Integration with Swagger UI</li> </ol> <p>Now you can build REST APIs that automatically generate OpenAPI specifications.</p>"},{"location":"spec/FUNCTION-INDEX/","title":"Function Index","text":"<p>=== Qi Language Reference ===</p>"},{"location":"spec/FUNCTION-INDEX/#special-forms","title":"Special Forms","text":"<ul> <li>binding let</li> <li>control-flow if, do, when, while, until, while-some, until-error, loop, recur</li> <li>definition def, defn, defn-</li> <li>error-handling try, defer</li> <li>function fn</li> <li>macro mac</li> <li>module module, export, use, flow</li> <li>pattern-matching match</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#operators","title":"Operators","text":"<ul> <li>arrow-operators -&gt;, =&gt;</li> <li>pattern-operators |</li> <li>pipe-operators |&gt;, |&gt;?, ||&gt;, ~&gt;</li> <li>quote-operators ', `, ,, ,@</li> <li>special-operators @, ...</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#common-symbols","title":"Common Symbols","text":"<ul> <li>accessors get, assoc</li> <li>collections list, vector, map, filter, reduce, first, rest, cons, concat</li> <li>io print, println</li> <li>operators +, -, *, /, =, &lt;, &gt;, &lt;=, &gt;=, not=</li> <li>predicates number?, fn?, string?, list?, vector?, map?, nil?, empty?</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#common-keywords","title":"Common Keywords","text":"<ul> <li>data name, value, id, type, title, description, data</li> <li>http status, message, body, headers, method, path, query, params, request, response</li> <li>result ok, error</li> <li>time created, updated, timestamp</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#built-in-functions-by-category","title":"Built-in Functions by Category","text":""},{"location":"spec/FUNCTION-INDEX/#args","title":"args","text":"<ul> <li>all, get, parse, count</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#authjwt","title":"auth/jwt","text":"<ul> <li>jwt/sign, jwt/verify, jwt/decode</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#authpassword","title":"auth/password","text":"<ul> <li>password/hash, password/verify</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#cmd","title":"cmd","text":"<ul> <li>exec, sh, pipe, pipe!, lines, stream-lines, stream-bytes, interactive, write, read-line, wait</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#corecollections","title":"core/collections","text":"<ul> <li>first, rest, last, nth, len, count, cons, conj, concat, reverse, sort, distinct, range, repeat, take, drop, zip, etc.</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#corefunctions","title":"core/functions","text":"<ul> <li>identity, constantly, partial, comp, apply</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#coreio-logic","title":"core/io-logic","text":"<ul> <li>print, println, not, error</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#corenumeric","title":"core/numeric","text":"<ul> <li>+, -, *, /, %, abs, min, max, inc, dec, sum, =, &lt;, &gt;, &lt;=, &gt;=</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#corepredicates","title":"core/predicates","text":"<ul> <li>nil?, list?, vector?, map?, string?, integer?, float?, number?, keyword?, function?, atom?, coll?, sequential?, empty?, some?, true?, false?, error?, even?, odd?, positive?, negative?, zero?</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#corestate-meta","title":"core/state-meta","text":"<ul> <li>atom, deref, swap!, reset!, eval, uvar, variable, macro?</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#corestring","title":"core/string","text":"<ul> <li>str, split, join</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#coreutil","title":"core/util","text":"<ul> <li>to-int, to-float, to-string, now, timestamp, sleep</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#datacsv","title":"data/csv","text":"<ul> <li>parse, stringify, read-file, write-file, read-stream</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#datajson","title":"data/json","text":"<ul> <li>parse, stringify, pretty</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#datayaml","title":"data/yaml","text":"<ul> <li>parse, stringify, pretty</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#db","title":"db","text":"<ul> <li>connect, close, exec, query, query-one, prepare, exec-prepared, query-prepared, begin, commit, rollback, escape-string, escape-identifier, table-list, column-list, table-exists?, column-exists?, create-table, drop-table, add-column, drop-column, list-indexes, create-index, drop-index</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#debug","title":"debug","text":"<ul> <li>trace, break, stack, info</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#ds","title":"ds","text":"<ul> <li>queue/new, queue/enqueue, queue/dequeue, queue/peek, queue/empty?, queue/size, stack/new, stack/push, stack/pop, stack/peek, stack/empty?, stack/size</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#env","title":"env","text":"<ul> <li>get, set, all, load-dotenv</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#flowcontrol","title":"flow/control","text":"<ul> <li>branch</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#fn","title":"fn","text":"<ul> <li>map, filter, reduce, pmap, pfilter, preduce, partition, group-by, map-lines, update, update-in, count-by, complement, juxt, tap&gt;, tap</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#go","title":"go","text":"<ul> <li>chan, send!, recv!, close!, chan-closed?, then, catch, go, pipeline, pipeline-map, pipeline-filter, select!, atom, swap!, reset!, deref, scope, scope-go, with-scope, parallel-do</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#io","title":"io","text":"<ul> <li>temp-file, temp-dir, cleanup-temp</li> <li>read-file, write-file, append-file, read-lines, file-exists?, file-stream, write-stream, list-dir, create-dir, delete-file, delete-dir, copy-file, move-file, file-info, is-file?, is-dir?, stdin-line, stdin-lines</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#iotemp","title":"io/temp","text":"<ul> <li>temp-file, temp-dir, cleanup-temp</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#kvs","title":"kvs","text":"<ul> <li>kvs/redis-get, kvs/redis-set, kvs/redis-delete, kvs/redis-exists?, kvs/redis-keys, kvs/redis-expire, kvs/redis-ttl, kvs/redis-incr, kvs/redis-decr, kvs/redis-lpush, kvs/redis-rpush, kvs/redis-lpop, kvs/redis-rpop, kvs/redis-lrange, kvs/redis-hset, kvs/redis-hget, kvs/redis-hgetall, kvs/redis-sadd, kvs/redis-smembers, kvs/redis-mget, kvs/redis-mset</li> <li>kvs/connect, kvs/get, kvs/set, kvs/del, kvs/exists, kvs/keys, kvs/expire, kvs/ttl, kvs/incr, kvs/decr, kvs/lpush, kvs/rpush, kvs/lpop, kvs/rpop, kvs/lrange, kvs/hset, kvs/hget, kvs/hgetall, kvs/sadd, kvs/smembers, kvs/mget, kvs/mset</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#kvsredis","title":"kvs/redis","text":"<ul> <li>kvs/redis-get, kvs/redis-set, kvs/redis-delete, kvs/redis-exists?, kvs/redis-keys, kvs/redis-expire, kvs/redis-ttl, kvs/redis-incr, kvs/redis-decr, kvs/redis-lpush, kvs/redis-rpush, kvs/redis-lpop, kvs/redis-rpop, kvs/redis-lrange, kvs/redis-hset, kvs/redis-hget, kvs/redis-hgetall, kvs/redis-sadd, kvs/redis-smembers, kvs/redis-mget, kvs/redis-mset</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#list","title":"list","text":"<ul> <li>take-while, drop-while, split-at, interleave, frequencies, sort-by, chunk, max-by, min-by, sum-by, find, find-index, every?, some?, zipmap, partition-by, take-nth, keep, dedupe, drop-last</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#log","title":"log","text":"<ul> <li>debug, info, warn, error, set-level, set-format</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#map","title":"map","text":"<ul> <li>select-keys, assoc-in, dissoc-in, update-keys, update-vals</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#markdown","title":"markdown","text":"<ul> <li>header, bold, italic, code, codeblock, link, list, table, quote, hr, escape</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#math","title":"math","text":"<ul> <li>pow, sqrt, round, floor, ceil, clamp</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#nethttp","title":"net/http","text":"<ul> <li>get, post, put, delete, patch, head, options, request, get-stream, post-stream, request-stream</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#path","title":"path","text":"<ul> <li>join, basename, dirname, extension, stem, absolute, normalize, is-absolute?, is-relative?</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#profile","title":"profile","text":"<ul> <li>enable, disable, reset, report</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#server","title":"server","text":"<ul> <li>serve, router, ok, json, not-found, no-content, with-logging, with-cors, with-json-body, static-file, static-dir</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#set","title":"set","text":"<ul> <li>union, intersection, difference, subset?, superset?</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#stats","title":"stats","text":"<ul> <li>mean, median, mode, stddev, variance, min, max, sum, product, percentile</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#stream","title":"stream","text":"<ul> <li>stream, range, iterate, repeat, cycle, map, filter, take, drop, realize</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#string","title":"string","text":""},{"location":"spec/FUNCTION-INDEX/#test","title":"test","text":"<ul> <li>assert-eq, assert-ne, assert-true, assert-false, assert-nil, run, assert-throws, summary, clear</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#time","title":"time","text":"<ul> <li>now-iso, from-unix, to-unix, format, today, add-days, add-hours, add-minutes, sub-days, sub-hours, sub-minutes, diff-days, diff-hours, diff-minutes, before?, after?, between?, parse, year, month, day, hour, minute, second, weekday</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#util","title":"util","text":"<ul> <li>inspect</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#validation","title":"validation","text":"<ul> <li>validate</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#table","title":"table","text":"<ul> <li>select, order-by, take, drop, where</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#table_1","title":"table","text":"<ul> <li>group-by, distinct-table</li> </ul>"},{"location":"spec/FUNCTION-INDEX/#zip","title":"zip","text":"<ul> <li>create, extract, list, gzip, gunzip</li> </ul> <p>Statistics:   - Function categories: 49   - Tagged files: 45   - Special forms: 1   - Operators: 5</p>"},{"location":"ja/","title":"Qi - A Lisp that flows","text":"<p>\u65e5\u672c\u8a9e | English</p> <p> </p> <p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b\u30b7\u30f3\u30d7\u30eb\u306aLisp\u7cfb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u3002\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3001\u4e26\u884c\u51e6\u7406\u306b\u5f37\u3044\u3067\u3059\u3002</p>"},{"location":"ja/#_1","title":"\u26a0\ufe0f \u958b\u767a\u72b6\u6cc1","text":"<p>\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f\u73fe\u5728\u30a2\u30af\u30c6\u30a3\u30d6\u306a\u958b\u767a\u4e2d\u3067\u3059\uff08Pre-1.0\uff09</p> <ul> <li>\u7834\u58ca\u7684\u5909\u66f4\u304c\u983b\u7e41\u306b\u767a\u751f\u3057\u307e\u3059</li> <li>API\u3084\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306f\u4e88\u544a\u306a\u304f\u5909\u66f4\u3055\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059</li> <li>\u672c\u756a\u74b0\u5883\u3067\u306e\u4f7f\u7528\u306f\u63a8\u5968\u3057\u307e\u305b\u3093</li> <li>\u672a\u30c6\u30b9\u30c8\u306e\u30b3\u30fc\u30c9\u3082\u591a\u304f\u3042\u308a\u307e\u3059</li> </ul> <p>\u73fe\u5728\u306e\u958b\u767a\u6bb5\u968e: Alpha / Experimental</p>"},{"location":"ja/#_2","title":"\u7279\u5fb4","text":"<ul> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: <code>|&gt;</code> <code>|&gt;?</code> <code>||&gt;</code> <code>~&gt;</code> \u3067\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u3092\u76f4\u611f\u7684\u306b\u8a18\u8ff0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u5f37\u529b\u306a <code>match</code> \u5f0f\u3067\u5206\u5c90\u3068\u5909\u63db\u3092\u7d71\u5408</li> <li>\u4e26\u884c\u30fb\u4e26\u5217: goroutine\u98a8\u306e\u4e26\u884c\u51e6\u7406\u3068\u30c1\u30e3\u30cd\u30eb\u3001\u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3</li> <li>Web\u958b\u767a: JSON/HTTP\u5bfe\u5fdc\u3001Railway Pipeline\u3067\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>\u8a8d\u8a3c\u30fb\u8a8d\u53ef: JWT\u8a8d\u8a3c\u3001Argon2\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\u3001\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9: PostgreSQL/MySQL/SQLite\u5bfe\u5fdc\uff08\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff09</li> <li>KVS: Redis\u5bfe\u5fdc\uff08\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3001\u5c06\u6765Memcached/InMemory\u5bfe\u5fdc\u4e88\u5b9a\uff09</li> <li>\u30c7\u30d0\u30c3\u30b0: \u30c8\u30ec\u30fc\u30b9\u3001\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3001\u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9\u6a5f\u80fd\uff08VSCode\u30c7\u30d0\u30c3\u30ac\u5bfe\u5fdc\uff09</li> <li>f-string: \u6587\u5b57\u5217\u88dc\u9593\u3068\u8907\u6570\u884c\u6587\u5b57\u5217\uff08<code>\"\"\"...\"\"\"</code>\uff09</li> <li>\u591a\u8a00\u8a9e\u5bfe\u5fdc: \u82f1\u8a9e\u30fb\u65e5\u672c\u8a9e\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\uff08<code>QI_LANG=ja</code>\uff09</li> </ul>"},{"location":"ja/#_3","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u4f8b","text":""},{"location":"ja/#_4","title":"\u57fa\u672c\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u6570\u5024\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3068\u5909\u63db\n([1 2 3 4 5 6 7 8 9 10]\n |&gt; (filter (fn [x] (&gt; x 5)))\n |&gt; (map (fn [x] (* x 2)))\n |&gt; (reduce + 0))\n;; =&gt; 90\n\n;; \u6587\u5b57\u5217\u51e6\u7406\n(\"hello world\"\n |&gt; str/upper\n |&gt; str/reverse)\n;; =&gt; \"DLROW OLLEH\"\n</code></pre>"},{"location":"ja/#railway-pipeline-","title":"Railway Pipeline - \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>;; {:error}\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f\u6271\u3044\uff08:ok\u30e9\u30c3\u30d7\u306a\u3057\uff01\uff09\n(defn validate-positive [x]\n  (if (&gt; x 0)\n    x                          ;; \u666e\u901a\u306e\u5024 \u2192 \u6210\u529f\n    {:error \"Must be positive\"}))\n\n(defn double [x]\n  (* x 2))                     ;; \u666e\u901a\u306e\u5024 \u2192 \u6210\u529f\n\n(defn format-result [x]\n  f\"Result: {x}\")              ;; \u666e\u901a\u306e\u5024 \u2192 \u6210\u529f\n\n;; \u6210\u529f\u30b1\u30fc\u30b9 - \u5024\u304c\u305d\u306e\u307e\u307e\u6d41\u308c\u308b\n(10\n |&gt;? validate-positive\n |&gt;? double\n |&gt;? format-result)\n;; =&gt; \"Result: 20\"\n\n;; \u30a8\u30e9\u30fc\u30b1\u30fc\u30b9 - \u30a8\u30e9\u30fc\u306f\u81ea\u52d5\u7684\u306b\u4f1d\u64ad\n(-5\n |&gt;? validate-positive\n |&gt;? double                    ;; \u5b9f\u884c\u3055\u308c\u306a\u3044\uff08\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\uff09\n |&gt;? format-result)            ;; \u5b9f\u884c\u3055\u308c\u306a\u3044\n;; =&gt; {:error \"Must be positive\"}\n</code></pre>"},{"location":"ja/#_5","title":"\u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; ||&gt; \u3067\u8907\u6570\u306e\u51e6\u7406\u3092\u4e26\u5217\u5b9f\u884c\n([1 2 3 4 5]\n ||&gt; (fn [x] (* x 2))\n ||&gt; (fn [x] (+ x 10))\n ||&gt; (fn [x] (* x x)))\n;; =&gt; [144, 196, 256, 324, 400]\n</code></pre>"},{"location":"ja/#_6","title":"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","text":"<pre><code># Rust\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5834\u5408\ncargo install --path .\n\n# \u307e\u305f\u306f\ncargo build --release\n</code></pre>"},{"location":"ja/#_7","title":"\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9","text":"<pre><code># \u6700\u65b0\u7248\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\nqi --upgrade\n</code></pre> <p>Qi\u306f\u81ea\u52d5\u7684\u306bGitHub\u304b\u3089\u6700\u65b0\u7248\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\u624b\u52d5\u3067\u30d3\u30eb\u30c9\u3084\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002</p>"},{"location":"ja/#_8","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210","text":"<pre><code># \u57fa\u672c\u7684\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nqi new my-project\ncd my-project\nqi main.qi\n\n# HTTP\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nqi new myapi --template http-server\ncd myapi\nqi main.qi\n</code></pre>"},{"location":"ja/#_9","title":"\u5229\u7528\u53ef\u80fd\u306a\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8","text":"<pre><code>qi template list\nqi template info http-server\n</code></pre>"},{"location":"ja/#repl","title":"REPL\uff08\u5bfe\u8a71\u578b\u5b9f\u884c\u74b0\u5883\uff09","text":"<pre><code>qi\n\n# REPL\u5185\u3067\nqi:1&gt; (+ 1 2 3)\n6\n\nqi:2&gt; ([1 2 3 4 5] |&gt; (map (fn [x] (* x 2))))\nVector([Integer(2), Integer(4), Integer(6), Integer(8), Integer(10)])\n</code></pre>"},{"location":"ja/#_10","title":"\u305d\u306e\u4ed6\u306e\u30b3\u30de\u30f3\u30c9","text":"<pre><code># \u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u5b9f\u884c\nqi script.qi\n\n# \u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u5b9f\u884c\nqi -e '(+ 1 2 3)'\n\n# \u30d1\u30a4\u30d7\u304b\u3089\u306e\u5165\u529b\u3092\u51e6\u7406\uff08\u81ea\u52d5\u7684\u306bstdin\u5909\u6570\u306b\u683c\u7d0d\uff09\ncat data.csv | qi -e '(stdin |&gt; (map str/trim) |&gt; (filter (fn [x] (&gt; (len x) 0))))'\nls -l | qi -e '(count stdin)'\n\n# \u30d8\u30eb\u30d7\u8868\u793a\nqi --help\n</code></pre>"},{"location":"ja/#qiinitqi","title":"\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\uff08.qi/init.qi\uff09","text":"<p>REPL\u304a\u3088\u3073\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u5b9f\u884c\u6642\u306b\u3001\u4ee5\u4e0b\u306e\u9806\u5e8f\u3067\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\u304c\u81ea\u52d5\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3059\uff1a</p> <pre><code># 1. \u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb\u8a2d\u5b9a\uff08\u512a\u5148\uff09\n~/.qi/init.qi\n\n# 2. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\n./.qi/init.qi\n</code></pre> <p>\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\u3067\u3088\u304f\u4f7f\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ea\u30ed\u30fc\u30c9\u3057\u305f\u308a\u3001\u4fbf\u5229\u306a\u95a2\u6570\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\uff1a</p> <pre><code>;; ~/.qi/init.qi \u306e\u4f8b\n;; \u30c6\u30fc\u30d6\u30eb\u51e6\u7406\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ea\u30ed\u30fc\u30c9\n(use \"std/lib/table\" :as table)\n\n;; \u30c7\u30d0\u30c3\u30b0\u7528\u95a2\u6570\n(defn dbg [x]\n  (do (println (str \"DEBUG: \" x))\n      x))\n</code></pre>"},{"location":"ja/#_11","title":"\u30a8\u30c7\u30a3\u30bf\u62e1\u5f35","text":""},{"location":"ja/#visual-studio-code","title":"Visual Studio Code","text":"<p>\u516c\u5f0f\u306eVSCode\u62e1\u5f35\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ul> <li>\u30ea\u30dd\u30b8\u30c8\u30ea: qi-vscode</li> <li>\u6a5f\u80fd:</li> <li>\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30cf\u30a4\u30e9\u30a4\u30c8</li> <li>\u30b3\u30fc\u30c9\u30b9\u30cb\u30da\u30c3\u30c8</li> <li>\u30d6\u30e9\u30b1\u30c3\u30c8\u30de\u30c3\u30c1\u30f3\u30b0</li> </ul> <p>\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u3084\u8a73\u7d30\u306fqi-vscode \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/#_12","title":"\u30c6\u30b9\u30c8","text":""},{"location":"ja/#_13","title":"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\uff08\u9ad8\u901f\uff09","text":"<pre><code># \u901a\u5e38\u306e\u30c6\u30b9\u30c8\uff08Docker\u306a\u3057\uff09\ncargo test\n\n# \u7279\u5b9a\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30c6\u30b9\u30c8\ncargo test parser\ncargo test eval\n</code></pre>"},{"location":"ja/#docker","title":"\u7d71\u5408\u30c6\u30b9\u30c8\uff08Docker\u81ea\u52d5\u8d77\u52d5\uff09","text":"<p>PostgreSQL\u3001MySQL\u3001Redis\u306e\u7d71\u5408\u30c6\u30b9\u30c8\u306f\u3001testcontainers\u3092\u4f7f\u7528\u3057\u3066Docker\u30b3\u30f3\u30c6\u30ca\u3092\u81ea\u52d5\u8d77\u52d5\u30fb\u524a\u9664\u3057\u307e\u3059\u3002</p> <p>\u524d\u63d0\u6761\u4ef6: Docker\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code># \u7d71\u5408\u30c6\u30b9\u30c8\u5b9f\u884c\uff08PostgreSQL + MySQL + Redis\uff09\ncargo test --features integration-tests\n\n# \u500b\u5225\u5b9f\u884c\ncargo test --features integration-tests --test integration_postgres\ncargo test --features integration-tests --test integration_mysql\ncargo test --features integration-tests --test integration_redis\n</code></pre> <p>\u52d5\u4f5c: - \u30c6\u30b9\u30c8\u958b\u59cb\u6642\u306bDocker\u30b3\u30f3\u30c6\u30ca\u304c\u81ea\u52d5\u8d77\u52d5\uff08\u30dd\u30fc\u30c8\u81ea\u52d5\u5272\u308a\u5f53\u3066\uff09 - \u30c6\u30b9\u30c8\u7d42\u4e86\u6642\u306b\u30b3\u30f3\u30c6\u30ca\u304c\u81ea\u52d5\u524a\u9664 - \u30a4\u30e1\u30fc\u30b8\u306f\u6b8b\u308b\u305f\u3081\u3001\u6b21\u56de\u306e\u30c6\u30b9\u30c8\u5b9f\u884c\u304c\u9ad8\u901f</p>"},{"location":"ja/#_14","title":"\u30ea\u30f3\u30af","text":"<ul> <li>GitHub \u30ea\u30dd\u30b8\u30c8\u30ea: qi-lang</li> <li>VSCode\u62e1\u5f35: qi-vscode</li> </ul>"},{"location":"ja/#_15","title":"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":""},{"location":"ja/#_16","title":"\u306f\u3058\u3081\u306b","text":"<ul> <li>Lisp\u7cfb\u8a00\u8a9e\u306e\u57fa\u790e \ud83d\udcda Lisp\u521d\u5fc3\u8005\u5411\u3051 - \u62ec\u5f27\u306e\u8aad\u307f\u65b9\uff085\u5206\uff09</li> <li>\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb \u2b50 \u521d\u5fc3\u8005\u5411\u3051 - Qi\u3092\u306f\u3058\u3081\u3088\u3046</li> <li>CLI\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 - <code>qi</code>\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u3044\u65b9</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7ba1\u7406 - qi.toml\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3001\u30ab\u30b9\u30bf\u30de\u30a4\u30ba</li> </ul>"},{"location":"ja/#_17","title":"\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9","text":"<ul> <li>\u8a00\u8a9e\u4ed5\u69d8\u66f8 - Qi\u306e\u5b8c\u5168\u306a\u4ed5\u69d8\u3068\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 - <code>|&gt;</code>, <code>|&gt;?</code>, <code>||&gt;</code>, <code>~&gt;</code></li> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406 - <code>go</code>, <code>chan</code></li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 - <code>match</code>\u5f0f</li> <li>\u30a8\u30e9\u30fc\u51e6\u7406 - <code>try</code>, <code>defer</code></li> <li>\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - 60\u4ee5\u4e0a\u306e\u7d44\u307f\u8fbc\u307f\u95a2\u6570</li> </ul>"},{"location":"ja/#_18","title":"\u30e9\u30a4\u30bb\u30f3\u30b9","text":"<p>MIT OR Apache-2.0 \u306e\u30c7\u30e5\u30a2\u30eb\u30e9\u30a4\u30bb\u30f3\u30b9\u3067\u3059\u3002\u304a\u597d\u304d\u306a\u65b9\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <ul> <li>LICENSE-MIT - MIT\u30e9\u30a4\u30bb\u30f3\u30b9</li> <li>LICENSE-APACHE - Apache License 2.0</li> </ul> <p>\u8a73\u7d30\u306f\u5404\u30e9\u30a4\u30bb\u30f3\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/cli/","title":"Qi CLI \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9","text":"<p>Qi\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u306e\u5b8c\u5168\u306a\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3067\u3059\u3002</p>"},{"location":"ja/cli/#_1","title":"\u76ee\u6b21","text":"<ul> <li>\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9</li> <li>\u30b3\u30de\u30f3\u30c9\u4e00\u89a7</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7ba1\u7406</li> <li>\u30b3\u30fc\u30c9\u5b9f\u884c</li> <li>REPL</li> <li>\u74b0\u5883\u5909\u6570</li> <li>\u7d42\u4e86\u30b3\u30fc\u30c9</li> </ul>"},{"location":"ja/cli/#_2","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>qi [OPTIONS] [FILE]\n</code></pre> <p>\u5f15\u6570\u306a\u3057\u3067\u8d77\u52d5\u3059\u308b\u3068REPL\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"ja/cli/#_3","title":"\u30b3\u30de\u30f3\u30c9\u4e00\u89a7","text":""},{"location":"ja/cli/#_4","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7ba1\u7406","text":""},{"location":"ja/cli/#qi-new-name-options","title":"<code>qi new &lt;name&gt; [OPTIONS]</code>","text":"<p>\u65b0\u3057\u3044Qi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <p>\u5f15\u6570: - <code>&lt;name&gt;</code> - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff08\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\uff09</p> <p>\u30aa\u30d7\u30b7\u30e7\u30f3: - <code>-t, --template &lt;template&gt;</code> - \u4f7f\u7528\u3059\u308b\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: <code>basic</code>\uff09</p> <p>\u4f8b: <pre><code># \u57fa\u672c\u7684\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nqi new my-project\n\n# HTTP\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nqi new myapi --template http-server\nqi new myapi -t http-server\n</code></pre></p> <p>\u52d5\u4f5c: 1. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210 2. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u5bfe\u8a71\u7684\u306b\u5165\u529b\uff08\u540d\u524d\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u3001\u8aac\u660e\u3001\u8457\u8005\u3001\u30e9\u30a4\u30bb\u30f3\u30b9\uff09 3. \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc 4. <code>qi.toml</code> \u3092\u751f\u6210</p>"},{"location":"ja/cli/#qi-template-list","title":"<code>qi template list</code>","text":"<p>\u5229\u7528\u53ef\u80fd\u306a\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002</p> <p>\u4f8b: <pre><code>qi template list\n</code></pre></p> <p>\u51fa\u529b\u4f8b: <pre><code>\u5229\u7528\u53ef\u80fd\u306a\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8:\n  basic            - \u57fa\u672c\u7684\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020\n  http-server      - JSON API\u30b5\u30fc\u30d0\u30fc with \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n</code></pre></p>"},{"location":"ja/cli/#qi-template-info-name","title":"<code>qi template info &lt;name&gt;</code>","text":"<p>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u8a73\u7d30\u60c5\u5831\u3092\u8868\u793a\u3057\u307e\u3059\u3002</p> <p>\u5f15\u6570: - <code>&lt;name&gt;</code> - \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d</p> <p>\u4f8b: <pre><code>qi template info http-server\n</code></pre></p> <p>\u51fa\u529b\u4f8b: <pre><code>Template: http-server\nDescription: JSON API\u30b5\u30fc\u30d0\u30fc with \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\nAuthor: Qi Team\nVersion: 0.1.0\nRequired features: http-server, format-json\nLocation: std/templates/http-server\n</code></pre></p>"},{"location":"ja/cli/#_5","title":"\u30b3\u30fc\u30c9\u5b9f\u884c","text":""},{"location":"ja/cli/#qi-file","title":"<code>qi &lt;file&gt;</code>","text":"<p>Qi\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <p>\u5f15\u6570: - <code>&lt;file&gt;</code> - \u5b9f\u884c\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\uff08<code>.qi</code>\uff09</p> <p>\u4f8b: <pre><code>qi script.qi\nqi main.qi\nqi examples/example.qi\n</code></pre></p>"},{"location":"ja/cli/#qi-e-code-qi-c-code","title":"<code>qi -e &lt;code&gt;</code> / <code>qi -c &lt;code&gt;</code>","text":"<p>\u30b3\u30fc\u30c9\u3092\u76f4\u63a5\u5b9f\u884c\u3057\u307e\u3059\uff08\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\uff09\u3002</p> <p>\u30aa\u30d7\u30b7\u30e7\u30f3: - <code>-e, -c &lt;code&gt;</code> - \u5b9f\u884c\u3059\u308bQi\u30b3\u30fc\u30c9</p> <p>stdin\u81ea\u52d5\u30d0\u30a4\u30f3\u30c9:</p> <p>\u30d1\u30a4\u30d7\u304b\u3089\u5165\u529b\u304c\u3042\u308b\u5834\u5408\u3001\u81ea\u52d5\u7684\u306b<code>stdin</code>\u5909\u6570\u306b\u5168\u30c7\u30fc\u30bf\uff08\u6587\u5b57\u5217\u306e\u30d9\u30af\u30bf\u30fc\uff09\u304c\u683c\u7d0d\u3055\u308c\u307e\u3059\uff1a</p> <pre><code># \u884c\u6570\u3092\u30ab\u30a6\u30f3\u30c8\ncat data.txt | qi -e '(count stdin)'\n\n# CSV\u30c7\u30fc\u30bf\u3092\u51e6\u7406\uff08\u7a7a\u884c\u3092\u9664\u5916\uff09\ncat users.csv | qi -e '(stdin |&gt; (filter (fn [x] (&gt; (len x) 0))))'\n\n# \u7a7a\u884c\u3092\u9664\u5916\u3057\u3066\u5927\u6587\u5b57\u5909\u63db\necho -e \"hello\\n\\nworld\" | qi -e '(stdin |&gt; (filter (fn [x] (&gt; (len x) 0))) |&gt; (map str/upper))'\n</code></pre> <p>\u4f8b: <pre><code>qi -e '(+ 1 2 3)'\n# =&gt; 6\n\nqi -e '(println \"Hello, Qi!\")'\n# =&gt; Hello, Qi!\n\nqi -c '([1 2 3 4 5] |&gt; (map (fn [x] (* x 2))) |&gt; (reduce + 0))'\n# =&gt; 30\n</code></pre></p>"},{"location":"ja/cli/#qi-","title":"<code>qi -</code>","text":"<p>\u6a19\u6e96\u5165\u529b\u304b\u3089\u30b3\u30fc\u30c9\u3092\u8aad\u307f\u8fbc\u3093\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <p>\u4f8b: <pre><code>echo '(println 42)' | qi -\n\ncat script.qi | qi -\n</code></pre></p>"},{"location":"ja/cli/#qi","title":"<code>qi</code> (\u5f15\u6570\u306a\u3057)","text":"<p>\u5bfe\u8a71\u578bREPL\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002</p> <p>\u4f8b: <pre><code>qi\n</code></pre></p> <p>REPL\u30b3\u30de\u30f3\u30c9: - <code>:help</code> - \u30d8\u30eb\u30d7\u3092\u8868\u793a - <code>:doc &lt;name&gt;</code> - \u95a2\u6570\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8868\u793a - <code>:vars</code> - \u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5909\u6570\u3092\u8868\u793a - <code>:funcs</code> - \u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u95a2\u6570\u3092\u8868\u793a - <code>:builtins [filter]</code> - \u7d44\u307f\u8fbc\u307f\u95a2\u6570\u3092\u8868\u793a\uff08\u30d5\u30a3\u30eb\u30bf\u53ef\u80fd\uff09 - <code>:clear</code> - \u74b0\u5883\u3092\u30af\u30ea\u30a2 - <code>:load &lt;file&gt;</code> - \u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080 - <code>:reload</code> - \u6700\u5f8c\u306b\u8aad\u307f\u8fbc\u3093\u3060\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u8aad\u307f\u8fbc\u307f - <code>:quit</code> - REPL\u3092\u7d42\u4e86</p> <p>\u6a5f\u80fd: - \u30bf\u30d6\u88dc\u5b8c\uff08\u95a2\u6570\u540d\u3001\u5909\u6570\u540d\u3001REPL\u30b3\u30de\u30f3\u30c9\uff09 - \u5c65\u6b74\uff08<code>~/.qi_history</code> \u306b\u4fdd\u5b58\uff09 - \u8907\u6570\u884c\u5165\u529b\uff08\u62ec\u5f27\u306e\u30d0\u30e9\u30f3\u30b9\u3092\u81ea\u52d5\u5224\u5b9a\uff09 - Ctrl+C \u3067\u5165\u529b\u30ad\u30e3\u30f3\u30bb\u30eb - Ctrl+D \u307e\u305f\u306f <code>:quit</code> \u3067\u7d42\u4e86</p>"},{"location":"ja/cli/#qi-l-file-qi-load-file","title":"<code>qi -l &lt;file&gt;</code> / <code>qi --load &lt;file&gt;</code>","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u304b\u3089REPL\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002</p> <p>\u30aa\u30d7\u30b7\u30e7\u30f3: - <code>-l, --load &lt;file&gt;</code> - \u8aad\u307f\u8fbc\u3080\u30d5\u30a1\u30a4\u30eb</p> <p>\u4f8b: <pre><code>qi -l utils.qi\nqi --load lib.qi\n</code></pre></p>"},{"location":"ja/cli/#_6","title":"\u305d\u306e\u4ed6\u306e\u30aa\u30d7\u30b7\u30e7\u30f3","text":""},{"location":"ja/cli/#qi-h-qi-help","title":"<code>qi -h</code> / <code>qi --help</code>","text":"<p>\u30d8\u30eb\u30d7\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u307e\u3059\u3002</p> <pre><code>qi --help\nqi -h\n</code></pre>"},{"location":"ja/cli/#qi-v-qi-version","title":"<code>qi -v</code> / <code>qi --version</code>","text":"<p>\u30d0\u30fc\u30b8\u30e7\u30f3\u60c5\u5831\u3092\u8868\u793a\u3057\u307e\u3059\u3002</p> <pre><code>qi --version\nqi -v\n</code></pre>"},{"location":"ja/cli/#qi-upgrade","title":"<code>qi --upgrade</code>","text":"<p>Qi\u3092\u6700\u65b0\u7248\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u307e\u3059\uff08GitHub Releases\u304b\u3089\u53d6\u5f97\uff09\u3002</p> <pre><code>qi --upgrade\n</code></pre> <p>\u52d5\u4f5c: 1. GitHub\u304b\u3089\u6700\u65b0\u30ea\u30ea\u30fc\u30b9\u3092\u78ba\u8a8d 2. \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306b\u5bfe\u5fdc\u3057\u305f\u30d0\u30a4\u30ca\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 3. \u73fe\u5728\u306e\u30d0\u30a4\u30ca\u30ea\u3092\u7f6e\u304d\u63db\u3048\uff08\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092<code>.old</code>\u306b\u4f5c\u6210\uff09 4. \u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u72b6\u6cc1\u3092\u8868\u793a</p> <p>\u5bfe\u5fdc\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0: - macOS (Apple Silicon / Intel) - Linux (x86_64 / aarch64) - Windows (x86_64)</p> <p>\u4f7f\u7528\u4f8b: <pre><code># \u6700\u65b0\u7248\u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\nqi --upgrade\n\n# \u73fe\u5728\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\nqi --version\n</code></pre></p>"},{"location":"ja/cli/#_7","title":"\u74b0\u5883\u5909\u6570","text":""},{"location":"ja/cli/#qi_lang","title":"<code>QI_LANG</code>","text":"<p>Qi\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u8a00\u8a9e\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002</p> <p>\u5024: - <code>ja</code> - \u65e5\u672c\u8a9e - <code>en</code> - \u82f1\u8a9e\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09</p> <p>\u4f8b: <pre><code>QI_LANG=ja qi script.qi\nQI_LANG=en qi --help\n</code></pre></p> <p>\u52d5\u4f5c: - \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3001\u30d8\u30eb\u30d7\u30e1\u30c3\u30bb\u30fc\u30b8\u3001REPL\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u6307\u5b9a\u3055\u308c\u305f\u8a00\u8a9e\u3067\u8868\u793a\u3055\u308c\u308b - \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\uff08<code>:doc</code>\uff09\u3082\u6307\u5b9a\u3055\u308c\u305f\u8a00\u8a9e\u3067\u8868\u793a\u3055\u308c\u308b</p>"},{"location":"ja/cli/#lang","title":"<code>LANG</code>","text":"<p>\u30b7\u30b9\u30c6\u30e0\u306e\u30ed\u30b1\u30fc\u30eb\u8a2d\u5b9a\u3002<code>QI_LANG</code>\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3002</p> <p>\u4f8b: <pre><code>LANG=ja_JP.UTF-8 qi script.qi\n</code></pre></p>"},{"location":"ja/cli/#_8","title":"\u7d42\u4e86\u30b3\u30fc\u30c9","text":"\u30b3\u30fc\u30c9 \u610f\u5473 <code>0</code> \u6b63\u5e38\u7d42\u4e86 <code>1</code> \u30a8\u30e9\u30fc\u767a\u751f\uff08\u69cb\u6587\u30a8\u30e9\u30fc\u3001\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u3001\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u7b49\uff09 <p>\u4f8b: <pre><code>qi script.qi\necho $?  # \u7d42\u4e86\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\n\nqi -e '(+ 1 2 3)'\necho $?  # =&gt; 0\n\nqi -e '(invalid syntax'\necho $?  # =&gt; 1\n</code></pre></p>"},{"location":"ja/cli/#_9","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u691c\u7d22\u9806\u5e8f","text":"<p><code>qi new</code>\u30b3\u30de\u30f3\u30c9\u306f\u3001\u4ee5\u4e0b\u306e\u9806\u5e8f\u3067\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u691c\u7d22\u3057\u307e\u3059\uff1a</p> <ol> <li><code>./.qi/templates/&lt;name&gt;/</code> - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb</li> <li><code>~/.qi/templates/&lt;name&gt;/</code> - \u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb</li> <li><code>&lt;qi-binary-dir&gt;/std/templates/&lt;name&gt;/</code> - \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u7248</li> <li><code>std/templates/&lt;name&gt;/</code> - \u958b\u767a\u7248</li> </ol> <p>\u6700\u521d\u306b\u898b\u3064\u304b\u3063\u305f\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/cli/#_10","title":"\u4f7f\u7528\u4f8b","text":""},{"location":"ja/cli/#_11","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\u306e\u6d41\u308c","text":"<pre><code># \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u4e00\u89a7\u3092\u78ba\u8a8d\nqi template list\n\n# HTTP\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nqi new myapi --template http-server\n\n# \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\ncd myapi\n\n# \u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\nqi main.qi\n</code></pre>"},{"location":"ja/cli/#_12","title":"\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067\u306e\u30c7\u30fc\u30bf\u51e6\u7406","text":"<pre><code># \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\nqi -e '(defn fib [n] (if (&lt;= n 1) n (+ (fib (- n 1)) (fib (- n 2))))) (fib 10)'\n\n# \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406\nqi -e '([1 2 3 4 5] |&gt; (filter (fn [x] (&gt; x 2))) |&gt; (map (fn [x] (* x 10))))'\n\n# JSON\u51e6\u7406\uff08HTTP feature\u304c\u6709\u52b9\u306a\u5834\u5408\uff09\nqi -e '(json/parse \"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\")'\n</code></pre>"},{"location":"ja/cli/#repl_1","title":"REPL\u3067\u306e\u958b\u767a","text":"<pre><code># \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8aad\u307f\u8fbc\u3093\u3067REPL\u8d77\u52d5\nqi -l src/lib.qi\n\n# REPL\u5185\u3067\u95a2\u6570\u3092\u30c6\u30b9\u30c8\nqi:1&gt; (greet \"World\")\n\u3053\u3093\u306b\u3061\u306f\u3001World\u3055\u3093\uff01\n\n# \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u78ba\u8a8d\nqi:2&gt; :doc map\n\n# \u7d44\u307f\u8fbc\u307f\u95a2\u6570\u3092\u691c\u7d22\nqi:3&gt; :builtins str\n</code></pre>"},{"location":"ja/cli/#_13","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7ba1\u7406\u3068qi.toml\u4ed5\u69d8 - qi.toml\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020</li> <li>\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb - \u5b9f\u8df5\u7684\u306a\u4f7f\u3044\u65b9</li> <li>\u8a00\u8a9e\u4ed5\u69d8 - Qi\u8a00\u8a9e\u306e\u6587\u6cd5\u3068\u6a5f\u80fd</li> </ul>"},{"location":"ja/project/","title":"Qi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7ba1\u7406","text":"<p>Qi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u69cb\u9020\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\uff08qi.toml\uff09\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30b7\u30b9\u30c6\u30e0\u306e\u5b8c\u5168\u306a\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3067\u3059\u3002</p>"},{"location":"ja/project/#_1","title":"\u76ee\u6b21","text":"<ul> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020</li> <li>qi.toml\u4ed5\u69d8</li> <li>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30b7\u30b9\u30c6\u30e0</li> <li>\u30ab\u30b9\u30bf\u30e0\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f5c\u6210</li> </ul>"},{"location":"ja/project/#_2","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020","text":"<p>\u6a19\u6e96\u7684\u306aQi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f\u4ee5\u4e0b\u306e\u69cb\u9020\u3092\u6301\u3061\u307e\u3059\uff1a</p> <pre><code>my-project/\n\u251c\u2500\u2500 qi.toml           # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 main.qi           # \u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\n\u251c\u2500\u2500 src/              # \u30e9\u30a4\u30d6\u30e9\u30ea\u30b3\u30fc\u30c9\n\u2502   \u2514\u2500\u2500 lib.qi\n\u251c\u2500\u2500 examples/         # \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u2514\u2500\u2500 example.qi\n\u2514\u2500\u2500 tests/            # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n    \u2514\u2500\u2500 test.qi\n</code></pre>"},{"location":"ja/project/#_3","title":"\u5404\u30d5\u30a1\u30a4\u30eb\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u5f79\u5272","text":""},{"location":"ja/project/#qitoml","title":"<code>qi.toml</code>","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3068\u8a2d\u5b9a\u3092\u8a18\u8ff0\u3059\u308bTOML\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3002\u8a73\u7d30\u306fqi.toml\u4ed5\u69d8\u3092\u53c2\u7167\u3002</p>"},{"location":"ja/project/#mainqi","title":"<code>main.qi</code>","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u3002<code>qi main.qi</code>\u3067\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/project/#src","title":"<code>src/</code>","text":"<p>\u518d\u5229\u7528\u53ef\u80fd\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002\u5c06\u6765\u7684\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u30b7\u30b9\u30c6\u30e0\u3067\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u306a\u308b\u4e88\u5b9a\u3002</p>"},{"location":"ja/project/#examples","title":"<code>examples/</code>","text":"<p>\u4f7f\u7528\u4f8b\u3084\u30c7\u30e2\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u76ee\u7684\u3084\u52d5\u4f5c\u78ba\u8a8d\u306b\u4f7f\u7528\u3002</p>"},{"location":"ja/project/#tests","title":"<code>tests/</code>","text":"<p>\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002<code>qi test</code>\u30b3\u30de\u30f3\u30c9\uff08\u5c06\u6765\u5b9f\u88c5\u4e88\u5b9a\uff09\u3067\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/project/#qitoml_1","title":"qi.toml\u4ed5\u69d8","text":"<p><code>qi.toml</code>\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u3001TOML\u5f62\u5f0f\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002</p>"},{"location":"ja/project/#_4","title":"\u57fa\u672c\u7684\u306a\u4f8b","text":"<pre><code>[project]\nname = \"my-project\"\nversion = \"0.1.0\"\nauthors = [\"Alice &lt;alice@example.com&gt;\"]\ndescription = \"My awesome Qi project\"\nlicense = \"MIT\"\nqi-version = \"0.1.0\"\n\n[dependencies]\n# \u5c06\u6765\u306e\u62e1\u5f35\u7528\uff08\u73fe\u5728\u306f\u672a\u5b9f\u88c5\uff09\n\n[features]\ndefault = [\"http-server\", \"format-json\"]\n</code></pre>"},{"location":"ja/project/#project","title":"<code>[project]</code> \u30bb\u30af\u30b7\u30e7\u30f3","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p>"},{"location":"ja/project/#name","title":"<code>name</code> (\u5fc5\u9808)","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3002\u82f1\u6570\u5b57\u3001\u30cf\u30a4\u30d5\u30f3\u3001\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2\u304c\u4f7f\u7528\u53ef\u80fd\u3002</p> <pre><code>name = \"my-project\"\n</code></pre>"},{"location":"ja/project/#version","title":"<code>version</code> (\u5fc5\u9808)","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3002\u30bb\u30de\u30f3\u30c6\u30a3\u30c3\u30af\u30d0\u30fc\u30b8\u30e7\u30cb\u30f3\u30b0\u63a8\u5968\u3002</p> <pre><code>version = \"0.1.0\"\n</code></pre>"},{"location":"ja/project/#authors","title":"<code>authors</code> (\u4efb\u610f)","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u8005\u306e\u30ea\u30b9\u30c8\u3002</p> <pre><code>authors = [\"Alice &lt;alice@example.com&gt;\", \"Bob &lt;bob@example.com&gt;\"]\n</code></pre>"},{"location":"ja/project/#description","title":"<code>description</code> (\u4efb\u610f)","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8aac\u660e\u3002</p> <pre><code>description = \"A web API server written in Qi\"\n</code></pre>"},{"location":"ja/project/#license","title":"<code>license</code> (\u4efb\u610f)","text":"<p>\u30e9\u30a4\u30bb\u30f3\u30b9\u8b58\u5225\u5b50\uff08SPDX\u5f62\u5f0f\u63a8\u5968\uff09\u3002</p> <pre><code>license = \"MIT\"\nlicense = \"Apache-2.0\"\nlicense = \"GPL-3.0-or-later\"\n</code></pre>"},{"location":"ja/project/#qi-version","title":"<code>qi-version</code> (\u5fc5\u9808)","text":"<p>\u4e92\u63db\u6027\u306e\u3042\u308bQi\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3002</p> <pre><code>qi-version = \"0.1.0\"\n</code></pre>"},{"location":"ja/project/#dependencies","title":"<code>[dependencies]</code> \u30bb\u30af\u30b7\u30e7\u30f3","text":"<p>\u4f9d\u5b58\u95a2\u4fc2\u3092\u5b9a\u7fa9\u3057\u307e\u3059\uff08\u5c06\u6765\u306e\u62e1\u5f35\u7528\u3001\u73fe\u5728\u306f\u672a\u5b9f\u88c5\uff09\u3002</p> <pre><code>[dependencies]\n# \u5c06\u6765\u7684\u306b\u4ed6\u306eQi\u30d1\u30c3\u30b1\u30fc\u30b8\u3078\u306e\u4f9d\u5b58\u3092\u8a18\u8ff0\n# my-lib = \"1.0.0\"\n</code></pre>"},{"location":"ja/project/#features","title":"<code>[features]</code> \u30bb\u30af\u30b7\u30e7\u30f3","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u30d5\u30e9\u30b0\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p>"},{"location":"ja/project/#default","title":"<code>default</code>","text":"<p>\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\u306b\u3059\u308b\u6a5f\u80fd\u306e\u30ea\u30b9\u30c8\u3002</p> <pre><code>[features]\ndefault = []  # \u57fa\u672c\u6a5f\u80fd\u306e\u307f\n\n# \u307e\u305f\u306f\ndefault = [\"http-server\", \"format-json\"]  # HTTP + JSON\u6a5f\u80fd\u3092\u6709\u52b9\u5316\n</code></pre>"},{"location":"ja/project/#_5","title":"\u5229\u7528\u53ef\u80fd\u306a\u6a5f\u80fd","text":"<p>\u4ee5\u4e0b\u306f\u3001Qi\u30e9\u30f3\u30bf\u30a4\u30e0\u3067\u5229\u7528\u53ef\u80fd\u306a\u6a5f\u80fd\u30d5\u30e9\u30b0\u306e\u4f8b\u3067\u3059\uff1a</p> Feature \u8aac\u660e <code>http-server</code> HTTP\u30b5\u30fc\u30d0\u30fc\u6a5f\u80fd\uff08<code>server/serve</code>, <code>server/json</code>\u306a\u3069\uff09 <code>http-client</code> HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u6a5f\u80fd\uff08<code>http/get</code>, <code>http/post</code>\u306a\u3069\uff09 <code>format-json</code> JSON\u51e6\u7406\u6a5f\u80fd\uff08<code>json/parse</code>, <code>json/stringify</code>\u306a\u3069\uff09 <code>format-yaml</code> YAML\u51e6\u7406\u6a5f\u80fd\uff08<code>yaml/parse</code>, <code>yaml/stringify</code>\u306a\u3069\uff09 <code>io-file</code> \u30d5\u30a1\u30a4\u30ebI/O\u6a5f\u80fd\uff08<code>io/read-file</code>, <code>io/write-file</code>\u306a\u3069\uff09 <code>io-glob</code> \u30d5\u30a1\u30a4\u30eb\u30b0\u30ed\u30d6\u6a5f\u80fd\uff08<code>io/glob</code>\u306a\u3069\uff09 <code>db-sqlite</code> SQLite\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6a5f\u80fd\uff08\u5c06\u6765\u5b9f\u88c5\u4e88\u5b9a\uff09 <code>concurrency</code> \u4e26\u884c\u51e6\u7406\u6a5f\u80fd\uff08<code>go</code>, <code>chan</code>\u306a\u3069\uff09 <code>std-math</code> \u6570\u5b66\u95a2\u6570\uff08<code>math/rand</code>, <code>math/sqrt</code>\u306a\u3069\uff09 <code>string-encoding</code> \u6587\u5b57\u5217\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\uff08base64, URL\u30a8\u30f3\u30b3\u30fc\u30c9\u306a\u3069\uff09 <p>\u6ce8\u610f: \u6a5f\u80fd\u30d5\u30e9\u30b0\u306f\u73fe\u5728\u306e\u5b9f\u88c5\u3067\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u76ee\u7684\u306e\u307f\u3067\u3001\u5b9f\u884c\u6642\u306e\u52d5\u4f5c\u306b\u306f\u5f71\u97ff\u3057\u307e\u305b\u3093\uff08\u5c06\u6765\u306e\u30d3\u30eb\u30c9\u30b7\u30b9\u30c6\u30e0\u3067\u4f7f\u7528\u4e88\u5b9a\uff09\u3002</p>"},{"location":"ja/project/#_6","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30b7\u30b9\u30c6\u30e0","text":"<p><code>qi new</code>\u30b3\u30de\u30f3\u30c9\u306f\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u7528\u3057\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p>"},{"location":"ja/project/#_7","title":"\u7d44\u307f\u8fbc\u307f\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8","text":""},{"location":"ja/project/#basic","title":"<code>basic</code> (\u30c7\u30d5\u30a9\u30eb\u30c8)","text":"<p>\u57fa\u672c\u7684\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020\u3002</p> <p>\u69cb\u9020: <pre><code>project/\n\u251c\u2500\u2500 qi.toml\n\u251c\u2500\u2500 main.qi\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 lib.qi\n\u251c\u2500\u2500 examples/\n\u2502   \u2514\u2500\u2500 example.qi\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 test.qi\n</code></pre></p> <p>\u7528\u9014: \u30b7\u30f3\u30d7\u30eb\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3084\u30e9\u30a4\u30d6\u30e9\u30ea\u958b\u767a</p>"},{"location":"ja/project/#http-server","title":"<code>http-server</code>","text":"<p>JSON API\u30b5\u30fc\u30d0\u30fc\u3002</p> <p>\u69cb\u9020: <pre><code>project/\n\u251c\u2500\u2500 qi.toml          # features = [\"http-server\", \"format-json\"]\n\u251c\u2500\u2500 main.qi          # \u30b5\u30fc\u30d0\u30fc\u5b9f\u88c5\n\u2514\u2500\u2500 src/\n</code></pre></p> <p>\u7528\u9014: RESTful API\u30b5\u30fc\u30d0\u30fc\u3001Web\u30d0\u30c3\u30af\u30a8\u30f3\u30c9</p> <p>\u7279\u5fb4: - \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u5b9f\u88c5\uff08<code>/</code>, <code>/api/hello</code>, <code>/api/users</code>\uff09 - JSON\u30ec\u30b9\u30dd\u30f3\u30b9 - \u30ea\u30af\u30a8\u30b9\u30c8\u30cf\u30f3\u30c9\u30e9\u30fc\u306e\u4f8b</p>"},{"location":"ja/project/#_8","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u691c\u7d22\u9806\u5e8f","text":"<p>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306f\u4ee5\u4e0b\u306e\u9806\u5e8f\u3067\u691c\u7d22\u3055\u308c\u307e\u3059\uff1a</p> <ol> <li><code>./.qi/templates/&lt;name&gt;/</code> - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb</li> <li><code>~/.qi/templates/&lt;name&gt;/</code> - \u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb</li> <li><code>&lt;qi-binary-dir&gt;/std/templates/&lt;name&gt;/</code> - \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u7248</li> <li><code>std/templates/&lt;name&gt;/</code> - \u958b\u767a\u7248</li> </ol> <p>\u6700\u521d\u306b\u898b\u3064\u304b\u3063\u305f\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/project/#_9","title":"\u30ab\u30b9\u30bf\u30e0\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f5c\u6210","text":"<p>\u72ec\u81ea\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/project/#_10","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u69cb\u9020","text":"<pre><code>~/.qi/templates/my-template/\n\u251c\u2500\u2500 template.toml          # \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\n\u251c\u2500\u2500 qi.toml.template       # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\u251c\u2500\u2500 main.qi.template       # \u30e1\u30a4\u30f3\u30d5\u30a1\u30a4\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 lib.qi.template\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 test.qi.template\n</code></pre>"},{"location":"ja/project/#templatetoml","title":"<code>template.toml</code>","text":"<p>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p> <pre><code>[template]\nname = \"my-template\"\ndescription = \"My custom template\"\nauthor = \"Your Name\"\nversion = \"1.0.0\"\n\n[features]\nrequired = [\"http-server\", \"format-json\"]\n</code></pre>"},{"location":"ja/project/#template","title":"<code>[template]</code> \u30bb\u30af\u30b7\u30e7\u30f3","text":"\u30d5\u30a3\u30fc\u30eb\u30c9 \u5fc5\u9808 \u8aac\u660e <code>name</code> \u2713 \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d <code>description</code> \u2713 \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u8aac\u660e <code>author</code> \u4f5c\u6210\u8005 <code>version</code> \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3"},{"location":"ja/project/#features_1","title":"<code>[features]</code> \u30bb\u30af\u30b7\u30e7\u30f3","text":"\u30d5\u30a3\u30fc\u30eb\u30c9 \u8aac\u660e <code>required</code> \u3053\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u5fc5\u8981\u306a\u6a5f\u80fd\u30d5\u30e9\u30b0\u306e\u30ea\u30b9\u30c8"},{"location":"ja/project/#_11","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u8a18\u6cd5","text":"<p>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u3001\u5909\u6570\u7f6e\u63db\u3068\u6761\u4ef6\u5206\u5c90\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/project/#_12","title":"\u5909\u6570\u7f6e\u63db","text":"<p><code>{{ variable }}</code> \u5f62\u5f0f\u3067\u5909\u6570\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002</p> <p>\u5229\u7528\u53ef\u80fd\u306a\u5909\u6570: - <code>{{ project_name }}</code> - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d - <code>{{ version }}</code> - \u30d0\u30fc\u30b8\u30e7\u30f3 - <code>{{ author }}</code> - \u8457\u8005\u540d - <code>{{ description }}</code> - \u8aac\u660e - <code>{{ license }}</code> - \u30e9\u30a4\u30bb\u30f3\u30b9</p> <p>\u4f8b: <pre><code># qi.toml.template\n[project]\nname = \"{{ project_name }}\"\nversion = \"{{ version }}\"\ndescription = \"{{ description }}\"\n</code></pre></p> <p>\u751f\u6210\u5f8c: <pre><code>[project]\nname = \"my-project\"\nversion = \"0.1.0\"\ndescription = \"My awesome project\"\n</code></pre></p>"},{"location":"ja/project/#_13","title":"\u6761\u4ef6\u5206\u5c90","text":"<p><code>{{ #if variable }}...{{ /if }}</code> \u5f62\u5f0f\u3067\u6761\u4ef6\u5206\u5c90\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <p>\u4f8b: <pre><code># qi.toml.template\n[project]\nname = \"{{ project_name }}\"\nversion = \"{{ version }}\"\n{{ #if author }}authors = [\"{{ author }}\"]{{ /if }}\n{{ #if description }}description = \"{{ description }}\"{{ /if }}\n{{ #if license }}license = \"{{ license }}\"{{ /if }}\nqi-version = \"0.1.0\"\n</code></pre></p> <p>\u5909\u6570\u304c\u7a7a\u306e\u5834\u5408\u3001\u305d\u306e\u884c\u5168\u4f53\u304c\u524a\u9664\u3055\u308c\u307e\u3059\u3002</p> <p>\u751f\u6210\u5f8c\uff08author, description\u304c\u7a7a\u306e\u5834\u5408\uff09: <pre><code>[project]\nname = \"my-project\"\nversion = \"0.1.0\"\nlicense = \"MIT\"\nqi-version = \"0.1.0\"\n</code></pre></p>"},{"location":"ja/project/#_14","title":"\u30d5\u30a1\u30a4\u30eb\u540d\u898f\u5247","text":"<ul> <li><code>.template</code> \u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u3092\u6301\u3064\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u304c\u524a\u9664\u3055\u308c\u3066\u51fa\u529b\u3055\u308c\u307e\u3059</li> <li>\u4f8b: <code>main.qi.template</code> \u2192 <code>main.qi</code></li> <li><code>template.toml</code> \u306f\u30b3\u30d4\u30fc\u3055\u308c\u307e\u305b\u3093</li> </ul>"},{"location":"ja/project/#_15","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u914d\u7f6e","text":""},{"location":"ja/project/#_16","title":"\u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8","text":"<pre><code>mkdir -p ~/.qi/templates/my-template\ncp -r my-template/* ~/.qi/templates/my-template/\n</code></pre>"},{"location":"ja/project/#_17","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8","text":"<pre><code>mkdir -p .qi/templates/my-template\ncp -r my-template/* .qi/templates/my-template/\n</code></pre>"},{"location":"ja/project/#_18","title":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f7f\u7528","text":"<pre><code># \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u4e00\u89a7\u3092\u78ba\u8a8d\nqi template list\n\n# \u30ab\u30b9\u30bf\u30e0\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u7528\nqi new my-project --template my-template\n\n# \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u60c5\u5831\u3092\u78ba\u8a8d\nqi template info my-template\n</code></pre>"},{"location":"ja/project/#cli","title":"\u4f8b: \u30ab\u30b9\u30bf\u30e0CLI\u30c4\u30fc\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8","text":"<p>\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u7528\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u4f8b\uff1a</p>"},{"location":"ja/project/#qitemplatesclimainqitemplate","title":"<code>~/.qi/templates/cli/main.qi.template</code>","text":"<pre><code>;; {{ project_name }} - Command-line tool\n;;\n;; \u4f7f\u3044\u65b9: qi main.qi [OPTIONS] [ARGS]\n\n(println \"=== {{ project_name }} v{{ version }} ===\")\n\n;; \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u306e\u30d1\u30fc\u30b9\n(defn parse-args [args]\n  {:command (first args)\n   :options (rest args)})\n\n;; \u30e1\u30a4\u30f3\u30ed\u30b8\u30c3\u30af\n(defn main [args]\n  (let [parsed (parse-args args)]\n    (match (get parsed :command)\n      \"help\" -&gt; (println \"\u30d8\u30eb\u30d7\u30e1\u30c3\u30bb\u30fc\u30b8\")\n      nil -&gt; (println \"\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\")\n      cmd -&gt; (println f\"\u4e0d\u660e\u306a\u30b3\u30de\u30f3\u30c9: {cmd}\"))))\n\n;; \u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\n(main (get (env) :args []))\n</code></pre>"},{"location":"ja/project/#_19","title":"\u4f7f\u7528\u4f8b","text":"<pre><code># CLI\u30c4\u30fc\u30eb\u3092\u4f5c\u6210\nqi new mytool --template cli\ncd mytool\nqi main.qi help\n</code></pre>"},{"location":"ja/project/#_20","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>CLI \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 - <code>qi</code>\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u3044\u65b9</li> <li>\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb - \u5b9f\u8df5\u7684\u306a\u4f7f\u3044\u65b9</li> <li>\u8a00\u8a9e\u4ed5\u69d8 - Qi\u8a00\u8a9e\u306e\u6587\u6cd5\u3068\u6a5f\u80fd</li> </ul>"},{"location":"ja/style-guide/","title":"Qi Style Guide","text":"<p>Qi\u30b3\u30fc\u30c9\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u898f\u5247\u3068\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u3092\u307e\u3068\u3081\u305f\u30b9\u30bf\u30a4\u30eb\u30ac\u30a4\u30c9\u3067\u3059\u3002</p> <p><code>qi fmt</code>\u30b3\u30de\u30f3\u30c9\u306f\u3001\u3053\u306e\u30ac\u30a4\u30c9\u306b\u57fa\u3065\u3044\u3066\u30b3\u30fc\u30c9\u3092\u81ea\u52d5\u6574\u5f62\u3057\u307e\u3059\u3002</p>"},{"location":"ja/style-guide/#_1","title":"\u76ee\u6b21","text":"<ol> <li>\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30eb\u30fc\u30eb</li> <li>\u547d\u540d\u898f\u5247</li> <li>\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9</li> <li>\u30a2\u30f3\u30c1\u30d1\u30bf\u30fc\u30f3</li> <li>\u30d5\u30a9\u30fc\u30de\u30c3\u30bf\u30fc\u8a2d\u5b9a</li> </ol>"},{"location":"ja/style-guide/#1","title":"1. \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30eb\u30fc\u30eb","text":""},{"location":"ja/style-guide/#11","title":"1.1 \u30a4\u30f3\u30c7\u30f3\u30c8","text":"<p>2\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u30bf\u30d6\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(defn factorial [n]\n  (if (&lt;= n 1)\n    1\n    (* n (factorial (- n 1)))))\n\n;; \u274c \u60aa\u3044\u4f8b\uff084\u30b9\u30da\u30fc\u30b9\uff09\n(defn factorial [n]\n    (if (&lt;= n 1)\n        1\n        (* n (factorial (- n 1)))))\n</code></pre>"},{"location":"ja/style-guide/#12","title":"1.2 \u884c\u306e\u9577\u3055","text":"<p>\u6700\u5927100\u6587\u5b57\u3092\u63a8\u5968\u3057\u307e\u3059\u3002</p> <pre><code>;; \u2705 100\u6587\u5b57\u4ee5\u5185\n(some-function arg1 arg2 arg3 arg4 arg5)\n\n;; \u2705 \u8d85\u3048\u308b\u5834\u5408\u306f\u6539\u884c\n(some-very-long-function-name-that-would-exceed-the-limit\n  arg1\n  arg2\n  arg3)\n</code></pre>"},{"location":"ja/style-guide/#13","title":"1.3 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u306f\u5148\u982d\u306b\u914d\u7f6e\u3057\u3001\u5404\u30b9\u30c6\u30c3\u30d7\u3092\u6539\u884c\u3057\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(data\n  |&gt; validate\n  |&gt; transform\n  |&gt; (filter active?)\n  |&gt; (map format)\n  |&gt; save)\n\n;; \u2705 \u77ed\u3044\u5834\u5408\u306f1\u884c\u3067\u3082OK\n(\"hello\" |&gt; str/upper |&gt; str/reverse)\n\n;; \u274c \u60aa\u3044\u4f8b\uff08\u6f14\u7b97\u5b50\u304c\u672b\u5c3e\uff09\n(data |&gt;\n  validate |&gt;\n  transform |&gt;\n  save)\n</code></pre>"},{"location":"ja/style-guide/#_2","title":"\u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 (<code>||&gt;</code>)","text":"<pre><code>(data\n  ||&gt; process1\n  ||&gt; process2\n  ||&gt; process3\n  |&gt; collect-results)\n</code></pre>"},{"location":"ja/style-guide/#14","title":"1.4 \u7279\u6b8a\u5f62\u5f0f","text":""},{"location":"ja/style-guide/#let","title":"<code>let</code>","text":"<p>\u675f\u7e1b\u3068\u30dc\u30c7\u30a3\u3092\u660e\u78ba\u306b\u5206\u96e2\u3057\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(let [x 10\n      y 20\n      sum (+ x y)]\n  (* sum 2))\n\n;; \u2705 \u8907\u96d1\u306a\u675f\u7e1b\n(let [user (get-user id)\n      profile (get-profile user)\n      settings (get-settings user)]\n  (render-page user profile settings))\n</code></pre>"},{"location":"ja/style-guide/#if","title":"<code>if</code>","text":"<p>\u6761\u4ef6\u3001then\u7bc0\u3001else\u7bc0\u3092\u63c3\u3048\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u5358\u7d14\u306a\u5834\u5408\n(if (&gt; x 10)\n  \"big\"\n  \"small\")\n\n;; \u2705 \u8907\u96d1\u306a\u5834\u5408\n(if (and (valid? user)\n         (active? user)\n         (authorized? user))\n  (process-request user)\n  (reject-request user))\n</code></pre>"},{"location":"ja/style-guide/#do","title":"<code>do</code>","text":"<p>\u5404\u5f0f\u3092\u540c\u3058\u30a4\u30f3\u30c7\u30f3\u30c8\u3067\u63c3\u3048\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(do\n  (log/info \"Starting process\")\n  (initialize-resources)\n  (execute-main-task)\n  (cleanup-resources)\n  (log/info \"Process completed\"))\n</code></pre>"},{"location":"ja/style-guide/#match","title":"<code>match</code>","text":"<p>\u30d1\u30bf\u30fc\u30f3\u3068\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u9593\u306b\u4e21\u5074\u30b9\u30da\u30fc\u30b9\u3092\u5165\u308c\u305f<code>-&gt;</code>\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(match value\n  nil -&gt; \"empty\"\n  0 -&gt; \"zero\"\n  n when (&gt; n 0) -&gt; \"positive\"\n  _ -&gt; \"negative\")\n\n;; \u2705 \u8907\u96d1\u306a\u30d1\u30bf\u30fc\u30f3\n(match [x y]\n  [0 0] -&gt; \"origin\"\n  [0 _] -&gt; \"y-axis\"\n  [_ 0] -&gt; \"x-axis\"\n  [x y] -&gt; f\"point ({x}, {y})\")\n\n;; \u2705 or\u30d1\u30bf\u30fc\u30f3\n(match status\n  :pending | :processing -&gt; \"in-progress\"\n  :completed | :success -&gt; \"done\"\n  :failed | :error -&gt; \"error\")\n\n;; \u2705 \u9577\u3044\u30a2\u30af\u30b7\u30e7\u30f3\n(match status\n  :pending -&gt; (do\n                (log/info \"Processing request\")\n                (process-request req))\n  :completed -&gt; (notify-user user)\n  :failed -&gt; (retry-with-backoff req))\n</code></pre>"},{"location":"ja/style-guide/#15","title":"1.5 \u95a2\u6570\u547c\u3073\u51fa\u3057","text":""},{"location":"ja/style-guide/#_3","title":"\u77ed\u3044\u5f15\u6570","text":"<pre><code>(+ 1 2 3)\n(str/upper \"hello\")\n(map inc [1 2 3])\n</code></pre>"},{"location":"ja/style-guide/#_4","title":"\u9577\u3044\u5f15\u6570","text":"<pre><code>;; \u2705 \u5404\u5f15\u6570\u3092\u6539\u884c\n(create-user\n  \"alice\"\n  \"alice@example.com\"\n  30\n  \"123 Main St\")\n\n;; \u2705 \u95a2\u6570\u5b9a\u7fa9\u3082\u540c\u69d8\n(defn process-user [username\n                    email\n                    age\n                    address]\n  ...)\n</code></pre>"},{"location":"ja/style-guide/#16","title":"1.6 \u30c7\u30fc\u30bf\u69cb\u9020","text":""},{"location":"ja/style-guide/#_5","title":"\u30d9\u30af\u30bf <code>[]</code>","text":"<pre><code>;; \u2705 \u77ed\u3044\u5834\u5408\n[1 2 3 4 5]\n\n;; \u2705 \u9577\u3044\u5834\u5408\n[first-element\n second-element\n third-element\n fourth-element]\n\n;; \u2705 \u5165\u308c\u5b50\n[[1 2 3]\n [4 5 6]\n [7 8 9]]\n</code></pre>"},{"location":"ja/style-guide/#_6","title":"\u30de\u30c3\u30d7 <code>{}</code>","text":"<p>\u30ad\u30fc\u3068\u5024\u3092\u7e26\u306b\u63c3\u3048\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u57fa\u672c\u5f62\n{:name \"Alice\"\n :age 30\n :email \"alice@example.com\"}\n\n;; \u2705 \u77ed\u3044\u5834\u5408\u306f1\u884c\u3067\u3082OK\n{:x 10 :y 20}\n\n;; \u2705 \u5165\u308c\u5b50\n{:user {:name \"Alice\"\n        :age 30\n        :email \"alice@example.com\"}\n :status :active\n :created-at \"2025-01-13\"}\n</code></pre>"},{"location":"ja/style-guide/#_7","title":"\u30ea\u30b9\u30c8 <code>()</code>","text":"<pre><code>'(1 2 3 4 5)\n\n'(first-item\n  second-item\n  third-item)\n</code></pre>"},{"location":"ja/style-guide/#17","title":"1.7 \u6587\u5b57\u5217","text":""},{"location":"ja/style-guide/#_8","title":"\u901a\u5e38\u306e\u6587\u5b57\u5217","text":"<pre><code>\"Hello, World!\"\n\n;; \u2705 \u9577\u3044\u6587\u5b57\u5217\u306f\u8907\u6570\u884c\u6587\u5b57\u5217\u3092\u4f7f\u7528\n\"\"\"\nThis is a very long string that spans multiple lines.\nYou can write it naturally without worrying about line breaks.\n\"\"\"\n</code></pre>"},{"location":"ja/style-guide/#f-string","title":"F-string","text":"<p>\u88dc\u9593\u90e8\u5206\u306f\u305d\u306e\u307e\u307e\u4fdd\u6301\u3057\u307e\u3059\u3002</p> <pre><code>;; \u2705 1\u884c\n(println f\"Hello, {name}! You are {age} years old.\")\n\n;; \u2705 \u8907\u6570\u884c\n(println f\"\"\"\n  Dear {name},\n\n  Your account balance is {balance}.\n  Thank you for using our service.\n  \"\"\")\n</code></pre> <p><code>qi fmt</code> \u306f\u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb\u306e\u6539\u884c\u30fb\u30af\u30a9\u30fc\u30c8\u30fb\u30a8\u30b9\u30b1\u30fc\u30d7\u8868\u73fe\u3092\u518d\u69cb\u6210\u305b\u305a\u3001\u5165\u529b\u6642\u306e\u5f62\u3092\u5c0a\u91cd\u3057\u307e\u3059\u3002</p>"},{"location":"ja/style-guide/#18","title":"1.8 \u30b3\u30e1\u30f3\u30c8","text":""},{"location":"ja/style-guide/#_9","title":"\u884c\u30b3\u30e1\u30f3\u30c8","text":"<pre><code>;; \u2705 \u30c8\u30c3\u30d7\u30ec\u30d9\u30eb: \u30bb\u30df\u30b3\u30ed\u30f32\u3064\n;; This is a top-level comment\n;; explaining the following code.\n\n(def x 10)\n\n;; \u2705 \u30a4\u30f3\u30e9\u30a4\u30f3: \u30bb\u30df\u30b3\u30ed\u30f31\u3064\uff08\u524d\u306b2\u30b9\u30da\u30fc\u30b9\uff09\n(def x 10)  ; This is an inline comment\n</code></pre> <p>\u30b3\u30e1\u30f3\u30c8\u306f\u524a\u9664\u30fb\u7d50\u5408\u3055\u308c\u307e\u305b\u3093\u3002\u5fc5\u8981\u306a\u8aac\u660e\u306f\u5b89\u5fc3\u3057\u3066\u66f8\u304d\u6b8b\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/style-guide/#_10","title":"\u30bb\u30af\u30b7\u30e7\u30f3\u533a\u5207\u308a","text":"<pre><code>;; ========================================\n;; Data Processing Functions\n;; ========================================\n\n(defn process-data [data]\n  ...)\n\n(defn transform-data [data]\n  ...)\n\n\n;; ========================================\n;; Helper Functions\n;; ========================================\n\n(defn helper-1 []\n  ...)\n</code></pre>"},{"location":"ja/style-guide/#19","title":"1.9 \u7a7a\u884c","text":""},{"location":"ja/style-guide/#102","title":"\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u5b9a\u7fa9\u306e\u9593: \u63a8\u59681\u884c\uff080\u301c2\u884c\u8a31\u5bb9\uff09","text":"<p>\u901a\u5e38\u306f 1 \u884c\u306e\u7a7a\u884c\u3067\u533a\u5207\u308a\u307e\u3059\u304c\u3001\u8aad\u307f\u3084\u3059\u3055\u306e\u305f\u3081\u306b 0\u301c2 \u884c\u306e\u7bc4\u56f2\u3067\u8abf\u6574\u3057\u3066\u69cb\u3044\u307e\u305b\u3093\u3002</p> <pre><code>(def x 10)\n\n(def y 20)\n\n(def config\n  {:host \"localhost\"\n   :port 8080})\n</code></pre>"},{"location":"ja/style-guide/#def-defn-defn-1","title":"<code>def</code> / <code>defn</code> / <code>defn-</code> \u306e\u524d: \u5fc5\u305a1\u884c\u7a7a\u3051\u308b\uff08\u30b3\u30e1\u30f3\u30c8\u306f\u9664\u5916\uff09","text":"<p>\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u306e\u5b9a\u7fa9\u30d5\u30a9\u30fc\u30e0\uff08<code>def</code>\u3001<code>defn</code>\u3001<code>defn-</code>\uff09\u306e\u76f4\u524d\u306b\u306f\u6700\u4f4e 1 \u884c\u306e\u7a7a\u884c\u3092\u5165\u308c\u3066\u30d6\u30ed\u30c3\u30af\u3092\u660e\u78ba\u306b\u3057\u307e\u3059\u3002\u8aac\u660e\u7528\u30b3\u30e1\u30f3\u30c8\u3092\u76f4\u524d\u306b\u7f6e\u304f\u5834\u5408\u306f\u3001\u305d\u306e\u30b3\u30e1\u30f3\u30c8\u306b\u7d9a\u3051\u3066\u5b9a\u7fa9\u3092\u66f8\u3044\u3066\u69cb\u3044\u307e\u305b\u3093\u3002</p> <pre><code>(def cache (atom {}))\n\n(defn clear-cache []\n  ...)\n\n;; kick entry point\n(defn main []\n  ...)\n\n;; internal helper\n;; \u30b3\u30e1\u30f3\u30c8\u306e\u76f4\u5f8c\u306b defn- \u3092\u66f8\u3044\u3066\u3082\u826f\u3044\n(defn- build-index [entries]\n  ...)\n</code></pre>"},{"location":"ja/style-guide/#2","title":"\u30bb\u30af\u30b7\u30e7\u30f3\u533a\u5207\u308a: 2\u884c","text":"<pre><code>(defn helper-1 [] ...)\n(defn helper-2 [] ...)\n\n\n;; ========================================\n;; Public API\n;; ========================================\n\n(defn public-api-1 [] ...)\n(defn public-api-2 [] ...)\n</code></pre>"},{"location":"ja/style-guide/#110","title":"1.10 \u30e2\u30b8\u30e5\u30fc\u30eb\u30b7\u30b9\u30c6\u30e0","text":""},{"location":"ja/style-guide/#use","title":"<code>use</code>\u5ba3\u8a00","text":"<pre><code>;; \u2705 \u77ed\u3044\u5834\u5408\n(use str :as s)\n(use list :only [map filter reduce])\n\n;; \u2705 \u9577\u3044\u5834\u5408\n(use http\n  :only [get post put delete\n         request with-headers\n         json xml])\n\n;; \u2705 \u8907\u6570\u306euse\uff08\u30d5\u30a1\u30a4\u30eb\u5192\u982d\u306b\u307e\u3068\u3081\u308b\uff09\n(use str :as s)\n(use list :as l)\n(use io :only [read-file write-file])\n(use http :only [get post])\n</code></pre>"},{"location":"ja/style-guide/#export","title":"<code>export</code>\u5ba3\u8a00","text":"<pre><code>;; \u2705 \u77ed\u3044\u5834\u5408\n(export [func1 func2 func3])\n\n;; \u2705 \u9577\u3044\u5834\u5408\n(export\n  [public-api-1\n   public-api-2\n   public-api-3\n   helper-function\n   utility-function])\n</code></pre>"},{"location":"ja/style-guide/#111","title":"1.11 \u30d5\u30a9\u30fc\u30de\u30c3\u30bf\u30fc\u30dd\u30ea\u30b7\u30fc","text":"<p>Qi \u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30bf\u306f\u300c\u30b3\u30fc\u30c9\u306e\u610f\u5473\u3092\u5909\u3048\u305a\u3001\u4f5c\u8005\u304c\u610f\u56f3\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u8868\u73fe\u3092\u5c0a\u91cd\u3059\u308b\u300d\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u307e\u3059\u3002</p> <ul> <li>\u30b3\u30e1\u30f3\u30c8\u3084\u7a7a\u767d\u306f\u524a\u9664\u30fb\u7d50\u5408\u305b\u305a\u3001\u8a2d\u5b9a\u7bc4\u56f2\u5185\u3067\u6700\u5c0f\u9650\u306e\u8abf\u6574\u306b\u3068\u3069\u3081\u308b</li> <li>\u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb\u306e\u518d\u30a8\u30b9\u30b1\u30fc\u30d7\u3084\u6b63\u898f\u5316\u306f\u884c\u308f\u306a\u3044</li> <li>\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u5b9a\u7fa9\u306e\u533a\u5207\u308a\u306f <code>.qi-format.edn</code> \u306e <code>blank-lines-between-defs</code> \u3092\u57fa\u6e96\u306b\u6b63\u898f\u5316\u3059\u308b</li> <li><code>def</code>/<code>defn</code>/<code>defn-</code> \u306e\u76f4\u524d\u306b\u306f\u6700\u4f4e 1 \u884c\u306e\u7a7a\u884c\u3092\u78ba\u4fdd\u3057\u3001\u30b3\u30e1\u30f3\u30c8\u76f4\u5f8c\u306e\u5b9a\u7fa9\u3092\u8a31\u5bb9\u3059\u308b</li> <li>\u30ac\u30a4\u30c9\u672a\u5b9a\u7fa9\u306e\u30b1\u30fc\u30b9\u306f\u65e2\u5b58\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u53ef\u80fd\u306a\u9650\u308a\u4fdd\u6301\u3057\u3001\u5c06\u6765\u7684\u306b\u30eb\u30fc\u30eb\u3092\u8ffd\u52a0\u3059\u308b</li> </ul>"},{"location":"ja/style-guide/#2_1","title":"2. \u547d\u540d\u898f\u5247","text":""},{"location":"ja/style-guide/#21","title":"2.1 \u95a2\u6570\u540d","text":"<p>\u30b1\u30d0\u30d6\u30b1\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(defn get-user [id] ...)\n(defn process-payment [amount] ...)\n(defn calculate-total-price [items] ...)\n\n;; \u274c \u60aa\u3044\u4f8b\n(defn getUser [id] ...)          ; camelCase\n(defn process_payment [amount] ...) ; snake_case\n</code></pre>"},{"location":"ja/style-guide/#22","title":"2.2 \u8ff0\u8a9e\u95a2\u6570","text":"<p>\u672b\u5c3e\u306b<code>?</code>\u3092\u4ed8\u3051\u307e\u3059\u3002</p> <pre><code>(defn active? [user] ...)\n(defn valid-email? [email] ...)\n(defn empty? [coll] ...)\n</code></pre>"},{"location":"ja/style-guide/#23","title":"2.3 \u7834\u58ca\u7684\u64cd\u4f5c","text":"<p>\u672b\u5c3e\u306b<code>!</code>\u3092\u4ed8\u3051\u307e\u3059\u3002</p> <pre><code>(defn send! [chan value] ...)\n(defn reset! [atom value] ...)\n(defn swap! [atom f] ...)\n</code></pre>"},{"location":"ja/style-guide/#24","title":"2.4 \u5909\u6570\u540d","text":"<p>\u30b1\u30d0\u30d6\u30b1\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(def max-connections 100)\n(def api-base-url \"https://api.example.com\")\n(let [user-id 123\n      user-name \"alice\"]\n  ...)\n</code></pre>"},{"location":"ja/style-guide/#25","title":"2.5 \u5b9a\u6570","text":"<p>\u901a\u5e38\u306e\u5909\u6570\u3068\u540c\u3058\u30b1\u30d0\u30d6\u30b1\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(def pi 3.14159)\n(def max-retry-count 3)\n(def default-timeout 30000)\n</code></pre>"},{"location":"ja/style-guide/#26","title":"2.6 \u30ad\u30fc\u30ef\u30fc\u30c9","text":"<p>\u30b1\u30d0\u30d6\u30b1\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>{:user-id 123\n :user-name \"alice\"\n :created-at \"2025-01-13\"}\n</code></pre>"},{"location":"ja/style-guide/#27","title":"2.7 \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u95a2\u6570","text":"<p><code>defn-</code>\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(defn- internal-helper [x]\n  \"\u30e2\u30b8\u30e5\u30fc\u30eb\u5185\u3067\u306e\u307f\u4f7f\u7528\"\n  (* x 2))\n\n(defn public-api [x]\n  \"\u5916\u90e8\u306b\u516c\u958b\"\n  (internal-helper x))\n</code></pre>"},{"location":"ja/style-guide/#3","title":"3. \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/style-guide/#31","title":"3.1 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u6d3b\u7528\u3059\u308b","text":"<pre><code>;; \u2705 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(data\n  |&gt; validate\n  |&gt; transform\n  |&gt; save)\n\n;; \u274c \u30cd\u30b9\u30c8\u3057\u305f\u95a2\u6570\u547c\u3073\u51fa\u3057\n(save (transform (validate data)))\n</code></pre>"},{"location":"ja/style-guide/#32-match","title":"3.2 match\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3092\u4f7f\u3046","text":"<pre><code>;; \u2705 match\n(match value\n  nil -&gt; \"empty\"\n  [x] -&gt; f\"single: {x}\"\n  [x ...rest] -&gt; f\"multiple\")\n\n;; \u274c \u8907\u96d1\u306aif-else\n(if (nil? value)\n  \"empty\"\n  (if (= (count value) 1)\n    f\"single: {(first value)}\"\n    \"multiple\"))\n</code></pre>"},{"location":"ja/style-guide/#33","title":"3.3 \u5206\u89e3\u3092\u6d3b\u7528\u3059\u308b","text":"<pre><code>;; \u2705 let\u5206\u89e3\n(let [{:name n :age a} user]\n  (println f\"{n} is {a} years old\"))\n\n;; \u2705 \u95a2\u6570\u5f15\u6570\u5206\u89e3\n(defn greet [{:name n}]\n  (println f\"Hello, {n}!\"))\n\n;; \u2705 match\u5206\u89e3\n(match coords\n  [x y] -&gt; (+ x y))\n</code></pre>"},{"location":"ja/style-guide/#34-use","title":"3.4 use\u3067\u540d\u524d\u7a7a\u9593\u3092\u6574\u7406","text":"<pre><code>;; \u2705 \u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u4f7f\u7528\n(use str :as s)\n(s/upper \"hello\")\n\n;; \u2705 \u5fc5\u8981\u306a\u95a2\u6570\u306e\u307f\u30a4\u30f3\u30dd\u30fc\u30c8\n(use list :only [map filter reduce])\n</code></pre>"},{"location":"ja/style-guide/#35","title":"3.5 \u65e9\u671f\u30ea\u30bf\u30fc\u30f3\u3092\u6d3b\u7528","text":"<pre><code>;; \u2705 \u30ac\u30fc\u30c9\u7bc0\n(defn process [data]\n  (if (nil? data)\n    nil\n    (do\n      (validate data)\n      (transform data))))\n\n;; \u2705 match\u3067\u306e\u65e9\u671f\u30ea\u30bf\u30fc\u30f3\n(match status\n  :invalid -&gt; nil\n  :pending -&gt; (process-pending)\n  :completed -&gt; result)\n</code></pre>"},{"location":"ja/style-guide/#36-f-string","title":"3.6 f-string\u3092\u6d3b\u7528","text":"<pre><code>;; \u2705 f-string\n(println f\"User {name} has {count} items\")\n\n;; \u274c str\u9023\u7d50\n(println (str \"User \" name \" has \" count \" items\"))\n</code></pre>"},{"location":"ja/style-guide/#4","title":"4. \u30a2\u30f3\u30c1\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"ja/style-guide/#41","title":"4.1 \u6df1\u3044\u30cd\u30b9\u30c8","text":"<pre><code>;; \u274c \u6df1\u3044\u30cd\u30b9\u30c8\n(if condition1\n  (if condition2\n    (if condition3\n      (do-something)\n      default)\n    default)\n  default)\n\n;; \u2705 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3084match\n(value\n  |&gt;? validate1\n  |&gt;? validate2\n  |&gt;? validate3\n  |&gt;? do-something)\n</code></pre>"},{"location":"ja/style-guide/#42","title":"4.2 \u9577\u3059\u304e\u308b\u95a2\u6570","text":"<pre><code>;; \u274c 100\u884c\u3092\u8d85\u3048\u308b\u95a2\u6570\n(defn huge-function [...]\n  ;; 100+ lines\n  )\n\n;; \u2705 \u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u5272\n(defn- step1 [x] ...)\n(defn- step2 [x] ...)\n(defn main-function [x]\n  (x |&gt; step1 |&gt; step2))\n</code></pre>"},{"location":"ja/style-guide/#43","title":"4.3 \u30b0\u30ed\u30fc\u30d0\u30eb\u72b6\u614b\u306e\u4e71\u7528","text":"<pre><code>;; \u274c \u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u306e\u76f4\u63a5\u5909\u66f4\n(def counter 0)\n(defn increment [] (set! counter (+ counter 1)))\n\n;; \u2705 atom\u3092\u4f7f\u7528\n(def counter (atom 0))\n(defn increment [] (swap! counter inc))\n</code></pre>"},{"location":"ja/style-guide/#44","title":"4.4 \u610f\u5473\u306e\u306a\u3044\u5909\u6570\u540d","text":"<pre><code>;; \u274c \u60aa\u3044\u4f8b\n(defn f [x y z] ...)\n(let [a 1 b 2] ...)\n\n;; \u2705 \u826f\u3044\u4f8b\n(defn calculate-total [price quantity tax] ...)\n(let [user-id 1 user-name \"alice\"] ...)\n</code></pre>"},{"location":"ja/style-guide/#5","title":"5. \u30d5\u30a9\u30fc\u30de\u30c3\u30bf\u30fc\u8a2d\u5b9a","text":""},{"location":"ja/style-guide/#51","title":"5.1 \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a","text":"<pre><code>;; .qi-format.edn\n{:indent-width 2\n :max-line-length 100\n :pipeline-newline true\n :pipeline-operator-position :leading\n :match-arrow-spacing :both\n :align-map-values true\n :sort-use-declarations false\n :blank-lines-between-defs 1\n :blank-lines-between-sections 2}\n</code></pre>"},{"location":"ja/style-guide/#52","title":"5.2 \u8a2d\u5b9a\u9805\u76ee","text":"\u9805\u76ee \u30c7\u30d5\u30a9\u30eb\u30c8 \u8aac\u660e <code>indent-width</code> <code>2</code> \u30a4\u30f3\u30c7\u30f3\u30c8\u5e45\uff08\u30b9\u30da\u30fc\u30b9\u6570\uff09 <code>max-line-length</code> <code>100</code> \u6700\u5927\u884c\u5e45\uff08\u6587\u5b57\u6570\uff09 <code>pipeline-newline</code> <code>true</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u6539\u884c\u3059\u308b\u304b <code>pipeline-operator-position</code> <code>:leading</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u306e\u4f4d\u7f6e\uff08<code>:leading</code> or <code>:trailing</code>\uff09 <code>match-arrow-spacing</code> <code>:both</code> match\u30a2\u30ed\u30fc\u306e\u30b9\u30da\u30fc\u30b9\uff08<code>:both</code>, <code>:before</code>, <code>:after</code>, <code>:none</code>\uff09 <code>align-map-values</code> <code>true</code> \u30de\u30c3\u30d7\u306e\u5024\u3092\u63c3\u3048\u308b\u304b <code>sort-use-declarations</code> <code>false</code> use\u5ba3\u8a00\u3092\u30bd\u30fc\u30c8\u3059\u308b\u304b <code>blank-lines-between-defs</code> <code>1</code> \u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u5b9a\u7fa9\u9593\u306e\u7a7a\u884c\u3092 0\u301c2 \u884c\u306e\u7bc4\u56f2\u3067\u6b63\u898f\u5316\uff08<code>def</code>/<code>defn</code>/<code>defn-</code> \u524d\u306f\u6700\u4f4e 1 \u884c\u78ba\u4fdd\uff09 <code>blank-lines-between-sections</code> <code>2</code> \u30bb\u30af\u30b7\u30e7\u30f3\u9593\u306e\u7a7a\u884c\u6570 <p>\u73fe\u884c\u30b9\u30bf\u30a4\u30eb\u30ac\u30a4\u30c9\u306e\u5024\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3059\u304c\u3001\u30c1\u30fc\u30e0\u30dd\u30ea\u30b7\u30fc\u306b\u5408\u308f\u305b\u3066 <code>.qi-format.edn</code> \u3067\u4e0a\u66f8\u304d\u3057\u3066\u3082\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002</p> <p><code>.qi-format.edn</code> \u306f\u30d5\u30a9\u30fc\u30e0\u3092\u542b\u3080\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u307e\u305f\u306f\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30eb\u30fc\u30c8\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306a EDN \u30de\u30c3\u30d7\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\uff1a</p> <pre><code>{:indent-width 2\n :blank-lines-between-defs 1\n :max-line-length 100}\n</code></pre> <p>\u6570\u5024\u4ee5\u5916\u306e\u5024\u3084\u672a\u5bfe\u5fdc\u30ad\u30fc\u306f\u7121\u8996\u3055\u308c\u3001\u30d1\u30fc\u30b5\u30fc\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u5834\u5408\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3057\u307e\u3059\u3002</p>"},{"location":"ja/style-guide/#53","title":"5.3 \u4f7f\u7528\u65b9\u6cd5","text":"<pre><code># \u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\uff08\u4e0a\u66f8\u304d\uff09\nqi fmt src/main.qi\n\n# \u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\uff08\u6a19\u6e96\u51fa\u529b\uff09\nqi fmt --check src/main.qi\n\n# \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u518d\u5e30\u7684\u306b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\nqi fmt src/\n\n# \u6a19\u6e96\u5165\u529b\u304b\u3089\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\ncat src/main.qi | qi fmt --stdin\n</code></pre>"},{"location":"ja/style-guide/#54","title":"5.4 \u30d5\u30a9\u30fc\u30de\u30c3\u30bf\u30fc\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8","text":"<p><code>qi fmt</code> \u306f\u4ee5\u4e0b\u306e\u30dd\u30a4\u30f3\u30c8\u3092\u6e80\u305f\u3059\u3088\u3046\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\uff08\u8a2d\u5b9a\u5024\u3067\u6319\u52d5\u304c\u5909\u5316\u3059\u308b\u3082\u306e\u306f <code>.qi-format.edn</code> \u53c2\u7167\uff09\u3002</p> <ul> <li>\u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb\u306e\u6539\u884c\u30fb\u30af\u30a9\u30fc\u30c8\u30fb\u30a8\u30b9\u30b1\u30fc\u30d7\u8868\u73fe\u306f\u5165\u529b\u3092\u5c0a\u91cd\u3057\u518d\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u306a\u3044</li> <li>\u30b3\u30e1\u30f3\u30c8\u3092\u524a\u9664\u30fb\u7d50\u5408\u305b\u305a\u3001\u610f\u5473\u3092\u58ca\u3055\u306a\u3044\u7bc4\u56f2\u3067\u4f4d\u7f6e\u3092\u7dad\u6301\u3059\u308b</li> <li><code>blank-lines-between-defs</code> \u306b\u5f93\u3063\u3066\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u5b9a\u7fa9\u9593\u306e\u7a7a\u884c\u6570\u3092 0\u301c2 \u884c\u306b\u6b63\u898f\u5316\u3059\u308b</li> <li><code>def</code>/<code>defn</code>/<code>defn-</code> \u76f4\u524d\u306b\u306f\u6700\u4f4e 1 \u884c\u306e\u7a7a\u884c\u3092\u78ba\u4fdd\u3057\u3001\u76f4\u524d\u30b3\u30e1\u30f3\u30c8\u3092\u8a31\u5bb9\u3059\u308b</li> <li>\u672c\u30ac\u30a4\u30c9\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u30ec\u30a4\u30a2\u30a6\u30c8\u306f\u3001\u65e2\u5b58\u306e\u69cb\u9020\u3092\u6975\u529b\u4fdd\u6301\u3059\u308b</li> </ul>"},{"location":"ja/style-guide/#_11","title":"\u53c2\u8003","text":"<p>\u3053\u306e\u30b9\u30bf\u30a4\u30eb\u30ac\u30a4\u30c9\u306f\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ul> <li>Clojure Style Guide</li> <li>Rust Style Guide</li> <li>Elixir Style Guide</li> </ul>"},{"location":"ja/style-guide/#_12","title":"\u30e9\u30a4\u30bb\u30f3\u30b9","text":"<p>MIT</p>"},{"location":"ja/spec/","title":"Qi\u8a00\u8a9e\u4ed5\u69d8\u66f8","text":"<p>Qi\u306e\u5b8c\u5168\u306a\u8a00\u8a9e\u4ed5\u69d8\u3068\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9</p> <p>\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3001Qi\u8a00\u8a9e\u306e\u5b9f\u88c5\u6e08\u307f\u6a5f\u80fd\u306e\u307f\u3092\u8a18\u8f09\u3057\u305f\u4ed5\u69d8\u66f8\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/#_1","title":"\ud83d\udcda \u76ee\u6b21","text":"<p>\u26a1 \u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8: \u30af\u30a4\u30c3\u30af\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 - 1\u30da\u30fc\u30b8\u3067Qi\u306e\u57fa\u672c\u3092\u5b66\u3076</p>"},{"location":"ja/spec/#_2","title":"\u30b3\u30a2\u6a5f\u80fd\uff08\u2605\u30a6\u30ea\uff09","text":"<ul> <li>02-flow-pipes.md - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3068\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc \u2b50</li> <li><code>|&gt;</code>, <code>||&gt;</code>, <code>|&gt;?</code>, <code>tap&gt;</code>, <code>~&gt;</code> \u6f14\u7b97\u5b50</li> <li>stream\uff08\u9045\u5ef6\u8a55\u4fa1\uff09</li> <li> <p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b</p> </li> <li> <p>03-concurrency.md - \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406 \u2b50</p> </li> <li>go/chan\uff08goroutine\u98a8\uff09</li> <li>async/await\u3001pmap\u3001pipeline</li> <li> <p>Atom\uff08\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406\uff09</p> </li> <li> <p>04-match.md - \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 \u2b50</p> </li> <li>\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u5206\u89e3</li> <li>\u30ac\u30fc\u30c9\u6761\u4ef6\u3001or\u30d1\u30bf\u30fc\u30f3</li> <li>Railway Oriented Programming</li> </ul>"},{"location":"ja/spec/#_3","title":"\u57fa\u672c","text":"<ul> <li>01-overview.md - Qi\u306e\u6982\u8981</li> <li>\u8a00\u8a9e\u54f2\u5b66\uff08Flow-Oriented Programming\uff09</li> <li>\u8a2d\u8a08\u539f\u5247</li> <li> <p>\u57fa\u672c\u8a2d\u8a08</p> </li> <li> <p>05-syntax-basics.md - \u57fa\u672c\u69cb\u6587</p> </li> <li>\u30c7\u30fc\u30bf\u578b\u3001\u30ea\u30c6\u30e9\u30eb\u3001\u30b3\u30e1\u30f3\u30c8</li> <li>\u7279\u6b8a\u5f62\u5f0f\uff08def\u3001fn\u3001let\u3001do\u3001if\u3001match\u3001loop/recur\u3001when\u3001while\u3001until\u3001while-some\u3001until-error\uff09</li> <li> <p>\u6f14\u7b97\u5b50</p> </li> <li> <p>06-data-structures.md - \u30c7\u30fc\u30bf\u69cb\u9020</p> </li> <li>\u30d9\u30af\u30bf\u30fc\u3001\u30ea\u30b9\u30c8\u3001\u30de\u30c3\u30d7\u3001\u30bb\u30c3\u30c8</li> <li>\u9ad8\u968e\u95a2\u6570\uff08map\u3001filter\u3001reduce\u3001each\uff09</li> <li> <p>\u30bd\u30fc\u30c8\u3001\u30b0\u30eb\u30fc\u30d7\u5316</p> </li> <li> <p>07-functions.md - \u95a2\u6570</p> </li> <li>\u95a2\u6570\u5b9a\u7fa9\uff08fn\u3001defn\uff09</li> <li>\u30af\u30ed\u30fc\u30b8\u30e3</li> <li> <p>\u9ad8\u968e\u95a2\u6570\uff08comp\u3001partial\u3001apply\u3001identity\uff09</p> </li> <li> <p>08-error-handling.md - \u30a8\u30e9\u30fc\u51e6\u7406</p> </li> <li>Result\u578b\uff08\u5024 / <code>{:error ...}</code>\uff09- validation\u5c02\u7528\u3067<code>{:ok value}</code>\u5f62\u5f0f\u3082\u30b5\u30dd\u30fc\u30c8</li> <li>try/catch</li> <li> <p>defer\uff08\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\uff09</p> </li> <li> <p>09-modules.md - \u30e2\u30b8\u30e5\u30fc\u30eb\u30b7\u30b9\u30c6\u30e0</p> </li> <li>module\u5ba3\u8a00\u3001export</li> <li>use\u3001load</li> <li>\u540d\u524d\u7a7a\u9593\u7ba1\u7406</li> </ul>"},{"location":"ja/spec/#_4","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea","text":"<ul> <li>10-stdlib-string.md - \u6587\u5b57\u5217\u64cd\u4f5c\uff0860\u4ee5\u4e0a\u306e\u95a2\u6570\uff09</li> <li>\u691c\u7d22\u3001\u5909\u63db\u3001\u30b1\u30fc\u30b9\u5909\u63db\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u3001\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3</li> <li>11-stdlib-http.md - HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8/\u30b5\u30fc\u30d0\u30fc</li> <li>\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08GET/POST/PUT/DELETE\uff09\u3001\u30b5\u30fc\u30d0\u30fc\uff08\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3001\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\uff09</li> <li>12-stdlib-json.md - JSON/YAML\u51e6\u7406</li> <li>\u30d1\u30fc\u30b9\u3001stringify\u3001Result\u578b\u7d71\u5408</li> <li>13-stdlib-io.md - \u30d5\u30a1\u30a4\u30ebI/O\uff08\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u5bfe\u5fdc\uff09</li> <li>\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u66f8\u304d\u3001\u591a\u8a00\u8a9e\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\uff08Shift_JIS\u3001GBK\u3001Big5\u7b49\uff09</li> <li>14-stdlib-test.md - \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af</li> <li>test/run\u3001\u30a2\u30b5\u30fc\u30b7\u30e7\u30f3\uff08assert-eq\u3001assert\u3001assert-not\u3001assert-throws\uff09</li> <li>qi test\u30b3\u30de\u30f3\u30c9\uff08\u81ea\u52d5\u691c\u51fa\u3001\u30b7\u30f3\u30d7\u30eb\u306a\u51fa\u529b\uff09</li> <li>15-stdlib-math.md - \u6570\u5b66\u95a2\u6570</li> <li>\u3079\u304d\u4e57\u30fb\u5e73\u65b9\u6839\uff08pow\u3001sqrt\uff09\u3001\u4e38\u3081\uff08round\u3001floor\u3001ceil\uff09\u3001\u7bc4\u56f2\u5236\u9650\uff08clamp\uff09</li> <li>\u4e71\u6570\u751f\u6210\uff08rand\u3001rand-int\u3001random-range\u3001shuffle\uff09</li> <li>16-stdlib-auth.md - \u8a8d\u8a3c\u30fb\u8a8d\u53ef</li> <li>JWT\uff08json web token\uff09\u751f\u6210\u30fb\u691c\u8a3c\u30fb\u30c7\u30b3\u30fc\u30c9</li> <li>\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\uff08Argon2\uff09</li> <li>17-stdlib-database.md - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9</li> <li>PostgreSQL\u63a5\u7d9a\uff08\u30af\u30a8\u30ea\u5b9f\u884c\u3001\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff09</li> <li>\u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea\u3001Result\u578b\u7d71\u5408</li> <li>18-stdlib-websocket.md - WebSocket\u901a\u4fe1</li> <li>WebSocket\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08\u63a5\u7d9a\u3001\u9001\u4fe1\u3001\u53d7\u4fe1\u3001\u30af\u30ed\u30fc\u30ba\uff09</li> <li>TLS/SSL\u5bfe\u5fdc\uff08wss://\uff09\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7\uff08\u30c6\u30ad\u30b9\u30c8\u3001\u30d0\u30a4\u30ca\u30ea\u3001\u30af\u30ed\u30fc\u30ba\u3001\u30a8\u30e9\u30fc\uff09</li> <li>19-stdlib-validation.md - \u30c7\u30fc\u30bf\u691c\u8a3c</li> <li>\u30b9\u30ad\u30fc\u30de\u30d9\u30fc\u30b9\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff08\u578b\u30c1\u30a7\u30c3\u30af\u3001\u5fc5\u9808\u30d5\u30a3\u30fc\u30eb\u30c9\u3001\u6587\u5b57\u5217\u9577\u3001\u6570\u5024\u7bc4\u56f2\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff09</li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306e\u691c\u8a3c\u3001Result\u578b\u7d71\u5408</li> <li>20-stdlib-debug.md - \u30c7\u30d0\u30c3\u30b0\u6a5f\u80fd</li> <li>\u30c8\u30ec\u30fc\u30b9\u6a5f\u80fd\uff08debug/trace\uff09\u3001\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\uff08debug/break\uff09</li> <li>\u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9\u53d6\u5f97\uff08debug/stack\uff09\u3001\u30c7\u30d0\u30c3\u30ac\u60c5\u5831\uff08debug/info\uff09</li> <li>21-stdlib-table.md - \u30c6\u30fc\u30d6\u30eb\u51e6\u7406</li> <li>SQL/awk\u30e9\u30a4\u30af\u306a\u8868\u5f62\u5f0f\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u30b0\u30eb\u30fc\u30d7\u5316\uff08table/group-by\uff09\u3001\u91cd\u8907\u9664\u53bb\uff08table/distinct-table\uff09</li> <li>22-stdlib-csv.md - CSV\u51e6\u7406</li> <li>CSV\u30d1\u30fc\u30b9\u30fb\u751f\u6210\uff08csv/parse\u3001csv/stringify\uff09</li> <li>\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u66f8\u304d\uff08csv/read-file\u3001csv/write-file\uff09\u3001RFC 4180\u6e96\u62e0</li> <li>23-stdlib-env.md - \u74b0\u5883\u5909\u6570</li> <li>\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97\u30fb\u8a2d\u5b9a\uff08env/get\u3001env/set\uff09</li> <li>\u5168\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97\uff08env/all\uff09</li> <li>.env\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\uff08env/load-dotenv\uff09</li> <li>24-stdlib-kvs.md - Key-Value Store</li> <li>\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08Redis/Memcached\u7b49\uff09</li> <li>\u57fa\u672c\u64cd\u4f5c\u3001\u6570\u5024\u64cd\u4f5c\u3001\u30ea\u30b9\u30c8\u3001\u30cf\u30c3\u30b7\u30e5\u3001\u30bb\u30c3\u30c8\u3001\u30d0\u30c3\u30c1\u51e6\u7406\uff0822\u95a2\u6570\uff09</li> <li>25-stdlib-log.md - \u30ed\u30ae\u30f3\u30b0</li> <li>\u30ed\u30b0\u30ec\u30d9\u30eb\uff08DEBUG\u3001INFO\u3001WARN\u3001ERROR\uff09</li> <li>\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\uff08\u30c6\u30ad\u30b9\u30c8\u3001JSON\uff09\u3001\u30ec\u30d9\u30eb\u8a2d\u5b9a\uff08log/set-level\uff09</li> <li>26-stdlib-markdown.md - Markdown\u51e6\u7406</li> <li>Markdown\u751f\u6210\uff08markdown/header\u3001markdown/list\u3001markdown/table\u7b49\uff09</li> <li>Markdown\u30d1\u30fc\u30b9\uff08markdown/parse\uff09\u3001\u9759\u7684\u30b5\u30a4\u30c8\u751f\u6210</li> <li>27-stdlib-path.md - \u30d1\u30b9\u64cd\u4f5c</li> <li>\u30d1\u30b9\u7d50\u5408\uff08path/join\uff09\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u53d6\u5f97\uff08path/basename\uff09</li> <li>\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5bfe\u5fdc\uff08Windows/Unix\uff09</li> <li>28-stdlib-stats.md - \u7d71\u8a08\u95a2\u6570</li> <li>\u4e2d\u5fc3\u50be\u5411\u306e\u6e2c\u5ea6\uff08mean\u3001median\u3001mode\uff09</li> <li>\u6563\u5e03\u5ea6\u306e\u6e2c\u5ea6\uff08variance\u3001stddev\uff09</li> <li>\u4f4d\u7f6e\u306e\u6e2c\u5ea6\uff08percentile\uff09</li> <li>29-stdlib-stream.md - \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> <li>\u9045\u5ef6\u8a55\u4fa1\uff08stream\u3001stream/map\u3001stream/filter\uff09</li> <li>\u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\uff08stream/range\u3001stream/iterate\uff09</li> <li>\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306a\u5927\u898f\u6a21\u30c7\u30fc\u30bf\u51e6\u7406</li> <li>30-stdlib-temp.md - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb</li> <li>\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\uff08temp/temp-file\uff09</li> <li>\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08temp/temp-dir\uff09\u3001\u81ea\u52d5\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7</li> <li>31-stdlib-time.md - \u65e5\u6642\u51e6\u7406</li> <li>ISO 8601\u5f62\u5f0f\uff08time/now-iso\u3001time/format\u3001time/parse\uff09</li> <li>\u65e5\u6642\u6f14\u7b97\uff08time/add-days\u3001time/diff-days\uff09\u3001UTC/\u30bf\u30a4\u30e0\u30be\u30fc\u30f3</li> <li>32-stdlib-zip.md - ZIP\u5727\u7e2e\u30fb\u89e3\u51cd</li> <li>ZIP\u4f5c\u6210\uff08zip/create\uff09\u3001\u89e3\u51cd\uff08zip/extract\uff09\u3001\u5185\u5bb9\u4e00\u89a7\uff08zip/list\uff09</li> <li>gzip\u5727\u7e2e\uff08zip/gzip\uff09\u3001\u89e3\u51cd\uff08zip/gunzip\uff09</li> <li>\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3001\u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3001\u914d\u5e03\u7528\u30a2\u30fc\u30ab\u30a4\u30d6</li> <li>33-stdlib-cmd.md - \u5916\u90e8\u30b3\u30de\u30f3\u30c9\u5b9f\u884c</li> <li>\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08cmd/exec\u3001cmd/sh\uff09</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\uff08cmd/pipe\uff09\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\uff08cmd/stream-lines\uff09</li> <li>\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\uff08\u30b3\u30de\u30f3\u30c9\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\uff09</li> <li>34-stdlib-list.md - \u30ea\u30b9\u30c8\u62e1\u5f35</li> <li>\u9ad8\u5ea6\u306a\u30ea\u30b9\u30c8\u64cd\u4f5c\uff08list/take-while\u3001list/chunk\u3001list/find\uff09</li> <li>\u983b\u5ea6\u96c6\u8a08\uff08list/frequencies\uff09\u3001\u56de\u8ee2\uff08list/rotate\uff09</li> <li>35-stdlib-map.md - \u30de\u30c3\u30d7\u62e1\u5f35</li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u64cd\u4f5c\uff08map/assoc-in\u3001map/dissoc-in\uff09</li> <li>\u30ad\u30fc/\u5024\u5909\u63db\uff08map/update-keys\u3001map/update-vals\uff09</li> <li>36-stdlib-set.md - \u30bb\u30c3\u30c8\u64cd\u4f5c</li> <li>\u6570\u5b66\u7684\u96c6\u5408\u6f14\u7b97\uff08union\u3001intersect\u3001difference\u3001symmetric-difference\uff09</li> <li>\u90e8\u5206\u96c6\u5408\u5224\u5b9a\uff08subset?\u3001superset?\u3001disjoint?\uff09</li> </ul>"},{"location":"ja/spec/#qi_1","title":"\ud83c\udfaf Qi\u306e\u7279\u5fb4","text":""},{"location":"ja/spec/#1-flow-oriented-programming","title":"1. Flow-Oriented Programming","text":"<p>\u300c\u30c7\u30fc\u30bf\u306f\u6d41\u308c\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b\u300d</p> <pre><code>(data\n |&gt; parse\n |&gt; (filter valid?)\n |&gt; (map transform)\n |&gt; save)\n</code></pre>"},{"location":"ja/spec/#2","title":"2. \u4e26\u884c\u30fb\u4e26\u5217\u3092\u7c21\u5358\u306b","text":"<p>Qi\u306e\u30ad\u30e2 - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u3067\u81ea\u7136\u306a\u4e26\u5217\u5316</p> <pre><code>;; \u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(urls ||&gt; http/get ||&gt; json/parse)\n\n;; goroutine\u98a8\u306e\u4e26\u884c\u51e6\u7406\n(def result (data ~&gt; transform ~&gt; process))\n(recv! result)\n</code></pre>"},{"location":"ja/spec/#3","title":"3. \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u5206\u5c90\u30fb\u5909\u63db</p> <pre><code>;; HTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff08try\u3067\u30a8\u30e9\u30fc\u30ad\u30e3\u30c3\u30c1\uff09\n(match (try (http/get! url))  ;; \u8a73\u7d30\u7248\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\n  {:error e} -&gt; (log-error e)\n  {:status 200 :body body} -&gt; (process-body body)\n  {:status 404} -&gt; nil\n  {:status _} -&gt; (error \"Unexpected status\"))\n</code></pre>"},{"location":"ja/spec/#_5","title":"\ud83d\udcd6 \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u8aad\u307f\u65b9","text":""},{"location":"ja/spec/#_6","title":"\u521d\u5fc3\u8005\u5411\u3051","text":"<ol> <li>01-overview.md - Qi\u3068\u306f\u4f55\u304b\uff1f</li> <li>05-syntax-basics.md - \u57fa\u672c\u7684\u306a\u69cb\u6587\u3092\u5b66\u3076</li> <li>06-data-structures.md - \u30c7\u30fc\u30bf\u306e\u6271\u3044\u65b9</li> <li>02-flow-pipes.md - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u4f7f\u3063\u3066\u307f\u308b</li> <li>10-stdlib-string.md - \u6587\u5b57\u5217\u64cd\u4f5c\u3092\u5b66\u3076</li> </ol>"},{"location":"ja/spec/#_7","title":"\u4e2d\u7d1a\u8005\u5411\u3051","text":"<ol> <li>04-match.md - \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u6d3b\u7528</li> <li>07-functions.md - \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0</li> <li>08-error-handling.md - \u30a8\u30e9\u30fc\u51e6\u7406\u306e\u6226\u7565</li> <li>03-concurrency.md - \u4e26\u884c\u51e6\u7406\u3092\u6d3b\u7528</li> <li>11-stdlib-http.md - HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8/\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u308b</li> <li>13-stdlib-io.md - \u30d5\u30a1\u30a4\u30ebI/O\u3068\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0</li> </ol>"},{"location":"ja/spec/#_8","title":"\u4e0a\u7d1a\u8005\u5411\u3051","text":"<ol> <li>03-concurrency.md - 3\u5c64\u4e26\u884c\u51e6\u7406\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3</li> <li>09-modules.md - \u30e2\u30b8\u30e5\u30fc\u30eb\u8a2d\u8a08</li> <li>02-flow-pipes.md - stream\uff08\u9045\u5ef6\u8a55\u4fa1\uff09</li> <li>12-stdlib-json.md - JSON/YAML\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406</li> </ol>"},{"location":"ja/spec/#_9","title":"\ud83d\udd0d \u95a2\u6570\u30fb\u6f14\u7b97\u5b50\u7d22\u5f15","text":""},{"location":"ja/spec/#14","title":"\u7279\u6b8a\u5f62\u5f0f\uff0814\u500b\uff09","text":"<ul> <li><code>def</code>, <code>defn</code>, <code>defn-</code> - \u5b9a\u7fa9 \u2192 05-syntax-basics.md</li> <li><code>fn</code> - \u95a2\u6570\u5b9a\u7fa9 \u2192 05-syntax-basics.md, 07-functions.md</li> <li><code>let</code> - \u30ed\u30fc\u30ab\u30eb\u675f\u7e1b \u2192 05-syntax-basics.md</li> <li><code>if</code>, <code>do</code> - \u5236\u5fa1\u69cb\u9020 \u2192 05-syntax-basics.md</li> <li><code>when</code> - \u6761\u4ef6\u304c\u771f\u306e\u3068\u304d\u306e\u307f\u5b9f\u884c \u2192 05-syntax-basics.md</li> <li><code>while</code> - \u6761\u4ef6\u304c\u771f\u306e\u9593\u30eb\u30fc\u30d7 \u2192 05-syntax-basics.md</li> <li><code>until</code> - \u6761\u4ef6\u304c\u771f\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7 \u2192 05-syntax-basics.md</li> <li><code>while-some</code> - nil\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7\uff08\u675f\u7e1b\u4ed8\u304d\uff09 \u2192 05-syntax-basics.md</li> <li><code>until-error</code> - \u30a8\u30e9\u30fc\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7\uff08\u675f\u7e1b\u4ed8\u304d\uff09 \u2192 05-syntax-basics.md</li> <li><code>loop</code>, <code>recur</code> - \u30eb\u30fc\u30d7 \u2192 05-syntax-basics.md</li> <li><code>match</code> - \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 \u2192 04-match.md</li> <li><code>try</code>, <code>defer</code> - \u30a8\u30e9\u30fc\u51e6\u7406 \u2192 08-error-handling.md</li> <li><code>mac</code> - \u30de\u30af\u30ed \u2192 05-syntax-basics.md</li> <li><code>module</code>, <code>export</code>, <code>use</code> - \u30e2\u30b8\u30e5\u30fc\u30eb \u2192 09-modules.md</li> </ul>"},{"location":"ja/spec/#5","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\uff085\u500b\uff09 \u2b50","text":"<ul> <li><code>|&gt;</code> - \u9010\u6b21\u30d1\u30a4\u30d7 \u2192 02-flow-pipes.md</li> <li><code>|&gt;?</code> - Railway Pipeline\uff08\u30a8\u30e9\u30fc\u51e6\u7406\uff09 \u2192 02-flow-pipes.md, 08-error-handling.md</li> <li><code>||&gt;</code> - \u4e26\u5217\u30d1\u30a4\u30d7 \u2192 02-flow-pipes.md</li> <li><code>~&gt;</code> - \u975e\u540c\u671f\u30d1\u30a4\u30d7 \u2192 02-flow-pipes.md, 03-concurrency.md</li> <li><code>tap&gt;</code> - \u526f\u4f5c\u7528\u30bf\u30c3\u30d7 \u2192 02-flow-pipes.md</li> </ul>"},{"location":"ja/spec/#_10","title":"\u30b3\u30a2\u95a2\u6570\uff08\u3088\u304f\u4f7f\u3046\uff09","text":"<p>\u6570\u5024\u6f14\u7b97: - <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> - \u7b97\u8853\u6f14\u7b97 \u2192 05-syntax-basics.md - <code>abs</code>, <code>min</code>, <code>max</code>, <code>inc</code>, <code>dec</code>, <code>sum</code> - \u6570\u5024\u95a2\u6570 \u2192 06-data-structures.md - <code>=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code> - \u6bd4\u8f03\u6f14\u7b97 \u2192 05-syntax-basics.md</p> <p>\u30b3\u30ec\u30af\u30b7\u30e7\u30f3: - <code>first</code>, <code>rest</code>, <code>last</code>, <code>nth</code> - \u30a2\u30af\u30bb\u30b9 \u2192 06-data-structures.md - <code>cons</code>, <code>conj</code>, <code>concat</code> - \u9023\u7d50 \u2192 06-data-structures.md - <code>take</code>, <code>drop</code>, <code>filter</code>, <code>map</code>, <code>reduce</code>, <code>each</code> - \u5909\u63db \u2192 06-data-structures.md - <code>sort</code>, <code>reverse</code>, <code>distinct</code> - \u30bd\u30fc\u30c8\u30fb\u91cd\u8907\u524a\u9664 \u2192 06-data-structures.md</p> <p>\u6587\u5b57\u5217: - <code>str</code>, <code>split</code>, <code>join</code> - \u57fa\u672c\u64cd\u4f5c \u2192 05-syntax-basics.md - 60\u4ee5\u4e0a\u306e\u6587\u5b57\u5217\u95a2\u6570 \u2192 10-stdlib-string.md</p> <p>\u8ff0\u8a9e\uff0823\u500b\uff09: - <code>nil?</code>, <code>some?</code>, <code>empty?</code> - nil/\u5b58\u5728\u30c1\u30a7\u30c3\u30af \u2192 05-syntax-basics.md - <code>number?</code>, <code>string?</code>, <code>list?</code>, <code>vector?</code>, <code>map?</code> - \u578b\u30c1\u30a7\u30c3\u30af \u2192 05-syntax-basics.md - <code>even?</code>, <code>odd?</code>, <code>positive?</code>, <code>negative?</code>, <code>zero?</code> - \u6570\u5024\u8ff0\u8a9e \u2192 05-syntax-basics.md - <code>error?</code> - \u30a8\u30e9\u30fc\u5224\u5b9a \u2192 05-syntax-basics.md, 08-error-handling.md</p> <p>I/O: - <code>print</code>, <code>println</code> - \u51fa\u529b \u2192 05-syntax-basics.md - \u30d5\u30a1\u30a4\u30ebI/O \u2192 13-stdlib-io.md</p> <p>\u4e26\u884c\u51e6\u7406 \u2b50: - <code>go/chan</code>, <code>go/send!</code>, <code>go/recv!</code> - goroutine\u98a8 \u2192 03-concurrency.md - <code>pmap</code>, <code>pfilter</code>, <code>preduce</code> - \u4e26\u5217map/filter/reduce \u2192 03-concurrency.md - <code>atom</code>, <code>swap!</code>, <code>reset!</code>, <code>deref</code> - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406 \u2192 03-concurrency.md</p>"},{"location":"ja/spec/#_11","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u95a2\u6570","text":"<ul> <li>HTTP: <code>http/get</code>, <code>http/post</code>, <code>server/serve</code> \u2192 11-stdlib-http.md</li> <li>WebSocket: <code>ws/connect</code>, <code>ws/send</code>, <code>ws/receive</code>, <code>ws/close</code> \u2192 18-stdlib-websocket.md</li> <li>JSON/YAML: <code>json/parse</code>, <code>json/stringify</code>, <code>yaml/parse</code> \u2192 12-stdlib-json.md</li> <li>Math: <code>math/pow</code>, <code>math/sqrt</code>, <code>math/round</code>, <code>math/rand</code> \u2192 15-stdlib-math.md</li> <li>Stats: <code>stats/mean</code>, <code>stats/median</code>, <code>stats/stddev</code>, <code>stats/percentile</code> \u2192 28-stdlib-stats.md</li> <li>Test: <code>test/assert-eq</code>, <code>test/run</code> \u2192 14-stdlib-test.md</li> <li>String: <code>string/upper</code>, <code>string/lower</code>, <code>string/trim</code>, \u4ed660+ \u2192 10-stdlib-string.md</li> <li>Auth: <code>jwt/sign</code>, <code>jwt/verify</code>, <code>password/hash</code>, <code>password/verify</code> \u2192 16-stdlib-auth.md</li> <li>Database: <code>db/connect</code>, <code>db/query</code>, <code>db/exec</code> (PostgreSQL/MySQL/SQLite) \u2192 17-stdlib-database.md</li> <li>Debug: <code>debug/trace</code>, <code>debug/break</code>, <code>debug/stack</code>, <code>debug/info</code> \u2192 20-stdlib-debug.md</li> </ul> <p>\ud83d\udcd1 \u5b8c\u5168\u306a\u95a2\u6570\u7d22\u5f15: FUNCTION-INDEX.md - \u5168\u95a2\u6570\u306e\u8a73\u7d30\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\uff08<code>./scripts/list_qi_functions.sh</code>\u3067\u751f\u6210\uff09</p>"},{"location":"ja/spec/#_12","title":"\ud83d\ude80 \u672a\u5b9f\u88c5\u6a5f\u80fd\u306b\u3064\u3044\u3066","text":"<p>\u672a\u5b9f\u88c5\u6a5f\u80fd\u3084\u30ed\u30fc\u30c9\u30de\u30c3\u30d7\u306b\u3064\u3044\u3066\u306f\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30eb\u30fc\u30c8\u306e<code>ROADMAP.md</code>\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/spec/#_13","title":"\ud83d\udcdd \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u65b9\u91dd","text":"<p>\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\uff1a</p> <ul> <li>\u5b9f\u88c5\u6e08\u307f\u6a5f\u80fd\u306e\u307f\u3092\u8a18\u8f09 - \u5168\u3066\u306e\u30b3\u30fc\u30c9\u4f8b\u306f\u52d5\u4f5c\u3057\u307e\u3059</li> <li>Phase\u8868\u8a18\u306a\u3057 - \u5168\u3066\u5b9f\u88c5\u6e08\u307f\u306e\u305f\u3081\u3001Phase\u8868\u8a18\u306f\u524a\u9664</li> <li>\u5b9f\u7528\u4f8b\u91cd\u8996 - \u6982\u5ff5\u3060\u3051\u3067\u306a\u304f\u3001\u5b9f\u969b\u306b\u4f7f\u3048\u308b\u30b3\u30fc\u30c9\u4f8b\u3092\u63d0\u4f9b</li> <li>Flow-Oriented - Qi\u306e\u54f2\u5b66\u306b\u6cbf\u3063\u305f\u8aac\u660e</li> </ul>"},{"location":"ja/spec/#_14","title":"\ud83c\udf0d \u591a\u8a00\u8a9e\u5bfe\u5fdc","text":"<p>Qi\u306f\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u591a\u8a00\u8a9e\u5bfe\u5fdc\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/#_15","title":"\u4f7f\u3044\u65b9","text":"<p>\u74b0\u5883\u5909\u6570<code>QI_LANG</code>\u3067\u8a00\u8a9e\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\uff1a</p> <pre><code># \u65e5\u672c\u8a9e\u3067\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\nQI_LANG=ja qi script.qi\n\n# \u82f1\u8a9e\u3067\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\nQI_LANG=en qi script.qi\n</code></pre>"},{"location":"ja/spec/#_16","title":"\u4f8b","text":"<pre><code># \u65e5\u672c\u8a9e\u30a8\u30e9\u30fc\n$ QI_LANG=ja qi -e '(+ 1 \"abc\")'\n\u30a8\u30e9\u30fc: \u6570\u5024\u6f14\u7b97\u306b\u306f\u6570\u5024\u306e\u307f\u3092\u4f7f\u7528\u3067\u304d\u307e\u3059\n\n# \u82f1\u8a9e\u30a8\u30e9\u30fc\n$ QI_LANG=en qi -e '(+ 1 \"abc\")'\nError: Numeric operations require numbers only\n</code></pre> <p>\u73fe\u5728\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u8a00\u8a9e\uff1a - \u65e5\u672c\u8a9e (<code>ja</code>) - \u30c7\u30d5\u30a9\u30eb\u30c8\uff08\u65e5\u672c\u4eba\u958b\u767a\u8005\u5411\u3051\uff09 - \u82f1\u8a9e (<code>en</code>) - \u56fd\u969b\u5bfe\u5fdc</p> <p>\u5b9f\u88c5: <code>src/i18n.rs</code> \u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4e00\u5143\u7ba1\u7406\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/#_17","title":"\ud83d\udd17 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>ROADMAP.md - \u672a\u5b9f\u88c5\u6a5f\u80fd\u3068\u30ed\u30fc\u30c9\u30de\u30c3\u30d7</li> <li>style-guide.md - \u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb\u30ac\u30a4\u30c9</li> <li>README.md - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5168\u4f53\u306e\u8aac\u660e</li> </ul>"},{"location":"ja/spec/#_18","title":"\ud83d\udcdc \u30e9\u30a4\u30bb\u30f3\u30b9","text":"<p>\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306fQi\u8a00\u8a9e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4e00\u90e8\u3067\u3042\u308a\u3001\u540c\u3058\u30e9\u30a4\u30bb\u30f3\u30b9\u306b\u5f93\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/01-overview/","title":"Qi\u8a00\u8a9e\u6982\u8981","text":"<p>Qi - A Lisp that flows</p> <p>\u30b7\u30f3\u30d7\u30eb\u3001\u9ad8\u901f\u3001\u7c21\u6f54\u306a\u30e2\u30c0\u30f3Lisp\u7cfb\u8a00\u8a9e\u3002\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3001\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u306b\u5f37\u3044\u3002</p> <p>\u4e26\u5217\u3001\u4e26\u884c\u3092\u7c21\u5358\u306b\u3067\u304d\u308b\u306e\u306fQi\u306e\u30ad\u30e2 - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u8a2d\u8a08\u30683\u5c64\u4e26\u884c\u51e6\u7406\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3002</p> <p>Note: \u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb\u3068\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u898f\u5247\u306b\u3064\u3044\u3066\u306f style-guide.md \u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/spec/01-overview/#-flow-oriented-programming","title":"\u8a00\u8a9e\u54f2\u5b66 - Flow-Oriented Programming","text":""},{"location":"ja/spec/01-overview/#_1","title":"\u6838\u3068\u306a\u308b\u601d\u60f3","text":"<p>\u300c\u30c7\u30fc\u30bf\u306f\u6d41\u308c\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b\u300d</p> <p>Qi\u306fFlow-Oriented Programming\uff08\u6d41\u308c\u6307\u5411\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff09\u3092\u4f53\u73fe\u3057\u307e\u3059\uff1a</p> <ol> <li>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u304c\u7b2c\u4e00\u7d1a\u5e02\u6c11</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 <code>|&gt;</code> \u304c\u8a00\u8a9e\u306e\u4e2d\u5fc3</li> <li><code>match</code> \u306f\u6d41\u308c\u3092\u5206\u5c90\u30fb\u5909\u63db\u3059\u308b\u5236\u5fa1\u69cb\u9020</li> <li>\u5c0f\u3055\u306a\u5909\u63db\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u5927\u304d\u306a\u6d41\u308c\u3092\u4f5c\u308b</li> <li> <p>Unix\u54f2\u5b66\u306e\u300cDo One Thing Well\u300d\u3092\u95a2\u6570\u578b\u3067\u5b9f\u73fe</p> </li> <li> <p>Simple, Fast, Concise</p> </li> <li>Simple: \u7279\u6b8a\u5f62\u5f0f9\u3064\u3001\u8a18\u6cd5\u6700\u5c0f\u9650\u3001\u5b66\u7fd2\u66f2\u7dda\u304c\u7de9\u3084\u304b</li> <li>Fast: \u8efd\u91cf\u30fb\u9ad8\u901f\u8d77\u52d5\u30fb\u5c06\u6765\u7684\u306bJIT\u30b3\u30f3\u30d1\u30a4\u30eb</li> <li> <p>Concise: \u77ed\u3044\u95a2\u6570\u540d\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3001<code>defn</code>\u7cd6\u8863\u69cb\u6587\u3067\u8868\u73fe\u529b\u8c4a\u304b</p> </li> <li> <p>\u30a8\u30cd\u30eb\u30ae\u30fc\u306e\u6d41\u308c</p> </li> <li>\u30c7\u30fc\u30bf\u306f\u4e00\u65b9\u5411\u306b\u6d41\u308c\u308b\uff08\u5de6\u304b\u3089\u53f3\u3001\u4e0a\u304b\u3089\u4e0b\uff09</li> <li>\u526f\u4f5c\u7528\u306f\u30bf\u30c3\u30d7\uff08<code>tap&gt;</code>\uff09\u3067\u89b3\u5bdf</li> <li>\u4e26\u5217\u51e6\u7406\u306f\u6d41\u308c\u306e\u5206\u5c90\u30fb\u5408\u6d41\u3068\u3057\u3066\u8868\u73fe</li> <li> <p>\u4e26\u884c\u30fb\u4e26\u5217\u3092\u7c21\u5358\u306b - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u8a2d\u8a08\u3067\u81ea\u7136\u306a\u4e26\u5217\u5316</p> </li> <li> <p>\u5b9f\u7528\u4e3b\u7fa9</p> </li> <li>Lisp\u7684\u7d14\u7c8b\u6027\u3088\u308a\u5b9f\u7528\u6027\u3092\u512a\u5148</li> <li>\u30e2\u30c0\u30f3\u306a\u6a5f\u80fd\uff08f-string\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff09\u3092\u7a4d\u6975\u63a1\u7528</li> <li>\u30d0\u30c3\u30c6\u30ea\u30fc\u540c\u68b1\uff08\u8c4a\u5bcc\u306a\u6587\u5b57\u5217\u64cd\u4f5c\u3001\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\uff09</li> </ol>"},{"location":"ja/spec/01-overview/#_2","title":"\u8a2d\u8a08\u539f\u5247","text":"<ol> <li>\u8aad\u307f\u3084\u3059\u3055 &gt; \u66f8\u304d\u3084\u3059\u3055</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306f\u4e0a\u304b\u3089\u4e0b\u3001\u5de6\u304b\u3089\u53f3\u306b\u8aad\u3081\u308b</li> <li> <p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u304c\u4e00\u76ee\u3067\u5206\u304b\u308b</p> </li> <li> <p>\u5408\u6210\u53ef\u80fd\u6027</p> </li> <li>\u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u5927\u304d\u306a\u51e6\u7406\u3092\u4f5c\u308b</li> <li> <p>\u5404\u30b9\u30c6\u30c3\u30d7\u306f\u72ec\u7acb\u3057\u3066\u30c6\u30b9\u30c8\u53ef\u80fd</p> </li> <li> <p>\u6bb5\u968e\u7684\u958b\u793a</p> </li> <li>\u521d\u5fc3\u8005: \u57fa\u672c\u7684\u306a <code>|&gt;</code> \u304b\u3089\u59cb\u3081\u3089\u308c\u308b</li> <li>\u4e2d\u7d1a\u8005: <code>match</code>\u3001<code>loop</code>\u3092\u6d3b\u7528</li> <li> <p>\u4e0a\u7d1a\u8005: \u4e26\u5217\u51e6\u7406\u3092\u99c6\u4f7f</p> </li> <li> <p>\u5b9f\u884c\u6642\u306e\u52b9\u7387</p> </li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306f\u6700\u9069\u5316\u3055\u308c\u308b</li> <li>\u9045\u5ef6\u8a55\u4fa1\u3067\u4e0d\u8981\u306a\u8a08\u7b97\u3092\u56de\u907f</li> <li>\u4e26\u5217\u51e6\u7406\u3067\u81ea\u7136\u306b\u30b9\u30b1\u30fc\u30eb</li> </ol>"},{"location":"ja/spec/01-overview/#_3","title":"\u30d5\u30a1\u30a4\u30eb\u62e1\u5f35\u5b50","text":"<pre><code>.qi\n</code></pre>"},{"location":"ja/spec/01-overview/#-qi","title":"\u4f7f\u3044\u65b9 - Qi\u306e\u5b9f\u884c\u65b9\u6cd5","text":"<p>Qi\u306f3\u3064\u306e\u5b9f\u884c\u30e2\u30fc\u30c9 + \u6a19\u6e96\u5165\u529b\u3092\u30b5\u30dd\u30fc\u30c8\uff1a</p>"},{"location":"ja/spec/01-overview/#1-repl","title":"1. REPL\uff08\u5bfe\u8a71\u30e2\u30fc\u30c9\uff09","text":"<pre><code>qi\n# \u307e\u305f\u306f\nqi -l utils.qi  # \u30d5\u30a1\u30a4\u30eb\u3092\u30d7\u30ea\u30ed\u30fc\u30c9\u3057\u3066REPL\u8d77\u52d5\n</code></pre>"},{"location":"ja/spec/01-overview/#2","title":"2. \u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u5b9f\u884c","text":"<pre><code>qi script.qi\nqi examples/hello.qi\n</code></pre>"},{"location":"ja/spec/01-overview/#3","title":"3. \u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u5b9f\u884c","text":"<pre><code>qi -e '(println \"Hello!\")'\nqi -e '((range 1 10) |&gt; (map (fn [x] (* x x))) |&gt; sum)'\n</code></pre>"},{"location":"ja/spec/01-overview/#4","title":"4. \u6a19\u6e96\u5165\u529b\u304b\u3089\u5b9f\u884c","text":"<p>Unix\u54f2\u5b66\u306b\u6e96\u62e0 - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d71\u5408</p> <pre><code># echo\u304b\u3089\necho '(println \"Hello from stdin!\")' | qi -\n\n# heredoc\u3067\u8907\u6570\u884c\u30b9\u30af\u30ea\u30d7\u30c8\nqi - &lt;&lt;'EOF'\n(def data [1 2 3 4 5])\n(def result (data |&gt; (map (fn [x] (* x x))) |&gt; sum))\n(println (str \"Sum of squares: \" result))\nEOF\n\n# \u4ed6\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089Qi\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u751f\u6210\njq -r '.script' config.json | qi -\ncurl -s https://example.com/script.qi | qi -\n\n# \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4e0d\u8981\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\uff09\necho \"$SECRET_SCRIPT\" | qi -\n\n# CI/CD\u3067\u306e\u52d5\u7684\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c\ncat automation.qi | qi -\n</code></pre>"},{"location":"ja/spec/01-overview/#_4","title":"\u306a\u305c\u6a19\u6e96\u5165\u529b\u5b9f\u884c\u304c\u91cd\u8981\u304b\uff1f","text":"<ol> <li>Unix\u54f2\u5b66 - \u4ed6\u306e\u30c4\u30fc\u30eb\uff08python/node/ruby\uff09\u3082 <code>-</code> \u3092\u30b5\u30dd\u30fc\u30c8</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408 - \u30b3\u30de\u30f3\u30c9\u306e\u51fa\u529b\u3092\u76f4\u63a5\u5b9f\u884c</li> <li>\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3 - \u6a5f\u5bc6\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u6b8b\u3055\u306a\u3044</li> <li>\u52d5\u7684\u751f\u6210 - \u4ed6\u306e\u30c4\u30fc\u30eb\u304cQi\u30b3\u30fc\u30c9\u3092\u751f\u6210\u2192\u5373\u5b9f\u884c</li> <li>CI/CD\u5bfe\u5fdc - GitHub Secrets\u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\u6ce8\u5165\u53ef\u80fd</li> </ol> <pre><code># \u5b9f\u7528\u4f8b\uff1aJSON\u304b\u3089Qi\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u62bd\u51fa\u3057\u3066\u5b9f\u884c\ncat automation.json | jq -r '.tasks.cleanup.script' | qi -\n\n# \u5b9f\u7528\u4f8b\uff1a\u52d5\u7684\u306b\u30c7\u30fc\u30bf\u51e6\u7406\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u751f\u6210\n./generate-processor.sh --type=csv --columns=3 | qi -\n</code></pre>"},{"location":"ja/spec/01-overview/#_5","title":"\u57fa\u672c\u8a2d\u8a08","text":""},{"location":"ja/spec/01-overview/#_6","title":"\u540d\u524d\u7a7a\u9593","text":"<p>Lisp-1\uff08Scheme\u6d3e\uff09 - \u5909\u6570\u3068\u95a2\u6570\u306f\u540c\u3058\u540d\u524d\u7a7a\u9593</p> <pre><code>(def add (fn [x y] (+ x y)))\n(def op add)           ;; \u95a2\u6570\u3092\u5909\u6570\u306b\u4ee3\u5165\n(op 1 2)               ;; 3\n</code></pre>"},{"location":"ja/spec/01-overview/#nil-bool","title":"nil \u3068 bool","text":"<p>nil \u3068 bool \u306f\u5225\u7269\u3001\u305f\u3060\u3057\u6761\u4ef6\u5f0f\u3067\u306f nil \u3082 falsy</p> <pre><code>nil false true          ;; 3\u3064\u306e\u7570\u306a\u308b\u5024\n(if nil \"yes\" \"no\")     ;; \"no\" (nil\u306ffalsy)\n(if false \"yes\" \"no\")   ;; \"no\" (false\u306ffalsy)\n(if 0 \"yes\" \"no\")       ;; \"yes\" (0\u306ftruthy)\n(if \"\" \"yes\" \"no\")      ;; \"yes\" (\u7a7a\u6587\u5b57\u3082truthy)\n\n;; \u660e\u793a\u7684\u306a\u6bd4\u8f03\n(= x nil)               ;; nil\u30c1\u30a7\u30c3\u30af\n(= x false)             ;; false\u30c1\u30a7\u30c3\u30af\n</code></pre>"},{"location":"ja/spec/01-overview/#_7","title":"\u578b\u30b7\u30b9\u30c6\u30e0","text":"<p>Qi\u306f\u52d5\u7684\u578b\u4ed8\u3051\u8a00\u8a9e\u3067\u3001\u4ee5\u4e0b\u306e\u57fa\u672c\u578b\u3092\u6301\u3061\u307e\u3059\uff1a</p> <ul> <li>\u6570\u5024: \u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570</li> <li>\u6587\u5b57\u5217: UTF-8\u5bfe\u5fdc\u3001f-string\u5bfe\u5fdc</li> <li>\u771f\u507d\u5024: <code>true</code>, <code>false</code></li> <li>nil: \u5024\u306e\u4e0d\u5728\u3092\u8868\u3059</li> <li>\u30d9\u30af\u30bf\u30fc: <code>[1 2 3]</code></li> <li>\u30de\u30c3\u30d7: <code>{:key \"value\"}</code></li> <li>\u30ea\u30b9\u30c8: <code>'(1 2 3)</code> (\u30af\u30aa\u30fc\u30c8\u5fc5\u9808)</li> <li>\u95a2\u6570: \u7b2c\u4e00\u7d1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8</li> <li>\u30ad\u30fc\u30ef\u30fc\u30c9: <code>:keyword</code></li> </ul>"},{"location":"ja/spec/02-flow-pipes/","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u62e1\u5f35 - Flow DSL","text":"<p>\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b\u8a00\u8a9e</p> <p>Qi\u306f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u62e1\u5f35\u3057\u3001\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u76f4\u611f\u7684\u306b\u8868\u73fe\u3067\u304d\u308b\u8a00\u8a9e\u3067\u3059\u3002</p> <p>\u5b9f\u88c5: <code>src/builtins/flow.rs</code>, <code>src/builtins/util.rs</code>, <code>src/builtins/stream.rs</code></p>"},{"location":"ja/spec/02-flow-pipes/#_1","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u306e\u4f53\u7cfb","text":"\u6f14\u7b97\u5b50 \u610f\u5473 \u7528\u9014 <code>|&gt;</code> \u9010\u6b21\u30d1\u30a4\u30d7 \u57fa\u672c\u7684\u306a\u30c7\u30fc\u30bf\u5909\u63db <code>\\|&gt;?</code> Railway \u30d1\u30a4\u30d7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3001Result\u578b\u306e\u9023\u9396 <code>||&gt;</code> \u4e26\u5217\u30d1\u30a4\u30d7 \u81ea\u52d5\u7684\u306bpmap\u5316\u3001\u30ea\u30b9\u30c8\u51e6\u7406\u306e\u4e26\u5217\u5316 <code>tap&gt;</code> \u526f\u4f5c\u7528\u30bf\u30c3\u30d7 \u30c7\u30d0\u30c3\u30b0\u3001\u30ed\u30b0\u3001\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0 <code>~&gt;</code> \u975e\u540c\u671f\u30d1\u30a4\u30d7 go/chan\u7d71\u5408\u3001\u975e\u540c\u671fIO"},{"location":"ja/spec/02-flow-pipes/#_2","title":"<code>|&gt;</code> \u57fa\u672c\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<p>\u5de6\u304b\u3089\u53f3\u3078\u30c7\u30fc\u30bf\u3092\u6d41\u3059</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(\"hello\" |&gt; str/upper |&gt; str/reverse)  ;; =&gt; \"OLLEH\"\n\n;; \u30cd\u30b9\u30c8\u56de\u907f\n([1 2 3 4 5 6]\n |&gt; (filter (fn [x] (= (% x 2) 0)))\n |&gt; (map (fn [x] (* x 2)))\n |&gt; (reduce + 0))  ;; =&gt; 24\n\n;; \u5f15\u6570\u4ed8\u304d\u95a2\u6570\n(10 |&gt; (+ 5) |&gt; (* 2))  ;; (+ 10 5) |&gt; (* 2) =&gt; 30\n\n;; _\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u30fc: \u4efb\u610f\u306e\u4f4d\u7f6e\u306b\u5024\u3092\u633f\u5165\n(42 |&gt; (+ 10 _ 3))  ;; (+ 10 42 3) =&gt; 55\n(\"world\" |&gt; (str \"Hello, \" _))  ;; (str \"Hello, \" \"world\") =&gt; \"Hello, world\"\n\n;; \u5b9f\u7528\u4f8b: URL\u69cb\u7bc9\n(def params [[\"name\" \"alice\"] [\"age\" \"30\"]])\n(def base-url \"https://api.example.com/users\")\n(params\n |&gt; (map (fn [[k v]] f\"{k}={v}\"))\n |&gt; (join \"&amp;\" _)\n |&gt; (str base-url \"?\" _))  ;; =&gt; \"https://api.example.com/users?name=alice&amp;age=30\"\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#_3","title":"<code>||&gt;</code> \u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<p>\u81ea\u52d5\u7684\u306bpmap\u306b\u5c55\u958b</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n([1 2 3 4 5] ||&gt; inc)  ;; (2 3 4 5 6)\n\n;; \u8907\u96d1\u306a\u8a08\u7b97\u3092\u4e26\u5217\u5316\n([10 20 30 40]\n ||&gt; (fn [x] (* x 2))\n |&gt; (filter (fn [n] (&gt; n 50)))\n |&gt; (reduce + 0))  ;; =&gt; 140\n</code></pre> <p>\u5b9f\u88c5: - lexer: <code>||&gt;</code>\u3092<code>Token::ParallelPipe</code>\u3068\u3057\u3066\u8a8d\u8b58 - parser: <code>x ||&gt; f</code> \u2192 <code>(pmap f x)</code>\u306b\u5c55\u958b</p>"},{"location":"ja/spec/02-flow-pipes/#_4","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3 \u26a1","text":"<p>\u4e26\u5217\u5316\u3059\u3079\u304d\u5834\u5408: - CPU\u96c6\u7d04\u7684\u306a\u51e6\u7406\uff08\u753b\u50cf\u51e6\u7406\u3001\u5727\u7e2e\u3001\u8a08\u7b97\uff09 - I/O\u5f85\u3061\u304c\u591a\u3044\u51e6\u7406\uff08HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u3001\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\uff09 - \u8981\u7d20\u6570\u304c\u591a\u3044\uff08\u76ee\u5b89\uff1a100\u8981\u7d20\u4ee5\u4e0a\uff09</p> <p>\u4e26\u5217\u5316\u3059\u3079\u304d\u3067\u306a\u3044\u5834\u5408: - \u8efd\u91cf\u306a\u51e6\u7406\uff08\u8981\u7d20\u3054\u3068\u306e\u51e6\u7406\u304c1ms\u672a\u6e80\uff09 - \u8981\u7d20\u6570\u304c\u5c11\u306a\u3044\uff08\u76ee\u5b89\uff1a10\u8981\u7d20\u672a\u6e80\uff09 - \u30e1\u30e2\u30ea\u5236\u7d04\u304c\u3042\u308b\u5834\u5408</p> <pre><code>;; \u274c \u60aa\u3044\u4f8b\uff1a\u8efd\u91cf\u51e6\u7406 + \u5c11\u91cf\u30c7\u30fc\u30bf\uff08\u4e26\u5217\u5316\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3067\u9045\u304f\u306a\u308b\uff09\n([1 2 3] ||&gt; inc)  ;; |&gt; \u3092\u4f7f\u3046\u65b9\u304c\u901f\u3044\n\n;; \ud83d\udca1 \u4f7f\u3044\u5206\u3051\u306e\u76ee\u5b89\n(def data [1 2 3 4 5])\n(if (&gt; (len data) 100)\n  (data ||&gt; (fn [x] (* x x)))  ;; \u4e26\u5217\u5316\n  (data |&gt; (map (fn [x] (* x x)))))  ;; \u9010\u6b21\u51e6\u7406\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#railway-pipeline","title":"<code>|&gt;?</code> Railway Pipeline","text":"<p>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u6d41\u308c\u306e\u4e2d\u306b\u7d44\u307f\u8fbc\u3080 - Railway Oriented Programming</p>"},{"location":"ja/spec/02-flow-pipes/#error","title":"\u65b0\u4ed5\u69d8\uff1a<code>:error</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f","text":"<p><code>{:error}</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f\u6271\u3044\uff01<code>:ok</code>\u30e9\u30c3\u30d7\u306a\u3057</p> <pre><code>;; \u30b7\u30f3\u30d7\u30eb\uff01\u5024\u304c\u305d\u306e\u307e\u307e\u6d41\u308c\u308b\n(10\n |&gt;? (fn [x] (* x 2))     ;; 20 \u2192 \u305d\u306e\u307e\u307e\u6b21\u3078\n |&gt;? (fn [x] (+ x 5)))    ;; 25 \u2192 \u305d\u306e\u307e\u307e\u6b21\u3078\n;; =&gt; 25\n\n;; \u30a8\u30e9\u30fc\u3092\u8fd4\u3057\u305f\u3044\u6642\u3060\u3051\u660e\u793a\u7684\u306b{:error}\n(10\n |&gt;? (fn [x] (if (&gt; x 0) (* x 2) {:error \"negative\"}))\n |&gt;? (fn [x] (+ x 5)))\n;; =&gt; 25\n\n(-5\n |&gt;? (fn [x] (if (&gt; x 0) (* x 2) {:error \"negative\"}))\n |&gt;? (fn [x] (+ x 5)))    ;; \u5b9f\u884c\u3055\u308c\u306a\u3044\uff08\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\uff09\n;; =&gt; {:error \"negative\"}\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#_5","title":"\u52d5\u4f5c\u30eb\u30fc\u30eb","text":"<p>\u5165\u529b\u5024\u306e\u51e6\u7406: 1. <code>{:error ...}</code> \u2192 \u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\uff08\u6b21\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3057\u306a\u3044\uff09 2. \u305d\u306e\u4ed6 \u2192 \u305d\u306e\u307e\u307e\u6b21\u306e\u95a2\u6570\u306b\u6e21\u3059</p> <p>\u51fa\u529b\u5024\u306e\u51e6\u7406: 1. <code>{:error ...}</code> \u2192 \u305d\u306e\u307e\u307e\u8fd4\u3059\uff08\u30a8\u30e9\u30fc\u4f1d\u64ad\uff09 2. \u305d\u306e\u4ed6 \u2192 \u305d\u306e\u307e\u307e\u8fd4\u3059\uff08<code>:ok</code>\u30e9\u30c3\u30d7\u306a\u3057\uff01\uff09</p>"},{"location":"ja/spec/02-flow-pipes/#_6","title":"\u5b9f\u7528\u4f8b","text":"<pre><code>;; JSON\u6587\u5b57\u5217\u306e\u30d1\u30fc\u30b9 + \u30c7\u30fc\u30bf\u5909\u63db\uff08\u30b7\u30f3\u30d7\u30eb\uff01\uff09\n(def json-str \"{\\\"user\\\": {\\\"name\\\": \\\"Alice\\\", \\\"age\\\": 30}}\")\n(json-str\n |&gt;? json/parse              ;; =&gt; \u30d1\u30fc\u30b9\u7d50\u679c\uff08\u5024\u305d\u306e\u307e\u307e\uff09\n |&gt;? (fn [data] (get data \"user\")))  ;; \u5024\u3092\u8fd4\u3059\u3060\u3051\uff01\n;; =&gt; {:name \"Alice\", :age 30}\n\n;; \u6761\u4ef6\u4ed8\u304d\u30a8\u30e9\u30fc\n(defn validate-age [age]\n  (if (&gt;= age 18)\n    age                       ;; \u666e\u901a\u306e\u5024 \u2192 \u6210\u529f\n    {:error \"Must be 18+\"}))  ;; \u30a8\u30e9\u30fc\u3060\u3051\u660e\u793a\u7684\u306b\n\n(20 |&gt;? validate-age |&gt;? (fn [x] (* x 2)))  ;; =&gt; 40\n(15 |&gt;? validate-age |&gt;? (fn [x] (* x 2)))  ;; =&gt; {:error \"Must be 18+\"}\n</code></pre> <p>\u4f7f\u3044\u5206\u3051: - <code>|&gt;</code>: \u901a\u5e38\u306e\u30c7\u30fc\u30bf\u5909\u63db\uff08\u30a8\u30e9\u30fc\u306a\u3057\uff09 - <code>|&gt;?</code>: \u30a8\u30e9\u30fc\u304c\u8d77\u3053\u308a\u3046\u308b\u51e6\u7406\uff08API\u3001\u30d5\u30a1\u30a4\u30ebIO\u3001\u30d1\u30fc\u30b9\uff09</p> <p>\u8a2d\u8a08\u54f2\u5b66: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u6d41\u308c\u306e\u4e00\u90e8\u3068\u3057\u3066\u8868\u73fe\u3002try-catch\u306e\u30cd\u30b9\u30c8\u3092\u907f\u3051\u3001\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u304c\u660e\u78ba\u306b\u306a\u308b\u3002JSON\u3084HTTP\u306a\u3069\u306eWeb\u958b\u767a\u6a5f\u80fd\u3068\u5b8c\u74a7\u306b\u7d71\u5408\u3002<code>{:error}</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f\u3068\u3057\u3066\u6271\u3044\u3001Lisp\u306e\u300cnil\u4ee5\u5916\u306f\u771f\u300d\u3068\u540c\u3058\u54f2\u5b66\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u3002</p>"},{"location":"ja/spec/02-flow-pipes/#tap","title":"<code>tap&gt;</code> \u526f\u4f5c\u7528\u30bf\u30c3\u30d7","text":"<p>\u6d41\u308c\u3092\u6b62\u3081\u305a\u306b\u89b3\u5bdf\uff08Unix <code>tee</code>\u76f8\u5f53\uff09</p> <pre><code>;; \u7c21\u6f54\u306a\u4f7f\u3044\u65b9\n([1 2 3]\n |&gt; (map inc)\n |&gt; (tap println)\n |&gt; (reduce + 0))\n;; \u51fa\u529b: (2 3 4)\n;; \u623b\u308a\u5024: 9\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u4e2d\u306e\u30c7\u30d0\u30c3\u30b0\n(\"hello world\"\n |&gt; str/upper\n |&gt; (tap println)  ;; \u4e2d\u9593\u7d50\u679c\u3092\u78ba\u8a8d\n |&gt; str/reverse)\n;; \u51fa\u529b: HELLO WORLD\n;; \u623b\u308a\u5024: \"DLROW OLLEH\"\n</code></pre> <p>\u5b9f\u88c5: - <code>tap</code>\u95a2\u6570\u3068\u3057\u3066\u5b9f\u88c5 - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u5185\u3067<code>|&gt; (tap f)</code>\u3068\u3057\u3066\u4f7f\u7528 - \u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u304b\u3089\u5143\u306e\u5024\u3092\u8fd4\u3059</p>"},{"location":"ja/spec/02-flow-pipes/#_7","title":"<code>~&gt;</code> \u975e\u540c\u671f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<p>\u4e26\u884c\u51e6\u7406\u3068\u306e\u7d71\u5408 - goroutine\u98a8\u306e\u975e\u540c\u671f\u5b9f\u884c</p> <p><code>~&gt;</code> \u6f14\u7b97\u5b50\u306f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092goroutine\u3067\u81ea\u52d5\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u30c1\u30e3\u30cd\u30eb\u3067\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u975e\u540c\u671f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(def result (10 ~&gt; inc ~&gt; (fn [x] (* x 2))))  ; \u5373\u5ea7\u306b\u30c1\u30e3\u30cd\u30eb\u3092\u8fd4\u3059\n(go/recv! result)  ; \u7d50\u679c\u3092\u53d7\u4fe1 =&gt; 22\n\n;; \u8907\u6570\u306e\u975e\u540c\u671f\u51e6\u7406\n(def r1 (10 ~&gt; inc ~&gt; (fn [x] (* x 2))))\n(def r2 (20 ~&gt; (fn [x] (* x 2)) ~&gt; inc))\n(println (go/recv! r1) (go/recv! r2))  ; \u4e26\u884c\u5b9f\u884c =&gt; 22 41\n\n;; go\u30d6\u30ed\u30c3\u30af\u5185\u3067\u3082\u5229\u7528\u53ef\u80fd\n(def output-chan (go/chan))\n(go/run\n  (go/send! output-chan (42 ~&gt; inc ~&gt; (fn [x] (* x 2)))))\n(go/recv! output-chan)  ; =&gt; 86\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#stream","title":"<code>stream</code> \u9045\u5ef6\u8a55\u4fa1","text":"<p>\u5de8\u5927\u30c7\u30fc\u30bf\u306e\u52b9\u7387\u7684\u51e6\u7406 - \u9045\u5ef6\u8a55\u4fa1\u3068\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020</p> <p>Stream\u306f\u5024\u3092\u5fc5\u8981\u306b\u306a\u308b\u307e\u3067\u8a08\u7b97\u3057\u306a\u3044\u9045\u5ef6\u8a55\u4fa1\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u3059\u3002 \u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\u3084\u5927\u304d\u306a\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306b\u6271\u3048\u307e\u3059\u3002</p>"},{"location":"ja/spec/02-flow-pipes/#stream_1","title":"Stream\u4f5c\u6210","text":"<pre><code>;; \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304b\u3089\u30b9\u30c8\u30ea\u30fc\u30e0\u4f5c\u6210\n(stream/stream [1 2 3 4 5])\n\n;; \u7bc4\u56f2\u30b9\u30c8\u30ea\u30fc\u30e0\n(stream/range 0 10)  ;; 0\u304b\u30899\u307e\u3067\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\uff1a\u540c\u3058\u5024\u3092\u7e70\u308a\u8fd4\u3057\n(stream/repeat 42)  ;; 42, 42, 42, ...\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\uff1a\u30ea\u30b9\u30c8\u3092\u5faa\u74b0\n(stream/cycle [1 2 3])  ;; 1, 2, 3, 1, 2, 3, ...\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\uff1a\u95a2\u6570\u3092\u53cd\u5fa9\u9069\u7528\n(stream/iterate (fn [x] (* x 2)) 1)  ;; 1, 2, 4, 8, 16, 32, ...\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#stream_2","title":"Stream\u5909\u63db","text":"<pre><code>;; map: \u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u9069\u7528\n(def s (stream/range 1 6))\n(def s2 (stream/map (fn [x] (* x 2)) s))\n(stream/realize s2)  ;; (2 4 6 8 10)\n\n;; filter: \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u306e\u307f\n(def s (stream/range 1 11))\n(def s2 (stream/filter (fn [x] (= (% x 2) 0)) s))\n(stream/realize s2)  ;; (2 4 6 8 10)\n\n;; take: \u6700\u521d\u306en\u500b\u3092\u53d6\u5f97\uff08\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u6709\u9650\u5316\uff09\n(def s (stream/repeat 42))\n(def s2 (stream/take 5 s))\n(stream/realize s2)  ;; (42 42 42 42 42)\n\n;; drop: \u6700\u521d\u306en\u500b\u3092\u30b9\u30ad\u30c3\u30d7\n(def s (stream/range 0 10))\n(def s2 (stream/drop 5 s))\n(stream/realize s2)  ;; (5 6 7 8 9)\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#stream_3","title":"Stream\u5b9f\u884c","text":"<pre><code>;; realize: \u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u30ea\u30b9\u30c8\u306b\u5909\u63db\uff08\u5168\u8981\u7d20\u3092\u8a08\u7b97\uff09\n(stream/realize (stream/stream [1 2 3]))  ;; (1 2 3)\n\n;; \u26a0\ufe0f \u6ce8\u610f: \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3092realize\u3059\u308b\u3068\u7121\u9650\u30eb\u30fc\u30d7\n;; (stream/realize (stream/repeat 42))  ;; NG: \u6c38\u9060\u306b\u7d42\u308f\u3089\u306a\u3044\n\n;; \u6b63\u3057\u3044\u4f7f\u3044\u65b9: take\u3067\u6709\u9650\u5316\u3057\u3066\u304b\u3089realize\n(stream/realize (stream/take 5 (stream/repeat 42)))  ;; OK\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#_8","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d71\u5408","text":"<pre><code>;; \u65e2\u5b58\u306e |&gt; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3067\u4f7f\u3048\u308b\n[1 2 3 4 5]\n  |&gt; stream/stream\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (&gt; x 10)))\n  |&gt; stream/realize\n;; (16 25)\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u51e6\u7406\n1\n  |&gt; (stream/iterate (fn [x] (* x 2)))\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; (1 2 4 8 16 32 64 128 256 512)\n\n;; \u8907\u96d1\u306a\u5909\u63db\u30c1\u30a7\u30fc\u30f3\n(stream/range 1 100)\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (= (% x 3) 0)))\n  |&gt; (stream/take 5)\n  |&gt; stream/realize\n;; (9 36 81 144 225)\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#_9","title":"\u5b9f\u7528\u4f8b","text":"<pre><code>;; \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\n(def fib-stream\n  (stream/iterate (fn [[a b]] [b (+ a b)]) [0 1]))\n\n(stream/realize (stream/take 10 fib-stream)\n  |&gt; (map first))  ;; (0 1 1 2 3 5 8 13 21 34)\n\n;; \u30c7\u30fc\u30bf\u51e6\u7406\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(defn process-data [data]\n  (data\n   |&gt; stream/stream\n   |&gt; (stream/map str/upper)\n   |&gt; (stream/filter (fn [s] (&gt; (len s) 3)))\n   |&gt; (stream/take 1000)\n   |&gt; stream/realize))\n\n(process-data [\"hello\" \"hi\" \"world\" \"qi\"])  ;; =&gt; (\"HELLO\" \"WORLD\")\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#io","title":"I/O\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3068HTTP\u30c7\u30fc\u30bf\u306e\u9045\u5ef6\u8aad\u307f\u8fbc\u307f - \u30c6\u30ad\u30b9\u30c8\uff06\u30d0\u30a4\u30ca\u30ea\u5bfe\u5fdc</p>"},{"location":"ja/spec/02-flow-pipes/#_10","title":"\u30c6\u30ad\u30b9\u30c8\u30e2\u30fc\u30c9\uff08\u884c\u30d9\u30fc\u30b9\uff09","text":"<pre><code>;; (comment) \u3067\u30e9\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u4e0d\u53ef\u80fd\u306a\u4f8b\u3092\u793a\u3059\n(comment\n  ;; stream/file: \u30d5\u30a1\u30a4\u30eb\u3092\u884c\u3054\u3068\u306b\u9045\u5ef6\u8aad\u307f\u8fbc\u307f\n  (stream/file \"large.log\")\n    |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n    |&gt; (stream/map str/upper)\n    |&gt; (stream/take 100)\n    |&gt; stream/realize\n\n  ;; http/get-stream: HTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u307f\n  (http/get-stream \"https://api.example.com/data\")\n    |&gt; (stream/take 10)\n    |&gt; stream/realize)\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#_11","title":"\u30d0\u30a4\u30ca\u30ea\u30e2\u30fc\u30c9\uff08\u30d0\u30a4\u30c8\u30c1\u30e3\u30f3\u30af\uff09","text":"<pre><code>;; (comment) \u3067\u30e9\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u4e0d\u53ef\u80fd\u306a\u4f8b\u3092\u793a\u3059\n(comment\n  ;; stream/file :bytes - \u30d5\u30a1\u30a4\u30eb\u30924KB\u30c1\u30e3\u30f3\u30af\u3067\u8aad\u307f\u8fbc\u307f\n  (stream/file \"image.png\" :bytes)\n    |&gt; (stream/take 10)\n    |&gt; stream/realize\n  ;; =&gt; Vector of Integers (bytes) \u306e\u30ea\u30b9\u30c8\n\n  ;; http/get-stream :bytes - HTTP\u30d0\u30a4\u30ca\u30ea\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n  (http/get-stream \"https://example.com/file.bin\" :bytes)\n    |&gt; (stream/map (fn [chunk] (len chunk)))\n    |&gt; stream/realize)\n</code></pre> <p>\u30e2\u30fc\u30c9\u6bd4\u8f03:</p> \u30e2\u30fc\u30c9 \u7528\u9014 \u623b\u308a\u5024 \u4f8b \u30c6\u30ad\u30b9\u30c8\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09 \u30ed\u30b0\u3001CSV\u3001JSON String\uff08\u884c\u3054\u3068\uff09 <code>(stream/file \"data.txt\")</code> \u30d0\u30a4\u30ca\u30ea\uff08<code>:bytes</code>\uff09 \u753b\u50cf\u3001\u52d5\u753b\u3001\u30d0\u30a4\u30ca\u30ea Vector of Integers\uff084KB\u30c1\u30e3\u30f3\u30af\uff09 <code>(stream/file \"image.png\" :bytes)</code> <pre><code>;; (comment) \u3067\u30e9\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u4e0d\u53ef\u80fd\u306a\u4f8b\u3092\u793a\u3059\n(comment\n  ;; CSV\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406\n  (stream/file \"data.csv\")\n    |&gt; (stream/drop 1)  ; \u30d8\u30c3\u30c0\u30fc\u30b9\u30ad\u30c3\u30d7\n    |&gt; (stream/map (fn [line] (str/split line \",\")))\n    |&gt; (stream/filter (fn [cols] (&gt; (len cols) 2)))\n    |&gt; (stream/take 1000)\n    |&gt; stream/realize\n\n  ;; HTTP\u304b\u3089JSON\u3092\u53d6\u5f97\u3057\u3066\u30d1\u30fc\u30b9\n  (http/get-stream \"https://jsonplaceholder.typicode.com/todos/1\")\n    |&gt; stream/realize\n    |&gt; (str/split _ \"\\n\")\n    |&gt; (join \"\\n\" _)\n    |&gt; json/parse)\n</code></pre> <p>\u5b9f\u7528\u4f8b: \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u89e3\u6790</p> <pre><code>;; (comment) \u3067\u30e9\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u4e0d\u53ef\u80fd\u306a\u4f8b\u3092\u793a\u3059\n(comment\n  ;; \u5927\u304d\u306a\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306b\u51e6\u7406\n  (defn analyze-logs [file]\n    (stream/file file\n     |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n     |&gt; (stream/map str/upper)\n     |&gt; (stream/take 100)  ; \u6700\u521d\u306e100\u30a8\u30e9\u30fc\n     |&gt; stream/realize))\n\n  ;; \u7d50\u679c\u3092\u53d6\u5f97\n  (def errors (analyze-logs \"/var/log/app.log\"))\n  (println (str \"Found \" (len errors) \" errors\")))\n</code></pre>"},{"location":"ja/spec/02-flow-pipes/#_12","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6587\u5316","text":"<p>Unix\u54f2\u5b66 \u00d7 \u95a2\u6570\u578b \u00d7 Lisp</p> <p>\u5c0f\u3055\u306a\u30d1\u30a4\u30d7\u3092\u5b9a\u7fa9\u3057\u3066\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u3001\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u5c0f\u3055\u306a\u30d1\u30a4\u30d7\u3092\u5b9a\u7fa9\n(defn clean-text [text]\n  (text |&gt; str/trim |&gt; str/lower))\n\n(defn extract-words [text]\n  (text |&gt; (str/split _ \" \") |&gt; (filter (fn [s] (&gt; (len s) 3)))))\n\n(defn dedupe [coll]\n  (coll |&gt; sort |&gt; distinct))\n\n;; \u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046\n(def document \"Hello World  from  Qi  Language\")\n(document\n |&gt; clean-text\n |&gt; extract-words\n |&gt; dedupe\n |&gt; (join \", \" _))  ;; =&gt; \"from, hello, language, world\"\n</code></pre>"},{"location":"ja/spec/03-concurrency/","title":"\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406 - Qi\u306e\u771f\u9ac4","text":"<p>Qi\u306f\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u7b2c\u4e00\u7d1a\u5e02\u6c11\u3068\u3057\u3066\u6271\u3046\u8a00\u8a9e\u3067\u3059\u3002</p> <p>\u300c\u4e26\u5217\u3001\u4e26\u884c\u3092\u7c21\u5358\u306b\u3067\u304d\u308b\u306e\u306fQi\u306e\u30ad\u30e2\u300d- \u3053\u308c\u304cQi\u306e\u8a2d\u8a08\u54f2\u5b66\u306e\u6838\u5fc3\u3067\u3059\u3002</p> <p>\u5b9f\u88c5: <code>src/builtins/concurrency.rs</code>, <code>src/builtins/fn.rs</code></p>"},{"location":"ja/spec/03-concurrency/#_1","title":"\u8a2d\u8a08\u54f2\u5b66","text":"<p>Qi\u306e\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u306f3\u5c64\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3067\u69cb\u6210\u3055\u308c\u307e\u3059\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Layer 3: go/await (\u9ad8\u30ec\u30d9\u30eb)        \u2502  \u2190 \u4f7f\u3044\u3084\u3059\u3055\uff08I/O\u3001API\uff09\n\u2502  - go/await, go/then, go/catch      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Layer 2: Pipeline (\u4e2d\u30ec\u30d9\u30eb)        \u2502  \u2190 \u95a2\u6570\u578b\u3089\u3057\u3055\n\u2502  - pmap, go/pipeline, go/fan-out/in \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Layer 1: go/chan (\u4f4e\u30ec\u30d9\u30eb\u57fa\u76e4)     \u2502  \u2190 \u30d1\u30ef\u30fc\u3068\u67d4\u8edf\u6027\n\u2502  - go/run, go/chan, go/send!, ...   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u3059\u3079\u3066go/\u540d\u524d\u7a7a\u9593\u306b\u7d71\u4e00 - \u30b7\u30f3\u30d7\u30eb\u3067\u4e00\u8cab\u6027\u306e\u3042\u308b\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3002</p>"},{"location":"ja/spec/03-concurrency/#layer-1-gochan","title":"Layer 1: go/chan\uff08\u57fa\u76e4\uff09","text":"<p>Go\u98a8\u306e\u4e26\u884c\u51e6\u7406</p>"},{"location":"ja/spec/03-concurrency/#_2","title":"\u30c1\u30e3\u30cd\u30eb\u4f5c\u6210","text":"<pre><code>(go/chan)       ;; \u7121\u5236\u9650\u30d0\u30c3\u30d5\u30a1\n(go/chan 10)    ;; \u30d0\u30c3\u30d5\u30a1\u30b5\u30a4\u30ba10\n</code></pre>"},{"location":"ja/spec/03-concurrency/#_3","title":"\u9001\u53d7\u4fe1","text":"<pre><code>;; \u30c1\u30e3\u30cd\u30eb\u3078\u306e\u9001\u4fe1\u3068\u53d7\u4fe1\n(def ch (go/chan))\n(def value 42)\n\n(go/send! ch value)              ;; \u30c1\u30e3\u30cd\u30eb\u306b\u9001\u4fe1\n(go/recv! ch)                    ;; \u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u53d7\u4fe1\n(go/recv! ch :timeout 1000)      ;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53d7\u4fe1\uff08\u30df\u30ea\u79d2\uff09\n(go/try-recv! ch)                ;; \u975e\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u53d7\u4fe1\n(go/close! ch)                   ;; \u30c1\u30e3\u30cd\u30eb\u30af\u30ed\u30fc\u30ba\n</code></pre>"},{"location":"ja/spec/03-concurrency/#goroutine","title":"goroutine","text":"<pre><code>(go/run (println \"async!\"))\n\n(def result-ch (go/chan))\n(go/run (go/send! result-ch (* 2 3)))\n(go/recv! result-ch)  ;; 6\n</code></pre>"},{"location":"ja/spec/03-concurrency/#_4","title":"\u4f7f\u7528\u4f8b: \u4e26\u5217\u8a08\u7b97","text":"<pre><code>;; \u8907\u6570\u306egoroutine\u3067\u4e26\u5217\u8a08\u7b97\n(def ch (go/chan))\n\n(go/run (go/send! ch (* 2 3)))\n(go/run (go/send! ch (* 4 5)))\n(go/run (go/send! ch (* 6 7)))\n\n[(go/recv! ch) (go/recv! ch) (go/recv! ch)]  ;; =&gt; [6 20 42]\n</code></pre>"},{"location":"ja/spec/03-concurrency/#select-","title":"select! - \u8907\u6570\u30c1\u30e3\u30cd\u30eb\u306e\u5f85\u3061\u5408\u308f\u305b","text":"<pre><code>;; \u8907\u6570\u306e\u30c1\u30e3\u30cd\u30eb\u304b\u3089\u6700\u521d\u306b\u6765\u305f\u30c7\u30fc\u30bf\u3092\u51e6\u7406\n(def ch1 (go/chan))\n(def ch2 (go/chan))\n\n(go/run (go/send! ch1 \"from ch1\"))\n(go/run (go/send! ch2 \"from ch2\"))\n\n(go/select! [\n  [ch1 (fn [val] (println \"Got from ch1:\" val))]\n  [ch2 (fn [val] (println \"Got from ch2:\" val))]])\n</code></pre>"},{"location":"ja/spec/03-concurrency/#structured-concurrency","title":"Structured Concurrency\uff08\u69cb\u9020\u5316\u4e26\u884c\u51e6\u7406\uff09","text":"<pre><code>;; \u30b9\u30b3\u30fc\u30d7\u4f5c\u6210\n(def ctx (go/make-scope))\n\n;; \u30b9\u30b3\u30fc\u30d7\u5185\u3067goroutine\u8d77\u52d5\n(go/scope-go ctx (fn []\n  (loop [i 0]\n    (if (go/cancelled? ctx)\n      (println \"cancelled\")\n      (do\n        (println i)\n        (sleep 100)\n        (recur (inc i)))))))\n\n;; \u30b9\u30b3\u30fc\u30d7\u5185\u306e\u5168goroutine\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\n(go/cancel! ctx)\n\n;; with-scope\u95a2\u6570\uff08\u4fbf\u5229\u7248\uff09\n(go/with-scope (fn [ctx]\n  (go/scope-go ctx task1)\n  (go/scope-go ctx task2)\n  ;; \u30b9\u30b3\u30fc\u30d7\u7d42\u4e86\u6642\u306b\u81ea\u52d5\u30ad\u30e3\u30f3\u30bb\u30eb\n  ))\n</code></pre>"},{"location":"ja/spec/03-concurrency/#layer-2-pipeline","title":"Layer 2: Pipeline\uff08\u69cb\u9020\u5316\u4e26\u884c\u51e6\u7406\uff09","text":"<p>\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u4e26\u5217\u51e6\u7406</p>"},{"location":"ja/spec/03-concurrency/#_5","title":"\u4e26\u5217\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u64cd\u4f5c","text":"<pre><code>;; pmap - \u4e26\u5217map\uff08rayon\u4f7f\u7528\uff09\n([1 2 3 4 5] |&gt; (pmap (fn [x] (* x x))))\n;; =&gt; (1 4 9 16 25)\n\n;; go/pfilter - \u4e26\u5217filter\n([1 2 3 4 5 6] |&gt; (go/pfilter (fn [x] (= (% x 2) 0))))\n;; =&gt; (2 4 6)\n\n;; go/preduce - \u4e26\u5217reduce (fn collection init)\n([1 2 3 4 5] |&gt; (fn [data] (go/preduce + data 0)))\n;; =&gt; 15\n\n;; go/parallel-do - \u8907\u6570\u5f0f\u306e\u4e26\u5217\u5b9f\u884c\n(go/parallel-do\n  (println \"Task 1\")\n  (println \"Task 2\")\n  (println \"Task 3\"))\n</code></pre>"},{"location":"ja/spec/03-concurrency/#_6","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406","text":"<pre><code>;; pipeline - n\u4e26\u5217\u3067xf\u5909\u63db\u3092ch\u306b\u9069\u7528\n(def ch (go/chan))\n(go/pipeline 4 (fn [x] (* x 2)) ch)\n</code></pre>"},{"location":"ja/spec/03-concurrency/#_7","title":"\u30d5\u30a1\u30f3\u30a2\u30a6\u30c8/\u30d5\u30a1\u30f3\u30a4\u30f3","text":"<pre><code>;; fan-out - 1\u3064\u306e\u30c1\u30e3\u30cd\u30eb\u3092n\u500b\u306b\u5206\u5c90\n(def ch (go/chan))\n(def output-chs (go/fan-out ch 3))\n\n;; fan-in - \u8907\u6570\u30c1\u30e3\u30cd\u30eb\u30921\u3064\u306b\u5408\u6d41\n(def ch1 (go/chan))\n(def ch2 (go/chan))\n(def ch3 (go/chan))\n(def merged (go/fan-in [ch1 ch2 ch3]))\n</code></pre>"},{"location":"ja/spec/03-concurrency/#layer-3-goawait","title":"Layer 3: go/await\uff08\u9ad8\u30ec\u30d9\u30eb\uff09","text":"<p>\u30e2\u30c0\u30f3\u306a\u975e\u540c\u671f\u51e6\u7406</p>"},{"location":"ja/spec/03-concurrency/#await","title":"\u57fa\u672c\u7684\u306aawait","text":"<pre><code>(def p (go/run (fn [] (+ 1 2 3))))\n(go/await p)  ;; =&gt; 6\n</code></pre>"},{"location":"ja/spec/03-concurrency/#promise","title":"Promise \u30c1\u30a7\u30fc\u30f3","text":"<pre><code>;; go/then\u3067Promise\u30c1\u30a7\u30fc\u30f3\u3092\u69cb\u7bc9\n(def p (go/run (fn [] 10)))\n(def p2 (go/then p (fn [x] (* x 2))))\n(def p3 (go/then p2 (fn [x] (+ x 1))))\n(go/await p3)  ;; =&gt; 21\n</code></pre>"},{"location":"ja/spec/03-concurrency/#promiseall","title":"Promise.all\u98a8","text":"<pre><code>(def promises [(go/run (fn [] 1)) (go/run (fn [] 2)) (go/run (fn [] 3))])\n(go/await (go/all promises))  ;; =&gt; [1 2 3]\n</code></pre>"},{"location":"ja/spec/03-concurrency/#promiserace","title":"Promise.race\u98a8","text":"<pre><code>(def promises [(go/run (fn [] \"slow\")) (go/run (fn [] \"fast\"))])\n(go/await (go/race promises))  ;; =&gt; \"fast\"\n</code></pre>"},{"location":"ja/spec/03-concurrency/#_8","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>(go/catch promise (fn [e] (println \"Error:\" e)))\n</code></pre>"},{"location":"ja/spec/03-concurrency/#-atom","title":"\u72b6\u614b\u7ba1\u7406 - Atom","text":"<p>\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</p> <p>Qi\u306e\u72b6\u614b\u7ba1\u7406\u306fAtom\uff08\u30a2\u30c8\u30e0\uff09\u3092\u4f7f\u3044\u307e\u3059\u3002Atom\u306f\u53c2\u7167\u900f\u904e\u6027\u3092\u4fdd\u3061\u306a\u304c\u3089\u3001\u5fc5\u8981\u306a\u5834\u6240\u3060\u3051\u3067\u72b6\u614b\u3092\u6301\u3064\u305f\u3081\u306e\u4ed5\u7d44\u307f\u3067\u3059\u3002</p>"},{"location":"ja/spec/03-concurrency/#_9","title":"\u57fa\u672c\u64cd\u4f5c","text":"<pre><code>atom                    ;; \u30a2\u30c8\u30e0\u4f5c\u6210\nderef                   ;; \u5024\u53d6\u5f97\n@                       ;; deref\u306e\u77ed\u7e2e\u5f62\uff08@counter =&gt; (deref counter)\uff09\nswap!                   ;; \u95a2\u6570\u3067\u66f4\u65b0\uff08\u30a2\u30c8\u30df\u30c3\u30af\uff09\nreset!                  ;; \u5024\u3092\u76f4\u63a5\u30bb\u30c3\u30c8\n</code></pre>"},{"location":"ja/spec/03-concurrency/#_10","title":"\u30a2\u30c8\u30e0\u306e\u4f5c\u6210\u3068\u53c2\u7167","text":"<pre><code>;; \u30ab\u30a6\u30f3\u30bf\u30fc\n(def counter (atom 0))\n\n;; \u5024\u3092\u53d6\u5f97\n(deref counter)  ;; 0\n\n;; \u5024\u3092\u66f4\u65b0\n(reset! counter 10)\n(deref counter)  ;; 10\n\n;; \u95a2\u6570\u3067\u66f4\u65b0\uff08\u73fe\u5728\u306e\u5024\u3092\u4f7f\u3046\uff09\n(swap! counter inc)\n(deref counter)  ;; 11\n\n(swap! counter + 5)\n(deref counter)  ;; 16\n</code></pre>"},{"location":"ja/spec/03-concurrency/#deref","title":"@ \u69cb\u6587\uff08deref\u306e\u77ed\u7e2e\u5f62\uff09","text":"<pre><code>;; deref\u306e\u77ed\u7e2e\u5f62\n(deref counter)  ;; \u5f93\u6765\n@counter         ;; \u77ed\u7e2e\u5f62\n\n;; \u3069\u3061\u3089\u3082\u540c\u3058\u610f\u5473\n(print (deref state))\n(print @state)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4fbf\u5229\n(def cache (atom {:user-123 {:name \"Alice\"}}))\n(get @cache :user-123)  ;; {:name \"Alice\"}\n\n;; \u95a2\u6570\u306e\u5f15\u6570\u3068\u3057\u3066\u3082\u4f7f\u3048\u308b\n(def users (atom [{:name \"Alice\"} {:name \"Bob\"}]))\n(first @users)  ;; {:name \"Alice\"}\n(map (fn [u] (get u :name)) @users)  ;; (\"Alice\" \"Bob\")\n</code></pre>"},{"location":"ja/spec/03-concurrency/#1","title":"\u5b9f\u7528\u4f8b1: \u30ab\u30a6\u30f3\u30bf\u30fc","text":"<pre><code>;; \u30ea\u30af\u30a8\u30b9\u30c8\u30ab\u30a6\u30f3\u30bf\u30fc\n(def request-count (atom 0))\n\n(defn handle-request [req]\n  (do\n    (swap! request-count inc)\n    (process req)))\n\n;; \u73fe\u5728\u306e\u30ab\u30a6\u30f3\u30c8\u78ba\u8a8d\n(deref request-count)  ;; \u51e6\u7406\u3057\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u6570\n</code></pre>"},{"location":"ja/spec/03-concurrency/#2","title":"\u5b9f\u7528\u4f8b2: \u72b6\u614b\u3092\u6301\u3064\u30ad\u30e3\u30c3\u30b7\u30e5","text":"<pre><code>;; \u30ad\u30e3\u30c3\u30b7\u30e5\n(def cache (atom {}))\n\n(defn get-or-fetch [key fetch-fn]\n  (let [cached (get (deref cache) key)]\n    (if cached\n      cached\n      (let [value (fetch-fn)]\n        (do\n          (swap! cache assoc key value)\n          value)))))\n\n;; \u4f7f\u7528\u4f8b\n(get-or-fetch :user-123 (fn [] (fetch-from-db :user-123)))\n</code></pre>"},{"location":"ja/spec/03-concurrency/#3-defer","title":"\u5b9f\u7528\u4f8b3: \u63a5\u7d9a\u7ba1\u7406\uff08defer\u3068\u7d44\u307f\u5408\u308f\u305b\uff09","text":"<pre><code>;; \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u63a5\u7d9a\u3092\u7ba1\u7406\uff08\u30d9\u30af\u30bf\u30fc\u3092\u4f7f\u7528\uff09\n(def clients (atom []))\n\n(defn handle-connection [conn]\n  (do\n    (swap! clients conj conn)\n    (defer (swap! clients (fn [cs] (filter (fn [c] (!= c conn)) cs))))  ;; \u78ba\u5b9f\u306b\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7\n    (process-connection conn)))\n\n;; \u30a2\u30af\u30c6\u30a3\u30d6\u63a5\u7d9a\u6570\n(len (deref clients))\n</code></pre>"},{"location":"ja/spec/03-concurrency/#4","title":"\u5b9f\u7528\u4f8b4: \u8907\u96d1\u306a\u72b6\u614b\u66f4\u65b0","text":"<pre><code>;; \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u72b6\u614b\n(def app-state (atom {\n  :users {}\n  :posts []\n  :status \"running\"\n}))\n\n;; \u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\n(defn add-user [user]\n  (swap! app-state (fn [state]\n    (assoc state :users\n      (assoc (get state :users) (get user :id) user)))))\n\n;; \u6295\u7a3f\u8ffd\u52a0\n(defn add-post [post]\n  (swap! app-state (fn [state]\n    (assoc state :posts (conj (get state :posts) post)))))\n\n;; \u72b6\u614b\u78ba\u8a8d\n(deref app-state)\n</code></pre>"},{"location":"ja/spec/03-concurrency/#5","title":"\u5b9f\u7528\u4f8b5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ab\u30a6\u30f3\u30bf\u30fc","text":"<pre><code>(def counter (atom 0))\n\n;; \u8907\u6570\u306egoroutine\u304b\u3089\u5b89\u5168\u306b\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n\n(sleep 100)  ;; \u5b8c\u4e86\u3092\u5f85\u3064\n(deref counter)  ;; =&gt; 3\n</code></pre>"},{"location":"ja/spec/03-concurrency/#atom","title":"Atom\u306e\u8a2d\u8a08\u54f2\u5b66","text":"<ol> <li>\u5c40\u6240\u7684\u306a\u72b6\u614b: \u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u306e\u4ee3\u308f\u308a\u306b\u3001\u5fc5\u8981\u306a\u5834\u6240\u3060\u3051\u3067Atom\u3092\u4f7f\u3046</li> <li>swap!\u306e\u539f\u5b50\u6027: \u66f4\u65b0\u304c\u78ba\u5b9f\u306b\u9069\u7528\u3055\u308c\u308b\uff08\u7af6\u5408\u72b6\u614b\u3092\u56de\u907f\uff09</li> <li>\u95a2\u6570\u578b\u3068\u306e\u5171\u5b58: \u7d14\u7c8b\u95a2\u6570\u3068Atom\u3092\u7d44\u307f\u5408\u308f\u305b\u308b</li> <li>defer\u3068\u76f8\u6027\u304c\u826f\u3044: \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u3067\u5a01\u529b\u3092\u767a\u63ee</li> </ol>"},{"location":"ja/spec/03-concurrency/#_11","title":"\u5b9f\u88c5\u6280\u8853\u30b9\u30bf\u30c3\u30af","text":"<ul> <li>crossbeam-channel: Go\u98a8\u30c1\u30e3\u30cd\u30eb\u5b9f\u88c5\uff08select!\u30de\u30af\u30ed\u3082\u63d0\u4f9b\uff09</li> <li>rayon: \u30c7\u30fc\u30bf\u4e26\u5217\uff08pmap, go/pfilter, go/preduce\u7b49\uff09</li> <li>parking_lot: \u9ad8\u6027\u80fdRwLock</li> <li>Arc&lt;RwLock&lt;_&gt;&gt;: Evaluator\u306e\u5b8c\u5168\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u5316</li> </ul>"},{"location":"ja/spec/03-concurrency/#_12","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/03-concurrency/#layer-1-gochan_1","title":"Layer 1 (go/chan)","text":"<ul> <li><code>go/chan</code>: \u30c1\u30e3\u30cd\u30eb\u4f5c\u6210</li> <li><code>go/send!</code>: \u9001\u4fe1</li> <li><code>go/recv!</code>: \u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u53d7\u4fe1</li> <li><code>go/recv! :timeout</code>: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53d7\u4fe1</li> <li><code>go/try-recv!</code>: \u975e\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u53d7\u4fe1</li> <li><code>go/close!</code>: \u30c1\u30e3\u30cd\u30eb\u30af\u30ed\u30fc\u30ba</li> <li><code>go/run</code>: goroutine\u8d77\u52d5</li> <li><code>go/select!</code>: \u8907\u6570\u30c1\u30e3\u30cd\u30eb\u5f85\u3061\u5408\u308f\u305b</li> <li><code>go/make-scope</code>: \u30b9\u30b3\u30fc\u30d7\u4f5c\u6210</li> <li><code>go/scope-go</code>: \u30b9\u30b3\u30fc\u30d7\u5185goroutine</li> <li><code>go/cancel!</code>: \u30b9\u30b3\u30fc\u30d7\u30ad\u30e3\u30f3\u30bb\u30eb</li> <li><code>go/cancelled?</code>: \u30ad\u30e3\u30f3\u30bb\u30eb\u78ba\u8a8d</li> <li><code>go/with-scope</code>: \u30b9\u30b3\u30fc\u30d7\u81ea\u52d5\u7ba1\u7406</li> </ul>"},{"location":"ja/spec/03-concurrency/#layer-2-pipeline_1","title":"Layer 2 (Pipeline)","text":"<ul> <li><code>pmap</code>: \u4e26\u5217map</li> <li><code>go/pfilter</code>: \u4e26\u5217filter</li> <li><code>go/preduce</code>: \u4e26\u5217reduce</li> <li><code>go/parallel-do</code>: \u8907\u6570\u5f0f\u306e\u4e26\u5217\u5b9f\u884c</li> <li><code>go/pipeline</code>: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406</li> <li><code>go/pipeline-map</code>: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3map</li> <li><code>go/pipeline-filter</code>: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3filter</li> <li><code>go/fan-out</code>: \u30d5\u30a1\u30f3\u30a2\u30a6\u30c8</li> <li><code>go/fan-in</code>: \u30d5\u30a1\u30f3\u30a4\u30f3</li> </ul>"},{"location":"ja/spec/03-concurrency/#layer-3-goawait_1","title":"Layer 3 (go/await)","text":"<ul> <li><code>go/await</code>: Promise\u3092\u5f85\u6a5f</li> <li><code>go/then</code>: Promise\u30c1\u30a7\u30fc\u30f3</li> <li><code>go/catch</code>: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>go/all</code>: \u8907\u6570Promise\u3092\u4e26\u5217\u5b9f\u884c</li> <li><code>go/race</code>: \u6700\u901f\u306ePromise\u3092\u8fd4\u3059</li> </ul>"},{"location":"ja/spec/03-concurrency/#_13","title":"\u72b6\u614b\u7ba1\u7406","text":"<ul> <li><code>atom</code>: \u30a2\u30c8\u30e0\u4f5c\u6210</li> <li><code>deref</code> (<code>@</code>): \u5024\u53d6\u5f97</li> <li><code>swap!</code>: \u95a2\u6570\u3067\u66f4\u65b0\uff08\u30a2\u30c8\u30df\u30c3\u30af\uff09</li> <li><code>reset!</code>: \u5024\u3092\u76f4\u63a5\u30bb\u30c3\u30c8</li> </ul>"},{"location":"ja/spec/04-match/","title":"\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u5206\u5c90\u3055\u305b\u308b\u5236\u5fa1\u69cb\u9020</p> <p>Qi\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u306f\u3001\u5358\u306a\u308b\u6761\u4ef6\u5206\u5c90\u3067\u306f\u306a\u304f\u3001\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u5206\u89e3\u30fb\u5909\u63db\u30fb\u691c\u8a3c\u3057\u306a\u304c\u3089\u51e6\u7406\u3092\u632f\u308a\u5206\u3051\u307e\u3059\u3002</p>"},{"location":"ja/spec/04-match/#_2","title":"\u57fa\u672c\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"ja/spec/04-match/#_3","title":"\u5024\u306e\u30de\u30c3\u30c1","text":"<pre><code>(match x\n  0 -&gt; \"zero\"\n  1 -&gt; \"one\"\n  n -&gt; (str \"other: \" n))\n</code></pre>"},{"location":"ja/spec/04-match/#nilbool","title":"nil/bool\u306e\u533a\u5225","text":"<pre><code>(match result\n  nil -&gt; \"not found\"\n  false -&gt; \"explicitly false\"\n  true -&gt; \"success\"\n  v -&gt; (str \"value: \" v))\n</code></pre>"},{"location":"ja/spec/04-match/#_4","title":"\u30de\u30c3\u30d7\u306e\u30de\u30c3\u30c1","text":"<pre><code>(def data {:type \"user\" :name \"Alice\"})\n(match data\n  {:type \"user\" :name n} -&gt; (str \"Hello, \" n)\n  {:type \"admin\"} -&gt; \"admin\"\n  _ -&gt; \"unknown\")\n;; =&gt; \"Hello, Alice\"\n</code></pre>"},{"location":"ja/spec/04-match/#_5","title":"\u30ea\u30b9\u30c8\u306e\u30de\u30c3\u30c1","text":"<pre><code>(match lst\n  [] -&gt; \"empty\"\n  [x] -&gt; x\n  [x ...rest] -&gt; (str \"first: \" x))\n</code></pre>"},{"location":"ja/spec/04-match/#_6","title":"\u30ac\u30fc\u30c9\u6761\u4ef6","text":"<pre><code>(match x\n  n when (&gt; n 0) -&gt; \"positive\"\n  n when (&lt; n 0) -&gt; \"negative\"\n  _ -&gt; \"zero\")\n</code></pre>"},{"location":"ja/spec/04-match/#_7","title":"\u62e1\u5f35\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"ja/spec/04-match/#1-as-","title":"1. <code>:as</code> \u675f\u7e1b - \u90e8\u5206\u3068\u5168\u4f53\u306e\u4e21\u65b9\u3092\u4f7f\u3046","text":"<p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3057\u305f\u5168\u4f53\u3092\u5909\u6570\u306b\u675f\u7e1b\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a:as\u4f7f\u7528\n(def data {:user {:name \"Alice\" :age 30}})\n(match data\n  {:user {:name n :age a} :as u} -&gt; (do\n    (println u)       ;; \u5168\u4f53\u3092\u8868\u793a\n    (str n \" is \" a \" years old\")))   ;; \u90e8\u5206\u3092\u4f7f\u7528\n;; =&gt; \"Alice is 30 years old\"\n\n;; \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3067\u3082\u4f7f\u3048\u308b\n(def response {:body {:user \"Bob\" :posts 10}})\n(match response\n  {:body {:user u :posts ps} :as body} -&gt; (str \"User: \" u \", Posts: \" ps \", Body: \" body)\n  {:error e :as err} -&gt; (str \"Error: \" err))\n;; =&gt; \"User: Bob, Posts: 10, Body: {:body {:user Bob, :posts 10}}\"\n\n;; \u6df1\u304f\u30cd\u30b9\u30c8\u3055\u308c\u305f:as\n(match {:type \"person\" :data {:name \"Alice\" :age 30}}\n  {:type t :data {:name n :age a :as user-data} :as record} -&gt;\n    (do\n      (println f\"Type: {t}\")           ;; \"Type: person\"\n      (println f\"Name: {n}, Age: {a}\") ;; \"Name: Alice, Age: 30\"\n      (println f\"User data: {user-data}\") ;; {:name \"Alice\", :age 30}\n      (println f\"Full record: {record}\"))) ;; \u5168\u4f53\u306e\u30de\u30c3\u30d7\n\n;; \u30d9\u30af\u30bf\u30fc\u3068\u30de\u30c3\u30d7\u306e\u7d44\u307f\u5408\u308f\u305b\n(match [1 {:x 10 :y 20}]\n  [a {:x b :as inner}] -&gt; [a b inner])\n;; =&gt; [1 10 {:x 10 :y 20}]\n\n;; \u95a2\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u3082\u4f7f\u3048\u308b\n(defn process [{:name n :age a :as user}]\n  (do\n    (println f\"Processing: {n}\")\n    user))  ;; \u5168\u4f53\u3092\u8fd4\u3059\n\n(process {:name \"Charlie\" :age 25})\n;; \u51fa\u529b: Processing: Charlie\n;; \u623b\u308a\u5024: {:name \"Charlie\", :age 25}\n</code></pre>"},{"location":"ja/spec/04-match/#2-or-","title":"2. <code>or</code> \u30d1\u30bf\u30fc\u30f3 - \u8907\u6570\u30d1\u30bf\u30fc\u30f3\u3067\u540c\u3058\u51e6\u7406","text":"<p>\u8907\u6570\u306e\u5024\u306b\u30de\u30c3\u30c1\u3055\u305b\u3066\u540c\u3058\u51e6\u7406\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\uff08<code>|</code> \u8a18\u6cd5\u3092\u4f7f\u7528\uff09\u3002</p> <pre><code>;; \u8907\u6570\u306e\u5024\u306b\u30de\u30c3\u30c1\n(match status\n  200 | 201 | 204 -&gt; \"success\"\n  400 | 401 | 403 -&gt; \"client error\"\n  500 | 502 | 503 -&gt; \"server error\"\n  _ -&gt; \"unknown\")\n\n;; \u6587\u5b57\u5217\u306b\u3082\u4f7f\u3048\u308b\n(match day\n  \"\u6708\" | \"\u706b\" | \"\u6c34\" | \"\u6728\" | \"\u91d1\" -&gt; \"\u5e73\u65e5\"\n  \"\u571f\" | \"\u65e5\" -&gt; \"\u9031\u672b\")\n\n;; \u30ad\u30fc\u30ef\u30fc\u30c9\u306b\u3082\u4f7f\u3048\u308b\n(match result\n  :ok | :success -&gt; (handle-ok)\n  :error | :fail -&gt; (handle-error))\n</code></pre>"},{"location":"ja/spec/04-match/#3-","title":"3. \u30cd\u30b9\u30c8 + \u30ac\u30fc\u30c9 - \u69cb\u9020\u7684\u306a\u6761\u4ef6\u5206\u5c90","text":"<p>\u6df1\u3044\u30cd\u30b9\u30c8\u3068\u30ac\u30fc\u30c9\u6761\u4ef6\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u6df1\u3044\u30cd\u30b9\u30c8\u3067\u3082\u8aad\u307f\u3084\u3059\u3044\n(def request {:user {:age 20 :country \"JP\"}})\n(match request\n  {:user {:age a :country c}} when (and (&gt;= a 18) (= c \"JP\")) -&gt; \"allowed\"\n  {:user {:age a}} when (&lt; a 18) -&gt; {:error \"age restriction\"}\n  _ -&gt; \"denied\")\n;; =&gt; \"allowed\"\n</code></pre>"},{"location":"ja/spec/04-match/#4-_-","title":"4. \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 <code>_</code> - \u95a2\u5fc3\u306e\u3042\u308b\u90e8\u5206\u3060\u3051\u62bd\u51fa","text":"<p>\u5fc5\u8981\u306a\u90e8\u5206\u3060\u3051\u3092\u62bd\u51fa\u3057\u3001\u4e0d\u8981\u306a\u90e8\u5206\u306f <code>_</code> \u3067\u7121\u8996\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u4e00\u90e8\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3060\u3051\u4f7f\u3046\n(def data {:user {:name \"Alice\" :age 30 :city \"Tokyo\"}})\n(match data\n  {:user {:name _ :age a :city c}} -&gt; (str \"Age: \" a \", City: \" c)\n  {:error _} -&gt; \"error occurred\")\n;; =&gt; \"Age: 30, City: Tokyo\"\n\n;; \u30ea\u30b9\u30c8\u306e\u4e00\u90e8\u3092\u30b9\u30ad\u30c3\u30d7\n(def coords [10 20 30])\n(match coords\n  [_ y _] -&gt; y  ;; y\u5ea7\u6a19\u3060\u3051\u53d6\u308a\u51fa\u3059\n  _ -&gt; 0)\n;; =&gt; 20\n</code></pre>"},{"location":"ja/spec/04-match/#5","title":"5. \u914d\u5217\u306e\u8907\u6570\u675f\u7e1b","text":"<p>\u8907\u6570\u8981\u7d20\u3092\u540c\u6642\u306b\u675f\u7e1b\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u8907\u6570\u8981\u7d20\u3092\u540c\u6642\u306b\u675f\u7e1b\n(def data [{:id 1} {:id 2}])\n(match data\n  [{:id id1} {:id id2}] -&gt; (str \"ID1: \" id1 \", ID2: \" id2)\n  [first ...rest] -&gt; (str \"First: \" first \", Rest: \" rest))\n;; =&gt; \"ID1: 1, ID2: 2\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u7d44\u307f\u5408\u308f\u305b\n(def coords [10 20 30 40])\n(match (coords |&gt; (take 2))\n  [x y] -&gt; (+ x y)\n  _ -&gt; 0)\n;; =&gt; 30\n</code></pre>"},{"location":"ja/spec/04-match/#match","title":"match\u306e\u8a2d\u8a08\u54f2\u5b66","text":"<ol> <li>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u5206\u5c90\u3055\u305b\u308b: match\u306f\u5358\u306a\u308bif-else\u3067\u306f\u306a\u304f\u3001\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u5206\u89e3\u3057\u3066\u6d41\u308c\u3092\u4f5c\u308b</li> <li>\u8aad\u307f\u3084\u3059\u3055\u512a\u5148: \u30d1\u30bf\u30fc\u30f3\u304c\u4e0a\u304b\u3089\u4e0b\u306b\u8aad\u3081\u308b\u3001\u6761\u4ef6\u304c\u4e00\u76ee\u3067\u5206\u304b\u308b</li> <li>\u6bb5\u968e\u7684\u958b\u793a: \u57fa\u672c\u30d1\u30bf\u30fc\u30f3\u304b\u3089\u59cb\u3081\u3066\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u62e1\u5f35\u6a5f\u80fd\u3092\u4f7f\u3046</li> </ol>"},{"location":"ja/spec/04-match/#try","title":"try\u3068\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<p><code>try</code> \u306f\u4f8b\u5916\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3001\u30a8\u30e9\u30fc\u6642\u306b <code>{:error e}</code> \u3092\u8fd4\u3057\u307e\u3059\u3002\u6210\u529f\u6642\u306f\u5024\u3092\u305d\u306e\u307e\u307e\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u6210\u529f\u6642\u306f\u5024\u305d\u306e\u307e\u307e\u3001\u30a8\u30e9\u30fc\u6642\u306f {:error e}\n(defn risky-operation []\n  (if (&gt; (rand) 0.5)\n    42\n    (panic \"Failed\")))\n\n(match (try (risky-operation))\n  {:error e} -&gt; (str \"Error: \" e)\n  result -&gt; result)\n;; =&gt; 42 \u307e\u305f\u306f \"Error: Failed\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u7d44\u307f\u5408\u308f\u305b\n(def json-str \"{\\\"value\\\": 100}\")\n(match (try\n         (json-str\n          |&gt; json/parse\n          |&gt; (fn [data] (get data \"value\"))\n          |&gt; (fn [v] (* v 2))))\n  {:error e} -&gt; nil\n  data -&gt; data)\n;; =&gt; 200\n</code></pre>"},{"location":"ja/spec/04-match/#_8","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/04-match/#1-http","title":"\u4f8b1: HTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>;; (comment) \u3067\u30e9\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u4e0d\u53ef\u80fd\u306a\u4f8b\u3092\u793a\u3059\n(comment\n  ;; http/get!\u306f\u4f8b\u5916\u3092\u6295\u3052\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u306e\u3067try\u3067\u30ad\u30e3\u30c3\u30c1\n  (match (try (http/get! url))  ;; \u8a73\u7d30\u7248\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\n    {:error e} -&gt; (str \"Error: \" e)\n    {:status 200 :body body} -&gt; body\n    {:status 404} -&gt; nil\n    {:status s} -&gt; {:error (str \"Unexpected status: \" s)}))\n</code></pre>"},{"location":"ja/spec/04-match/#2","title":"\u4f8b2: \u30c7\u30fc\u30bf\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>(def user {:name \"Alice\" :age 30 :email \"alice@example.com\"})\n(match user\n  {:name n :age a :email e} when (and (&gt; a 0) (str/contains? e \"@\")) -&gt; \"Valid user\"\n  {:name _ :age a} when (&lt;= a 0) -&gt; {:error \"Invalid age\"}\n  {:name _ :email e} when (not (str/contains? e \"@\")) -&gt; {:error \"Invalid email\"}\n  _ -&gt; {:error \"Missing required fields\"})\n;; =&gt; \"Valid user\"\n</code></pre>"},{"location":"ja/spec/04-match/#3","title":"\u4f8b3: \u30ea\u30b9\u30c8\u51e6\u7406","text":"<pre><code>(defn process-list [lst]\n  (match lst\n    [] -&gt; \"empty\"\n    [x] -&gt; (str \"single: \" x)\n    [x y] -&gt; (str \"pair: \" x \", \" y)\n    [x y ...rest] -&gt; (str \"multiple: \" x \", \" y \", and \" (len rest) \" more\")))\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/","title":"\u57fa\u672c\u69cb\u6587","text":"<p>Qi\u306e\u57fa\u672c\u7684\u306a\u69cb\u6587\u8981\u7d20</p>"},{"location":"ja/spec/05-syntax-basics/#_2","title":"\u30b3\u30e1\u30f3\u30c8","text":"<pre><code>; 1\u884c\u30b3\u30e1\u30f3\u30c8\n;; \u4e00\u822c\u7684\u306b\u306f ;; \u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\n\n(def x 42)  ; \u884c\u672b\u30b3\u30e1\u30f3\u30c8\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_3","title":"\u30c7\u30fc\u30bf\u578b","text":"<p>Qi\u306f\u52d5\u7684\u578b\u4ed8\u3051\u8a00\u8a9e\u3067\u3001\u4ee5\u4e0b\u306e\u57fa\u672c\u578b\u3092\u6301\u3061\u307e\u3059\uff1a</p> <ul> <li>\u6570\u5024: \u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570</li> <li>\u6587\u5b57\u5217: UTF-8\u5bfe\u5fdc\u3001f-string\u5bfe\u5fdc</li> <li>\u771f\u507d\u5024: <code>true</code>, <code>false</code></li> <li>nil: \u5024\u306e\u4e0d\u5728\u3092\u8868\u3059</li> <li>\u30d9\u30af\u30bf\u30fc: <code>[1 2 3]</code></li> <li>\u30de\u30c3\u30d7: <code>{:key \"value\"}</code></li> <li>\u30ea\u30b9\u30c8: <code>'(1 2 3)</code> (\u30af\u30aa\u30fc\u30c8\u5fc5\u9808)</li> <li>\u95a2\u6570: \u7b2c\u4e00\u7d1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8</li> <li>\u30ad\u30fc\u30ef\u30fc\u30c9: <code>:keyword</code></li> </ul>"},{"location":"ja/spec/05-syntax-basics/#_4","title":"\u30ea\u30c6\u30e9\u30eb","text":""},{"location":"ja/spec/05-syntax-basics/#_5","title":"\u6570\u5024","text":"<pre><code>42          ;; \u6574\u6570\n3.14        ;; \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\n-10         ;; \u8ca0\u306e\u6570\n1_000_000   ;; \u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2\u533a\u5207\u308a\uff08\u53ef\u8aad\u6027\u5411\u4e0a\uff09\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_6","title":"\u6587\u5b57\u5217","text":"<pre><code>;; \u57fa\u672c\n\"hello\"\n\"hello\\nworld\"      ;; \u30a8\u30b9\u30b1\u30fc\u30d7\u30b7\u30fc\u30b1\u30f3\u30b9\n\"say \\\"hello\\\"\"     ;; \u30af\u30aa\u30fc\u30c8\u306e\u30a8\u30b9\u30b1\u30fc\u30d7\n\n;; \u8907\u6570\u884c\u6587\u5b57\u5217\uff08Python\u98a8\uff09\n\"\"\"\nThis is a\nmulti-line\nstring\n\"\"\"\n\n;; \u8907\u6570\u884c\u3067SQL\u3084HTML\u3092\u8a18\u8ff0\n(def query \"\"\"\n  SELECT name, age\n  FROM users\n  WHERE age &gt;= 18\n  ORDER BY name\n\"\"\")\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#f-string","title":"f-string\uff08\u6587\u5b57\u5217\u88dc\u9593\uff09","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\nf\"Hello, World!\"  ;; =&gt; \"Hello, World!\"\n\n;; \u5909\u6570\u306e\u88dc\u9593\n(def name \"Alice\")\nf\"Hello, {name}!\"  ;; =&gt; \"Hello, Alice!\"\n\n;; \u5f0f\u3082\u4f7f\u3048\u308b\nf\"Result: {(+ 1 2)}\"  ;; =&gt; \"Result: 3\"\n\n;; \u30ea\u30b9\u30c8\u3084\u30d9\u30af\u30bf\u306e\u88dc\u9593\nf\"List: {[1 2 3]}\"  ;; =&gt; \"List: [1 2 3]\"\n\n;; \u30de\u30c3\u30d7\u30a2\u30af\u30bb\u30b9\n(def user {:name \"Bob\" :age 30})\nf\"Name: {(get user :name)}, Age: {(get user :age)}\"\n;; =&gt; \"Name: Bob, Age: 30\"\n\n;; \u30a8\u30b9\u30b1\u30fc\u30d7\nf\"Escaped: \\{not interpolated\\}\"  ;; =&gt; \"Escaped: {not interpolated}\"\n\n;; \u8907\u6570\u884cf-string\n(def name \"Alice\")\n(def age 30)\n\nf\"\"\"\nName: {name}\nAge: {age}\nStatus: Active\n\"\"\"\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#bool-nil","title":"bool \u3068 nil","text":"<pre><code>true\nfalse\nnil\n\n;; \u6761\u4ef6\u5f0f\u3067\u306e\u6271\u3044\n(if nil \"yes\" \"no\")     ;; \"no\" (nil\u306ffalsy)\n(if false \"yes\" \"no\")   ;; \"no\" (false\u306ffalsy)\n(if 0 \"yes\" \"no\")       ;; \"yes\" (0\u306ftruthy)\n(if \"\" \"yes\" \"no\")      ;; \"yes\" (\u7a7a\u6587\u5b57\u3082truthy)\n\n;; \u660e\u793a\u7684\u306a\u6bd4\u8f03\n(= x nil)               ;; nil\u30c1\u30a7\u30c3\u30af\n(= x false)             ;; false\u30c1\u30a7\u30c3\u30af\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_7","title":"\u30ad\u30fc\u30ef\u30fc\u30c9","text":"<pre><code>:keyword\n:name\n:type\n\n;; \u30de\u30c3\u30d7\u306e\u30ad\u30fc\u3068\u3057\u3066\u4f7f\u7528\n{:name \"Alice\" :age 30}\n\n;; \u30de\u30c3\u30d7\u304b\u3089\u5024\u3092\u53d6\u5f97\uff08get\u95a2\u6570\u3092\u4f7f\u7528\uff09\n(def user {:name \"Bob\" :age 25})\n(get user :name)  ;; =&gt; \"Bob\"\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_8","title":"\u5185\u90e8\u5b9f\u88c5\uff1a\u30a4\u30f3\u30bf\u30fc\u30f3\u5316","text":"<p>Qi\u3067\u306f\u3001\u30ad\u30fc\u30ef\u30fc\u30c9\u3068\u30b7\u30f3\u30dc\u30eb\u306f\u81ea\u52d5\u7684\u306b\u30a4\u30f3\u30bf\u30fc\u30f3\u5316\u3055\u308c\u307e\u3059\u3002</p> <p>\u30a4\u30f3\u30bf\u30fc\u30f3\u5316\u3068\u306f: - \u540c\u3058\u6587\u5b57\u5217\u30921\u3064\u306e\u30e1\u30e2\u30ea\u9818\u57df\u306b\u683c\u7d0d\u3057\u3001\u8907\u6570\u306e\u5834\u6240\u3067\u5171\u6709\u3059\u308b\u4ed5\u7d44\u307f - Rust \u306e <code>Arc&lt;str&gt;</code> \u3092\u4f7f\u7528\u3057\u3066\u5b9f\u88c5</p> <p>\u30e1\u30ea\u30c3\u30c8: 1. \u30e1\u30e2\u30ea\u52b9\u7387: \u540c\u3058\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u4f55\u5ea6\u4f7f\u3063\u3066\u3082\u3001\u30e1\u30e2\u30ea\u306f1\u3064\u3060\u3051 2. \u9ad8\u901f\u6bd4\u8f03: \u6587\u5b57\u5217\u306e\u5185\u5bb9\u3067\u306f\u306a\u304f\u3001\u30dd\u30a4\u30f3\u30bf\u3092\u6bd4\u8f03\u3059\u308b\u3060\u3051\u3067OK 3. \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5: Arc \u306b\u3088\u308a\u8907\u6570\u30b9\u30ec\u30c3\u30c9\u3067\u5b89\u5168\u306b\u5171\u6709</p> <pre><code>;; \u2705 \u30a4\u30f3\u30bf\u30fc\u30f3\u5316\u3055\u308c\u308b\uff08\u63a8\u5968\uff09\n(def k1 :name)\n(def k2 :name)\n;; k1\u3068k2\u306f\u540c\u3058\u30e1\u30e2\u30ea\u9818\u57df\u3092\u6307\u3059 \u2192 \u9ad8\u901f\u6bd4\u8f03\n\n;; \u30b7\u30f3\u30dc\u30eb\u3082\u540c\u69d8\u306b\u30a4\u30f3\u30bf\u30fc\u30f3\u5316\n(def s1 'foo)\n(def s2 'foo)\n;; s1\u3068s2\u306f\u540c\u3058\u30e1\u30e2\u30ea\u9818\u57df\u3092\u6307\u3059\n</code></pre> <p>\u6280\u8853\u7684\u8a73\u7d30: <pre><code>// \u5185\u90e8\u5b9f\u88c5\uff08Rust\uff09\npub enum Value {\n    Keyword(Arc&lt;str&gt;),  // :name\n    Symbol(Arc&lt;str&gt;),   // 'symbol\n    String(String),     // \u901a\u5e38\u306e\u6587\u5b57\u5217\uff08\u30a4\u30f3\u30bf\u30fc\u30f3\u5316\u306a\u3057\uff09\n    // ...\n}\n</code></pre></p> <p>\u3053\u306e\u8a2d\u8a08\u306b\u3088\u308a\u3001Qi\u306f\u5927\u91cf\u306e\u30ad\u30fc\u30ef\u30fc\u30c9\u30fb\u30b7\u30f3\u30dc\u30eb\u3092\u6271\u3046\u5834\u5408\u3067\u3082\u9ad8\u901f\u304b\u3064\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u3067\u3059\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#_9","title":"\u30d9\u30af\u30bf\u30fc","text":"<pre><code>[]              ;; \u7a7a\u306e\u30d9\u30af\u30bf\u30fc\n[1 2 3]         ;; \u6570\u5024\u306e\u30d9\u30af\u30bf\u30fc\n[\"a\" \"b\" \"c\"]   ;; \u6587\u5b57\u5217\u306e\u30d9\u30af\u30bf\u30fc\n[1 \"hello\" :key]  ;; \u6df7\u5728\u3082\u53ef\u80fd\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_10","title":"\u30de\u30c3\u30d7","text":"<pre><code>{}                          ;; \u7a7a\u306e\u30de\u30c3\u30d7\n{:name \"Alice\" :age 30}     ;; \u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u30ad\u30fc\u306b\u3059\u308b\n{\"name\" \"Bob\" \"age\" 25}     ;; \u6587\u5b57\u5217\u3092\u30ad\u30fc\u306b\u3059\u308b\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_11","title":"\u30ea\u30b9\u30c8","text":"<pre><code>'()             ;; \u7a7a\u306e\u30ea\u30b9\u30c8\n'(1 2 3)        ;; \u30af\u30aa\u30fc\u30c8\u5fc5\u9808\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#9","title":"\u7279\u6b8a\u5f62\u5f0f\uff089\u3064\uff09","text":""},{"location":"ja/spec/05-syntax-basics/#def-","title":"<code>def</code> - \u30b0\u30ed\u30fc\u30d0\u30eb\u5b9a\u7fa9","text":"<pre><code>(def x 42)\n(def greet (fn [name] (str \"Hello, \" name)))\n(def ops [+ - * /])\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#defn-","title":"<code>defn</code> - \u95a2\u6570\u5b9a\u7fa9\uff08\u7cd6\u8863\u69cb\u6587\uff09","text":"<pre><code>;; \u57fa\u672c\u5f62\u5f0f\n(defn greet [name]\n  (str \"Hello, \" name))\n\n;; \u53ef\u5909\u9577\u5f15\u6570\n(defn sum [&amp; nums]\n  (reduce + 0 nums))\n\n;; \u30d9\u30af\u30bf\u306e\u5206\u89e3\uff08Destructuring\uff09\n(defn add-pair [[x y]]\n  (+ x y))\n\n(defn format-kv [[k v]]\n  f\"{k}={v}\")\n\n;; ...rest\u69cb\u6587\uff08\u30d9\u30af\u30bf\u306e\u6b8b\u308a\u306e\u8981\u7d20\u3092\u53d6\u5f97\uff09\n(defn process-list [[first ...rest]]\n  (str \"first: \" first \", rest: \" rest))\n\n(process-list [1 2 3 4])  ;; =&gt; \"first: 1, rest: (2 3 4)\"\n\n;; map\u306e\u5206\u89e3\n(defn greet [{:name n :age a}]\n  (str n \"\u3055\u3093\u306f\" a \"\u6b73\u3067\u3059\"))\n\n(greet {:name \"\u592a\u90ce\" :age 25})  ;; =&gt; \"\u592a\u90ce\u3055\u3093\u306f25\u6b73\u3067\u3059\"\n\n;; map\u5206\u89e3 + :as\u675f\u7e1b\n(defn log-user [{:name n :as user}]\n  (do\n    (println f\"Processing: {n}\")\n    user))\n\n;; defn\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5c55\u958b\u3055\u308c\u308b\n(defn greet [name] body)\n;; \u2193\n(def greet (fn [name] body))\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#fn-","title":"<code>fn</code> - \u95a2\u6570\u5b9a\u7fa9","text":"<pre><code>(fn [x] (* x 2))\n(fn [x y] (+ x y))\n(fn [] (println \"no args\"))\n\n;; \u53ef\u5909\u9577\u5f15\u6570\n(fn [&amp; args] (reduce + 0 args))\n\n;; \u30d9\u30af\u30bf\u306e\u5206\u89e3\uff08Destructuring\uff09\n(fn [[x y]] (+ x y))  ;; 2\u8981\u7d20\u306e\u30d9\u30af\u30bf\u3092\u53d7\u3051\u53d6\u308b\n(fn [[k v]] f\"{k}={v}\")  ;; \u30ad\u30fc\u3068\u5024\u306e\u30da\u30a2\n\n;; \u30cd\u30b9\u30c8\u3057\u305f\u5206\u89e3\n(fn [[[a b] c]] (+ a b c))  ;; [[1 2] 3] =&gt; 6\n\n;; ...rest\u69cb\u6587\n(fn [[first ...rest]]\n  (str \"first: \" first \", rest: \" rest))\n\n;; map\u306e\u5206\u89e3\n(fn [{:name n :age a}]\n  (str n \" is \" a \" years old\"))\n\n;; map\u5206\u89e3 + :as\u675f\u7e1b\n(fn [{:name n :as user}]\n  (do\n    (println f\"Processing: {n}\")\n    user))\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#let-","title":"<code>let</code> - \u30ed\u30fc\u30ab\u30eb\u675f\u7e1b","text":"<pre><code>(let [x 10 y 20]\n  (+ x y))\n\n;; \u30cd\u30b9\u30c8\u53ef\u80fd\n(let [a 1]\n  (let [b 2]\n    (+ a b)))\n\n;; \u30d9\u30af\u30bf\u306e\u5206\u89e3\uff08Destructuring\uff09\n(let [[x y] [10 20]]\n  (+ x y))  ;; =&gt; 30\n\n(let [[k v] [\"name\" \"Alice\"]]\n  f\"{k}={v}\")  ;; =&gt; \"name=Alice\"\n\n;; \u30cd\u30b9\u30c8\u3057\u305f\u5206\u89e3\n(let [[[a b] c] [[1 2] 3]]\n  (+ a b c))  ;; =&gt; 6\n\n;; ...rest\u69cb\u6587\n(let [[first ...rest] [1 2 3 4]]\n  (str \"first: \" first \", rest: \" rest))\n;; =&gt; \"first: 1, rest: (2 3 4)\"\n\n(let [[x y ...tail] [10 20 30 40]]\n  {:x x :y y :tail tail})\n;; =&gt; {:x 10, :y 20, :tail (30 40)}\n\n;; map\u306e\u5206\u89e3\n(let [{:name n :age a} {:name \"Alice\" :age 30}]\n  (str n \" is \" a))\n;; =&gt; \"Alice is 30\"\n\n;; :as\u675f\u7e1b\uff08\u90e8\u5206\u3068\u5168\u4f53\u3092\u540c\u6642\u306b\u53d6\u5f97\uff09\n(let [{:name n :age a :as person} {:name \"Bob\" :age 25 :role \"admin\"}]\n  [n a person])\n;; =&gt; [\"Bob\" 25 {:name \"Bob\", :age 25, :role \"admin\"}]\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#do-","title":"<code>do</code> - \u9806\u6b21\u5b9f\u884c","text":"<pre><code>(do\n  (println \"first\")\n  (println \"second\")\n  42)  ;; \u6700\u5f8c\u306e\u5f0f\u306e\u5024\u3092\u8fd4\u3059\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#if-","title":"<code>if</code> - \u6761\u4ef6\u5206\u5c90","text":"<pre><code>;; \u57fa\u672c\u5f62\n(if test then else)\n\n;; \u5b9f\u7528\u4f8b\n(if (&gt; x 10) \"big\" \"small\")\n\n;; else\u7701\u7565\u53ef\u80fd\uff08\u7701\u7565\u6642\u306fnil\uff09\n(if (valid? data)\n  (process data))\n\n;; \u30cd\u30b9\u30c8\n(if (&gt; x 0)\n    (if (&lt; x 10) \"small positive\" \"big positive\")\n    \"negative or zero\")\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#quote-","title":"<code>quote</code> - \u30af\u30aa\u30fc\u30c8","text":"<pre><code>;; \u5f0f\u3092\u8a55\u4fa1\u305b\u305a\u306b\u305d\u306e\u307e\u307e\u8fd4\u3059\n'(1 2 3)        ;; \u30ea\u30b9\u30c8\u3068\u3057\u3066\u8fd4\u3059\n'(+ 1 2)        ;; \u8a55\u4fa1\u3055\u308c\u305a (+ 1 2) \u306e\u307e\u307e\n'symbol         ;; \u30b7\u30f3\u30dc\u30eb\u3068\u3057\u3066\u8fd4\u3059\n\n;; quote\u306a\u3057\u3060\u3068\u30a8\u30e9\u30fc\uff08\u30ea\u30b9\u30c8\u306f\u95a2\u6570\u547c\u3073\u51fa\u3057\u3068\u3057\u3066\u8a55\u4fa1\u3055\u308c\u308b\uff09\n(1 2 3)         ;; \u30a8\u30e9\u30fc: 1\u306f\u95a2\u6570\u3067\u306f\u306a\u3044\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#mac-","title":"<code>mac</code> - \u30de\u30af\u30ed\u5b9a\u7fa9","text":"<p>\u30de\u30af\u30ed\u306f\u30b3\u30fc\u30c9\u751f\u6210\u3092\u884c\u3046\u7279\u6b8a\u306a\u95a2\u6570\u3067\u3059\u3002quasiquote (<code>`</code>)\u3001unquote (<code>,</code>)\u3001unquote-splice (<code>,@</code>) \u3092\u4f7f\u3063\u3066\u30b3\u30fc\u30c9\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#quasiquote-unquote","title":"Quasiquote / Unquote \u306e\u57fa\u672c","text":"<pre><code>;; quasiquote (`) - \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u4f5c\u6210\n`(+ 1 2)         ;; =&gt; (+ 1 2) \u30ea\u30b9\u30c8\u3068\u3057\u3066\u8fd4\u3059\n\n;; unquote (,) - \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5185\u3067\u5f0f\u3092\u8a55\u4fa1\n(def x 10)\n`(+ 1 ,x)        ;; =&gt; (+ 1 10) x\u304c\u8a55\u4fa1\u3055\u308c\u308b\n\n;; unquote-splice (,@) - \u30ea\u30b9\u30c8\u3092\u5c55\u958b\n(def items [1 2 3])\n`(list ,@items)  ;; =&gt; (list 1 2 3) items\u304c\u5c55\u958b\u3055\u308c\u308b\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#unquote","title":"\u7279\u6b8a\u5f62\u5f0f\u5185\u3067\u306eunquote","text":"<p>fn\u3001let\u3001def\u306a\u3069\u306e\u7279\u6b8a\u5f62\u5f0f\u5185\u3067\u3082unquote\u306f\u6b63\u3057\u304f\u52d5\u4f5c\u3057\u307e\u3059\uff1a</p> <pre><code>(def value 42)\n\n;; fn\u5185\u3067\u306eunquote\n`(fn [x] ,value)          ;; =&gt; (fn [x] 42)\n`(fn [y] (+ y ,value))    ;; =&gt; (fn [y] (+ y 42))\n\n;; let\u5185\u3067\u306eunquote\n`(let [x ,value] x)       ;; =&gt; (let [x 42] x)\n`(let [a ,value b 10] (+ a b))  ;; =&gt; (let [a 42 b 10] (+ a b))\n\n;; def\u5185\u3067\u306eunquote\n`(def myvar ,value)       ;; =&gt; (def myvar 42)\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_12","title":"\u30de\u30af\u30ed\u306e\u5b9f\u88c5\u4f8b","text":"<pre><code>;; when\u30de\u30af\u30ed - if + do\u306e\u7c21\u6f54\u7248\n(mac when [test &amp; body]\n  `(if ,test\n     (do ,@body)\n     nil))\n\n(when (&gt; x 0)\n  (println \"positive\")\n  (process x))\n;; \u5c55\u958b\u7d50\u679c: (if (&gt; x 0) (do (println \"positive\") (process x)) nil)\n\n;; unless\u30de\u30af\u30ed - \u6761\u4ef6\u304c\u507d\u306e\u3068\u304d\u306b\u5b9f\u884c\n(mac unless [test &amp; body]\n  `(if ,test\n     nil\n     (do ,@body)))\n\n(unless (empty? data)\n  (println \"has data\")\n  (process data))\n\n;; debug\u30de\u30af\u30ed - \u5f0f\u3068\u7d50\u679c\u3092\u8868\u793a\n(mac debug [expr]\n  `(let [result ,expr]\n     (do\n       (println f\"Debug: {',expr} = {result}\")\n       result)))\n\n(debug (+ 1 2))\n;; \u51fa\u529b: Debug: (+ 1 2) = 3\n;; \u8fd4\u308a\u5024: 3\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#loop-recur-","title":"<code>loop</code> / <code>recur</code> - \u30eb\u30fc\u30d7","text":"<p>\u672b\u5c3e\u518d\u5e30\u6700\u9069\u5316\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u7279\u6b8a\u5f62\u5f0f\u3067\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u5f62\n(loop [var1 val1 var2 val2 ...]\n  body\n  (recur new-val1 new-val2 ...))\n\n;; \u968e\u4e57\uff085! = 120\uff09\n(defn factorial [n]\n  (loop [i n acc 1]\n    (if (= i 0)\n      acc\n      (recur (dec i) (* acc i)))))\n\n(factorial 5)  ;; 120\n\n;; \u30ab\u30a6\u30f3\u30c8\u30c0\u30a6\u30f3\n(defn count-down [n]\n  (loop [i n]\n    (if (&lt;= i 0)\n      \"done\"\n      (do\n        (print i)\n        (recur (dec i))))))\n\n;; \u30ea\u30b9\u30c8\u51e6\u7406\n(defn sum-list [lst]\n  (loop [items lst result 0]\n    (if (empty? items)\n      result\n      (recur (rest items) (+ result (first items))))))\n\n(sum-list [1 2 3 4 5])  ;; 15\n</code></pre> <p>\u5b9f\u88c5\u306e\u30dd\u30a4\u30f3\u30c8: - <code>loop</code>\u306f\u65b0\u3057\u3044\u74b0\u5883\u3092\u4f5c\u6210\u3057\u3001\u5909\u6570\u3092\u521d\u671f\u5024\u3067\u675f\u7e1b - <code>recur</code>\u306f\u7279\u5225\u306a\u30a8\u30e9\u30fc\u3068\u3057\u3066\u6271\u3044\u3001<code>loop</code>\u3067\u30ad\u30e3\u30c3\u30c1\u3057\u3066\u5909\u6570\u3092\u66f4\u65b0 - \u901a\u5e38\u306e\u518d\u5e30\u3068\u7570\u306a\u308a\u3001\u30b9\u30bf\u30c3\u30af\u3092\u6d88\u8cbb\u3057\u306a\u3044\uff08\u672b\u5c3e\u518d\u5e30\u6700\u9069\u5316\uff09</p>"},{"location":"ja/spec/05-syntax-basics/#_13","title":"\u8a73\u7d30\u306a\u4ed5\u69d8\u3068\u5236\u7d04","text":"<p>loop\u306e\u52d5\u4f5c: 1. \u30eb\u30fc\u30d7\u5c02\u7528\u306e\u65b0\u3057\u3044\u74b0\u5883\uff08\u30b9\u30b3\u30fc\u30d7\uff09\u3092\u4f5c\u6210 2. \u521d\u671f\u5024\u3092\u8a55\u4fa1\u3057\u3066\u5909\u6570\u306b\u675f\u7e1b 3. \u30dc\u30c7\u30a3\u3092\u8a55\u4fa1 4. <code>recur</code>\u304c\u547c\u3070\u308c\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059</p> <p>recur\u306e\u5236\u7d04: - \u5fc5\u305aloop\u306e\u672b\u5c3e\u3067\u4f7f\u7528\u3059\u308b\u3053\u3068 - \u4ee5\u4e0b\u306f\u5168\u3066\u30a8\u30e9\u30fc   <pre><code>;; \u274c \u672b\u5c3e\u4ee5\u5916\u3067\u306erecur\uff08\u30a8\u30e9\u30fc\uff09\n(loop [i 10]\n  (if (&gt; i 0)\n    (+ (recur (dec i)) 1)  ;; \u672b\u5c3e\u3067\u306f\u306a\u3044\n    0))\n\n;; \u2705 \u6b63\u3057\u3044\u672b\u5c3e\u4f4d\u7f6e\n(loop [i 10 acc 0]\n  (if (&gt; i 0)\n    (recur (dec i) (+ acc i))  ;; OK: if\u306e\u672b\u5c3e\n    acc))\n</code></pre> - \u5f15\u6570\u306e\u6570\u306f\u5fc5\u305aloop\u306e\u5909\u6570\u6570\u3068\u4e00\u81f4\u3059\u308b\u3053\u3068 <pre><code>(loop [x 1 y 2]\n  (recur x))  ;; \u30a8\u30e9\u30fc: 2\u500b\u5fc5\u8981\u3060\u304c1\u500b\u3057\u304b\u306a\u3044\n</code></pre></p> <p>\u5185\u90e8\u5b9f\u88c5\u306e\u8a73\u7d30: - Qi\u306f<code>recur</code>\u3092\u7279\u6b8a\u306a\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u30bb\u30f3\u30c1\u30cd\u30eb\u5024\uff09\u3068\u3057\u3066\u5b9f\u88c5 - <code>recur</code>\u306e\u5f15\u6570\u306f\u4e8b\u524d\u306b\u8a55\u4fa1\u3055\u308c\u3001thread_local\u306b\u4fdd\u5b58\u3055\u308c\u308b - <code>loop</code>\u304c\u3053\u306e\u30bb\u30f3\u30c1\u30cd\u30eb\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3001\u5909\u6570\u3092\u66f4\u65b0\u3057\u3066\u518d\u8a55\u4fa1 - \u3053\u306e\u8a2d\u8a08\u306b\u3088\u308a\u3001\u30b9\u30bf\u30c3\u30af\u3092\u6d88\u8cbb\u305b\u305a\u306b\u672b\u5c3e\u518d\u5e30\u3092\u5b9f\u73fe</p> <p>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u7279\u6027: - \u901a\u5e38\u306e\u518d\u5e30: O(n)\u306e\u30b9\u30bf\u30c3\u30af\u6d88\u8cbb \u2192 \u30b9\u30bf\u30c3\u30af\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u306e\u30ea\u30b9\u30af - loop/recur: O(1)\u306e\u30b9\u30bf\u30c3\u30af\u6d88\u8cbb \u2192 \u7121\u9650\u30eb\u30fc\u30d7\u3082\u5b89\u5168\uff08\u30e1\u30e2\u30ea\u304c\u7d9a\u304f\u9650\u308a\uff09</p> <pre><code>;; \u901a\u5e38\u306e\u518d\u5e30\uff08\u30b9\u30bf\u30c3\u30af\u6d88\u8cbb\uff09\n(defn factorial-recursive [n]\n  (if (&lt;= n 1)\n    1\n    (* n (factorial-recursive (dec n)))))\n\n;; loop/recur\uff08\u30b9\u30bf\u30c3\u30af\u6d88\u8cbb\u306a\u3057\uff09\n(defn factorial-loop [n]\n  (loop [i n acc 1]\n    (if (&lt;= i 1)\n      acc\n      (recur (dec i) (* acc i)))))\n\n;; 100\u4e07\u56de\u3067\u3082\u5b89\u5168\n(factorial-loop 1000000)  ;; OK\n(factorial-recursive 1000000)  ;; \u30b9\u30bf\u30c3\u30af\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#when-","title":"<code>when</code> - \u6761\u4ef6\u304c\u771f\u306e\u3068\u304d\u306e\u307f\u5b9f\u884c","text":"<p><code>if</code>\u306eelse\u7bc0\u304c\u4e0d\u8981\u306a\u5834\u5408\u306e\u7c21\u6f54\u306a\u8a18\u6cd5\u3067\u3059\u3002\u8907\u6570\u306e\u5f0f\u3092\u9806\u6b21\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u5f62\n(when test\n  expr1\n  expr2\n  ...)\n\n;; \u5b9f\u7528\u4f8b\n(when (&gt; x 10)\n  (println \"\u5927\u304d\u3044\u5024\u3067\u3059\")\n  (process x))\n\n;; if\u3068\u6bd4\u8f03\n(if (&gt; x 10)\n  (do\n    (println \"\u5927\u304d\u3044\u5024\u3067\u3059\")\n    (process x))\n  nil)  ;; \u3053\u308c\u3068\u540c\u3058\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\n(data\n |&gt; (when (valid? data)\n      (println \"\u51e6\u7406\u958b\u59cb\")\n      (process data)))\n</code></pre> <p>\u623b\u308a\u5024: - \u6761\u4ef6\u304c\u771f\u306e\u5834\u5408: \u6700\u5f8c\u306e\u5f0f\u306e\u5024 - \u6761\u4ef6\u304c\u507d\u306e\u5834\u5408: <code>nil</code></p>"},{"location":"ja/spec/05-syntax-basics/#while-","title":"<code>while</code> - \u6761\u4ef6\u304c\u771f\u306e\u9593\u30eb\u30fc\u30d7","text":"<p>\u6761\u4ef6\u5f0f\u304c\u771f\uff08truthy\u306a\u5024\uff09\u306e\u9593\u3001\u30dc\u30c7\u30a3\u3092\u7e70\u308a\u8fd4\u3057\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u5f62\n(while test\n  body...)\n\n;; \u30ab\u30a6\u30f3\u30bf\u4f8b\n(def counter (atom 0))\n(while (&lt; @counter 5)\n  (println f\"\u30ab\u30a6\u30f3\u30c8: {@counter}\")\n  (swap! counter inc))\n\n;; \u30d5\u30a1\u30a4\u30eb\u51e6\u7406\u306e\u4f8b\n(def lines (atom (io/stdin-lines)))\n(while (some? (first @lines))\n  (println (first @lines))\n  (swap! lines rest))\n</code></pre> <p>\u623b\u308a\u5024: \u5e38\u306b<code>nil</code></p> <p>\u6ce8\u610f: \u7121\u9650\u30eb\u30fc\u30d7\u3092\u907f\u3051\u308b\u305f\u3081\u3001\u30dc\u30c7\u30a3\u5185\u3067\u6761\u4ef6\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#until-","title":"<code>until</code> - \u6761\u4ef6\u304c\u771f\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7","text":"<p>\u6761\u4ef6\u5f0f\u304c\u771f\u306b\u306a\u308b\u307e\u3067\u30dc\u30c7\u30a3\u3092\u7e70\u308a\u8fd4\u3057\u5b9f\u884c\u3057\u307e\u3059\uff08<code>while</code>\u306e\u9006\uff09\u3002</p> <pre><code>;; \u57fa\u672c\u5f62\n(until test\n  body...)\n\n;; \u30ab\u30a6\u30f3\u30bf\u4f8b\uff08while\u306e\u9006\uff09\n(def counter (atom 0))\n(until (&gt;= @counter 5)\n  (println f\"\u30ab\u30a6\u30f3\u30c8: {@counter}\")\n  (swap! counter inc))\n\n;; \u30ea\u30c8\u30e9\u30a4\u4f8b\n(def success (atom false))\n(until @success\n  (println \"\u30ea\u30c8\u30e9\u30a4\u4e2d...\")\n  (reset! success (try-operation)))\n</code></pre> <p>\u623b\u308a\u5024: \u5e38\u306b<code>nil</code></p>"},{"location":"ja/spec/05-syntax-basics/#while-some-nil","title":"<code>while-some</code> - nil\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7\uff08\u675f\u7e1b\u4ed8\u304d\uff09","text":"<p>\u5f0f\u3092\u8a55\u4fa1\u3057\u3001\u7d50\u679c\u304c<code>nil</code>\u306b\u306a\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\u5404\u53cd\u5fa9\u3067\u7d50\u679c\u3092\u5909\u6570\u306b\u675f\u7e1b\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u5f62\n(while-some [binding expr]\n  body...)\n\n;; \u30ea\u30b9\u30c8\u51e6\u7406\n(def remaining (atom [1 2 3 4 5]))\n(while-some [item (first @remaining)]\n  (println f\"\u51e6\u7406: {item}\")\n  (swap! remaining rest))\n\n;; \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\uff08\u884c\u5358\u4f4d\uff09\n(while-some [line (io/stdin-line)]\n  (line\n   |&gt; str/trim\n   |&gt; (when (&gt; (len line) 0)\n        (process-line line))))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\n(while-some [val (get-next-value)]\n  (val\n   |&gt; transform\n   |&gt; validate\n   |&gt; save))\n</code></pre> <p>\u52d5\u4f5c: - <code>expr</code>\u3092\u8a55\u4fa1 - \u7d50\u679c\u304c<code>nil</code>\u306a\u3089\u7d42\u4e86 - \u7d50\u679c\u304c<code>nil</code>\u4ee5\u5916\u306a\u3089\u3001\u305d\u306e\u5024\u3092<code>binding</code>\u306b\u675f\u7e1b\u3057\u3066\u30dc\u30c7\u30a3\u3092\u5b9f\u884c - \u6b21\u306e\u53cd\u5fa9\u3078</p> <p>\u623b\u308a\u5024: \u5e38\u306b<code>nil</code></p>"},{"location":"ja/spec/05-syntax-basics/#until-error-","title":"<code>until-error</code> - \u30a8\u30e9\u30fc\u306b\u306a\u308b\u307e\u3067\u30eb\u30fc\u30d7\uff08\u675f\u7e1b\u4ed8\u304d\uff09","text":"<p>\u5f0f\u3092\u8a55\u4fa1\u3057\u3001\u7d50\u679c\u304c<code>{:error ...}</code>\u306b\u306a\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\u5404\u53cd\u5fa9\u3067\u7d50\u679c\u3092\u5909\u6570\u306b\u675f\u7e1b\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u5f62\n(until-error [binding expr]\n  body...)\n\n;; Result\u578b\u3068\u306e\u7d71\u5408\n(until-error [result (fetch-next)]\n  (println f\"\u53d6\u5f97\u6210\u529f: {result}\")\n  (process result))\n\n;; HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u4f8b\n(until-error [response (http/get next-url)]\n  (println f\"\u30b9\u30c6\u30fc\u30bf\u30b9: {(get response :status)}\")\n  (when (= (get response :status) 200)\n    (process-response response)))\n\n;; \u30da\u30fc\u30b8\u30cd\u30fc\u30b7\u30e7\u30f3\u51e6\u7406\n(def page (atom 1))\n(until-error [data (api/fetch-page @page)]\n  (data\n   |&gt; process-items\n   |&gt; save-to-db)\n  (swap! page inc))\n</code></pre> <p>\u52d5\u4f5c: - <code>expr</code>\u3092\u8a55\u4fa1 - \u7d50\u679c\u304c<code>{:error ...}</code>\u306a\u3089\u3001\u305d\u306e\u5024\u3092\u8fd4\u3057\u3066\u7d42\u4e86 - \u7d50\u679c\u304c<code>{:error ...}</code>\u4ee5\u5916\u306a\u3089\u3001\u305d\u306e\u5024\u3092<code>binding</code>\u306b\u675f\u7e1b\u3057\u3066\u30dc\u30c7\u30a3\u3092\u5b9f\u884c - \u6b21\u306e\u53cd\u5fa9\u3078</p> <p>\u623b\u308a\u5024: \u30a8\u30e9\u30fc\u30de\u30c3\u30d7 <code>{:error ...}</code>\u3001\u307e\u305f\u306f\u30eb\u30fc\u30d7\u304c\u5b9f\u884c\u3055\u308c\u306a\u304b\u3063\u305f\u5834\u5408\u306f<code>nil</code></p> <p>Railway Oriented Programming: <code>|&gt;?</code>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u5f37\u529b\u306a\u30a8\u30e9\u30fc\u51e6\u7406\u304c\u53ef\u80fd\u3067\u3059\uff1a</p> <pre><code>(until-error [result (fetch-data)]\n  (result\n   |&gt;? validate\n   |&gt;? transform\n   |&gt;? save))\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_14","title":"\u30eb\u30fc\u30d7\u69cb\u6587\u306e\u4f7f\u3044\u5206\u3051","text":"<p>Qi\u306b\u306f\u8907\u6570\u306e\u30eb\u30fc\u30d7\u69cb\u6587\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u305e\u308c\u9069\u5207\u306a\u7528\u9014\u304c\u3042\u308b\u305f\u3081\u3001\u72b6\u6cc1\u306b\u5fdc\u3058\u3066\u4f7f\u3044\u5206\u3051\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#_15","title":"\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u51e6\u7406","text":"<p>\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u5168\u4f53\u3092\u51e6\u7406\u3059\u308b\u5834\u5408 \u2192 \u9ad8\u968e\u95a2\u6570\u3092\u4f7f\u7528</p> <pre><code>;; \u2705 \u63a8\u5968\n(map transform data)\n(filter valid? data)\n(each println data)\n\n;; \u274c \u975e\u63a8\u5968\uff08\u5197\u9577\uff09\n(def items (atom data))\n(while (some? (first @items))\n  (process (first @items))\n  (swap! items rest))\n</code></pre> <p>\u7528\u9014: \u30c7\u30fc\u30bf\u5909\u63db\u3001\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3001\u526f\u4f5c\u7528\u306e\u9069\u7528</p>"},{"location":"ja/spec/05-syntax-basics/#_16","title":"\u6761\u4ef6\u4ed8\u304d\u30eb\u30fc\u30d7\uff08\u95a2\u6570\u578b\u7684\uff09","text":"<p>nil\u30c1\u30a7\u30c3\u30af\u4ed8\u304d\u30eb\u30fc\u30d7 \u2192 <code>while-some</code></p> <pre><code>;; \u2705 \u63a8\u5968\uff08\u95a2\u6570\u578b\u7684\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u76f8\u6027\u826f\u3044\uff09\n(while-some [line (io/stdin-line)]\n  (line\n   |&gt; str/trim\n   |&gt; process\n   |&gt; save))\n</code></pre> <p>\u30a8\u30e9\u30fc\u30c1\u30a7\u30c3\u30af\u4ed8\u304d\u30eb\u30fc\u30d7 \u2192 <code>until-error</code></p> <pre><code>;; \u2705 \u63a8\u5968\uff08Result\u578b\u7d71\u5408\u3001Railway Oriented Programming\uff09\n(until-error [result (fetch-next)]\n  (result\n   |&gt;? validate\n   |&gt;? save))\n</code></pre> <p>\u7528\u9014: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3001\u30da\u30fc\u30b8\u30cd\u30fc\u30b7\u30e7\u30f3\u3001API\u547c\u3073\u51fa\u3057</p>"},{"location":"ja/spec/05-syntax-basics/#_17","title":"\u5358\u7d14\u306a\u30eb\u30fc\u30d7\uff08\u526f\u4f5c\u7528\u30d9\u30fc\u30b9\uff09","text":"<p>\u30ab\u30a6\u30f3\u30bf\u30d9\u30fc\u30b9\u306e\u30eb\u30fc\u30d7 \u2192 <code>while</code> / <code>until</code></p> <pre><code>;; \u2705 \u63a8\u5968\uff08\u30b7\u30f3\u30d7\u30eb\u3067\u76f4\u611f\u7684\uff09\n(def count (atom 0))\n(while (&lt; @count 100)\n  (do-something)\n  (swap! count inc))\n\n;; \u30ea\u30c8\u30e9\u30a4\u30ed\u30b8\u30c3\u30af\n(def success (atom false))\n(until @success\n  (reset! success (try-operation)))\n</code></pre> <p>\u7528\u9014: \u30ab\u30a6\u30f3\u30bf\u51e6\u7406\u3001\u30ea\u30c8\u30e9\u30a4\u30ed\u30b8\u30c3\u30af\u3001\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u306e\u30dd\u30fc\u30ea\u30f3\u30b0</p> <p>\u6ce8\u610f: \u7121\u9650\u30eb\u30fc\u30d7\u3092\u907f\u3051\u308b\u305f\u3081\u3001\u30dc\u30c7\u30a3\u5185\u3067\u6761\u4ef6\u3092\u5fc5\u305a\u5909\u66f4\u3059\u308b\u3053\u3068\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#_18","title":"\u672b\u5c3e\u518d\u5e30\u6700\u9069\u5316","text":"<p>\u30b9\u30bf\u30c3\u30af\u3092\u6d88\u8cbb\u3057\u306a\u3044\u518d\u5e30 \u2192 <code>loop</code> / <code>recur</code></p> <pre><code>;; \u2705 \u63a8\u5968\uff08\u5927\u91cf\u306e\u53cd\u5fa9\u3001\u518d\u5e30\u7684\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff09\n(defn factorial [n]\n  (loop [i n acc 1]\n    (if (&lt;= i 1)\n      acc\n      (recur (dec i) (* acc i)))))\n</code></pre> <p>\u7528\u9014: \u518d\u5e30\u7684\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3001\u5927\u91cf\u306e\u53cd\u5fa9\u304c\u5fc5\u8981\u306a\u51e6\u7406</p>"},{"location":"ja/spec/05-syntax-basics/#_19","title":"\u30af\u30a4\u30c3\u30af\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9","text":"\u7528\u9014 \u69cb\u6587 \u7279\u5fb4 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u51e6\u7406 <code>map</code>, <code>filter</code>, <code>each</code> \u7c21\u6f54\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u5bfe\u5fdc nil\u307e\u3067\u30eb\u30fc\u30d7 <code>while-some</code> \u95a2\u6570\u578b\u7684\u3001\u675f\u7e1b\u4ed8\u304d \u30a8\u30e9\u30fc\u307e\u3067\u30eb\u30fc\u30d7 <code>until-error</code> Result\u578b\u7d71\u5408 \u30ab\u30a6\u30f3\u30bf\u30eb\u30fc\u30d7 <code>while</code>, <code>until</code> \u30b7\u30f3\u30d7\u30eb\u3001\u526f\u4f5c\u7528\u30d9\u30fc\u30b9 \u672b\u5c3e\u518d\u5e30 <code>loop/recur</code> \u30b9\u30bf\u30c3\u30af\u6d88\u8cbb\u306a\u3057 <p>\u539f\u5247: \u6700\u3082\u7c21\u6f54\u3067\u610f\u56f3\u304c\u660e\u78ba\u306a\u69cb\u6587\u3092\u9078\u3076\u3053\u3068\u3002\u8ff7\u3063\u305f\u3089\u9ad8\u968e\u95a2\u6570\uff08<code>map</code>, <code>filter</code>, <code>each</code>\uff09\u304b\u3089\u691c\u8a0e\u3059\u308b\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#_20","title":"\u540d\u524d\u7a7a\u9593","text":"<p>Lisp-1\uff08Scheme\u6d3e\uff09 - \u5909\u6570\u3068\u95a2\u6570\u306f\u540c\u3058\u540d\u524d\u7a7a\u9593</p> <pre><code>(def add (fn [x y] (+ x y)))\n(def op add)           ;; \u95a2\u6570\u3092\u5909\u6570\u306b\u4ee3\u5165\n(op 1 2)               ;; 3\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_21","title":"\u6f14\u7b97\u5b50","text":""},{"location":"ja/spec/05-syntax-basics/#_22","title":"\u7b97\u8853\u6f14\u7b97\u5b50","text":"<p>\u6574\u6570\u3068\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306e\u4e21\u65b9\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\u7570\u306a\u308b\u578b\u3092\u6df7\u5728\u3055\u305b\u308b\u3068\u3001\u7d50\u679c\u306f\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306b\u306a\u308a\u307e\u3059\u3002</p> <pre><code>(+ 1 2)         ;; 3\n(+ 1.5 2.5)     ;; 4.0\n(+ 1 2.5)       ;; 3.5 \uff08\u578b\u304c\u6607\u683c\uff09\n\n(- 5 3)         ;; 2\n(- 5.0 3.0)     ;; 2.0\n\n(* 4 5)         ;; 20\n(* 2.5 3)       ;; 7.5\n\n(/ 10 2)        ;; 5\n(/ 10.0 2.0)    ;; 5.0\n(/ 10 3.0)      ;; 3.3333...\n\n(% 10 3)        ;; 1\uff08\u5270\u4f59\uff09\n(% 10.5 3)      ;; 1.5\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_23","title":"\u6bd4\u8f03\u6f14\u7b97\u5b50","text":"<p>\u6574\u6570\u3068\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306e\u4e21\u65b9\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\u7570\u306a\u308b\u578b\u3092\u6bd4\u8f03\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002</p> <pre><code>(= 1 1)         ;; true\n(= 1.0 1.0)     ;; true\n(= 1 1.0)       ;; false \uff08\u578b\u304c\u7570\u306a\u308b\uff09\n\n(!= 1 2)        ;; true\n(!= 1.0 2.0)    ;; true\n\n(&lt; 1 2)         ;; true\n(&lt; 1.5 2.0)     ;; true\n(&lt; 1 2.5)       ;; true \uff08\u6574\u6570\u3068\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306e\u6bd4\u8f03\uff09\n\n(&lt;= 1 1)        ;; true\n(&lt;= 1.0 2.0)    ;; true\n\n(&gt; 2 1)         ;; true\n(&gt; 2.5 1.5)     ;; true\n\n(&gt;= 2 2)        ;; true\n(&gt;= 2.0 2.0)    ;; true\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_24","title":"\u8ad6\u7406\u6f14\u7b97\u5b50","text":"<pre><code>(and true false)     ;; false\n(or true false)      ;; true\n(not true)           ;; false\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_25","title":"\u57fa\u672c\u7684\u306a\u95a2\u6570\u547c\u3073\u51fa\u3057","text":"<pre><code>;; \u95a2\u6570\u9069\u7528\n(f x y z)         ;; f \u3092\u5f15\u6570 x, y, z \u3067\u547c\u3073\u51fa\u3057\n\n;; \u7d44\u307f\u8fbc\u307f\u95a2\u6570\n(+ 1 2 3)         ;; 6\n(str \"hello\" \" \" \"world\")  ;; \"hello world\"\n\n;; \u30e6\u30fc\u30b6\u30fc\u5b9a\u7fa9\u95a2\u6570\n(defn square [x] (* x x))\n(square 5)        ;; 25\n\n;; \u9ad8\u968e\u95a2\u6570\n(map inc [1 2 3])  ;; (2 3 4)\n(filter even? [1 2 3 4])  ;; (2 4)\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#core","title":"Core\u8ff0\u8a9e\u95a2\u6570","text":"<p>Qi\u306f\u578b\u30c1\u30a7\u30c3\u30af\u3084\u6761\u4ef6\u5224\u5b9a\u306e\u305f\u3081\u306e\u8ff0\u8a9e\u95a2\u6570\uff08<code>?</code>\u3067\u7d42\u308f\u308b\u95a2\u6570\uff09\u3092\u591a\u6570\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/05-syntax-basics/#12","title":"\u578b\u30c1\u30a7\u30c3\u30af\u8ff0\u8a9e\uff0812\u500b\uff09","text":"<pre><code>;; nil\u5224\u5b9a\n(nil? nil)          ;; =&gt; true\n(nil? 0)            ;; =&gt; false\n(nil? \"\")           ;; =&gt; false\n\n;; \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u578b\n(list? '(1 2 3))    ;; =&gt; true\n(vector? [1 2 3])   ;; =&gt; true\n(map? {:a 1})       ;; =&gt; true\n\n;; \u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u578b\n(string? \"hello\")   ;; =&gt; true\n(integer? 42)       ;; =&gt; true\n(float? 3.14)       ;; =&gt; true\n(number? 42)        ;; =&gt; true  (integer\u307e\u305f\u306ffloat)\n\n;; \u7279\u6b8a\u578b\n(keyword? :test)    ;; =&gt; true\n(function? inc)     ;; =&gt; true\n(atom? (atom 0))    ;; =&gt; true\n(stream? (stream/range 0 10))  ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#3","title":"\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u8ff0\u8a9e\uff083\u500b\uff09","text":"<pre><code>(coll? [1 2 3])           ;; =&gt; true  (list/vector/map)\n(sequential? [1 2 3])     ;; =&gt; true  (list\u307e\u305f\u306fvector)\n(empty? [])               ;; =&gt; true\n(empty? nil)              ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#4","title":"\u72b6\u614b\u8ff0\u8a9e\uff084\u500b\uff09","text":"<pre><code>;; nil\u3067\u306a\u3044\u5224\u5b9a\n(some? 0)           ;; =&gt; true\n(some? \"\")          ;; =&gt; true\n(some? nil)         ;; =&gt; false\n\n;; \u53b3\u5bc6\u306a\u771f\u507d\u5024\u30c1\u30a7\u30c3\u30af\n(true? true)        ;; =&gt; true\n(true? 1)           ;; =&gt; false  (truthy\u3060\u304ctrue\u3067\u306f\u306a\u3044)\n\n(false? false)      ;; =&gt; true\n(false? nil)        ;; =&gt; false  (falsy\u3060\u304cfalse\u3067\u306f\u306a\u3044)\n\n;; \u30a8\u30e9\u30fc\u5224\u5b9a\n(error? {:error \"failed\"})  ;; =&gt; true\n(error? 42)                 ;; =&gt; false\n(error? nil)                ;; =&gt; false\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#5","title":"\u6570\u5024\u8ff0\u8a9e\uff085\u500b\uff09","text":"<pre><code>;; \u5076\u6570\u30fb\u5947\u6570\n(even? 2)           ;; =&gt; true\n(odd? 3)            ;; =&gt; true\n\n;; \u7b26\u53f7\u5224\u5b9a\n(positive? 1)       ;; =&gt; true\n(negative? -1)      ;; =&gt; true\n(zero? 0)           ;; =&gt; true\n(zero? 0.0)         ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/05-syntax-basics/#_26","title":"\u8ff0\u8a9e\u306e\u7528\u9014","text":"<p>\u8ff0\u8a9e\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5834\u9762\u3067\u6d3b\u7528\u3055\u308c\u307e\u3059\uff1a</p> <pre><code>;; filter\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\n(filter even? [1 2 3 4 5])        ;; =&gt; (2 4)\n(filter some? [1 nil 2 nil 3])    ;; =&gt; (1 2 3)\n\n;; \u6761\u4ef6\u5206\u5c90\n(if (nil? x)\n  \"x\u306fnil\"\n  \"x\u306f\u4f55\u3089\u304b\u306e\u5024\")\n\n;; match\u6587\u306e\u30ac\u30fc\u30c9\n(match data\n  {:value v} when (positive? v) -&gt; \"\u6b63\u306e\u5024\"\n  {:value v} when (zero? v) -&gt; \"\u30bc\u30ed\"\n  _ -&gt; \"\u305d\u306e\u4ed6\")\n</code></pre> <p>\u6ce8: \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u64cd\u4f5c\u306e<code>list/some?</code>\u3068<code>list/every?</code>\uff08\u8ff0\u8a9e+\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3067\u5224\u5b9a\uff09\u306f\u5225\u306e\u95a2\u6570\u3067\u3059\uff08\u2192 \u30c7\u30fc\u30bf\u69cb\u9020\u53c2\u7167\uff09\u3002</p>"},{"location":"ja/spec/06-data-structures/","title":"\u30c7\u30fc\u30bf\u69cb\u9020","text":"<p>Qi\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u578b\u3068\u64cd\u4f5c</p> <p>\u5b9f\u88c5: <code>src/builtins/core_collections.rs</code>, <code>src/builtins/list.rs</code>, <code>src/builtins/map.rs</code>, <code>src/builtins/set.rs</code></p>"},{"location":"ja/spec/06-data-structures/#_2","title":"\u30ea\u30b9\u30c8\u3068\u30d9\u30af\u30bf\u306e\u4f7f\u3044\u5206\u3051","text":""},{"location":"ja/spec/06-data-structures/#_3","title":"\u3044\u3064\u30ea\u30b9\u30c8\u3092\u4f7f\u3046\u304b","text":"<p>\u30ea\u30b9\u30c8 <code>(...)</code> \u306f\u4ee5\u4e0b\u306e\u5834\u5408\u306b\u9069\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ul> <li>\u518d\u5e30\u7684\u306a\u30c7\u30fc\u30bf\u51e6\u7406 - first/rest\u3067\u306e\u5206\u89e3\u304c\u81ea\u7136</li> <li>Lisp\u7684\u306a\u51e6\u7406 - \u30af\u30aa\u30fc\u30c8\u3055\u308c\u305f\u30b3\u30fc\u30c9\u3001S\u5f0f</li> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 - \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3068\u306e\u76f8\u6027\u304c\u826f\u3044</li> <li>\u9806\u6b21\u51e6\u7406 - \u5148\u982d\u304b\u3089\u9806\u306b\u51e6\u7406\u3059\u308b\u5834\u5408</li> </ul> <pre><code>;; \u518d\u5e30\u7684\u306a\u51e6\u7406\n(defn sum [lst]\n  (if (empty? lst)\n    0\n    (+ (first lst) (sum (rest lst)))))\n\n(sum (list 1 2 3 4 5))  ;; =&gt; 15\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_4","title":"\u3044\u3064\u30d9\u30af\u30bf\u3092\u4f7f\u3046\u304b","text":"<p>\u30d9\u30af\u30bf <code>[...]</code> \u306f\u4ee5\u4e0b\u306e\u5834\u5408\u306b\u9069\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ul> <li>\u30e9\u30f3\u30c0\u30e0\u30a2\u30af\u30bb\u30b9 - nth\u95a2\u6570\u3067\u4efb\u610f\u306e\u4f4d\u7f6e\u306bO(1)\u3067\u30a2\u30af\u30bb\u30b9</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u91cd\u8996 - \u30e1\u30e2\u30ea\u52b9\u7387\u304c\u826f\u3044</li> <li>JSON\u3068\u306e\u76f8\u4e92\u5909\u63db - JSON\u914d\u5217\u3068\u81ea\u7136\u306b\u5bfe\u5fdc</li> <li>\u5927\u91cf\u306e\u30c7\u30fc\u30bf - \u52b9\u7387\u7684\u306a\u30e1\u30e2\u30ea\u4f7f\u7528</li> </ul> <pre><code>;; \u30e9\u30f3\u30c0\u30e0\u30a2\u30af\u30bb\u30b9\n(def data [10 20 30 40 50])\n(nth data 2)  ;; =&gt; 30 (\u9ad8\u901f)\n\n;; JSON\u3068\u306e\u76f8\u4e92\u5909\u63db\n(json/stringify {:items [1 2 3]})\n;; =&gt; \"{\\\"items\\\":[1,2,3]}\"\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_5","title":"\u5b9f\u7528\u7684\u306a\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3","text":"<ul> <li>\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u30d9\u30af\u30bf - \u8ff7\u3063\u305f\u3089\u30d9\u30af\u30bf\u3092\u4f7f\u3046\uff08\u73fe\u4ee3\u7684\u3001JSON\u4e92\u63db\uff09</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406 - \u3069\u3061\u3089\u3067\u3082\u540c\u3058\u3088\u3046\u306b\u52d5\u4f5c\u3059\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 - \u4e21\u65b9\u30b5\u30dd\u30fc\u30c8\u3001\u30ea\u30b9\u30c8\u306e\u65b9\u304c\u6163\u7fd2\u7684</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9 - \u30d9\u30af\u30bf\u306e\u65b9\u304c\u9ad8\u901f\uff08\u305f\u3060\u3057\u4f53\u611f\u5dee\u306f\u5c11\u306a\u3044\uff09</li> </ul> <pre><code>;; \u3069\u3061\u3089\u3067\u3082\u540c\u3058\u3088\u3046\u306b\u52d5\u4f5c\n[1 2 3] |&gt; (map inc) |&gt; (filter even?)  ;; =&gt; [2 4]\n(list 1 2 3) |&gt; (map inc) |&gt; (filter even?)  ;; =&gt; (2 4)\n</code></pre>"},{"location":"ja/spec/06-data-structures/#listvector","title":"List\u3068Vector\u306e\u578b\u7dad\u6301\u30eb\u30fc\u30eb","text":"<p>Qi\u3067\u306f\u3001\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u64cd\u4f5c\u95a2\u6570\u306f\u4ee5\u4e0b\u306e\u30eb\u30fc\u30eb\u306b\u5f93\u3063\u3066\u623b\u308a\u5024\u306e\u578b\u3092\u6c7a\u5b9a\u3057\u307e\u3059\uff1a</p>"},{"location":"ja/spec/06-data-structures/#_6","title":"\u5909\u63db\u7cfb\u95a2\u6570\uff08\u5165\u529b\u3092\u52a0\u5de5\u3059\u308b\uff09","text":"<p>\u5165\u529b\u306e\u578b\u3092\u7dad\u6301\u3057\u307e\u3059\u3002List\u5165\u529b\u2192List\u8fd4\u5374\u3001Vector\u5165\u529b\u2192Vector\u8fd4\u5374\u3002</p> <ul> <li><code>map</code>, <code>filter</code>, <code>reduce</code>\uff08\u9ad8\u968e\u95a2\u6570\uff09</li> <li><code>sort</code>, <code>distinct</code>, <code>reverse</code></li> <li><code>take</code>, <code>drop</code>, <code>rest</code>, <code>take-while</code>, <code>drop-while</code></li> </ul> <pre><code>;; Vector\u5165\u529b\u2192Vector\u8fd4\u5374\n(map inc [1 2 3])              ;; =&gt; [2 3 4]\n(filter even? [1 2 3 4])       ;; =&gt; [2 4]\n(sort [3 1 4])                 ;; =&gt; [1 3 4]\n\n;; List\u5165\u529b\u2192List\u8fd4\u5374\n(map inc (list 1 2 3))         ;; =&gt; (2 3 4)\n(filter even? (list 1 2 3 4))  ;; =&gt; (2 4)\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_7","title":"\u9023\u7d50\u7cfb\u95a2\u6570\uff08\u8907\u6570\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u7d50\u5408\uff09","text":"<p>\u7b2c\u4e00\u5f15\u6570\u306e\u578b\u3092\u512a\u5148\u3057\u307e\u3059\u3002</p> <ul> <li><code>concat</code> - \u7b2c\u4e00\u5f15\u6570\u304cVector\u306a\u3089Vector\u8fd4\u5374</li> <li><code>zip</code> - \u7b2c\u4e00\u5f15\u6570\u304cVector\u306a\u3089Vector\u8fd4\u5374</li> <li><code>cons</code> - \u7b2c\u4e8c\u5f15\u6570\uff08\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u5074\uff09\u306e\u578b\u3092\u7dad\u6301</li> </ul> <pre><code>;; \u7b2c\u4e00\u5f15\u6570\u306e\u578b\u3092\u512a\u5148\n(concat [1 2] (list 3 4))      ;; =&gt; [1 2 3 4]\n(concat (list 1 2) [3 4])      ;; =&gt; (1 2 3 4)\n(zip [1 2] (list \"a\" \"b\"))     ;; =&gt; [[1 \"a\"] [2 \"b\"]]\n\n;; cons \u306f\u7b2c\u4e8c\u5f15\u6570\u306e\u578b\u3092\u7dad\u6301\n(cons 0 [1 2 3])               ;; =&gt; [0 1 2 3]\n(cons 0 (list 1 2 3))          ;; =&gt; (0 1 2 3)\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_8","title":"\u69cb\u7bc9\u7cfb\u95a2\u6570\uff08\u65b0\u3057\u3044\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u751f\u6210\uff09","text":"<p>\u5e38\u306bList\u3092\u8fd4\u5374\u3057\u307e\u3059\uff08Lisp\u7cfb\u8a00\u8a9e\u306e\u6163\u7fd2\uff09\u3002</p> <ul> <li><code>range</code>, <code>repeat</code>, <code>flatten</code></li> <li><code>keys</code>, <code>vals</code>\uff08\u30de\u30c3\u30d7\u64cd\u4f5c\uff09</li> </ul> <pre><code>(range 5)                      ;; =&gt; (0 1 2 3 4)\n(repeat 3 \"x\")                 ;; =&gt; (\"x\" \"x\" \"x\")\n(flatten [[1 2] [3 4]])        ;; =&gt; (1 2 3 4)\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_9","title":"\u578b\u5909\u63db\u95a2\u6570","text":"<p>\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u660e\u793a\u7684\u306b\u578b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <ul> <li><code>list</code> - \u53ef\u5909\u9577\u5f15\u6570\u304b\u3089List\u3092\u751f\u6210</li> <li><code>vector</code> - \u53ef\u5909\u9577\u5f15\u6570\u304b\u3089Vector\u3092\u751f\u6210</li> <li><code>to-list</code> - List/Vector\u3092List\u306b\u5909\u63db</li> <li><code>to-vector</code> - List/Vector\u3092Vector\u306b\u5909\u63db</li> </ul> <pre><code>(list 1 2 3)                   ;; =&gt; (1 2 3)\n(vector 1 2 3)                 ;; =&gt; [1 2 3]\n(to-list [1 2 3])              ;; =&gt; (1 2 3)\n(to-vector (list 1 2 3))       ;; =&gt; [1 2 3]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_10","title":"\u30d9\u30af\u30bf\u30fc","text":""},{"location":"ja/spec/06-data-structures/#_11","title":"\u57fa\u672c","text":"<pre><code>[1 2 3]           ;; \u6570\u5024\u306e\u30d9\u30af\u30bf\u30fc\n[\"a\" \"b\" \"c\"]     ;; \u6587\u5b57\u5217\u306e\u30d9\u30af\u30bf\u30fc\n[1 \"hello\" :key]  ;; \u6df7\u5728\u3082\u53ef\u80fd\n[]                ;; \u7a7a\u306e\u30d9\u30af\u30bf\u30fc\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_12","title":"\u30a2\u30af\u30bb\u30b9","text":"<pre><code>;; nth - n\u756a\u76ee\u306e\u8981\u7d20\u3092\u53d6\u5f97\uff080\u304b\u3089\u958b\u59cb\uff09\n(nth [10 20 30] 1)     ;; =&gt; 20\n\n;; first - \u6700\u521d\u306e\u8981\u7d20\n(first [10 20 30])     ;; =&gt; 10\n\n;; last - \u6700\u5f8c\u306e\u8981\u7d20\n(last [10 20 30])      ;; =&gt; 30\n\n;; rest - \u6700\u521d\u4ee5\u5916\u306e\u8981\u7d20\n(rest [10 20 30])      ;; =&gt; [20 30]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_13","title":"\u8ffd\u52a0\u30fb\u7d50\u5408","text":"<pre><code>;; cons - \u5148\u982d\u306b\u8981\u7d20\u3092\u8ffd\u52a0\uff08\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u578b\u3092\u7dad\u6301\uff09\n(cons 0 [10 20 30])       ;; =&gt; [0 10 20 30]\n\n;; conj - \u672b\u5c3e\u306b\u8981\u7d20\u3092\u8ffd\u52a0\uff08Vector\u306f\u672b\u5c3e\u8ffd\u52a0\u3001List\u306f\u5148\u982d\u8ffd\u52a0\uff09\n(conj [10 20 30] 40)      ;; =&gt; [10 20 30 40]\n\n;; concat - \u30ea\u30b9\u30c8\u3092\u9023\u7d50\uff08\u7b2c\u4e00\u5f15\u6570\u306e\u578b\u3092\u512a\u5148\uff09\n(concat [10 20] [30 40])  ;; =&gt; [10 20 30 40]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_14","title":"\u53d6\u5f97\u30fb\u30b9\u30ad\u30c3\u30d7","text":"<pre><code>;; take - \u6700\u521d\u306en\u500b\u3092\u53d6\u5f97\uff08\u578b\u3092\u7dad\u6301\uff09\n(take 2 [10 20 30 40])    ;; =&gt; [10 20]\n\n;; drop - \u6700\u521d\u306en\u500b\u3092\u30b9\u30ad\u30c3\u30d7\uff08\u578b\u3092\u7dad\u6301\uff09\n(drop 2 [10 20 30 40])    ;; =&gt; [30 40]\n\n;; take-while - \u8ff0\u8a9e\u304c\u771f\u306e\u9593\u53d6\u5f97\n(take-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])  ;; =&gt; (1 2 3)\n\n;; drop-while - \u8ff0\u8a9e\u304c\u771f\u306e\u9593\u524a\u9664\n(drop-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])  ;; =&gt; (6 7 4)\n\n;; list/drop-last - \u672b\u5c3en\u500b\u3092\u524a\u9664\n(list/drop-last 2 [1 2 3 4 5])  ;; =&gt; (1 2 3)\n\n;; list/take-nth - n\u500b\u304a\u304d\u306b\u53d6\u5f97\n(list/take-nth 2 [1 2 3 4 5 6])  ;; =&gt; (1 3 5)\n\n;; list/split-at - \u6307\u5b9a\u4f4d\u7f6e\u3067\u5206\u5272\n(list/split-at 2 [1 2 3 4 5])  ;; =&gt; [(1 2) (3 4 5)]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_15","title":"\u5909\u63db","text":"<pre><code>;; reverse - \u9806\u5e8f\u3092\u53cd\u8ee2\uff08\u578b\u3092\u7dad\u6301\uff09\n(reverse [10 20 30])         ;; =&gt; [30 20 10]\n\n;; flatten - \u30cd\u30b9\u30c8\u3092\u5e73\u5766\u5316\uff08\u5e38\u306bList\u3092\u8fd4\u5374\uff09\n(flatten [[1 2] [3 [4 5]]])  ;; =&gt; (1 2 3 4 5)\n\n;; distinct - \u91cd\u8907\u3092\u6392\u9664\uff08\u578b\u3092\u7dad\u6301\uff09\n(distinct [1 2 2 3 3 3])     ;; =&gt; [1 2 3]\n\n;; list/dedupe - \u9023\u7d9a\u3059\u308b\u91cd\u8907\u3092\u524a\u9664\n(list/dedupe [1 1 2 2 3 3])  ;; =&gt; (1 2 3)\n(list/dedupe [1 2 1 2])      ;; =&gt; (1 2 1 2) (\u975e\u9023\u7d9a\u306f\u6b8b\u308b)\n\n;; sort - \u6607\u9806\u30bd\u30fc\u30c8\uff08\u578b\u3092\u7dad\u6301\uff09\n(sort [3 1 4 1 5])           ;; =&gt; [1 1 3 4 5]\n\n;; list/interleave - 2\u3064\u306e\u30ea\u30b9\u30c8\u3092\u4ea4\u4e92\u306b\u7d50\u5408\n(list/interleave [1 2 3] [4 5 6])  ;; =&gt; (1 4 2 5 3 6)\n\n;; list/chunk - \u6307\u5b9a\u30b5\u30a4\u30ba\u3067\u5206\u5272\n(list/chunk 2 [1 2 3 4 5 6])  ;; =&gt; ((1 2) (3 4) (5 6))\n\n;; list/zipmap - 2\u3064\u306e\u30ea\u30b9\u30c8\u304b\u3089\u30de\u30c3\u30d7\u3092\u751f\u6210\n(list/zipmap [:a :b :c] [1 2 3])  ;; =&gt; {:a 1, :b 2, :c 3}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_16","title":"\u30b5\u30a4\u30ba\u30fb\u72b6\u614b","text":"<pre><code>;; len - \u8981\u7d20\u6570\u3092\u8fd4\u3059\n(len [10 20 30])      ;; =&gt; 3\n\n;; count - \u8981\u7d20\u6570\u3092\u8fd4\u3059\uff08len\u306e\u30a8\u30a4\u30ea\u30a2\u30b9\uff09\n(count [10 20 30])    ;; =&gt; 3\n\n;; empty? - \u7a7a\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\n(empty? [])           ;; =&gt; true\n(empty? [1])          ;; =&gt; false\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_17","title":"\u30ea\u30b9\u30c8","text":""},{"location":"ja/spec/06-data-structures/#_18","title":"\u57fa\u672c","text":"<pre><code>'(1 2 3)          ;; \u30af\u30aa\u30fc\u30c8\u5fc5\u9808\n'()               ;; \u7a7a\u30ea\u30b9\u30c8\n\n(first '(1 2 3))  ;; =&gt; 1\n(rest '(1 2 3))   ;; =&gt; (2 3)\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_19","title":"\u751f\u6210","text":"<pre><code>;; list - \u53ef\u5909\u9577\u5f15\u6570\u304b\u3089List\u3092\u751f\u6210\n(list 1 2 3)      ;; =&gt; (1 2 3)\n(list)            ;; =&gt; ()\n\n;; range - \u6570\u5024\u306e\u7bc4\u56f2\u3092\u751f\u6210\n(range 5)         ;; =&gt; (0 1 2 3 4)\n(range 2 5)       ;; =&gt; (2 3 4)\n\n;; repeat - \u540c\u3058\u5024\u3092n\u56de\u7e70\u308a\u8fd4\u3057\u305f\u30ea\u30b9\u30c8\u3092\u751f\u6210\n(repeat 5 0)      ;; =&gt; (0 0 0 0 0)\n(repeat 3 \"a\")    ;; =&gt; (\"a\" \"a\" \"a\")\n(repeat 2 [1 2])  ;; =&gt; ([1 2] [1 2])\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_20","title":"\u30de\u30c3\u30d7","text":""},{"location":"ja/spec/06-data-structures/#_21","title":"\u57fa\u672c","text":"<pre><code>{:name \"Alice\" :age 30}    ;; \u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u30ad\u30fc\u306b\u3059\u308b\n{\"name\" \"Bob\" \"age\" 25}    ;; \u6587\u5b57\u5217\u3092\u30ad\u30fc\u306b\u3059\u308b\n{}                         ;; \u7a7a\u30de\u30c3\u30d7\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_22","title":"\u30de\u30c3\u30d7\u306e\u30ad\u30fc\u3068\u3057\u3066\u4f7f\u3048\u308b\u578b","text":"<p>Qi\u306e\u30de\u30c3\u30d7\u306f\u3001\u578b\u5b89\u5168\u306a\u30ad\u30fc\uff08<code>MapKey</code>\u578b\uff09\u306e\u307f\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e4\u3064\u306e\u578b\u304c\u30ad\u30fc\u3068\u3057\u3066\u4f7f\u7528\u3067\u304d\u307e\u3059\uff1a</p> \u578b \u4f8b \u7528\u9014 Keyword <code>:name</code>, <code>:age</code> \u6700\u3082\u4e00\u822c\u7684\u3002\u69cb\u9020\u5316\u30c7\u30fc\u30bf\u306e\u30ad\u30fc String <code>\"name\"</code>, <code>\"email\"</code> JSON\u4e92\u63db\u3001\u5916\u90e8\u30c7\u30fc\u30bf\u3068\u306e\u9023\u643a Symbol <code>'foo</code>, <code>'bar</code> \u30de\u30af\u30ed\u3001\u30e1\u30bf\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 Integer <code>0</code>, <code>1</code>, <code>42</code> \u914d\u5217\u98a8\u306e\u30a2\u30af\u30bb\u30b9\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"},{"location":"ja/spec/06-data-structures/#float","title":"Float\u306f\u30ad\u30fc\u306b\u306a\u308c\u306a\u3044","text":"<p>\u7406\u7531: \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306f\u30cf\u30c3\u30b7\u30e5\u5316\u304c\u4e0d\u5b89\u5b9a\u306a\u305f\u3081\u3001\u30de\u30c3\u30d7\u306e\u30ad\u30fc\u3068\u3057\u3066\u4f7f\u7528\u3067\u304d\u307e\u305b\u3093\u3002</p> <pre><code>;; \u2705 \u4f7f\u3048\u308b\u578b\n{:name \"Alice\"}           ;; Keyword\n{\"email\" \"test@test.com\"} ;; String\n{42 \"value\"}              ;; Integer\n\n;; \u274c \u30a8\u30e9\u30fc\n{3.14 \"pi\"}               ;; Float - \u30a8\u30e9\u30fc: Float\u306f\u30ad\u30fc\u306b\u306a\u308c\u306a\u3044\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_23","title":"\u5185\u90e8\u5b9f\u88c5","text":"<p>Qi\u306e\u5185\u90e8\u3067\u306f\u3001\u30de\u30c3\u30d7\u306e\u30ad\u30fc\u306f<code>MapKey</code> enum\u578b\u3067\u8868\u73fe\u3055\u308c\u307e\u3059\uff1a</p> <pre><code>pub enum MapKey {\n    Keyword(Arc&lt;str&gt;),   // :name\n    Symbol(Arc&lt;str&gt;),    // 'symbol\n    String(String),      // \"text\"\n    Integer(i64),        // 42\n}\n</code></pre> <p>\u3053\u306e\u8a2d\u8a08\u306b\u3088\u308a\uff1a - \u578b\u5b89\u5168: \u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u30ad\u30fc\u306e\u578b\u3092\u30c1\u30a7\u30c3\u30af - \u9ad8\u901f: Arc\u306b\u3088\u308b\u30a4\u30f3\u30bf\u30fc\u30f3\u5316\u3067\u6bd4\u8f03\u304c\u9ad8\u901f - \u30e1\u30e2\u30ea\u52b9\u7387: \u540c\u3058\u30ad\u30fc\u30ef\u30fc\u30c9/\u30b7\u30f3\u30dc\u30eb\u306f\u30e1\u30e2\u30ea\u3092\u5171\u6709"},{"location":"ja/spec/06-data-structures/#_24","title":"\u30a2\u30af\u30bb\u30b9","text":"<pre><code>;; get - \u30ad\u30fc\u3067\u5024\u3092\u53d6\u5f97\n(get {:name \"Alice\" :age 30} :name)   ;; =&gt; \"Alice\"\n(get {:name \"Alice\"} :age 0)          ;; =&gt; 0 (\u30c7\u30d5\u30a9\u30eb\u30c8\u5024)\n\n;; \u30ad\u30fc\u30ef\u30fc\u30c9\u30fb\u6587\u5b57\u5217\u3092\u95a2\u6570\u3068\u3057\u3066\u4f7f\u3046\uff08\u7c21\u6f54\u306a\u8a18\u6cd5\uff09\n(:name {:name \"Alice\" :age 30})       ;; =&gt; \"Alice\"\n(:age {:name \"Alice\" :age 30})        ;; =&gt; 30\n(\"name\" {\"name\" \"Bob\" \"age\" 25})      ;; =&gt; \"Bob\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(def response {:status 200 :body \"OK\"})\n(response |&gt; :status)                 ;; =&gt; 200\n\n;; JSON\u7b49\u306e\u5916\u90e8\u30c7\u30fc\u30bf\u3078\u306e\u30a2\u30af\u30bb\u30b9\n(def user-data {\"name\" \"Carol\" \"email\" \"carol@example.com\"})\n(\"email\" user-data)                   ;; =&gt; \"carol@example.com\"\n\n;; keys - \u5168\u30ad\u30fc\u3092\u53d6\u5f97\n(keys {:name \"Alice\" :age 30})        ;; =&gt; (\"name\" \"age\")\n\n;; vals - \u5168\u5024\u3092\u53d6\u5f97\n(vals {:name \"Alice\" :age 30})        ;; =&gt; (\"Alice\" 30)\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_25","title":"\u8ffd\u52a0\u30fb\u524a\u9664","text":"<pre><code>;; assoc - \u30ad\u30fc\u3068\u5024\u3092\u8ffd\u52a0\n(assoc {:name \"Alice\"} :age 30)           ;; =&gt; {:name \"Alice\" :age 30}\n\n;; dissoc - \u30ad\u30fc\u3092\u524a\u9664\n(dissoc {:name \"Alice\" :age 30} :age)     ;; =&gt; {:name \"Alice\"}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_26","title":"\u30de\u30fc\u30b8\u30fb\u9078\u629e","text":"<pre><code>;; merge - \u30de\u30c3\u30d7\u3092\u7d50\u5408\n(merge {:a 1} {:b 2})                         ;; =&gt; {:a 1 :b 2}\n(merge {:a 1} {:a 2})                         ;; =&gt; {:a 2} (\u53f3\u304c\u512a\u5148)\n\n;; map/select-keys - \u6307\u5b9a\u3057\u305f\u30ad\u30fc\u306e\u307f\u62bd\u51fa\n(map/select-keys {:a 1 :b 2 :c 3} [:a :c])   ;; =&gt; {:a 1 :c 3}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_27","title":"\u30cd\u30b9\u30c8\u64cd\u4f5c","text":"<pre><code>;; update - \u5024\u3092\u95a2\u6570\u3067\u66f4\u65b0\n(update {:name \"Alice\" :age 30} :age inc)\n;; =&gt; {:name \"Alice\" :age 31}\n\n;; update-in - \u30cd\u30b9\u30c8\u3057\u305f\u5024\u3092\u66f4\u65b0\n(update-in {:user {:profile {:visits 10}}} [:user :profile :visits] inc)\n;; =&gt; {:user {:profile {:visits 11}}}\n\n;; get-in - \u30cd\u30b9\u30c8\u3057\u305f\u5024\u3092\u53d6\u5f97\n(get-in {:user {:name \"Bob\"}} [:user :name])    ;; =&gt; \"Bob\"\n(get-in {} [:user :name] \"guest\")               ;; =&gt; \"guest\"\n\n;; map/assoc-in - \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306b\u5024\u3092\u8a2d\u5b9a\n(map/assoc-in {} [:user :profile :name] \"Alice\")\n;; =&gt; {:user {:profile {:name \"Alice\"}}}\n(map/assoc-in {:user {:age 30}} [:user :name] \"Bob\")\n;; =&gt; {:user {:age 30, :name \"Bob\"}}\n\n;; map/dissoc-in - \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u304b\u3089\u30ad\u30fc\u3092\u524a\u9664\n(map/dissoc-in {:user {:name \"Alice\" :age 30}} [:user :age])\n;; =&gt; {:user {:name \"Alice\"}}\n(map/dissoc-in {:a {:b {:c 1}}} [:a :b :c])\n;; =&gt; {:a {:b {}}}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_28","title":"\u30de\u30c3\u30d7\u306e\u4e00\u62ec\u5909\u63db","text":"<pre><code>;; map/map-keys - \u30ad\u30fc\u3092\u5909\u63db\n(map/map-keys str/upper {:name \"Alice\" :age 30})\n;; =&gt; {\"NAME\" \"Alice\", \"AGE\" 30}\n\n;; map/map-vals - \u5024\u3092\u5909\u63db\n(map/map-vals inc {:a 1 :b 2})\n;; =&gt; {:a 2, :b 3}\n\n;; map/filter-keys - \u30ad\u30fc\u3067\u30d5\u30a3\u30eb\u30bf\n(map/filter-keys keyword? {:name \"Alice\" \"age\" 30})\n;; =&gt; {:name \"Alice\"}\n\n;; map/filter-vals - \u5024\u3067\u30d5\u30a3\u30eb\u30bf\n(map/filter-vals even? {:a 1 :b 2 :c 3})\n;; =&gt; {:b 2}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_29","title":"\u30bb\u30c3\u30c8\uff08\u96c6\u5408\u6f14\u7b97\uff09","text":"<pre><code>;; set/union - \u548c\u96c6\u5408\n(set/union [1 2] [2 3])                         ;; =&gt; [1 2 3]\n\n;; set/intersect - \u7a4d\u96c6\u5408\n(set/intersect [1 2 3] [2 3 4])                 ;; =&gt; [2 3]\n\n;; set/difference - \u5dee\u96c6\u5408\n(set/difference [1 2 3] [2])                    ;; =&gt; [1 3]\n\n;; set/symmetric-difference - \u5bfe\u79f0\u5dee\n(set/symmetric-difference [1 2 3] [2 3 4])      ;; =&gt; [1 4]\n\n;; set/subset? - \u90e8\u5206\u96c6\u5408\u5224\u5b9a\n(set/subset? [1 2] [1 2 3])                     ;; =&gt; true\n\n;; set/superset? - \u4e0a\u4f4d\u96c6\u5408\u5224\u5b9a\n(set/superset? [1 2 3] [1 2])                   ;; =&gt; true\n\n;; set/disjoint? - \u4e92\u3044\u306b\u7d20\u5224\u5b9a\n(set/disjoint? [1 2] [3 4])                     ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_30","title":"\u9ad8\u968e\u95a2\u6570","text":""},{"location":"ja/spec/06-data-structures/#map-","title":"map - \u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u9069\u7528","text":"<pre><code>;; Vector\u5165\u529b\u2192Vector\u8fd4\u5374\n(map inc [1 2 3])                    ;; =&gt; [2 3 4]\n(map str [1 2 3])                    ;; =&gt; [\"1\" \"2\" \"3\"]\n\n;; List\u5165\u529b\u2192List\u8fd4\u5374\n(map inc (list 1 2 3))               ;; =&gt; (2 3 4)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3] |&gt; (map (fn [x] (* x x))))  ;; =&gt; [1 4 9]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#filter-","title":"filter - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f\u62bd\u51fa","text":"<pre><code>;; Vector\u5165\u529b\u2192Vector\u8fd4\u5374\n(filter even? [1 2 3 4 5])                      ;; =&gt; [2 4]\n(filter (fn [x] (&gt; x 10)) [5 15 3 20])          ;; =&gt; [15 20]\n\n;; List\u5165\u529b\u2192List\u8fd4\u5374\n(filter even? (list 1 2 3 4 5))                 ;; =&gt; (2 4)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4 5] |&gt; (filter odd?))                  ;; =&gt; [1 3 5]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#reduce-","title":"reduce - \u7573\u307f\u8fbc\u307f","text":"<pre><code>(reduce + 0 [1 2 3 4])        ;; =&gt; 10\n(reduce * 1 [2 3 4])          ;; =&gt; 24\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4 5] |&gt; (reduce + 0)) ;; =&gt; 15\n</code></pre>"},{"location":"ja/spec/06-data-structures/#each-","title":"each - \u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u9069\u7528\uff08\u526f\u4f5c\u7528\u7528\uff09","text":"<p><code>map</code>\u3068\u7570\u306a\u308a\u3001\u623b\u308a\u5024\u3092\u53ce\u96c6\u305b\u305a<code>nil</code>\u3092\u8fd4\u3057\u307e\u3059\u3002\u526f\u4f5c\u7528\uff08println\u3001\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u8fbc\u307f\u306a\u3069\uff09\u3092\u76ee\u7684\u3068\u3059\u308b\u5834\u5408\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(each println [1 2 3])\n;; \u51fa\u529b:\n;; 1\n;; 2\n;; 3\n;; =&gt; nil\n\n;; Vector\u3001List\u4e21\u65b9\u306b\u5bfe\u5fdc\n(each println (list \"a\" \"b\" \"c\"))\n;; \u51fa\u529b:\n;; a\n;; b\n;; c\n;; =&gt; nil\n\n;; \u30e9\u30e0\u30c0\u5f0f\u3068\u7d44\u307f\u5408\u308f\u305b\n(each (fn [x] (println f\"\u5024: {x}\")) [10 20 30])\n;; \u51fa\u529b:\n;; \u5024: 10\n;; \u5024: 20\n;; \u5024: 30\n;; =&gt; nil\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n(def lines [\"  hello  \" \"  world  \" \"  test  \"])\n(lines\n |&gt; (map str/trim)\n |&gt; (map str/upper)\n |&gt; (each println))\n;; \u5404\u884c\u3092\u5927\u6587\u5b57\u306b\u5909\u63db\u3057\u3066\u51fa\u529b\n\n;; when \u3068\u7d44\u307f\u5408\u308f\u305b\u305f\u6761\u4ef6\u4ed8\u304d\u51e6\u7406\n(def data [\"item1\" \"\" \"item2\" \"item3\"])\n(data\n |&gt; (each (fn [item]\n            (when (&gt; (len item) 0)\n              (println f\"\u51e6\u7406: {item}\")))))\n\n;; \u7d71\u8a08\u60c5\u5831\u306e\u96c6\u8a08\n(def data2 [1 2 3 4 5])\n(def count (atom 0))\n(data2\n |&gt; (each (fn [item]\n            (when (&gt; item 2)\n              (swap! count inc)))))\n</code></pre> <p>map \u3068\u306e\u4f7f\u3044\u5206\u3051: - <code>map</code>: \u623b\u308a\u5024\u304c\u5fc5\u8981\u306a\u5834\u5408\uff08\u30c7\u30fc\u30bf\u5909\u63db\uff09 - <code>each</code>: \u623b\u308a\u5024\u304c\u4e0d\u8981\u306a\u5834\u5408\uff08\u526f\u4f5c\u7528\u306e\u307f\uff09</p> <pre><code>;; map - \u5909\u63db\u7d50\u679c\u3092\u8fd4\u3059\n(map inc [1 2 3])  ;; =&gt; [2 3 4]\n\n;; each - \u526f\u4f5c\u7528\u306e\u307f\u3001nil\u3092\u8fd4\u3059\n(each println [1 2 3])  ;; =&gt; nil\uff08\u305f\u3060\u3057\u5404\u8981\u7d20\u304c\u51fa\u529b\u3055\u308c\u308b\uff09\n</code></pre>"},{"location":"ja/spec/06-data-structures/#find-","title":"find - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u6700\u521d\u306e\u8981\u7d20","text":"<pre><code>(find (fn [x] (&gt; x 5)) [1 7 3])     ;; =&gt; 7\n(find even? [1 3 4 5])              ;; =&gt; 4\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_31","title":"\u8ff0\u8a9e\uff08\u5168\u4f53\u30c1\u30a7\u30c3\u30af\uff09","text":"<pre><code>;; list/every? - \u5168\u8981\u7d20\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\n(list/every? (fn [x] (&gt; x 0)) [1 2 3])   ;; =&gt; true\n(list/every? even? [2 4 6])              ;; =&gt; true\n\n;; list/some? - \u3044\u305a\u308c\u304b\u306e\u8981\u7d20\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\n(list/some? (fn [x] (&gt; x 5)) [1 7 3])    ;; =&gt; true\n(list/some? even? [1 3 5])               ;; =&gt; false\n</code></pre> <p>\u6ce8: <code>some?</code>\uff081\u5f15\u6570\uff09\u306fCore\u8ff0\u8a9e\u95a2\u6570\u3068\u3057\u3066\u3001nil\u3067\u306a\u3044\u304b\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u8ff0\u8a9e\u3067\u3059\uff08\u2192 \u57fa\u672c\u69cb\u6587\u53c2\u7167\uff09\u3002</p>"},{"location":"ja/spec/06-data-structures/#_32","title":"\u30bd\u30fc\u30c8\u30fb\u30b0\u30eb\u30fc\u30d7\u5316","text":""},{"location":"ja/spec/06-data-structures/#_33","title":"\u30bd\u30fc\u30c8","text":"<pre><code>;; sort - \u6607\u9806\u30bd\u30fc\u30c8\uff08\u578b\u3092\u7dad\u6301\uff09\n(sort [3 1 4 1 5])                             ;; =&gt; [1 1 3 4 5]\n(sort [\"zebra\" \"apple\" \"banana\"])              ;; =&gt; [\"apple\" \"banana\" \"zebra\"]\n(sort (list 3 1 4 1 5))                        ;; =&gt; (1 1 3 4 5)\n\n;; list/sort-by - \u30ad\u30fc\u6307\u5b9a\u30bd\u30fc\u30c8\n(list/sort-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; ({:name \"Bob\" :age 25} {:name \"Alice\" :age 30})\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_34","title":"\u30b0\u30eb\u30fc\u30d7\u5316","text":"<pre><code>;; list/group-by - \u30ad\u30fc\u95a2\u6570\u3067\u30b0\u30eb\u30fc\u30d7\u5316\n(list/group-by even? [1 2 3 4 5 6])\n;; =&gt; {true [2 4 6], false [1 3 5]}\n\n;; list/partition - \u8ff0\u8a9e\u30672\u5206\u5272\n(list/partition even? [1 2 3 4])\n;; =&gt; [[2 4] [1 3]]\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_35","title":"\u983b\u5ea6\u30fb\u30ab\u30a6\u30f3\u30c8","text":"<pre><code>;; list/frequencies - \u51fa\u73fe\u983b\u5ea6\u3092\u96c6\u8a08\n(list/frequencies [1 2 2 3 3 3])\n;; =&gt; {1 1, 2 2, 3 3}\n\n;; list/count-by - \u8ff0\u8a9e\u3067\u30ab\u30a6\u30f3\u30c8\n(list/count-by even? [1 2 3 4])\n;; =&gt; {true 2, false 2}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_36","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/06-data-structures/#_37","title":"\u30c7\u30fc\u30bf\u5206\u6790\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u91cd\u8907\u6392\u9664\u3057\u3066\u30bd\u30fc\u30c8\n([5 2 8 2 9 1 3 8 4]\n |&gt; distinct\n |&gt; sort)\n;; =&gt; (1 2 3 4 5 8 9)\n\n;; \u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u96c6\u8a08\n(list/group-by (fn [n] (% n 3)) [1 2 3 4 5 6 7 8 9])\n;; =&gt; {0 (3 6 9), 1 (1 4 7), 2 (2 5 8)}\n</code></pre>"},{"location":"ja/spec/06-data-structures/#_38","title":"\u30e6\u30fc\u30b6\u30fc\u691c\u7d22","text":"<pre><code>(def users [{:name \"Alice\" :age 30} {:name \"Bob\" :age 25}])\n\n;; \u30e6\u30fc\u30b6\u30fc\u3092\u540d\u524d\u3067\u63a2\u3059\n(find (fn [u] (= (get u :name) \"Bob\")) users)\n;; =&gt; {:name \"Bob\" :age 25}\n\n;; \u5168\u54e1\u6210\u4eba\u304b\u78ba\u8a8d\n(list/every? (fn [u] (&gt;= (get u :age) 20)) users)\n;; =&gt; true\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u691c\u7d22\n(users\n |&gt; (filter (fn [u] (&gt;= (get u :age) 25)))\n |&gt; (map (fn [u] (get u :name))))\n;; =&gt; (\"Alice\" \"Bob\")\n</code></pre>"},{"location":"ja/spec/07-functions/","title":"\u95a2\u6570","text":"<p>\u7b2c\u4e00\u7d1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066\u306e\u95a2\u6570</p> <p>Qi\u3067\u306f\u95a2\u6570\u306f\u7b2c\u4e00\u7d1a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3042\u308a\u3001\u5909\u6570\u306b\u4ee3\u5165\u3057\u305f\u308a\u3001\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u8fd4\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/07-functions/#_2","title":"\u95a2\u6570\u306e\u5b9a\u7fa9","text":""},{"location":"ja/spec/07-functions/#fn-","title":"fn - \u7121\u540d\u95a2\u6570","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u95a2\u6570\n(fn [x] (* x 2))\n\n;; \u8907\u6570\u5f15\u6570\n(fn [x y] (+ x y))\n\n;; \u5f15\u6570\u306a\u3057\n(fn [] (println \"no args\"))\n\n;; \u53ef\u5909\u9577\u5f15\u6570\n(fn [&amp; args] (reduce + 0 args))\n</code></pre>"},{"location":"ja/spec/07-functions/#defn-","title":"defn - \u540d\u524d\u4ed8\u304d\u95a2\u6570","text":"<pre><code>;; \u57fa\u672c\u5f62\u5f0f\n(defn greet [name]\n  (str \"Hello, \" name))\n\n;; \u53ef\u5909\u9577\u5f15\u6570\n(defn sum [&amp; nums]\n  (reduce + 0 nums))\n\n;; \u30d9\u30af\u30bf\u306e\u5206\u89e3\uff08Destructuring\uff09\n(defn add-pair [[x y]]\n  (+ x y))\n\n;; map\u306e\u5206\u89e3\n(defn greet-user [{:name n :age a}]\n  (str n \"\u3055\u3093\u306f\" a \"\u6b73\u3067\u3059\"))\n</code></pre>"},{"location":"ja/spec/07-functions/#_3","title":"\u30af\u30ed\u30fc\u30b8\u30e3","text":"<p>\u95a2\u6570\u306f\u5b9a\u7fa9\u6642\u306e\u30b9\u30b3\u30fc\u30d7\u306e\u5909\u6570\u3092\u6355\u6349\u3067\u304d\u307e\u3059\uff08\u30af\u30ed\u30fc\u30b8\u30e3\uff09\u3002</p> <pre><code>;; \u30ab\u30a6\u30f3\u30bf\u30fc\u95a2\u6570\u306e\u751f\u6210\n(defn make-counter []\n  (let [count (atom 0)]\n    (fn []\n      (swap! count inc)\n      (deref count))))\n\n(def counter (make-counter))\n(counter)  ;; =&gt; 1\n(counter)  ;; =&gt; 2\n(counter)  ;; =&gt; 3\n\n;; \u90e8\u5206\u9069\u7528\u306e\u3088\u3046\u306a\u30af\u30ed\u30fc\u30b8\u30e3\n(defn make-adder [n]\n  (fn [x] (+ x n)))\n\n(def add5 (make-adder 5))\n(add5 10)  ;; =&gt; 15\n</code></pre>"},{"location":"ja/spec/07-functions/#_4","title":"\u9ad8\u968e\u95a2\u6570","text":""},{"location":"ja/spec/07-functions/#identity-","title":"identity - \u5f15\u6570\u3092\u305d\u306e\u307e\u307e\u8fd4\u3059","text":"<pre><code>(identity 42)                         ;; =&gt; 42\n\n;; \u30d5\u30a3\u30eb\u30bf\u3067nil\u3068false\u3092\u9664\u53bb\n(filter identity [1 false nil 2])     ;; =&gt; (1 2)\n</code></pre>"},{"location":"ja/spec/07-functions/#constantly-","title":"constantly - \u5e38\u306b\u540c\u3058\u5024\u3092\u8fd4\u3059\u95a2\u6570\u3092\u751f\u6210","text":"<pre><code>(def always-42 (constantly 42))\n(always-42 \"anything\")                ;; =&gt; 42\n(always-42 1 2 3)                     ;; =&gt; 42\n\n;; \u5b9f\u7528\u4f8b: \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u751f\u6210\n(map (constantly 0) [1 2 3])          ;; =&gt; (0 0 0)\n</code></pre>"},{"location":"ja/spec/07-functions/#apply-","title":"apply - \u30ea\u30b9\u30c8\u3092\u5f15\u6570\u3068\u3057\u3066\u95a2\u6570\u306b\u9069\u7528","text":"<pre><code>(apply + [1 2 3])                     ;; =&gt; 6\n(apply max [5 2 8 3])                 ;; =&gt; 8\n\n;; \u5b9f\u7528\u4f8b: \u53ef\u5909\u9577\u5f15\u6570\u306e\u5c55\u958b\n(defn sum-all [&amp; nums]\n  (apply + nums))\n\n(sum-all 1 2 3 4 5)                   ;; =&gt; 15\n</code></pre>"},{"location":"ja/spec/07-functions/#comp-","title":"comp - \u95a2\u6570\u3092\u5408\u6210\uff08\u53f3\u304b\u3089\u5de6\u306b\u9069\u7528\uff09","text":"<pre><code>;; \u95a2\u6570\u5408\u6210\n(def process (comp inc (* 2)))\n(process 5)                           ;; =&gt; 11  ((5 * 2) + 1)\n\n;; \u8907\u6570\u306e\u95a2\u6570\u3092\u5408\u6210\n(def transform (comp str/upper str/trim))\n(transform \"  hello  \")               ;; =&gt; \"HELLO\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u6bd4\u8f03\n;; comp: (comp f g h) \u306f h \u2192 g \u2192 f \u306e\u9806\n;; |&gt;:   x |&gt; h |&gt; g |&gt; f \u306f\u540c\u3058\u51e6\u7406\n</code></pre>"},{"location":"ja/spec/07-functions/#partial-","title":"partial - \u90e8\u5206\u9069\u7528","text":"<pre><code>;; \u90e8\u5206\u9069\u7528\u3067\u65b0\u3057\u3044\u95a2\u6570\u3092\u4f5c\u6210\n(def add5 (partial + 5))\n(add5 10)                             ;; =&gt; 15\n\n;; \u8907\u6570\u5f15\u6570\u306e\u90e8\u5206\u9069\u7528\n(def greet-hello (partial str \"Hello, \"))\n(greet-hello \"Alice\")                 ;; =&gt; \"Hello, Alice\"\n\n;; \u5b9f\u7528\u4f8b: \u30d5\u30a3\u30eb\u30bf\u6761\u4ef6\u306e\u751f\u6210\n(def greater-than-10 (partial &lt; 10))\n(filter greater-than-10 [5 15 3 20])  ;; =&gt; (15 20)\n</code></pre>"},{"location":"ja/spec/07-functions/#fn","title":"fn/ \u30e2\u30b8\u30e5\u30fc\u30eb\uff08\u9ad8\u5ea6\u306a\u9ad8\u968e\u95a2\u6570\uff09","text":""},{"location":"ja/spec/07-functions/#fncomplement-","title":"fn/complement - \u8ff0\u8a9e\u306e\u5426\u5b9a","text":"<pre><code>;; \u8ff0\u8a9e\u3092\u5426\u5b9a\u3057\u305f\u95a2\u6570\u3092\u751f\u6210\n(def odd? (fn/complement even?))\n(odd? 3)                              ;; =&gt; true\n(odd? 4)                              ;; =&gt; false\n\n;; \u5b9f\u7528\u4f8b: \u30d5\u30a3\u30eb\u30bf\u306e\u53cd\u8ee2\n(filter (fn/complement nil?) [1 nil 2 nil 3])  ;; =&gt; (1 2 3)\n</code></pre>"},{"location":"ja/spec/07-functions/#fnjuxt-","title":"fn/juxt - \u8907\u6570\u95a2\u6570\u3092\u4e26\u5217\u9069\u7528","text":"<pre><code>;; \u8907\u6570\u306e\u95a2\u6570\u3092\u4e26\u5217\u306b\u9069\u7528\u3057\u3066\u7d50\u679c\u3092\u30d9\u30af\u30bf\u3067\u8fd4\u3059\n((fn/juxt inc dec) 5)                 ;; =&gt; [6 4]\n\n;; \u5b9f\u7528\u4f8b: \u30c7\u30fc\u30bf\u306e\u591a\u89d2\u7684\u5206\u6790\n(def analyze (fn/juxt min max sum len))\n(analyze [1 2 3 4 5])                 ;; =&gt; [1 5 15 5]\n\n;; \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306e\u62bd\u51fa\n(def extract-info (fn/juxt :name :age :email))\n(extract-info {:name \"Alice\" :age 30 :email \"alice@example.com\"})\n;; =&gt; [\"Alice\" 30 \"alice@example.com\"]\n</code></pre>"},{"location":"ja/spec/07-functions/#fntap-","title":"fn/tap&gt; - \u526f\u4f5c\u7528\u3092\u4f34\u3046\u51e6\u7406","text":"<pre><code>;; \u5024\u3092\u305d\u306e\u307e\u307e\u8fd4\u3057\u3064\u3064\u3001\u526f\u4f5c\u7528\uff08\u30ed\u30ae\u30f3\u30b0\u306a\u3069\uff09\u3092\u5b9f\u884c\n(def log-and-pass (fn/tap&gt; println))\n(log-and-pass 42)  ;; 42\u3092\u51fa\u529b\u3057\u3066\u300142\u3092\u8fd4\u3059\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u30c7\u30d0\u30c3\u30b0\n(10\n  |&gt; (fn/tap&gt; (fn [x] (println \"\u5165\u529b:\" x)))\n  |&gt; (* _ 2)\n  |&gt; (fn/tap&gt; (fn [x] (println \"2\u500d:\" x)))\n  |&gt; (+ _ 5))\n;; \u51fa\u529b:\n;; \u5165\u529b: 10\n;; 2\u500d: 20\n;; =&gt; 25\n\n;; \u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u5b9f\u88c5\n(def counter (atom 0))\n(def count-and-pass\n  (fn/tap&gt; (fn [_] (reset! counter (+ (deref counter) 1)))))\n\n(map count-and-pass [1 2 3 4 5])\n;; =&gt; (1 2 3 4 5)\n(deref counter)  ;; =&gt; 5\n</code></pre>"},{"location":"ja/spec/07-functions/#_5","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/07-functions/#_6","title":"\u30c7\u30fc\u30bf\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u95a2\u6570\u5408\u6210\u3067\u30c7\u30fc\u30bf\u51e6\u7406\n(def process-text\n  (comp\n    str/upper\n    str/trim\n    (partial str/replace _ \"!\" \".\")))\n\n(process-text \"  hello world!  \")     ;; =&gt; \"HELLO WORLD.\"\n</code></pre>"},{"location":"ja/spec/07-functions/#_7","title":"\u30d5\u30a3\u30eb\u30bf\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>;; \u8907\u6570\u306e\u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\n(def valid-user?\n  (fn [user]\n    (and\n      ((complement nil?) (get user :name))\n      (&gt; (get user :age) 18))))\n\n(filter valid-user?\n  [{:name \"Alice\" :age 30}\n   {:name nil :age 20}\n   {:name \"Bob\" :age 15}])\n;; =&gt; ({:name \"Alice\" :age 30})\n</code></pre>"},{"location":"ja/spec/07-functions/#_8","title":"\u9ad8\u968e\u95a2\u6570\u3067\u306e\u30c7\u30d0\u30c3\u30b0","text":"<pre><code>;; \u30bf\u30c3\u30d7\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u89b3\u5bdf\n(defn debug [label]\n  (fn [x]\n    (println label x)\n    x))\n\n([1 2 3]\n |&gt; (map inc)\n |&gt; ((debug \"after map:\"))\n |&gt; sum)\n;; \u51fa\u529b: after map: (2 3 4)\n;; =&gt; 9\n</code></pre>"},{"location":"ja/spec/07-functions/#_9","title":"\u30ab\u30ea\u30fc\u5316\u98a8\u306e\u95a2\u6570\u5b9a\u7fa9","text":"<pre><code>;; \u8907\u6570\u306e\u5f15\u6570\u3092\u6bb5\u968e\u7684\u306b\u9069\u7528\n(defn make-multiplier [n]\n  (fn [x] (* x n)))\n\n(def double (make-multiplier 2))\n(def triple (make-multiplier 3))\n\n(double 5)  ;; =&gt; 10\n(triple 5)  ;; =&gt; 15\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3] |&gt; (map double))  ;; =&gt; (2 4 6)\n</code></pre>"},{"location":"ja/spec/08-error-handling/","title":"\u30a8\u30e9\u30fc\u51e6\u7406","text":"<p>Qi\u306e\u30a8\u30e9\u30fc\u51e6\u7406\u6226\u7565</p> <p>Qi\u306f\u7528\u9014\u306b\u5fdc\u3058\u30663\u3064\u306e\u30a8\u30e9\u30fc\u51e6\u7406\u65b9\u6cd5\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a</p> <ol> <li>Result\u578b\uff08\u5024 / <code>{:error ...}</code>\uff09 - \u56de\u5fa9\u53ef\u80fd\u306a\u30a8\u30e9\u30fc\u3001Railway Pipeline\uff08validation\u5c02\u7528\u3067<code>{:ok value}</code>\u5f62\u5f0f\u3082\u30b5\u30dd\u30fc\u30c8\uff09</li> <li>try/catch - \u4f8b\u5916\u306e\u30ad\u30e3\u30c3\u30c1\u3068\u30ea\u30ab\u30d0\u30ea</li> <li>defer - \u30ea\u30bd\u30fc\u30b9\u89e3\u653e\u306e\u4fdd\u8a3c\uff08<code>finally</code>\u306e\u4ee3\u66ff\uff09</li> </ol>"},{"location":"ja/spec/08-error-handling/#1-result-railway-pipeline","title":"1. Result\u578b - Railway Pipeline\uff08\u63a8\u5968\u30d1\u30bf\u30fc\u30f3\uff09","text":"<p>\u7528\u9014: API\u3001\u30d5\u30a1\u30a4\u30ebIO\u3001\u30d1\u30fc\u30b9\u7b49\u306e\u5931\u6557\u304c\u4e88\u60f3\u3055\u308c\u308b\u51e6\u7406</p>"},{"location":"ja/spec/08-error-handling/#error","title":"\u65b0\u4ed5\u69d8\uff1a<code>{:error}</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f","text":"<p><code>{:error}</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f\u6271\u3044\uff01<code>:ok</code>\u30e9\u30c3\u30d7\u306a\u3057</p> <pre><code>;; \u30b7\u30f3\u30d7\u30eb\uff01\u666e\u901a\u306e\u5024\u3092\u8fd4\u3059\u3060\u3051\n(defn divide [x y]\n  (if (= y 0)\n    {:error \"division by zero\"}  ;; \u30a8\u30e9\u30fc\u3060\u3051\u660e\u793a\u7684\u306b\n    (/ x y)))                     ;; \u666e\u901a\u306e\u5024 \u2192 \u6210\u529f\n\n;; match\u3067\u51e6\u7406\uff08\u5fc5\u8981\u306a\u3089\uff09\n(match (divide 10 2)\n  {:error e} -&gt; (log e)\n  result -&gt; result)\n\n;; error?\u8ff0\u8a9e\u3067\u5224\u5b9a\uff08\u30b7\u30f3\u30d7\u30eb\uff09\n(def result (divide 10 2))\n(if (error? result)\n  (log \"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\")\n  (process result))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u30a8\u30e9\u30fc\u51e6\u7406\uff08\u8a73\u7d30\u306f02-flow-pipes.md\u3092\u53c2\u7167\uff09\n(def user-input \"10\")\n(defn validate [s] (if (&gt; (len s) 0) s {:error \"Empty input\"}))\n(defn parse-number [s] (match (try (str/parse-int s)) {:error e} -&gt; {:error e} n -&gt; n))\n(defn format-result [n] (str \"Result: \" n))\n\n(user-input\n |&gt; validate\n |&gt;? parse-number      ;; \u666e\u901a\u306e\u5024\u3092\u8fd4\u3059\u3060\u3051\u3067OK\n |&gt;? (fn [n] (divide 100 n))\n |&gt;? format-result)\n;; \u6210\u529f\u6642 =&gt; \u7d50\u679c\u306e\u5024\u3001\u30a8\u30e9\u30fc\u6642 =&gt; {:error ...}\n</code></pre>"},{"location":"ja/spec/08-error-handling/#railway-pipeline","title":"Railway Pipeline\u3068\u306e\u7d71\u5408","text":"<p><code>|&gt;?</code> \u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306b\u7d71\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; HTTP\u30ea\u30af\u30a8\u30b9\u30c8 + \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\uff08\u30b7\u30f3\u30d7\u30eb\uff01\uff09\n(\"https://api.example.com/users/123\"\n |&gt; http/get                      ;; =&gt; \"{\\\"user\\\": {...}}\"\uff08\u30dc\u30c7\u30a3\u306e\u307f\uff09\n |&gt;? json/parse                   ;; =&gt; \u30d1\u30fc\u30b9\u7d50\u679c\uff08\u5024\u305d\u306e\u307e\u307e\uff09\n |&gt;? (fn [data] (get data \"user\")))  ;; \u5024\u3092\u8fd4\u3059\u3060\u3051\uff01\n;; \u6210\u529f\u6642 =&gt; \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u3001\u30a8\u30e9\u30fc\u6642 =&gt; {:error ...}\n\n;; JSON\u30d1\u30fc\u30b9 + \u30c7\u30fc\u30bf\u5909\u63db\n(\"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\"\n |&gt; json/parse                    ;; =&gt; \u30d1\u30fc\u30b9\u7d50\u679c\uff08\u5024\u305d\u306e\u307e\u307e\uff09\n |&gt;? (fn [data] (get data \"name\"))  ;; \u5024\u3092\u8fd4\u3059\u3060\u3051\uff01\n |&gt;? str/upper)                   ;; \u95a2\u6570\u3092\u76f4\u63a5\u6e21\u3059\u3060\u3051\uff01\n;; =&gt; \"ALICE\"\n</code></pre>"},{"location":"ja/spec/08-error-handling/#_2","title":"\u52d5\u4f5c\u30eb\u30fc\u30eb","text":"<p>\u5165\u529b\u5024\u306e\u51e6\u7406: 1. <code>{:error ...}</code> \u2192 \u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\uff08\u95a2\u6570\u3092\u5b9f\u884c\u3057\u306a\u3044\uff09 2. \u305d\u306e\u4ed6 \u2192 \u305d\u306e\u307e\u307e\u95a2\u6570\u306b\u6e21\u3059</p> <p>\u51fa\u529b\u5024\u306e\u51e6\u7406: 1. <code>{:error ...}</code> \u2192 \u305d\u306e\u307e\u307e\u8fd4\u3059\uff08\u30a8\u30e9\u30fc\u4f1d\u64ad\uff09 2. \u305d\u306e\u4ed6 \u2192 \u305d\u306e\u307e\u307e\u8fd4\u3059\uff08<code>:ok</code>\u30e9\u30c3\u30d7\u306a\u3057\uff01\uff09</p>"},{"location":"ja/spec/08-error-handling/#_3","title":"\u8a2d\u8a08\u54f2\u5b66","text":"<p>\u30a8\u30e9\u30fc\u3092\u30c7\u30fc\u30bf\u3068\u3057\u3066\u6271\u3044\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u4e2d\u3067\u6d41\u3059\u3002try-catch\u306e\u30cd\u30b9\u30c8\u3092\u907f\u3051\u3001\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u304c\u660e\u78ba\u306b\u306a\u308b\u3002<code>{:error}</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f\u3068\u3057\u3066\u6271\u3044\u3001Lisp\u306e\u300cnil\u4ee5\u5916\u306f\u771f\u300d\u3068\u540c\u3058\u54f2\u5b66\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u3002</p>"},{"location":"ja/spec/08-error-handling/#2-trycatch-","title":"2. try/catch - \u4f8b\u5916\u51e6\u7406","text":"<p>\u7528\u9014: \u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\u306e\u30ad\u30e3\u30c3\u30c1\u3001\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u30b3\u30fc\u30c9\u306e\u547c\u3073\u51fa\u3057</p>"},{"location":"ja/spec/08-error-handling/#_4","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>;; try-catch\u30d6\u30ed\u30c3\u30af\n(match (try (risky-operation))\n  {:error e} -&gt; (handle-error e)\n  result -&gt; result)\n\n;; \u30cd\u30b9\u30c8\u53ef\u80fd\n(match (try\n         (let [data (parse-data input)]\n           (process data)))\n  {:error e} -&gt; {:error (str \"Failed: \" e)}\n  result -&gt; result)\n</code></pre>"},{"location":"ja/spec/08-error-handling/#_5","title":"\u5b9f\u7528\u4f8b","text":"<pre><code>;; \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\u306e\u30a8\u30e9\u30fc\u51e6\u7406\n(match (try (io/read-file \"config.json\"))\n  {:error e} -&gt; (do\n                  (log/error \"Failed to read config:\" e)\n                  {:error e})\n  content -&gt; (json/parse content))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(match (try\n         (url\n          |&gt; http-get\n          |&gt; parse\n          |&gt; process))\n  {:error e} -&gt; []\n  data -&gt; data)\n</code></pre> <p>\u6ce8\u610f: Qi\u306b\u306f<code>finally</code>\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u4ee3\u308f\u308a\u306b<code>defer</code>\u3092\u4f7f\u3044\u307e\u3059\uff08\u4e0b\u8a18\u53c2\u7167\uff09\u3002</p>"},{"location":"ja/spec/08-error-handling/#3-defer-finally","title":"3. defer - \u30ea\u30bd\u30fc\u30b9\u89e3\u653e\u306e\u4fdd\u8a3c\uff08finally\u306e\u4ee3\u66ff\uff09","text":"<p>\u7528\u9014: \u30d5\u30a1\u30a4\u30eb\u3001\u63a5\u7d9a\u3001\u30ed\u30c3\u30af\u306a\u3069\u306e\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406</p>"},{"location":"ja/spec/08-error-handling/#_6","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>;; defer\u3067\u78ba\u5b9f\u306b\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7\n(defn process-file [path]\n  (let [f (open-file path)]\n    (do\n      (defer (close-file f))  ;; \u95a2\u6570\u7d42\u4e86\u6642\u306b\u5fc5\u305a\u5b9f\u884c\n      (let [data (io/read-file f)]\n        (transform data)))))\n\n;; \u5b9f\u7528\u4f8b: \u30d5\u30a1\u30a4\u30eb\u51e6\u7406\n(defn safe-read [path]\n  (let [f (open path)]\n    (do\n      (defer (close f))  ;; \u95a2\u6570\u7d42\u4e86\u6642\u306b\u5fc5\u305a\u5b9f\u884c\n      (read f))))\n</code></pre>"},{"location":"ja/spec/08-error-handling/#defer","title":"\u8907\u6570\u306edefer\u306e\u5b9f\u884c\u9806\u5e8f","text":"<p>\u8907\u6570\u306edefer\u306f\u30b9\u30bf\u30c3\u30af\u7684\u306b\u5b9f\u884c\u3055\u308c\u307e\u3059\uff08\u5f8c\u5165\u308c\u5148\u51fa\u3057: LIFO\uff09\u3002</p> <pre><code>(defn complex-operation []\n  (do\n    (let [conn (open-connection)]\n      (defer (close-connection conn)))\n    (let [lock (acquire-lock)]\n      (defer (release-lock lock)))\n    (let [file (open-file \"data.txt\")]\n      (defer (close-file file)))\n    ;; \u51e6\u7406...\n    ;; \u7d42\u4e86\u6642\u306e\u5b9f\u884c\u9806\u5e8f: close-file \u2192 release-lock \u2192 close-connection\n    ))\n\n;; \u30b7\u30f3\u30d7\u30eb\u306a\u4f8b\n(do\n  (defer (log \"3\"))\n  (defer (log \"2\"))\n  (defer (log \"1\"))\n  (work))\n;; \u5b9f\u884c\u9806: work \u2192 \"1\" \u2192 \"2\" \u2192 \"3\"\n</code></pre>"},{"location":"ja/spec/08-error-handling/#defer_1","title":"\u30a8\u30e9\u30fc\u6642\u306edefer","text":"<p>\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3082\u3001defer\u306f\u5fc5\u305a\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002</p> <pre><code>(defn safe-process []\n  (do\n    (let [res (allocate-resource)]\n      (defer (free-resource res)))\n    (if (error-condition?)\n      (error \"something went wrong\")  ;; defer\u306f\u5b9f\u884c\u3055\u308c\u308b\n      (process res))))\n</code></pre>"},{"location":"ja/spec/08-error-handling/#_7","title":"\u8a2d\u8a08\u54f2\u5b66","text":"<ul> <li><code>finally</code>\u3088\u308a\u30b7\u30f3\u30d7\u30eb - \u95a2\u6570\u306e\u3069\u3053\u306b\u3067\u3082\u66f8\u3051\u308b</li> <li>\u5f37\u529b - \u8907\u6570\u306edefer\u3092\u7d44\u307f\u5408\u308f\u305b\u3089\u308c\u308b</li> <li>Go\u8a00\u8a9e\u306edefer\u3068\u540c\u3058\u8a2d\u8a08</li> <li>Lisp\u7684 - \u7279\u6b8a\u306a\u69cb\u6587\u3092\u5897\u3084\u3055\u306a\u3044</li> </ul> <p>\u306a\u305cfinally\u304c\u306a\u3044\u306e\u304b: <code>defer</code>\u306e\u65b9\u304c\u67d4\u8edf\u3067\u3001\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u304c\u76f4\u611f\u7684\u3002try-catch-finally\u306e\u30cd\u30b9\u30c8\u3088\u308a\u8aad\u307f\u3084\u3059\u3044\u3002</p>"},{"location":"ja/spec/08-error-handling/#4-error-","title":"4. error - \u56de\u5fa9\u4e0d\u80fd\u306a\u30a8\u30e9\u30fc","text":"<p>\u7528\u9014: \u81f4\u547d\u7684\u306a\u30a8\u30e9\u30fc\u3001\u524d\u63d0\u6761\u4ef6\u306e\u9055\u53cd</p>"},{"location":"ja/spec/08-error-handling/#_8","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>;; \u81f4\u547d\u7684\u30a8\u30e9\u30fc\u306ferror\u3067\u6295\u3052\u308b\n(defn critical-init []\n  (if (not (io/file-exists? \"config.qi\"))\n    (error \"config.qi not found\")\n    (load-config)))\n\n(defn factorial [n]\n  (if (&lt; n 0)\n    (error \"negative input not allowed\")\n    (loop [i n acc 1]\n      (if (= i 0)\n        acc\n        (recur (dec i) (* acc i))))))\n</code></pre>"},{"location":"ja/spec/08-error-handling/#try","title":"try\u3067\u30ad\u30e3\u30c3\u30c1","text":"<pre><code>;; error\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3066\u51e6\u7406\n(match (try (factorial -5))\n  {:error e} -&gt; (log (str \"Error: \" e))\n  result -&gt; result)\n</code></pre>"},{"location":"ja/spec/08-error-handling/#_9","title":"\u30a8\u30e9\u30fc\u51e6\u7406\u306e\u4f7f\u3044\u5206\u3051","text":""},{"location":"ja/spec/08-error-handling/#result","title":"Result\u578b\u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9","text":"<ul> <li>API\u547c\u3073\u51fa\u3057\u3001HTTP\u30ea\u30af\u30a8\u30b9\u30c8</li> <li>\u30d5\u30a1\u30a4\u30ebI/O\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30a8\u30ea</li> <li>JSON/YAML\u30d1\u30fc\u30b9</li> <li>\u30e6\u30fc\u30b6\u30fc\u5165\u529b\u306e\u691c\u8a3c</li> <li>\u5931\u6557\u304c\u4e88\u60f3\u3055\u308c\u308b\u51e6\u7406\u5168\u822c</li> </ul>"},{"location":"ja/spec/08-error-handling/#trycatch","title":"try/catch\u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9","text":"<ul> <li>\u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\u306e\u30ad\u30e3\u30c3\u30c1</li> <li>\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u547c\u3073\u51fa\u3057</li> <li>\u8907\u96d1\u306a\u51e6\u7406\u306e\u307e\u3068\u3081\u3066\u30ad\u30e3\u30c3\u30c1</li> <li>\u4f8b\u5916\u7684\u306a\u72b6\u6cc1\u306e\u51e6\u7406</li> </ul>"},{"location":"ja/spec/08-error-handling/#_10","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8fd4\u5374\u5f62\u5f0f","text":"<p>Qi\u306e\u7d44\u307f\u8fbc\u307f\u95a2\u6570\u306f\u3001\u30a8\u30e9\u30fc\u306e\u6027\u8cea\u306b\u5fdc\u3058\u3066\u7570\u306a\u308b\u5f62\u5f0f\u3092\u8fd4\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/08-error-handling/#result-error","title":"Result\u578b\u3092\u8fd4\u3059\u95a2\u6570\uff08\u5024 / <code>{:error ...}</code>\uff09","text":"<p>\u30c7\u30fc\u30bf\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u7cfb - \u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\u306f\u4e88\u671f\u3055\u308c\u308b\u305f\u3081\u3001\u660e\u793a\u7684\u306a\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\uff1a</p> <ul> <li><code>json/parse</code>, <code>json/stringify</code>, <code>json/pretty</code> - JSON\u51e6\u7406</li> <li><code>yaml/parse</code>, <code>yaml/stringify</code> - YAML\u51e6\u7406</li> <li><code>csv/parse</code>, <code>csv/stringify</code> - CSV\u51e6\u7406\uff08\u4e88\u5b9a\uff09</li> </ul> <pre><code>;; \u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\u3092\u660e\u793a\u7684\u306b\u51e6\u7406\n(match (json/parse user-input)\n  {:error msg} -&gt; (show-error-to-user msg)\n  data -&gt; (process data))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(def user-input \"{\\\"name\\\":\\\"alice\\\",\\\"age\\\":30}\")\n(user-input\n |&gt; json/parse\n |&gt;? (fn [data] (get data \"name\"))\n |&gt;? str/upper)\n</code></pre>"},{"location":"ja/spec/08-error-handling/#okvalue-errmessage","title":"\u4f8b\u5916\u3092\u6295\u3052\u308b\u95a2\u6570\uff08<code>Ok(value)</code> / <code>Err(message)</code>\uff09","text":"<p>I/O\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7cfb - \u5931\u6557\u306f\u4f8b\u5916\u7684\u306a\u72b6\u6cc1\u3068\u3057\u3066\u6271\u3046\uff1a</p> <ul> <li><code>http/get</code>, <code>http/post</code>, <code>http/put</code>, <code>http/delete</code> - HTTP\u64cd\u4f5c</li> <li><code>io/read-file</code>, <code>io/write-file</code> - \u30d5\u30a1\u30a4\u30ebI/O</li> <li><code>io/open</code>, <code>io/close</code> - \u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c</li> <li><code>db/*</code> - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u64cd\u4f5c\uff08\u4e88\u5b9a\uff09</li> </ul> <pre><code>;; \u5931\u6557\u6642\u306f\u4f8b\u5916\u3068\u3057\u3066\u4f1d\u64ad\n(def content (io/read-file \"config.json\"))\n\n;; try\u3067\u30ad\u30e3\u30c3\u30c1\u3057\u3066\u51e6\u7406\n(match (try (http/get \"https://api.example.com/data\"))\n  {:error e} -&gt; (log-error e)\n  response -&gt; (process response))\n</code></pre>"},{"location":"ja/spec/08-error-handling/#_11","title":"\u8a2d\u8a08\u65b9\u91dd","text":"<p>\u3053\u306e\u533a\u5225\u306f\u4ee5\u4e0b\u306e\u7406\u7531\u306b\u57fa\u3065\u304d\u307e\u3059\uff1a</p> <ol> <li>\u30c7\u30fc\u30bf\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u7cfb\u306f\u5024/<code>{:error}</code>\u3092\u8fd4\u3059</li> <li>\u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\u306f\u4e88\u671f\u3055\u308c\u308b\u5931\u6557\uff08\u4e0d\u6b63\u306aJSON\u6587\u5b57\u5217\u306a\u3069\uff09</li> <li>\u30e6\u30fc\u30b6\u30fc\u5165\u529b\u306e\u691c\u8a3c\u306a\u3069\u3001\u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u304c\u6b63\u5e38\u306a\u30d5\u30ed\u30fc</li> <li>match\u3084\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\uff08<code>|&gt;?</code>\uff09\u3067\u660e\u793a\u7684\u306b\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li> <p>\u6210\u529f\u6642\u306f\u5024\u3092\u76f4\u63a5\u8fd4\u3059\uff08<code>:ok</code>\u30e9\u30c3\u30d7\u306a\u3057\uff09</p> </li> <li> <p>I/O\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7cfb\u306f\u4f8b\u5916</p> </li> <li>\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u306a\u3044\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc\u306f\u4f8b\u5916\u7684\u306a\u72b6\u6cc1</li> <li>\u6b63\u5e38\u7cfb\u306e\u30b3\u30fc\u30c9\u3092\u7c21\u6f54\u306b\u4fdd\u3064</li> <li>\u5fc5\u8981\u306b\u5fdc\u3058\u3066try/catch\u3067\u30ad\u30e3\u30c3\u30c1</li> </ol> <p>\u3053\u306e\u65b9\u91dd\u306b\u3088\u308a\u3001\u30e6\u30fc\u30b6\u30fc\u306f\u300c\u4e88\u671f\u3055\u308c\u308b\u30a8\u30e9\u30fc\u300d\u3068\u300c\u4f8b\u5916\u7684\u306a\u72b6\u6cc1\u300d\u3092\u81ea\u7136\u306b\u533a\u5225\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/08-error-handling/#defer_2","title":"defer\u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9","text":"<ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u30af\u30ed\u30fc\u30ba</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u306e\u30af\u30ed\u30fc\u30ba</li> <li>\u30ed\u30c3\u30af\u306e\u89e3\u653e</li> <li>\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664</li> <li>\u30ea\u30bd\u30fc\u30b9\u306e\u89e3\u653e\u304c\u5fc5\u8981\u306a\u5834\u5408</li> </ul>"},{"location":"ja/spec/08-error-handling/#error_1","title":"error\u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9","text":"<ul> <li>\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4e0d\u5728</li> <li>\u524d\u63d0\u6761\u4ef6\u306e\u9055\u53cd</li> <li>\u4e0d\u6b63\u306a\u5f15\u6570</li> <li>\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u7d99\u7d9a\u3067\u304d\u306a\u3044\u81f4\u547d\u7684\u306a\u30a8\u30e9\u30fc</li> </ul>"},{"location":"ja/spec/08-error-handling/#rusterrqierror","title":"\u5185\u90e8\u5b9f\u88c5\uff1aRust\u306eErr\u3068Qi\u306e{:error}","text":"<p>Qi\u306e\u30a8\u30e9\u30fc\u51e6\u7406\u306f\u3001Rust\u306eResult\u578b\u3068Qi\u306e\u5024\u578b\u3092\u6a4b\u6e21\u3057\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/08-error-handling/#_12","title":"\u4e8c\u91cd\u306e\u30a8\u30e9\u30fc\u8868\u73fe","text":"<p>Rust\u5074\uff08\u5185\u90e8\u5b9f\u88c5\uff09: <pre><code>fn eval(&amp;self, expr: &amp;Expr) -&gt; Result&lt;Value, String&gt;\n</code></pre> - \u6210\u529f: <code>Ok(Value)</code> - \u30a8\u30e9\u30fc: <code>Err(String)</code></p> <p>Qi\u5074\uff08\u30e6\u30fc\u30b6\u30fc\u5411\u3051\uff09: <pre><code>;; \u6210\u529f: \u5024\u305d\u306e\u307e\u307e\n42\n\"hello\"\n{:user \"alice\"}\n\n;; \u30a8\u30e9\u30fc: {:error ...}\u30de\u30c3\u30d7\n{:error \"file not found\"}\n{:error {:type \"network\" :code 404}}\n</code></pre></p>"},{"location":"ja/spec/08-error-handling/#try_1","title":"try\u306b\u3088\u308b\u5909\u63db","text":"<p><code>try</code>\u306f\u3001Rust\u306eErr\u3092Qi\u306e<code>{:error}</code>\u306b\u5909\u63db\u3057\u307e\u3059\uff1a</p> <pre><code>;; try\u306e\u52d5\u4f5c\n(try (risky-operation))\n;; \u2193 \u5185\u90e8\u51e6\u7406\n;; Ok(value) \u2192 value\uff08\u305d\u306e\u307e\u307e\u8fd4\u3059\uff09\n;; Err(msg) \u2192 {:error msg}\uff08\u30a8\u30e9\u30fc\u30de\u30c3\u30d7\u306b\u5909\u63db\uff09\n</code></pre> <p>\u5b9f\u88c5\u306e\u8a73\u7d30: <pre><code>// src/eval/special_forms.rs\npub fn eval_try(&amp;self, expr: &amp;Expr) -&gt; Result&lt;Value, String&gt; {\n    match self.eval(expr) {\n        Ok(value) =&gt; Ok(value),     // \u6210\u529f \u2192 \u305d\u306e\u307e\u307e\n        Err(msg) =&gt; Ok(Value::error(msg)),  // \u30a8\u30e9\u30fc \u2192 {:error msg}\n    }\n}\n</code></pre></p>"},{"location":"ja/spec/08-error-handling/#railway-pipeline_1","title":"Railway Pipeline\u306e\u5185\u90e8\u52d5\u4f5c","text":"<p><code>|&gt;?</code>\u6f14\u7b97\u5b50\u306f\u3001<code>{:error}</code>\u3092\u691c\u51fa\u3057\u3066\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\u3057\u307e\u3059\uff1a</p> <pre><code>(value\n |&gt;? step1\n |&gt;? step2\n |&gt;? step3)\n</code></pre> <p>\u5c55\u958b\u5f8c: <pre><code>let v1 = step1(value);\nif v1.is_error() { return v1; }  // {:error}\u306a\u3089\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\nlet v2 = step2(v1);\nif v2.is_error() { return v2; }\nlet v3 = step3(v2);\nv3\n</code></pre></p>"},{"location":"ja/spec/08-error-handling/#_13","title":"\u8a2d\u8a08\u306e\u610f\u56f3","text":"<p>\u3053\u306e\u4e8c\u91cd\u69cb\u9020\u306b\u3088\u308a\u3001\u4ee5\u4e0b\u304c\u5b9f\u73fe\u3055\u308c\u307e\u3059\uff1a</p> <ol> <li>Rust\u5074: \u578b\u5b89\u5168\u306a\u4f8b\u5916\u51e6\u7406\uff08Result\u578b\uff09</li> <li>Qi\u5074: Lisp\u7684\u306a\u30c7\u30fc\u30bf\u6307\u5411\u30a8\u30e9\u30fc\u51e6\u7406\uff08\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li>try: \u4e21\u8005\u306e\u6a4b\u6e21\u3057\uff08Err \u2192 {:error}\uff09</li> </ol> <pre><code>;; Rust\u306e\u4f8b\u5916\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3066\u3001Qi\u306e\u5024\u306b\u5909\u63db\n(match (try (io/read-file path))\n  {:error e} -&gt; (handle-error e)  ;; Qi\u5074\u3067\u30c7\u30fc\u30bf\u3068\u3057\u3066\u6271\u3046\n  content -&gt; content)\n</code></pre> <p>\u3053\u306e\u8a2d\u8a08\u306b\u3088\u308a\u3001Rust\u306e\u5b89\u5168\u6027\u3068Lisp\u306e\u67d4\u8edf\u6027\u3092\u4e21\u7acb\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/08-error-handling/#_14","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/08-error-handling/#api","title":"API\u30af\u30e9\u30a4\u30a2\u30f3\u30c8","text":"<pre><code>(defn fetch-user [user-id]\n  (user-id\n   |&gt; (str \"https://api.example.com/users/\" _)\n   |&gt; http/get\n   |&gt;? json/parse\n   |&gt;? validate-user))\n\n;; \u4f7f\u7528\u4f8b\n(match (fetch-user \"123\")\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  user -&gt; (process-user user))\n</code></pre>"},{"location":"ja/spec/08-error-handling/#with-defer","title":"\u30d5\u30a1\u30a4\u30eb\u51e6\u7406with defer","text":"<pre><code>(defn process-log-file [path]\n  (let [f (io/open path :read)]\n    (do\n      (defer (io/close f))\n      (io/read-lines f\n       |&gt; (filter (fn [line] (str/contains? line \"ERROR\")))\n       |&gt; (map parse-log-line)\n       |&gt; (take 100)))))\n</code></pre>"},{"location":"ja/spec/08-error-handling/#_15","title":"\u8907\u96d1\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":"<pre><code>(defn complex-operation [input]\n  (match (try\n           (input\n            |&gt; validate\n            |&gt;? parse-data\n            |&gt;? transform\n            |&gt;? save-to-db))\n    {:error e} -&gt; (do\n                    (log/error \"Operation failed:\" e)\n                    (send-alert e)\n                    {:failure e})\n    result -&gt; {:success result}))\n</code></pre>"},{"location":"ja/spec/09-modules/","title":"\u30e2\u30b8\u30e5\u30fc\u30eb\u30b7\u30b9\u30c6\u30e0","text":"<p>\u30d5\u30a1\u30a4\u30eb\u5358\u4f4d\u3067\u306e\u540d\u524d\u7a7a\u9593\u5206\u96e2</p> <p>Qi\u3067\u306f\u30d5\u30a1\u30a4\u30eb\u5358\u4f4d\u3067\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u69cb\u6210\u3057\u3001\u540d\u524d\u7a7a\u9593\u3092\u5206\u96e2\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/09-modules/#_2","title":"\u57fa\u672c\u6982\u5ff5","text":"<ul> <li>\u63a2\u7d22\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u3001\u8868\u793a\u306fmodule\u540d: <code>use</code>\u306e\u63a2\u7d22\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\u306f<code>module</code>\u5ba3\u8a00\u3067\u5909\u66f4\u53ef</li> <li>use \u304c\u81ea\u52d5\u30ed\u30fc\u30c9: <code>use</code>\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\uff0b\u30a4\u30f3\u30dd\u30fc\u30c8</li> <li>load \u306f\u526f\u4f5c\u7528\u306e\u307f: \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7b49\u3092\u5b9f\u884c\u3059\u308b\u3060\u3051</li> <li>export\u306a\u3057 = \u5168\u516c\u958b: <code>export</code>\u5ba3\u8a00\u304c\u306a\u3051\u308c\u3070\u5168\u3066\u516c\u958b\uff08<code>defn-</code>\u9664\u304f\uff09</li> <li>export\u3042\u308a = \u9078\u629e\u516c\u958b: <code>export</code>\u5ba3\u8a00\u304c\u3042\u308c\u3070\u3001\u660e\u793a\u3057\u305f\u3082\u306e\u306e\u307f\u516c\u958b</li> <li>defn- \u306f\u5b8c\u5168\u975e\u516c\u958b: <code>export</code>\u306b\u95a2\u4fc2\u306a\u304f\u5e38\u306b\u975e\u516c\u958b</li> </ul>"},{"location":"ja/spec/09-modules/#module","title":"module\u5ba3\u8a00","text":"<p><code>module</code>\u306f\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u8868\u793a\u540d\u3092\u6307\u5b9a\u3057\u307e\u3059\uff08\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\uff09\u3002</p>"},{"location":"ja/spec/09-modules/#_3","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>;; http.qi\n(module web-api)  ;; \u8868\u793a\u540d\u3092 'web-api' \u306b\u3059\u308b\n\n(defn get [url] ...)\n\n;; \u63a2\u7d22\u306f 'http.qi' \u3067\u884c\u308f\u308c\u308b\n;; \u30a2\u30af\u30bb\u30b9\u306f 'web-api/get' \u306b\u306a\u308b\n</code></pre>"},{"location":"ja/spec/09-modules/#_4","title":"\u4ed5\u69d8","text":"<ul> <li>\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb: \u306a\u3051\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u540d\uff08basename\uff09\u304c\u30e2\u30b8\u30e5\u30fc\u30eb\u540d</li> <li>\u63a2\u7d22\u306b\u306f\u5f71\u97ff\u3057\u306a\u3044: <code>use http</code> \u306f <code>http.qi</code> \u3092\u63a2\u3059\uff08module\u540d\u3067\u306f\u306a\u3044\uff09</li> <li>\u8868\u793a\u540d\u306e\u307f\u5909\u66f4: \u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306e\u30d7\u30ec\u30d5\u30a3\u30c3\u30af\u30b9\u304c\u5909\u308f\u308b</li> <li>1\u30d5\u30a1\u30a4\u30eb1\u56de\u306e\u307f: \u8907\u6570\u306e<code>module</code>\u5ba3\u8a00\u306f\u30a8\u30e9\u30fc</li> <li>\u4f4d\u7f6e: \u30d5\u30a1\u30a4\u30eb\u5148\u982d\u63a8\u5968\uff08\u6280\u8853\u7684\u306b\u306f\u3069\u3053\u3067\u3082OK\uff09</li> <li>\u623b\u308a\u5024: <code>nil</code></li> </ul>"},{"location":"ja/spec/09-modules/#_5","title":"\u4f8b","text":"<pre><code>;; http.qi\n(module web-api)\n\n;; \u4f7f\u3046\u5074\n(use http)              ;; http.qi \u3092\u63a2\u3059 \u2192 \u6210\u529f\n(web-api/get \"...\")     ;; OK\uff08module\u540d\u3067\u30a2\u30af\u30bb\u30b9\uff09\n(http/get \"...\")        ;; Error\uff08\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u306f\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\uff09\n</code></pre>"},{"location":"ja/spec/09-modules/#export","title":"export\u5ba3\u8a00","text":"<p><code>export</code>\u306f\u516c\u958b\u3059\u308b\u30b7\u30f3\u30dc\u30eb\u3092\u5236\u5fa1\u3057\u307e\u3059\uff08\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\uff09\u3002</p>"},{"location":"ja/spec/09-modules/#a-export","title":"\u30e2\u30fc\u30c9A: export\u5ba3\u8a00\u306a\u3057 \u2192 \u5168\u3066\u516c\u958b\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09","text":"<pre><code>;; utils.qi\n(defn add [a b] (+ a b))        ;; \u516c\u958b\uff08defn\u306a\u306e\u3067\uff09\n(defn multiply [a b] (* a b))   ;; \u516c\u958b\uff08defn\u306a\u306e\u3067\uff09\n(defn- helper [x] (* x 2))      ;; \u975e\u516c\u958b\uff08defn-\u306a\u306e\u3067\uff09\n\n;; \u5168\u3066\u306edefn\u304c\u81ea\u52d5\u7684\u306b\u516c\u958b\u3055\u308c\u308b\n</code></pre>"},{"location":"ja/spec/09-modules/#b-export","title":"\u30e2\u30fc\u30c9B: export\u5ba3\u8a00\u3042\u308a \u2192 \u9078\u629e\u516c\u958b","text":"<pre><code>;; utils.qi\n(defn add [a b] (+ a b))        ;; \u975e\u516c\u958b\uff08export\u306b\u306a\u3044\uff09\n(defn multiply [a b] (* a b))   ;; \u516c\u958b\uff08export\u306b\u3042\u308b\uff09\n(defn- helper [x] (* x 2))      ;; \u975e\u516c\u958b\uff08\u5e38\u306b\uff09\n\n(export multiply)  ;; multiply\u306e\u307f\u516c\u958b\n</code></pre>"},{"location":"ja/spec/09-modules/#_6","title":"\u4ed5\u69d8","text":"<ul> <li>\u30c7\u30d5\u30a9\u30eb\u30c8\u516c\u958b: <code>export</code>\u306a\u3057 \u2192 \u5168<code>defn</code>\u304c\u516c\u958b\u3001\u5168<code>defn-</code>\u304c\u975e\u516c\u958b</li> <li>\u9078\u629e\u516c\u958b: <code>export</code>\u3042\u308a \u2192 \u660e\u793a\u3057\u305f\u3082\u306e\u306e\u307f\u516c\u958b\u3001\u305d\u308c\u4ee5\u5916\u306f\u975e\u516c\u958b</li> <li>defn-\u306f\u5e38\u306b\u975e\u516c\u958b: <code>export</code>\u306b\u66f8\u3044\u3066\u3082\u30a8\u30e9\u30fc</li> <li>\u8907\u6570\u5ba3\u8a00\u53ef: \u7d2f\u7a4d\u3055\u308c\u308b</li> <li>\u4f4d\u7f6e: \u3069\u3053\u3067\u3082OK\uff08\u672b\u5c3e\u63a8\u5968\uff09</li> <li>\u623b\u308a\u5024: <code>nil</code></li> </ul>"},{"location":"ja/spec/09-modules/#export_1","title":"\u8907\u6570\u306eexport\u5ba3\u8a00","text":"<pre><code>(defn get [url] ...)\n(defn post [url data] ...)\n(defn put [url data] ...)\n\n(export get)        ;; get \u306e\u307f\u516c\u958b\n(export post put)   ;; post, put \u3082\u8ffd\u52a0\uff08\u7d2f\u7a4d\uff09\n;; \u7d50\u679c: get, post, put \u304c\u5168\u3066\u516c\u958b\n</code></pre>"},{"location":"ja/spec/09-modules/#_7","title":"\u30e2\u30b8\u30e5\u30fc\u30eb\u5b9a\u7fa9\u306e\u4f8b","text":""},{"location":"ja/spec/09-modules/#1-export","title":"\u30d1\u30bf\u30fc\u30f31: \u30b7\u30f3\u30d7\u30eb\uff08export\u306a\u3057\uff09","text":"<pre><code>;; math.qi\n(defn add [a b] (+ a b))        ;; \u516c\u958b\n(defn sub [a b] (- a b))        ;; \u516c\u958b\n(defn- validate [x] (&gt; x 0))    ;; \u975e\u516c\u958b\n\n;; \u5916\u90e8\u304b\u3089: (math/add ...), (math/sub ...) OK\n;;          (math/validate ...) Error\n</code></pre>"},{"location":"ja/spec/09-modules/#2-export","title":"\u30d1\u30bf\u30fc\u30f32: \u660e\u793a\u7684export","text":"<pre><code>;; math.qi\n(defn add [a b] (+ a b))        ;; \u516c\u958b\uff08export\u306b\u3042\u308b\uff09\n(defn sub [a b] (- a b))        ;; \u975e\u516c\u958b\uff08export\u306b\u306a\u3044\uff09\n(defn multiply [a b] (* a b))   ;; \u975e\u516c\u958b\uff08export\u306b\u306a\u3044\uff09\n(defn- validate [x] (&gt; x 0))    ;; \u975e\u516c\u958b\uff08\u5e38\u306b\uff09\n\n(export add)  ;; add\u306e\u307f\u516c\u958b\n\n;; \u5916\u90e8\u304b\u3089: (math/add ...) OK\n;;          (math/sub ...), (math/multiply ...) Error\n</code></pre>"},{"location":"ja/spec/09-modules/#3-module-export","title":"\u30d1\u30bf\u30fc\u30f33: module\u5ba3\u8a00 + export","text":"<pre><code>;; http.qi\n(module web-client)  ;; \u8868\u793a\u540d\u3092\u5909\u66f4\n\n(defn- build-url [base path] (str base \"/\" path))\n(defn get [url] ...)\n(defn post [url data] ...)\n(defn internal-func [x] ...)  ;; export\u3057\u306a\u3044\u306e\u3067\u975e\u516c\u958b\n\n(export get post)\n\n;; \u5916\u90e8\u304b\u3089:\n;; (use http)  ;; http.qi \u3092\u63a2\u3059\n;; (web-client/get ...) OK\uff08module\u540d\u3067\u30a2\u30af\u30bb\u30b9\uff09\n;; (web-client/post ...) OK\n;; (web-client/internal-func ...) Error\uff08\u975e\u516c\u958b\uff09\n</code></pre>"},{"location":"ja/spec/09-modules/#use","title":"\u30a4\u30f3\u30dd\u30fc\u30c8\uff08use\uff09","text":"<p><code>use</code>\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\uff0b\u30b7\u30f3\u30dc\u30eb\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u3092\u884c\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/09-modules/#1","title":"\u30d1\u30bf\u30fc\u30f31: \u7279\u5b9a\u306e\u95a2\u6570\u306e\u307f\u30a4\u30f3\u30dd\u30fc\u30c8\uff08\u63a8\u5968\uff09","text":"<pre><code>(use http :only [get post])\n(get \"https://...\")                      ;; OK\n</code></pre>"},{"location":"ja/spec/09-modules/#2-modulefunction","title":"\u30d1\u30bf\u30fc\u30f32: \u30a8\u30a4\u30ea\u30a2\u30b9\uff08module/function\u5f62\u5f0f\uff09","text":"<pre><code>(use http :as h)\n(h/get \"https://...\")                    ;; OK\n</code></pre>"},{"location":"ja/spec/09-modules/#3","title":"\u30d1\u30bf\u30fc\u30f33: \u5168\u3066\u30a4\u30f3\u30dd\u30fc\u30c8","text":"<pre><code>(use http :all)\n(get \"https://...\")                      ;; OK\n(post \"https://...\" {:data 123})         ;; OK\n</code></pre>"},{"location":"ja/spec/09-modules/#4","title":"\u30d1\u30bf\u30fc\u30f34: \u30d1\u30b9\u6307\u5b9a","text":"<pre><code>(use \"lib/utils\" :only [format-date])    ;; lib/utils.qi \u3092\u8aad\u307f\u8fbc\u307f\n(use \"./vendor/json\" :as json)           ;; \u76f8\u5bfe\u30d1\u30b9\n</code></pre>"},{"location":"ja/spec/09-modules/#_8","title":"\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\u306e\u6c7a\u5b9a\u30eb\u30fc\u30eb","text":"<p>\u63a2\u7d22\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u3001\u30a2\u30af\u30bb\u30b9\u306fmodule\u540d\u306e\u539f\u5247:</p>"},{"location":"ja/spec/09-modules/#1_1","title":"\u30b1\u30fc\u30b91: \u30e2\u30b8\u30e5\u30fc\u30eb\u540d\u306e\u307f \u2192 \u81ea\u52d5\u63a2\u7d22","text":"<pre><code>(use http :only [get])\n;; 1. http.qi \u3092\u63a2\u7d22\uff08./http.qi, ~/.qi/modules/http.qi \u7b49\uff09\n;; 2. http.qi \u5185\u306e module\u5ba3\u8a00\u3092\u78ba\u8a8d\n;;    - (module web-api) \u2192 \u30a2\u30af\u30bb\u30b9\u306f web-api/get\n;;    - \u306a\u3057 \u2192 \u30a2\u30af\u30bb\u30b9\u306f http/get\n</code></pre>"},{"location":"ja/spec/09-modules/#2-basename","title":"\u30b1\u30fc\u30b92: \u30d1\u30b9\u6307\u5b9a \u2192 basename \u3067\u63a2\u7d22","text":"<pre><code>(use \"lib/http\" :only [get])\n;; 1. lib/http.qi \u3092\u8aad\u307f\u8fbc\u307f\n;; 2. lib/http.qi \u5185\u306e module\u5ba3\u8a00\u3092\u78ba\u8a8d\n;;    - (module web-api) \u2192 \u30a2\u30af\u30bb\u30b9\u306f web-api/get\n;;    - \u306a\u3057 \u2192 \u30a2\u30af\u30bb\u30b9\u306f http/get (basename)\n</code></pre>"},{"location":"ja/spec/09-modules/#3-as","title":"\u30b1\u30fc\u30b93: :as \u3067\u30a8\u30a4\u30ea\u30a2\u30b9","text":"<pre><code>(use \"lib/http\" :as h)\n;; 1. lib/http.qi \u3092\u8aad\u307f\u8fbc\u307f\n;; 2. module\u5ba3\u8a00\u306b\u95a2\u4fc2\u306a\u304f\u3001\u30a8\u30a4\u30ea\u30a2\u30b9 'h' \u3092\u4f7f\u7528\n;; =&gt; \u30a2\u30af\u30bb\u30b9\u306f h/get\n</code></pre>"},{"location":"ja/spec/09-modules/#4-module","title":"\u30b1\u30fc\u30b94: module\u5ba3\u8a00\u3068\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>;; lib/http.qi\n(module web-client)\n(defn get [url] ...)\n\n;; \u4f7f\u3046\u5074\n(use \"lib/http\")\n(web-client/get \"...\")  ;; OK\uff08module\u540d\u3067\u30a2\u30af\u30bb\u30b9\uff09\n\n(use \"lib/http\" :as h)\n(h/get \"...\")           ;; OK\uff08\u30a8\u30a4\u30ea\u30a2\u30b9\u304c\u512a\u5148\uff09\n</code></pre>"},{"location":"ja/spec/09-modules/#_9","title":"\u540d\u524d\u885d\u7a81\u306e\u51e6\u7406","text":"<pre><code>;; lib1/utils.qi \u2192 (module string-utils)\n;; lib2/utils.qi \u2192 (module string-utils)  \u2190 \u540c\u3058module\u540d\uff01\n\n(use \"lib1/utils\")  ;; \u30e2\u30b8\u30e5\u30fc\u30eb\u540d: string-utils\n(use \"lib2/utils\")  ;; Error: module 'string-utils' already loaded\n\n;; \u89e3\u6c7a\u7b561: :as \u3067\u30a8\u30a4\u30ea\u30a2\u30b9\n(use \"lib1/utils\" :as utils1)\n(use \"lib2/utils\" :as utils2)\n\n;; \u89e3\u6c7a\u7b562: \u30d5\u30a1\u30a4\u30eb\u306emodule\u5ba3\u8a00\u3092\u5909\u66f4\n;; lib2/utils.qi \u3092 (module text-utils) \u306b\u5909\u66f4\n</code></pre>"},{"location":"ja/spec/09-modules/#load","title":"load\uff08\u526f\u4f5c\u7528\u306e\u307f\u5b9f\u884c\uff09","text":"<p><code>load</code>\u306f\u30d5\u30a1\u30a4\u30eb\u3092\u8a55\u4fa1\u3059\u308b\u3060\u3051\u3067\u3001\u30b7\u30f3\u30dc\u30eb\u306f\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u307e\u305b\u3093\u3002 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3084\u521d\u671f\u5316\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>;; \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\uff08\u526f\u4f5c\u7528\u306e\u307f\uff09\n(load \"config.qi\")\n\n;; use\u3068\u306e\u9055\u3044\n(use http)    ;; http.qi \u3092\u8aad\u307f\u8fbc\u307f\uff0b\u30b7\u30f3\u30dc\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n(load \"init\") ;; init.qi \u3092\u8a55\u4fa1\u3059\u308b\u3060\u3051\uff08\u30b7\u30f3\u30dc\u30eb\u306f\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u306a\u3044\uff09\n</code></pre>"},{"location":"ja/spec/09-modules/#_10","title":"\u516c\u958b/\u975e\u516c\u958b\u306e\u6c7a\u5b9a\u30d5\u30ed\u30fc","text":"<pre><code>\u95a2\u6570\u5b9a\u7fa9\u306e\u516c\u958b/\u975e\u516c\u958b:\n\ndefn- \u3067\u5b9a\u7fa9\n  \u2192 \u5e38\u306b\u975e\u516c\u958b\uff08export\u3067\u304d\u306a\u3044\uff09\n\ndefn \u3067\u5b9a\u7fa9\n  \u2192 export\u5ba3\u8a00\u304c\u5b58\u5728\u3059\u308b\u304b\uff1f\n      YES \u2192 export\u30ea\u30b9\u30c8\u306b\u542b\u307e\u308c\u308b\u304b\uff1f\n              YES \u2192 \u516c\u958b\n              NO  \u2192 \u975e\u516c\u958b\n      NO  \u2192 \u516c\u958b\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n</code></pre>"},{"location":"ja/spec/09-modules/#_11","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/09-modules/#_12","title":"\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f5c\u6210","text":"<pre><code>;; lib/string-utils.qi\n(module string-utils)\n\n;; \u516c\u958b\u95a2\u6570\n(defn upper [s]\n  (str/upper s))\n\n(defn lower [s]\n  (str/lower s))\n\n;; \u5185\u90e8\u95a2\u6570\uff08\u975e\u516c\u958b\uff09\n(defn- validate [s]\n  (and (string? s) (&gt; (len s) 0)))\n\n;; \u660e\u793a\u7684\u306bexport\n(export upper lower)\n</code></pre>"},{"location":"ja/spec/09-modules/#_13","title":"\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u7528","text":"<pre><code>;; main.qi\n(use \"lib/string-utils\" :only [upper lower])\n\n(upper \"hello\")  ;; =&gt; \"HELLO\"\n(lower \"WORLD\")  ;; =&gt; \"world\"\n\n;; \u307e\u305f\u306f\n(use \"lib/string-utils\" :as str-util)\n(str-util/upper \"hello\")  ;; =&gt; \"HELLO\"\n</code></pre>"},{"location":"ja/spec/09-modules/#_14","title":"\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f","text":"<pre><code>;; config.qi\n(def api-key \"secret-key\")\n(def db-host \"localhost\")\n\n;; main.qi\n(load \"config\")  ;; \u526f\u4f5c\u7528\u306e\u307f\uff08\u30b7\u30f3\u30dc\u30eb\u306f\u30a4\u30f3\u30dd\u30fc\u30c8\u3055\u308c\u306a\u3044\uff09\n\n;; api-key\u3084db-host\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\n(println api-key)  ;; =&gt; \"secret-key\"\n</code></pre>"},{"location":"ja/spec/09-modules/#qiinitqi","title":"\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\uff08.qi/init.qi\uff09","text":"<p>REPL\u304a\u3088\u3073\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u5b9f\u884c\u6642\u306e\u81ea\u52d5\u30ed\u30fc\u30c9</p> <p>Qi\u306f\u3001REPL\u304a\u3088\u3073\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\uff08<code>-e</code>\u30aa\u30d7\u30b7\u30e7\u30f3\uff09\u5b9f\u884c\u6642\u306b\u3001\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\u3092\u81ea\u52d5\u7684\u306b\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/09-modules/#_15","title":"\u8aad\u307f\u8fbc\u307f\u9806\u5e8f","text":"<pre><code>1. ~/.qi/init.qi  \uff08\u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb\u8a2d\u5b9a\u30fb\u512a\u5148\uff09\n2. ./.qi/init.qi  \uff08\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\uff09\n</code></pre> <ul> <li>\u4e21\u65b9\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001\u4e21\u65b9\u30ed\u30fc\u30c9\u3055\u308c\u307e\u3059</li> <li>\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\u3055\u308c\u307e\u3059</li> <li>\u30a8\u30e9\u30fc\u304c\u3042\u3063\u305f\u5834\u5408\u306f\u8b66\u544a\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u304c\u3001\u5b9f\u884c\u306f\u7d99\u7d9a\u3057\u307e\u3059</li> </ul>"},{"location":"ja/spec/09-modules/#_16","title":"\u5bfe\u8c61\u3068\u306a\u308b\u5b9f\u884c\u30e2\u30fc\u30c9","text":"<ul> <li>\u2705 REPL\u30e2\u30fc\u30c9 (<code>qi</code>)</li> <li>\u2705 \u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u30e2\u30fc\u30c9 (<code>qi -e '...'</code>)</li> <li>\u274c \u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u5b9f\u884c (<code>qi script.qi</code>) - \u5bfe\u8c61\u5916</li> </ul>"},{"location":"ja/spec/09-modules/#qiinitqi_1","title":"\u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb\u8a2d\u5b9a\uff08~/.qi/init.qi\uff09","text":"<p>\u3059\u3079\u3066\u306eQi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u5171\u901a\u306b\u4f7f\u3044\u305f\u3044\u8a2d\u5b9a\u3092\u8a18\u8ff0\u3057\u307e\u3059\uff1a</p> <pre><code>;; ~/.qi/init.qi - \u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb\u8a2d\u5b9a\n\n;; \u3088\u304f\u4f7f\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ea\u30ed\u30fc\u30c9\n(use \"table\" :as table)\n(use \"string\" :as str)\n\n;; \u30c7\u30d0\u30c3\u30b0\u7528\u30d8\u30eb\u30d1\u30fc\u95a2\u6570\n(defn dbg [x]\n  (do (println (str \"DEBUG: \" x))\n      x))\n\n;; \u30ea\u30b9\u30c8\u306e\u9577\u3055\u3092\u8868\u793a\u3057\u3066\u304b\u3089\u8fd4\u3059\n(defn show-len [lst]\n  (do (println (str \"length: \" (len lst)))\n      lst))\n</code></pre>"},{"location":"ja/spec/09-modules/#qiinitqi_2","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\uff08./.qi/init.qi\uff09","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u56fa\u6709\u306e\u8a2d\u5b9a\u3092\u8a18\u8ff0\u3057\u307e\u3059\uff1a</p> <pre><code>;; ./.qi/init.qi - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\n\n;; \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u56fa\u6709\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30ed\u30fc\u30c9\n(use \"lib/utils\" :as utils)\n\n;; \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u56fa\u6709\u306e\u5b9a\u6570\n(def db-host \"localhost\")\n(def db-port 5432)\n\n;; \u958b\u767a\u7528\u306e\u30d8\u30eb\u30d1\u30fc\n(defn reload-config []\n  (load \".env\"))\n</code></pre>"},{"location":"ja/spec/09-modules/#_17","title":"\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067\u306e\u6d3b\u7528\u4f8b","text":"<p>\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30d7\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304f\u3068\u3001\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067use\u4e0d\u8981\u3067\u4f7f\u3048\u307e\u3059\uff1a</p> <pre><code># ~/.qi/init.qi \u306b (use \"table\" :as table) \u3092\u8a18\u8ff0\u3057\u3066\u304a\u304f\n\n# \u30d1\u30a4\u30d7\u304b\u3089CSV\u3092\u51e6\u7406\uff08table\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u3059\u3067\u306b\u5229\u7528\u53ef\u80fd\uff09\ncat data.csv | qi -e '(stdin |&gt; split \"\\n\" |&gt; table/parse-csv |&gt; (table/where (fn [row] (&gt; (get row :age) 30))))'\n</code></pre>"},{"location":"ja/spec/09-modules/#_18","title":"\u6ce8\u610f\u70b9","text":"<ul> <li>\u521d\u671f\u5316\u30d5\u30a1\u30a4\u30eb\u306fREPL/\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u5c02\u7528\u3067\u3059</li> <li>\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u5b9f\u884c\u6642\u306b\u306f\u8aad\u307f\u8fbc\u307e\u308c\u307e\u305b\u3093\uff08\u660e\u793a\u7684\u306b<code>load</code>\u3092\u4f7f\u7528\uff09</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30ed\u30fc\u30ab\u30eb\u8a2d\u5b9a\u306f\u3001\u30e6\u30fc\u30b6\u30fc\u30b0\u30ed\u30fc\u30d0\u30eb\u8a2d\u5b9a\u306e\u5f8c\u306b\u8aad\u307f\u8fbc\u307e\u308c\u307e\u3059</li> <li>\u540c\u540d\u306e\u5b9a\u7fa9\u304c\u3042\u308b\u5834\u5408\u3001\u5f8c\u304b\u3089\u8aad\u307f\u8fbc\u307e\u308c\u305f\u65b9\u304c\u512a\u5148\u3055\u308c\u307e\u3059</li> </ul>"},{"location":"ja/spec/10-stdlib-string/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u6587\u5b57\u5217\u64cd\u4f5c\uff08str/\uff09","text":"<p>60\u4ee5\u4e0a\u306e\u6587\u5b57\u5217\u64cd\u4f5c\u95a2\u6570</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>str/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/10-stdlib-string/#_1","title":"\u691c\u7d22","text":"<pre><code>;; str/contains? - \u90e8\u5206\u6587\u5b57\u5217\u3092\u542b\u3080\u304b\u5224\u5b9a\n(str/contains? \"hello world\" \"world\")     ;; =&gt; true\n\n;; str/starts-with? - \u524d\u65b9\u4e00\u81f4\u5224\u5b9a\n(str/starts-with? \"hello\" \"he\")           ;; =&gt; true\n\n;; str/ends-with? - \u5f8c\u65b9\u4e00\u81f4\u5224\u5b9a\n(str/ends-with? \"hello\" \"lo\")             ;; =&gt; true\n\n;; str/index-of - \u6700\u521d\u306e\u51fa\u73fe\u4f4d\u7f6e\uff08\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408\u306fnil\uff09\n(str/index-of \"hello world\" \"world\")      ;; =&gt; 6\n(str/index-of \"hello\" \"xyz\")              ;; =&gt; nil\n\n;; str/last-index-of - \u6700\u5f8c\u306e\u51fa\u73fe\u4f4d\u7f6e\uff08\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408\u306fnil\uff09\n(str/last-index-of \"hello hello\" \"hello\") ;; =&gt; 6\n(str/last-index-of \"hello\" \"xyz\")         ;; =&gt; nil\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_2","title":"\u57fa\u672c\u5909\u63db","text":"<pre><code>;; str/upper - \u5927\u6587\u5b57\u5316\n(str/upper \"hello\")                       ;; =&gt; \"HELLO\"\n\n;; str/lower - \u5c0f\u6587\u5b57\u5316\n(str/lower \"HELLO\")                       ;; =&gt; \"hello\"\n\n;; str/capitalize - \u5148\u982d\u306e\u307f\u5927\u6587\u5b57\n(str/capitalize \"hello\")                  ;; =&gt; \"Hello\"\n\n;; str/title - \u30bf\u30a4\u30c8\u30eb\u30b1\u30fc\u30b9\n(str/title \"hello world\")                 ;; =&gt; \"Hello World\"\n\n;; str/trim - \u524d\u5f8c\u306e\u7a7a\u767d\u3092\u524a\u9664\n(str/trim \"  hello  \")                    ;; =&gt; \"hello\"\n\n;; str/trim-left - \u5de6\u5074\u306e\u7a7a\u767d\u3092\u524a\u9664\n(str/trim-left \"  hello  \")               ;; =&gt; \"hello  \"\n\n;; str/trim-right - \u53f3\u5074\u306e\u7a7a\u767d\u3092\u524a\u9664\n(str/trim-right \"  hello  \")              ;; =&gt; \"  hello\"\n\n;; str/repeat - \u6587\u5b57\u5217\u3092\u7e70\u308a\u8fd4\u3057\n(str/repeat \"-\" 80)                       ;; =&gt; \"----...\" (80\u500b)\n(str/repeat \"ab\" 3)                       ;; =&gt; \"ababab\"\n\n;; str/reverse - \u6587\u5b57\u5217\u3092\u9006\u9806\u306b\n(str/reverse \"hello\")                     ;; =&gt; \"olleh\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_3","title":"\u30b1\u30fc\u30b9\u5909\u63db","text":"<pre><code>;; str/snake - \u30b9\u30cd\u30fc\u30af\u30b1\u30fc\u30b9\u306b\u5909\u63db\n(str/snake \"userName\")                    ;; =&gt; \"user_name\"\n\n;; str/camel - \u30ad\u30e3\u30e1\u30eb\u30b1\u30fc\u30b9\u306b\u5909\u63db\n(str/camel \"user_name\")                   ;; =&gt; \"userName\"\n\n;; str/kebab - \u30b1\u30d0\u30d6\u30b1\u30fc\u30b9\u306b\u5909\u63db\n(str/kebab \"userName\")                    ;; =&gt; \"user-name\"\n\n;; str/pascal - \u30d1\u30b9\u30ab\u30eb\u30b1\u30fc\u30b9\u306b\u5909\u63db\n(str/pascal \"user_name\")                  ;; =&gt; \"UserName\"\n\n;; str/split-camel - \u30ad\u30e3\u30e1\u30eb\u30b1\u30fc\u30b9\u3092\u5206\u5272\n(str/split-camel \"userName\")              ;; =&gt; [\"user\" \"Name\"]\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_4","title":"\u5206\u5272\u30fb\u7d50\u5408","text":"<pre><code>;; str/split - \u6587\u5b57\u5217\u3092\u5206\u5272\n(str/split \"a,b,c\" \",\")                   ;; =&gt; [\"a\" \"b\" \"c\"]\n\n;; str/lines - \u884c\u306b\u5206\u5272\n(str/lines \"hello\\nworld\")                ;; =&gt; [\"hello\" \"world\"]\n\n;; str/words - \u5358\u8a9e\u306b\u5206\u5272\n(str/words \"hello world\")                 ;; =&gt; [\"hello\" \"world\"]\n\n;; str/chars - \u6587\u5b57\u306b\u5206\u5272\n(str/chars \"hello\")                       ;; =&gt; [\"h\" \"e\" \"l\" \"l\" \"o\"]\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_5","title":"\u7f6e\u63db","text":"<pre><code>;; str/replace - \u5168\u3066\u7f6e\u63db\n(str/replace \"hello world\" \"world\" \"qi\")  ;; =&gt; \"hello qi\"\n\n;; str/replace-first - \u6700\u521d\u306e1\u3064\u306e\u307f\u7f6e\u63db\n(str/replace-first \"aa bb aa\" \"aa\" \"cc\")  ;; =&gt; \"cc bb aa\"\n\n;; str/splice - \u7bc4\u56f2\u3092\u7f6e\u63db\n(str/splice \"hello world\" 6 11 \"universe\") ;; =&gt; \"hello universe\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_6","title":"\u90e8\u5206\u6587\u5b57\u5217","text":"<pre><code>;; str/slice - \u7bc4\u56f2\u3092\u53d6\u5f97\n(str/slice \"hello world\" 0 5)             ;; =&gt; \"hello\"\n\n;; str/take-str - \u5148\u982dn\u6587\u5b57\u3092\u53d6\u5f97\uff08\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6700\u9069\u5316\uff09\n(str/take-str 3 \"hello\")                  ;; =&gt; \"hel\"\n(\"hello\" |&gt; (str/take-str 3))             ;; =&gt; \"hel\"\n\n;; str/drop-str - \u5148\u982dn\u6587\u5b57\u3092\u524a\u9664\uff08\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6700\u9069\u5316\uff09\n(str/drop-str 2 \"hello\")                  ;; =&gt; \"llo\"\n(\"hello\" |&gt; (str/drop-str 2))             ;; =&gt; \"llo\"\n\n;; str/sub-before - \u533a\u5207\u308a\u6587\u5b57\u3088\u308a\u524d\u3092\u53d6\u5f97\n(str/sub-before \"user@example.com\" \"@\")   ;; =&gt; \"user\"\n\n;; str/sub-after - \u533a\u5207\u308a\u6587\u5b57\u3088\u308a\u5f8c\u3092\u53d6\u5f97\n(str/sub-after \"user@example.com\" \"@\")    ;; =&gt; \"example.com\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_7","title":"\u6574\u5f62\u30fb\u914d\u7f6e","text":"<pre><code>;; str/pad-left - \u5de6\u8a70\u3081\n(str/pad-left \"Total\" 20)                 ;; =&gt; \"               Total\"\n\n;; str/pad-right - \u53f3\u8a70\u3081\n(str/pad-right \"Name\" 20)                 ;; =&gt; \"Name               \"\n\n;; str/pad - \u4e2d\u592e\u63c3\u3048\n(str/pad \"hi\" 10)                         ;; =&gt; \"    hi    \"\n(str/pad \"hi\" 10 \"*\")                     ;; =&gt; \"****hi****\"\n\n;; str/truncate - \u9577\u3055\u3092\u5236\u9650\n(str/truncate \"hello world\" 8)            ;; =&gt; \"hello...\"\n\n;; str/trunc-words - \u5358\u8a9e\u6570\u3092\u5236\u9650\n(str/trunc-words \"hello world from qi\" 2) ;; =&gt; \"hello world...\"\n\n;; str/indent - \u30a4\u30f3\u30c7\u30f3\u30c8\u8ffd\u52a0\n(str/indent \"hello\\nworld\" 2)             ;; =&gt; \"  hello\\n  world\"\n\n;; str/wrap - \u6307\u5b9a\u5e45\u3067\u6298\u308a\u8fd4\u3057\n(str/wrap \"hello world from qi\" 10)       ;; =&gt; \"hello\\nworld from\\nqi\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_8","title":"\u6b63\u898f\u5316","text":"<pre><code>;; str/squish - \u9023\u7d9a\u7a7a\u767d\u30921\u3064\u306b\uff08\u524d\u5f8ctrim\u8fbc\u307f\uff09\n(str/squish \"  hello   world  \\n\")        ;; =&gt; \"hello world\"\n\n;; str/expand-tabs - \u30bf\u30d6\u3092\u30b9\u30da\u30fc\u30b9\u306b\u5909\u63db\n(str/expand-tabs \"\\thello\\tworld\")        ;; =&gt; \"    hello    world\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_9","title":"\u5224\u5b9a\uff08\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff09","text":"<pre><code>;; str/digit? - \u6570\u5b57\u306e\u307f\u304b\u5224\u5b9a\n(str/digit? \"12345\")                      ;; =&gt; true\n\n;; str/alpha? - \u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u307f\u304b\u5224\u5b9a\n(str/alpha? \"hello\")                      ;; =&gt; true\n\n;; str/alnum? - \u82f1\u6570\u5b57\u306e\u307f\u304b\u5224\u5b9a\n(str/alnum? \"hello123\")                   ;; =&gt; true\n\n;; str/space? - \u7a7a\u767d\u6587\u5b57\u306e\u307f\u304b\u5224\u5b9a\n(str/space? \"  \\n\\t\")                     ;; =&gt; true\n\n;; str/numeric? - \u6570\u5024\u8868\u73fe\u304b\u5224\u5b9a\n(str/numeric? \"123.45\")                   ;; =&gt; true\n\n;; str/integer? - \u6574\u6570\u8868\u73fe\u304b\u5224\u5b9a\n(str/integer? \"123\")                      ;; =&gt; true\n\n;; str/blank? - \u7a7a\u767d\u307e\u305f\u306f\u7a7a\u6587\u5b57\u5217\u304b\u5224\u5b9a\n(str/blank? \"  \\n\")                       ;; =&gt; true\n\n;; str/ascii? - ASCII\u6587\u5b57\u306e\u307f\u304b\u5224\u5b9a\n(str/ascii? \"hello\")                      ;; =&gt; true\n\n;; str/lower? - \u5168\u3066\u5c0f\u6587\u5b57\u304b\u5224\u5b9a\n(str/lower? \"hello\")                      ;; =&gt; true\n\n;; str/upper? - \u5168\u3066\u5927\u6587\u5b57\u304b\u5224\u5b9a\n(str/upper? \"HELLO\")                      ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#urlweb","title":"URL/Web","text":"<pre><code>;; str/slugify - URL/\u30d5\u30a1\u30a4\u30eb\u540d\u7528\u306b\u5909\u63db\n(str/slugify \"Hello World! 2024\")         ;; =&gt; \"hello-world-2024\"\n(str/slugify \"Caf\u00e9 r\u00e9sum\u00e9\")               ;; =&gt; \"cafe-resume\"\n\n;; str/url-encode - URL\u30a8\u30f3\u30b3\u30fc\u30c9\n(str/url-encode \"hello world\")            ;; =&gt; \"hello%20world\"\n\n;; str/url-decode - URL\u30c7\u30b3\u30fc\u30c9\n(str/url-decode \"hello%20world\")          ;; =&gt; \"hello world\"\n\n;; str/html-encode - HTML\u30a8\u30f3\u30b3\u30fc\u30c9\n(str/html-encode \"&lt;div&gt;test&lt;/div&gt;\")       ;; =&gt; \"&amp;lt;div&amp;gt;test&amp;lt;/div&amp;gt;\"\n\n;; str/html-decode - HTML\u30c7\u30b3\u30fc\u30c9\n(str/html-decode \"&amp;lt;div&amp;gt;test&amp;lt;/div&amp;gt;\") ;; =&gt; \"&lt;div&gt;test&lt;/div&gt;\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_10","title":"\u30a8\u30f3\u30b3\u30fc\u30c9","text":"<pre><code>;; str/to-base64 - Base64\u30a8\u30f3\u30b3\u30fc\u30c9\n(str/to-base64 \"hello\")                   ;; =&gt; \"aGVsbG8=\"\n\n;; str/from-base64 - Base64\u30c7\u30b3\u30fc\u30c9\n(str/from-base64 \"aGVsbG8=\")              ;; =&gt; \"hello\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_11","title":"\u30d1\u30fc\u30b9","text":"<pre><code>;; str/parse-int - \u6574\u6570\u306b\u30d1\u30fc\u30b9\n(str/parse-int \"123\")                     ;; =&gt; 123\n\n;; str/parse-float - \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306b\u30d1\u30fc\u30b9\n(str/parse-float \"3.14\")                  ;; =&gt; 3.14\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#unicode","title":"Unicode","text":"<pre><code>;; str/chars-count - Unicode\u6587\u5b57\u6570\n(str/chars-count \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\")                ;; =&gt; 1\n\n;; str/bytes-count - \u30d0\u30a4\u30c8\u6570\n(str/bytes-count \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\")                ;; =&gt; 25\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_12","title":"\u751f\u6210","text":"<pre><code>;; str/hash - \u30cf\u30c3\u30b7\u30e5\u5024\u751f\u6210\n(str/hash \"hello\")                        ;; =&gt; \"2cf24dba5fb0a30e...\"\n(str/hash \"hello\" :sha256)                ;; SHA-256 (\u30c7\u30d5\u30a9\u30eb\u30c8)\n\n;; str/uuid - UUID\u751f\u6210\n(str/uuid)                                ;; =&gt; \"550e8400-e29b-41d4-a716-446655440000\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#nlp","title":"NLP","text":"<pre><code>;; str/word-count - \u5358\u8a9e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\n(str/word-count \"hello world\")            ;; =&gt; 2\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_13","title":"\u30d5\u30a9\u30fc\u30de\u30c3\u30c8","text":"<pre><code>;; str/format - \u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u30fc\u7f6e\u63db\n(str/format \"Hello, {}!\" \"World\")         ;; =&gt; \"Hello, World!\"\n(str/format \"{} + {} = {}\" 1 2 3)         ;; =&gt; \"1 + 2 = 3\"\n\n;; str/format-decimal - \u5c0f\u6570\u70b9\u6841\u6570\u6307\u5b9a\n(str/format-decimal 3.14159 2)            ;; =&gt; \"3.14\"\n(3.14159 |&gt; (str/format-decimal _ 2))     ;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n\n;; str/format-comma - 3\u6841\u30ab\u30f3\u30de\u533a\u5207\u308a\n(str/format-comma 1234567)                ;; =&gt; \"1,234,567\"\n(1234567 |&gt; str/format-comma)             ;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n\n;; str/format-percent - \u30d1\u30fc\u30bb\u30f3\u30c8\u8868\u793a\n(str/format-percent 0.1234)               ;; =&gt; \"12%\"\n(str/format-percent 0.1234 2)             ;; =&gt; \"12.34%\"\n(0.856 |&gt; (str/format-percent _ 1))       ;; =&gt; \"85.6%\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_14","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/10-stdlib-string/#url","title":"URL\u51e6\u7406","text":"<pre><code>;; URL\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u751f\u6210\n(def params [[\"user\" \"alice\"] [\"page\" \"1\"] [\"sort\" \"name\"]])\n\n(params\n |&gt; (map (fn [[k v]] (str k \"=\" (str/url-encode v))))\n |&gt; (join \"&amp;\" _))\n;; =&gt; \"user=alice&amp;page=1&amp;sort=name\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_15","title":"\u30c6\u30ad\u30b9\u30c8\u6574\u5f62","text":"<pre><code>;; \u30de\u30fc\u30af\u30c0\u30a6\u30f3\u306e\u30b3\u30fc\u30c9\u6574\u5f62\n(defn format-code [code lang]\n  f\"```{lang}\\n{(str/trim code)}\\n```\")\n\n(format-code \"  def x = 42  \" \"qi\")\n;; =&gt; \"```qi\\ndef x = 42\\n```\"\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_16","title":"\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>;; \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u7c21\u6613\u30c1\u30a7\u30c3\u30af\n(defn valid-email? [email]\n  (and\n    (str/contains? email \"@\")\n    (str/contains? (str/sub-after email \"@\") \".\")\n    (not (str/blank? (str/sub-before email \"@\")))))\n\n(valid-email? \"user@example.com\")  ;; =&gt; true\n(valid-email? \"invalid\")           ;; =&gt; false\n</code></pre>"},{"location":"ja/spec/10-stdlib-string/#_17","title":"\u30c7\u30fc\u30bf\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; CSV\u30d8\u30c3\u30c0\u30fc\u306e\u6b63\u898f\u5316\n(def headers [\"User Name\" \"E-Mail\" \"Created At\"])\n\n(headers\n |&gt; (map str/lower)\n |&gt; (map str/squish)\n |&gt; (map (fn [s] (str/replace s \" \" \"_\"))))\n;; =&gt; [\"user_name\" \"e-mail\" \"created_at\"]\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - HTTP","text":"<p>HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u30b5\u30fc\u30d0\u30fc</p>"},{"location":"ja/spec/11-stdlib-http/#httphttp","title":"HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08http/\uff09","text":"<p>Qi\u3067\u306f2\u7a2e\u985e\u306eHTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ul> <li>\u30b7\u30f3\u30d7\u30eb\u7248\uff08<code>http/get</code>, <code>http/post</code>\u7b49\uff09: \u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u306e\u307f\u3092\u8fd4\u3059\u30022xx\u4ee5\u5916\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306f\u4f8b\u5916\u3092\u6295\u3052\u308b</li> <li>\u8a73\u7d30\u7248\uff08<code>http/get!</code>, <code>http/post!</code>\u7b49\uff09: \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3001\u30d8\u30c3\u30c0\u30fc\u3001\u30dc\u30c7\u30a3\u3092\u542b\u3080\u8a73\u7d30\u60c5\u5831\u3092\u8fd4\u3059\u3002\u3059\u3079\u3066\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3067Map\u3092\u8fd4\u3059\uff08\u4f8b\u5916\u3092\u6295\u3052\u306a\u3044\uff09</li> </ul>"},{"location":"ja/spec/11-stdlib-http/#-","title":"\u30b7\u30f3\u30d7\u30eb\u7248 - \u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u306e\u307f\u53d6\u5f97","text":"<p>\u591a\u304f\u306e\u5834\u5408\u3001\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u3060\u3051\u304c\u5fc5\u8981\u3067\u3059\u3002\u30b7\u30f3\u30d7\u30eb\u7248\u306f\u6587\u5b57\u5217\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <p>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0: 2xx\u4ee5\u5916\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\uff08404, 500\u7b49\uff09\u306f\u4f8b\u5916\u3092\u6295\u3052\u307e\u3059\u3002</p> <pre><code>;; http/get - HTTP GET\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u30dc\u30c7\u30a3\u306e\u307f\uff09\n(http/get \"https://httpbin.org/get\")\n;; =&gt; \"{\\\"args\\\": {}, \\\"headers\\\": {...}}\"\n\n;; http/post - HTTP POST\u30ea\u30af\u30a8\u30b9\u30c8\n(http/post \"https://api.example.com/users\" {\"name\" \"Alice\" \"email\" \"alice@example.com\"})\n;; =&gt; \"{\\\"id\\\": 123, \\\"name\\\": \\\"Alice\\\"}\"\n\n;; http/put - HTTP PUT\u30ea\u30af\u30a8\u30b9\u30c8\n(http/put \"https://api.example.com/users/1\" {\"name\" \"Alice Updated\"})\n\n;; http/delete - HTTP DELETE\u30ea\u30af\u30a8\u30b9\u30c8\n(http/delete \"https://api.example.com/users/1\")\n\n;; http/patch - HTTP PATCH\u30ea\u30af\u30a8\u30b9\u30c8\n(http/patch \"https://api.example.com/users/1\" {\"email\" \"newemail@example.com\"})\n\n;; http/head - HTTP HEAD\u30ea\u30af\u30a8\u30b9\u30c8\n(http/head \"https://api.example.com/status\")\n\n;; http/options - HTTP OPTIONS\u30ea\u30af\u30a8\u30b9\u30c8\n(http/options \"https://api.example.com\")\n\n;; \u30b7\u30f3\u30d7\u30eb\u306a\u4f7f\u3044\u65b9 - \u30dc\u30c7\u30a3\u3092\u76f4\u63a5JSON\u30d1\u30fc\u30b9\n(def users (http/get \"https://api.example.com/users\" |&gt; json/parse))\n\n;; \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 - 404\u3084500\u306f\u4f8b\u5916\u3092\u6295\u3052\u308b\n(match (try (http/get \"https://api.example.com/notfound\"))\n  {:error e} -&gt; (println \"Error:\" e)  ;; =&gt; \"Error: HTTP\u30a8\u30e9\u30fc 404\"\n  body -&gt; (json/parse body))\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#-_1","title":"\u8a73\u7d30\u7248 - \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u30fb\u30d8\u30c3\u30c0\u30fc\u4ed8\u304d","text":"<p>\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3084\u30d8\u30c3\u30c0\u30fc\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u611f\u5606\u7b26\uff08<code>!</code>\uff09\u4ed8\u304d\u306e\u8a73\u7d30\u7248\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <p>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0: \u3059\u3079\u3066\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\uff082xx, 4xx, 5xx\uff09\u3067Map\u3092\u8fd4\u3057\u307e\u3059\u3002\u4f8b\u5916\u306f\u6295\u3052\u307e\u305b\u3093\u3002</p> <pre><code>;; http/get! - HTTP GET\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/get! \"https://httpbin.org/get\")\n;; =&gt; {:status 200 :headers {\"content-type\" \"application/json\" ...} :body \"...\"}\n\n;; http/post! - HTTP POST\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/post! \"https://api.example.com/users\" {\"name\" \"Alice\"})\n;; =&gt; {:status 201 :headers {...} :body \"...\"}\n\n;; http/put! - HTTP PUT\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/put! \"https://api.example.com/users/1\" {\"name\" \"Alice Updated\"})\n\n;; http/delete! - HTTP DELETE\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/delete! \"https://api.example.com/users/1\")\n\n;; http/patch! - HTTP PATCH\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/patch! \"https://api.example.com/users/1\" {\"email\" \"newemail@example.com\"})\n\n;; http/head! - HTTP HEAD\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/head! \"https://api.example.com/status\")\n\n;; http/options! - HTTP OPTIONS\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u8a73\u7d30\u60c5\u5831\uff09\n(http/options! \"https://api.example.com\")\n\n;; \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3092\u30c1\u30a7\u30c3\u30af\n(let [res (http/get! \"https://api.example.com/users\")]\n  (if (= 200 (get res :status))\n    (json/parse (get res :body))\n    (error (str \"HTTP error: \" (get res :status)))))\n\n;; 404\u30a8\u30e9\u30fc\u3067\u3082\u4f8b\u5916\u3092\u6295\u3052\u305a\u3001Map\u3092\u8fd4\u3059\n(let [res (http/get! \"https://api.example.com/notfound\")]\n  (println \"Status:\" (get res :status))  ;; =&gt; \"Status: 404\"\n  (println \"Body:\" (get res :body)))     ;; \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u53ef\u80fd\n\n;; \u30d8\u30c3\u30c0\u30fc\u3092\u53d6\u5f97\n(let [res (http/get! \"https://api.example.com/data\")]\n  (get-in res [:headers \"content-type\"]))\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_1","title":"\u30aa\u30d7\u30b7\u30e7\u30f3\u5f15\u6570","text":"<p>\u30b7\u30f3\u30d7\u30eb\u7248\u30fb\u8a73\u7d30\u7248\u306e\u4e21\u65b9\u3067\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u5f15\u6570\u3092\u6e21\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff1a</p> <ul> <li><code>:headers</code> - \u30ab\u30b9\u30bf\u30e0HTTP\u30d8\u30c3\u30c0\u30fc\uff08Map\uff09</li> <li><code>:timeout</code> - \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u6642\u9593\uff08\u30df\u30ea\u79d2\uff09</li> <li><code>:basic-auth</code> - Basic\u8a8d\u8a3c\uff08<code>[username password]</code>\u5f62\u5f0f\u306eVector\uff09</li> <li><code>:bearer-token</code> - Bearer Token\u8a8d\u8a3c\uff08\u6587\u5b57\u5217\uff09</li> </ul> <pre><code>;; GET\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u30ab\u30b9\u30bf\u30e0\u30d8\u30c3\u30c0\u30fc\u3092\u8ffd\u52a0\n(http/get \"https://api.example.com/data\"\n  {:headers {\"X-API-Key\" \"your-api-key\"}})\n\n;; POST\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u8a8d\u8a3c\u3068\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u8a2d\u5b9a\n(http/post \"https://api.example.com/users\"\n  {\"name\" \"Alice\"}\n  {:bearer-token \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n   :timeout 10000})\n\n;; Basic\u8a8d\u8a3c\u3092\u4f7f\u7528\n(http/get! \"https://api.example.com/protected\"\n  {:basic-auth [\"username\" \"password\"]})\n\n;; \u8907\u6570\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u7d44\u307f\u5408\u308f\u305b\n(http/post! \"https://api.example.com/data\"\n  {\"key\" \"value\"}\n  {:headers {\"X-Request-ID\" \"12345\"}\n   :timeout 5000})\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_2","title":"\u8a73\u7d30\u8a2d\u5b9a","text":"<pre><code>;; http/request - \u30ab\u30b9\u30bf\u30e0\u30ea\u30af\u30a8\u30b9\u30c8\n(http/request {\n  :method \"POST\"\n  :url \"https://api.example.com/data\"\n  :headers {\"Authorization\" \"Bearer token123\"}\n  :body {\"data\" \"value\"}\n  :timeout 5000\n})\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_3","title":"\u8a8d\u8a3c","text":"<pre><code>;; Basic\u8a8d\u8a3c\n(http/request {\n  :url \"https://api.example.com/data\"\n  :basic-auth [\"username\" \"password\"]\n})\n\n;; Bearer Token\u8a8d\u8a3c\n(http/request {\n  :url \"https://api.example.com/data\"\n  :bearer-token \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n})\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_4","title":"\u30b3\u30f3\u30c6\u30f3\u30c4\u5727\u7e2e","text":"<pre><code>;; \u81ea\u52d5\u89e3\u51cd\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\uff09\n(http/get \"https://example.com/api\")  ;; gzip/deflate/brotli \u3092\u81ea\u52d5\u89e3\u51cd\n\n;; \u9001\u4fe1\u6642\u306e\u5727\u7e2e\n(http/post \"https://example.com/api\"\n  {\"data\" \"large payload\"}\n  {:headers {\"content-encoding\" \"gzip\"}})  ;; \u30dc\u30c7\u30a3\u3092\u81ea\u52d5\u7684\u306bgzip\u5727\u7e2e\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#railway-pipeline","title":"Railway Pipeline\u3068\u306e\u7d71\u5408","text":"<pre><code>;; \u30b7\u30f3\u30d7\u30eb\u7248\u3067\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 - \u30dc\u30c7\u30a3\u304c\u76f4\u63a5\u8fd4\u3055\u308c\u308b\n(\"https://api.github.com/users/octocat\"\n |&gt; http/get\n |&gt; json/parse\n |&gt; (fn [data] (get data \"name\")))\n;; =&gt; \"The Octocat\"\n\n;; \u8a73\u7d30\u7248\u3067\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 - \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u3092\u30c1\u30a7\u30c3\u30af\n(\"https://api.github.com/users/octocat\"\n |&gt; http/get!\n |&gt; (fn [resp]\n      (if (= 200 (get resp :status))\n        (get resp :body)\n        (error (str \"HTTP \" (get resp :status)))))\n |&gt; json/parse\n |&gt; (fn [data] (get data \"name\")))\n;; =&gt; \"The Octocat\"\n\n;; \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\uff08try\u3067\u4f8b\u5916\u3092\u30ad\u30e3\u30c3\u30c1\uff09\n(match (try\n         (\"https://api.github.com/users/octocat\"\n          |&gt; http/get\n          |&gt; json/parse\n          |&gt; (fn [data] (get data \"name\"))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  name -&gt; name)\n;; =&gt; \"The Octocat\" (\u6210\u529f\u6642) \u307e\u305f\u306f {:error ...} (\u5931\u6557\u6642)\n\n;; Railway\u6f14\u7b97\u5b50\u3067\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(\"https://api.github.com/users/octocat\"\n |&gt; (try (http/get _))\n |&gt;? json/parse\n |&gt;? (fn [data] (get data \"name\")))\n;; =&gt; \"The Octocat\" (\u6210\u529f\u6642) \u307e\u305f\u306f {:error ...} (\u5931\u6557\u6642)\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#httpserver","title":"HTTP\u30b5\u30fc\u30d0\u30fc\uff08server/\uff09","text":"<p>Flow-Oriented \u306a Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9</p>"},{"location":"ja/spec/11-stdlib-http/#_5","title":"\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30eb\u30d1\u30fc","text":"<pre><code>;; server/ok - 200 OK\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/ok \"Hello, World!\")\n;; =&gt; {:status 200 :headers {...} :body \"Hello, World!\"}\n\n;; server/json - JSON\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/json {\"message\" \"hello\" \"status\" \"success\"})\n;; =&gt; {:status 200 :headers {\"Content-Type\" \"application/json\"} :body \"{...}\"}\n\n;; server/not-found - 404 Not Found\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/not-found \"Page not found\")\n\n;; server/no-content - 204 No Content\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/no-content)\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_6","title":"\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0","text":"<pre><code>;; server/router - \u30eb\u30fc\u30bf\u30fc\u4f5c\u6210\n(server/router [[\"/\" {:get hello-handler}]\n                [\"/api/users\" {:get list-users :post create-user}]\n                [\"/api/users/:id\" {:get get-user}]])\n\n;; server/serve - \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\n(comment\n  (server/serve app {:port 3000})\n  ;; =&gt; HTTP server started on http://127.0.0.1:3000\n  )\n\n;; server/serve - \u8a73\u7d30\u8a2d\u5b9a\n(comment\n  (server/serve app {:port 8080 :host \"0.0.0.0\" :timeout 30})\n  ;; =&gt; HTTP server started on http://0.0.0.0:8080 (timeout: 30s)\n  )\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_7","title":"\u30df\u30c9\u30eb\u30a6\u30a7\u30a2","text":"<pre><code>;; server/with-logging - \u30ea\u30af\u30a8\u30b9\u30c8/\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30ed\u30b0\u51fa\u529b\n(def handler (server/with-logging (fn [req] (server/ok \"Hello\"))))\n\n;; server/with-cors - CORS\u30d8\u30c3\u30c0\u30fc\u3092\u8ffd\u52a0\n(def handler (server/with-cors (fn [req] (server/json {...}))))\n\n;; server/with-json-body - \u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u3092\u81ea\u52d5\u7684\u306bJSON\u30d1\u30fc\u30b9\n(def handler (server/with-json-body (fn [req] (get req :json))))\n\n;; server/with-compression - \u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u3092gzip\u5727\u7e2e\n(def handler (server/with-compression (fn [req] (server/ok \"...\"))))\n\n;; server/with-basic-auth - Basic\u8a8d\u8a3c\n(def handler (server/with-basic-auth (fn [req] ...) \"user\" \"pass\"))\n\n;; server/with-bearer - Bearer Token\u62bd\u51fa\n(def handler (server/with-bearer (fn [req] (get req :token))))\n\n;; server/with-no-cache - \u30ad\u30e3\u30c3\u30b7\u30e5\u7121\u52b9\u5316\u30d8\u30c3\u30c0\u30fc\u3092\u8ffd\u52a0\n(def handler (server/with-no-cache (fn [req] (server/ok \"...\"))))\n\n;; server/with-cache-control - \u30ab\u30b9\u30bf\u30e0Cache-Control\u30d8\u30c3\u30c0\u30fc\u3092\u8ffd\u52a0\n(def handler (server/with-cache-control (fn [req] ...) \"public, max-age=3600\"))\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_8","title":"\u9759\u7684\u30d5\u30a1\u30a4\u30eb\u914d\u4fe1","text":"<pre><code>;; server/static-file - \u5358\u4e00\u30d5\u30a1\u30a4\u30eb\u914d\u4fe1\n(server/static-file \"index.html\")\n\n;; server/static-dir - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4fe1\n(server/static-dir \"public\")\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_9","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/11-stdlib-http/#_10","title":"\u30b7\u30f3\u30d7\u30eb\u306a\u30b5\u30fc\u30d0\u30fc","text":"<pre><code>;; \u30cf\u30f3\u30c9\u30e9\u30fc\uff08\u30ea\u30af\u30a8\u30b9\u30c8 -&gt; \u30ec\u30b9\u30dd\u30f3\u30b9\uff09\n(def hello-handler\n  (fn [req] (server/ok \"Hello, World!\")))\n\n;; \u30eb\u30fc\u30c8\u5b9a\u7fa9\uff08\u30c7\u30fc\u30bf\u99c6\u52d5\uff09\n(def routes [[\"/\" {:get hello-handler}]])\n\n;; \u30a2\u30d7\u30ea\u8d77\u52d5\n(def app (server/router routes))\n(comment\n  (server/serve app {:port 3000}))\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#json-api-with","title":"JSON API with \u30d1\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf","text":"<pre><code>;; \u30cf\u30f3\u30c9\u30e9\u30fc\u5b9a\u7fa9\n(def list-users\n  (fn [req]\n    (server/json {\"users\" [{\"id\" 1 \"name\" \"Alice\"}\n                           {\"id\" 2 \"name\" \"Bob\"}]})))\n\n(def get-user\n  (fn [req]\n    (let [user-id (get-in req [:params \"id\"])]\n      (server/json {\"id\" user-id \"name\" \"Alice\"}))))\n\n(def create-user\n  (fn [req]\n    (server/json {\"status\" \"created\"} {:status 201})))\n\n;; \u30eb\u30fc\u30c8\u5b9a\u7fa9\uff08\u30d1\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf: /users/:id \u5f62\u5f0f\uff09\n(def routes\n  [[\"/api/users\" {:get list-users :post create-user}]\n   [\"/api/users/:id\" {:get get-user}]\n   [\"/api/users/:user_id/posts/:post_id\" {:get get-post}]])\n\n;; \u30a2\u30d7\u30ea\u8d77\u52d5\n(def app (server/router routes))\n(comment\n  (server/serve app {:port 8080 :host \"0.0.0.0\" :timeout 30}))\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_11","title":"\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>;; \u8907\u6570\u306e\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u91cd\u306d\u308b\n(def api-handler\n  (-&gt; (fn [req]\n        (let [json-data (get req :json)]\n          (server/json {\"received\" json-data})))\n      server/with-json-body\n      server/with-cors\n      server/with-logging\n      server/with-compression))\n\n;; \u307e\u305f\u306f comp \u3092\u4f7f\u3063\u305f\u95a2\u6570\u5408\u6210\n(def protected-api\n  (comp\n    server/with-logging\n    server/with-cors\n    (partial server/with-basic-auth _ \"admin\" \"secret\")\n    server/with-json-body))\n\n(def routes\n  [[\"/api/data\" {:post (protected-api handle-data)}]])\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_12","title":"\u30ea\u30af\u30a8\u30b9\u30c8/\u30ec\u30b9\u30dd\u30f3\u30b9\u30aa\u30d6\u30b8\u30a7\u30af\u30c8","text":"<pre><code>;; \u30ea\u30af\u30a8\u30b9\u30c8\u69cb\u9020\n{:method :get                       ;; HTTP\u30e1\u30bd\u30c3\u30c9\uff08\u30ad\u30fc\u30ef\u30fc\u30c9\uff09\n :path \"/api/users/123\"             ;; \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9\n :query \"page=1&amp;limit=10\"           ;; \u30af\u30a8\u30ea\u6587\u5b57\u5217\uff08\u751f\uff09\n :query-params {\"page\" \"1\"          ;; \u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\uff08\u81ea\u52d5\u30d1\u30fc\u30b9\uff09\n                \"limit\" \"10\"}\n :headers {\"content-type\" \"application/json\" ...}\n :body \"...\"                        ;; \u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\uff08\u6587\u5b57\u5217\uff09\n :params {\"id\" \"123\"}}              ;; \u30d1\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf\uff08\u30de\u30c3\u30c1\u3057\u305f\u5834\u5408\u306e\u307f\uff09\n\n;; \u30ec\u30b9\u30dd\u30f3\u30b9\u69cb\u9020\n{:status 200                        ;; HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\n :headers {\"Content-Type\" \"text/plain; charset=utf-8\" ...}\n :body \"Hello, World!\"}             ;; \u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\uff08\u6587\u5b57\u5217\u3001JSON\u3001HTML\u7b49\uff09\n\n;; \u30ec\u30b9\u30dd\u30f3\u30b9\u69cb\u9020\uff08\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u914d\u4fe1\uff09\n{:status 200\n :headers {\"Content-Type\" \"video/mp4\" ...}\n :body-file \"/path/to/large-file.mp4\"}  ;; \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\uff08\u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u7528\uff09\n</code></pre>"},{"location":"ja/spec/11-stdlib-http/#_13","title":"\u5b9f\u88c5\u6e08\u307f\u6a5f\u80fd","text":"<ul> <li>\u2705 \u30c7\u30fc\u30bf\u99c6\u52d5: \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306f\u691c\u67fb\u30fb\u5909\u63db\u53ef\u80fd\u306a\u30c7\u30fc\u30bf\u69cb\u9020</li> <li>\u2705 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: \u30cf\u30f3\u30c9\u30e9\u30fc\u306f <code>|&gt;</code> \u3067\u6d41\u308c\u304c\u660e\u78ba</li> <li>\u2705 \u5408\u6210\u53ef\u80fd: \u3059\u3079\u3066\u304c\u95a2\u6570\u3067\u3001\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3082\u95a2\u6570</li> <li>\u2705 \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5: \u4e26\u5217\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u306b\u5bfe\u5fdc</li> <li>\u2705 \u30d1\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf: <code>/users/:id</code> \u5f62\u5f0f\u3092\u30b5\u30dd\u30fc\u30c8\uff08\u8907\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u5bfe\u5fdc\uff09</li> <li>\u2705 \u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf: <code>?page=1&amp;limit=10</code> \u3092\u81ea\u52d5\u30d1\u30fc\u30b9\u3001\u914d\u5217\u5bfe\u5fdc\u3001URL\u30c7\u30b3\u30fc\u30c9</li> <li>\u2705 \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8: \u30ea\u30af\u30a8\u30b9\u30c8\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u8a2d\u5b9a\u53ef\u80fd\uff08\u30c7\u30d5\u30a9\u30eb\u30c830\u79d2\uff09</li> <li>\u2705 \u30df\u30c9\u30eb\u30a6\u30a7\u30a2: \u30ed\u30ae\u30f3\u30b0\u3001CORS\u3001JSON\u30dc\u30c7\u30a3\u30d1\u30fc\u30b9\uff08\u8907\u6570\u91cd\u306d\u53ef\u80fd\uff09</li> <li>\u2705 \u9759\u7684\u30d5\u30a1\u30a4\u30eb\u914d\u4fe1: HTML\u3001CSS\u3001JS\u3001\u753b\u50cf\u3001\u30d5\u30a9\u30f3\u30c8\u306a\u3069\u306e\u30d0\u30a4\u30ca\u30ea\u30d5\u30a1\u30a4\u30eb\u5bfe\u5fdc</li> <li>\u2705 \u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u914d\u4fe1: \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\uff08\u52d5\u753b\u3001PDF\u7b49\uff09\u3092\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306b\u914d\u4fe1\uff08<code>:body-file</code>\u30ad\u30fc\uff09</li> <li>\u2705 \u30b3\u30f3\u30c6\u30f3\u30c4\u5727\u7e2e: gzip/deflate/brotli\u5727\u7e2e\u3092\u30b5\u30dd\u30fc\u30c8</li> <li>\u2705 \u8a8d\u8a3c: Basic Auth\u3001Bearer Token\u62bd\u51fa</li> <li>\u2705 \u30ad\u30e3\u30c3\u30b7\u30e5\u5236\u5fa1: Cache-Control\u3001\u30b0\u30ec\u30fc\u30b9\u30d5\u30eb\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3</li> </ul>"},{"location":"ja/spec/12-stdlib-json/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - JSON/YAML","text":"<p>JSON\u30fbYAML\u51e6\u7406</p>"},{"location":"ja/spec/12-stdlib-json/#jsonjson","title":"JSON\u51e6\u7406\uff08json/\uff09","text":""},{"location":"ja/spec/12-stdlib-json/#_1","title":"\u57fa\u672c\u64cd\u4f5c","text":"<pre><code>;; json/parse - JSON\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\n(json/parse \"{\\\"name\\\":\\\"Alice\\\",\\\"age\\\":30}\")\n;; =&gt; {\"name\" \"Alice\" \"age\" 30}\n\n;; json/stringify - \u5024\u3092JSON\u5316\uff08\u30b3\u30f3\u30d1\u30af\u30c8\uff09\n(json/stringify {\"name\" \"Bob\" \"age\" 25})\n;; =&gt; \"{\\\"name\\\":\\\"Bob\\\",\\\"age\\\":25}\"\n\n;; json/pretty - \u5024\u3092\u6574\u5f62JSON\u5316\n(json/pretty {\"name\" \"Bob\" \"age\" 25})\n;; =&gt; \"{\\n  \\\"name\\\": \\\"Bob\\\",\\n  \\\"age\\\": 25\\n}\"\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#result","title":"Result\u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30d1\u30fc\u30b9","text":"<p>\u3059\u3079\u3066\u306eJSON\u95a2\u6570\u306f\u6210\u529f\u6642\u306b\u5024\u3092\u305d\u306e\u307e\u307e\u8fd4\u3057\u3001\u5931\u6557\u6642\u306b <code>{:error message}</code> \u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u6b63\u5e38\u306a\u30d1\u30fc\u30b9\n(match (json/parse \"{\\\"valid\\\": true}\")\n  {:error e} -&gt; (log e)\n  data -&gt; data)\n;; =&gt; {\"valid\" true}\n\n;; \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(match (json/parse \"{invalid json}\")\n  {:error e} -&gt; (println \"Parse error:\" e)\n  data -&gt; data)\n;; =&gt; \"Parse error: ...\"\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_2","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528","text":"<pre><code>;; API\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u2192\u5909\u63db\u2192\u4fdd\u5b58\uff08HTTP\u306f\u4f8b\u5916\u3092\u6295\u3052\u308b\u306e\u3067try\u3067\u30ad\u30e3\u30c3\u30c1\uff09\n(match (try\n         (\"https://api.example.com/users/123\"\n          |&gt; http/get\n          |&gt;? json/parse\n          |&gt;? (fn [data] (assoc data \"processed\" true))\n          |&gt;? json/pretty\n          |&gt;? (fn [json] (io/write-file \"output.json\" json))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  result -&gt; result)\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#yamlyaml","title":"YAML\u51e6\u7406\uff08yaml/\uff09","text":"<p>Pure Rust\u5b9f\u88c5 - serde_yaml\u4f7f\u7528</p>"},{"location":"ja/spec/12-stdlib-json/#_3","title":"\u57fa\u672c\u64cd\u4f5c","text":"<pre><code>;; yaml/parse - YAML\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\n(yaml/parse \"name: Alice\\nage: 30\\ntags:\\n  - dev\\n  - ops\")\n;; =&gt; {\"name\" \"Alice\" \"age\" 30 \"tags\" [\"dev\" \"ops\"]}\n\n;; yaml/stringify - \u5024\u3092YAML\u5316\n(yaml/stringify {\"name\" \"Bob\" \"age\" 25 \"tags\" [\"backend\" \"devops\"]})\n;; =&gt; \"name: Bob\\nage: 25\\ntags:\\n- backend\\n- devops\\n\"\n\n;; yaml/pretty - \u5024\u3092\u6574\u5f62YAML\u5316\uff08yaml/stringify\u3068\u540c\u3058\uff09\n(yaml/pretty {\"server\" {\"host\" \"localhost\" \"port\" 8080}})\n;; =&gt; \"server:\\n  host: localhost\\n  port: 8080\\n\"\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_4","title":"\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u51e6\u7406","text":"<pre><code>;; \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30d1\u30fc\u30b9\u3057\u3066\u30dd\u30fc\u30c8\u756a\u53f7\u3092\u53d6\u5f97\uff08I/O\u306f\u4f8b\u5916\u3092\u6295\u3052\u308b\u306e\u3067try\u3067\u30ad\u30e3\u30c3\u30c1\uff09\n(match (try\n         (\"config.yaml\"\n          |&gt; io/read-file\n          |&gt;? yaml/parse\n          |&gt;? (fn [conf] (get-in conf [\"server\" \"port\"]))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  port -&gt; port)\n;; =&gt; 8080\n\n;; \u30c7\u30fc\u30bf\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\uff08JSON \u2192 YAML\uff09\n(match (try\n         (\"data.json\"\n          |&gt; io/read-file\n          |&gt;? json/parse\n          |&gt;? yaml/stringify\n          |&gt;? (fn [yaml] (io/write-file \"data.yaml\" yaml))))\n  {:error e} -&gt; (log/error \"Failed:\" e)\n  result -&gt; result)\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#yaml","title":"YAML\u306e\u7279\u5fb4","text":"<ul> <li>\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u6700\u9069\uff08JSON/TOML\u3088\u308a\u8aad\u307f\u3084\u3059\u3044\uff09</li> <li>\u30a4\u30f3\u30c7\u30f3\u30c8\u81ea\u52d5\u6574\u5f62</li> <li>JSON\u4e92\u63db\uff08YAML\u306fJSON\u306e\u30b9\u30fc\u30d1\u30fc\u30bb\u30c3\u30c8\uff09</li> <li>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0: \u6210\u529f\u6642\u306f\u5024\u3092\u305d\u306e\u307e\u307e\u8fd4\u3057\u3001\u5931\u6557\u6642\u306b <code>{:error \"...\"}</code></li> </ul>"},{"location":"ja/spec/12-stdlib-json/#_5","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/12-stdlib-json/#api","title":"API \u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u3068\u4fdd\u5b58","text":"<pre><code>(defn fetch-and-save [url output-file]\n  (match (try\n           (url\n            |&gt; http/get\n            |&gt;? json/parse\n            |&gt;? json/pretty\n            |&gt;? (fn [json-str] (io/write-file output-file json-str))))\n    {:error e} -&gt; (log/error \"Failed:\" e)\n    result -&gt; result))\n\n(fetch-and-save \"https://api.github.com/users/octocat\" \"user.json\")\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_6","title":"\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f","text":"<pre><code>(defn load-config [path]\n  (match (try\n           (path\n            |&gt; io/read-file\n            |&gt;? yaml/parse\n            |&gt;? (fn [config]\n                  ;; \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n                  (if (get config \"version\")\n                    config\n                    {:error \"Missing version field\"}))))\n    {:error e} -&gt; {:error e}\n    config -&gt; config))\n\n(match (load-config \"config.yaml\")\n  {:error e} -&gt; (println \"Error:\" e)\n  config -&gt; (println \"Config loaded:\" config))\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_7","title":"\u30c7\u30fc\u30bf\u5909\u63db","text":"<pre><code>;; JSON \u2192 YAML\u5909\u63db\n(defn json-to-yaml [input-file output-file]\n  (match (try\n           (input-file\n            |&gt; io/read-file\n            |&gt;? json/parse\n            |&gt;? yaml/stringify\n            |&gt;? (fn [yaml-str] (io/write-file output-file yaml-str))))\n    {:error e} -&gt; (log/error \"Failed:\" e)\n    result -&gt; result))\n\n(json-to-yaml \"data.json\" \"data.yaml\")\n\n;; YAML \u2192 JSON\u5909\u63db\n(defn yaml-to-json [input-file output-file]\n  (match (try\n           (input-file\n            |&gt; io/read-file\n            |&gt;? yaml/parse\n            |&gt;? json/stringify\n            |&gt;? (fn [json-str] (io/write-file output-file json-str))))\n    {:error e} -&gt; (log/error \"Failed:\" e)\n    result -&gt; result))\n\n(yaml-to-json \"config.yaml\" \"config.json\")\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_8","title":"\u30d0\u30c3\u30c1\u51e6\u7406","text":"<pre><code>;; \u8907\u6570\u306eJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4e26\u5217\u30d1\u30fc\u30b9\n(def files [\"data1.json\" \"data2.json\" \"data3.json\"])\n\n(files\n ||&gt; (fn [f] (try (io/read-file f)))\n ||&gt; (fn [content]\n       (match content\n         {:error e} -&gt; {:error e}\n         c -&gt; (json/parse c)))\n |&gt; (filter (fn [result] (not (error? result)))))\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_9","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u30a8\u30e9\u30fc\u51e6\u7406\n(defn process-json [json-str]\n  (match (json/parse json-str)\n    {:error e} -&gt; (do\n                    (log/error \"Parse failed:\" e)\n                    {:error e})\n    data -&gt; (do\n              (println \"Parsed successfully\")\n              (assoc data \"timestamp\" (now)))))\n\n;; \u8907\u6570\u306e\u30d1\u30fc\u30b9\u8a66\u884c\n(defn try-parse-formats [input-str]\n  (match (json/parse input-str)\n    {:error _} -&gt; (yaml/parse input-str)\n    data -&gt; data))\n</code></pre>"},{"location":"ja/spec/12-stdlib-json/#_10","title":"\u578b\u30de\u30c3\u30d4\u30f3\u30b0","text":""},{"location":"ja/spec/12-stdlib-json/#qi-jsonyaml","title":"Qi \u2192 JSON/YAML","text":"Qi\u578b JSON YAML <code>nil</code> <code>null</code> <code>null</code> <code>true/false</code> <code>true/false</code> <code>true/false</code> \u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570 \u6570\u5024 \u6570\u5024 \u6587\u5b57\u5217 \u6587\u5b57\u5217 \u6587\u5b57\u5217 \u30d9\u30af\u30bf\u30fc\u30fb\u30ea\u30b9\u30c8 \u914d\u5217 \u30ea\u30b9\u30c8 \u30de\u30c3\u30d7 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8 \u30de\u30c3\u30d7 \u30ad\u30fc\u30ef\u30fc\u30c9 \u6587\u5b57\u5217 \u6587\u5b57\u5217"},{"location":"ja/spec/12-stdlib-json/#jsonyaml-qi","title":"JSON/YAML \u2192 Qi","text":"JSON/YAML Qi\u578b <code>null</code> <code>nil</code> <code>true/false</code> <code>true/false</code> \u6570\u5024 \u6574\u6570 or \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570 \u6587\u5b57\u5217 \u6587\u5b57\u5217 \u914d\u5217 \u30d9\u30af\u30bf\u30fc \u30aa\u30d6\u30b8\u30a7\u30af\u30c8/\u30de\u30c3\u30d7 \u30de\u30c3\u30d7"},{"location":"ja/spec/13-stdlib-io/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30d5\u30a1\u30a4\u30ebI/O","text":"<p>\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c\u3068\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u5bfe\u5fdc</p>"},{"location":"ja/spec/13-stdlib-io/#io","title":"\u57fa\u672cI/O","text":""},{"location":"ja/spec/13-stdlib-io/#_1","title":"\u51fa\u529b","text":"<pre><code>;; print - \u6a19\u6e96\u51fa\u529b\uff08\u6539\u884c\u306a\u3057\uff09\n(print \"Hello\")                     ;; Hello\uff08\u6539\u884c\u306a\u3057\uff09\n\n;; println - \u6a19\u6e96\u51fa\u529b\uff08\u6539\u884c\u3042\u308a\uff09\n(println \"Hello\")                   ;; Hello\\n\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_2","title":"\u6a19\u6e96\u5165\u529b","text":"<pre><code>;; io/stdin-line - \u6a19\u6e96\u5165\u529b\u304b\u30891\u884c\u8aad\u3080\uff08EOF\u6642\u306fnil\uff09\n(io/stdin-line)                     ;; =&gt; \"user input\"\n(io/stdin-line)                     ;; =&gt; nil\uff08EOF\uff09\n\n;; \u4f7f\u7528\u4f8b: 1\u884c\u305a\u3064\u51e6\u7406\n(defn process []\n  (let [line (io/stdin-line)]\n    (if (some? line)\n      (do\n        (line |&gt; str/trim |&gt; str/upper |&gt; println)\n        (process))\n      nil)))\n\n(process)\n\n;; io/stdin-lines - \u6a19\u6e96\u5165\u529b\u304b\u3089\u5168\u884c\u8aad\u3080\uff08\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406\u5411\u304d\uff09\n(io/stdin-lines)                    ;; =&gt; [\"line1\" \"line2\" \"line3\"]\n\n;; \u4f7f\u7528\u4f8b: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406\uff08\u6700\u3082Qi\u3089\u3057\u3044\u66f8\u304d\u65b9\uff09\n(io/stdin-lines\n |&gt; (map str/trim)\n |&gt; (filter (fn [s] (not (str/empty? s))))\n |&gt; (map str/upper)\n |&gt; (map println))\n\n;; Unix\u30d1\u30a4\u30d7\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\n;; $ cat data.txt | qi process.qi\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_3","title":"\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f","text":"<pre><code>;; io/read-file - \u30d5\u30a1\u30a4\u30eb\u5168\u4f53\u3092\u8aad\u307f\u8fbc\u307f\n(io/read-file \"data.txt\")           ;; =&gt; \"file content...\"\n\n;; io/read-lines - \u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u307f\uff08\u30e1\u30e2\u30ea\u52b9\u7387\u7684\uff09\n(io/read-lines \"data.txt\")          ;; =&gt; [\"line1\" \"line2\" \"line3\"]\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_4","title":"\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u8fbc\u307f","text":"<pre><code>;; io/write-file - \u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u307f\uff08\u4e0a\u66f8\u304d\uff09\n(io/write-file \"Hello, Qi!\" \"/tmp/test.txt\")\n\n;; io/append-file - \u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u8a18\n(io/append-file \"\\nSecond line\" \"/tmp/test.txt\")\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_5","title":"\u30d5\u30a1\u30a4\u30eb\u78ba\u8a8d","text":"<pre><code>;; io/file-exists? - \u30d5\u30a1\u30a4\u30eb\u306e\u5b58\u5728\u78ba\u8a8d\n(io/file-exists? \"/tmp/test.txt\")   ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_6","title":"\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u5bfe\u5fdc","text":""},{"location":"ja/spec/13-stdlib-io/#unicode","title":"Unicode","text":"<pre><code>;; :utf-8 (\u30c7\u30d5\u30a9\u30eb\u30c8\u3001BOM\u81ea\u52d5\u9664\u53bb)\n(io/read-file \"data.txt\")\n\n;; :utf-8-bom (BOM\u4ed8\u304dUTF-8\u3001Excel\u5bfe\u5fdc)\n(io/write-file data \"excel.csv\" :encoding :utf-8-bom)\n\n;; :utf-16le (UTF-16LE\u3001BOM\u4ed8\u304d\u3001Excel\u591a\u8a00\u8a9e\u5bfe\u5fdc)\n(io/write-file data \"multilang_excel.csv\" :encoding :utf-16le)\n\n;; :utf-16be (UTF-16BE\u3001BOM\u4ed8\u304d)\n(io/write-file data \"data.txt\" :encoding :utf-16be)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_7","title":"\u65e5\u672c\u8a9e","text":"<pre><code>;; :sjis / :shift-jis (Shift_JIS/Windows-31J\u3001\u65e5\u672cWindows/Excel)\n(io/read-file \"legacy.csv\" :encoding :sjis)\n(io/write-file data \"for_excel.csv\" :encoding :sjis)\n\n;; :euc-jp (EUC-JP\u3001Unix\u7cfb)\n(io/read-file \"unix_text.txt\" :encoding :euc-jp)\n\n;; :iso-2022-jp (JIS\u3001\u30e1\u30fc\u30eb)\n(io/read-file \"mail.txt\" :encoding :iso-2022-jp)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_8","title":"\u4e2d\u56fd\u8a9e","text":"<pre><code>;; :gbk (GBK\u3001\u4e2d\u56fd\u672c\u571f\u30fb\u30b7\u30f3\u30ac\u30dd\u30fc\u30eb\u3001\u7c21\u4f53\u5b57Windows/Excel)\n(io/write-file data \"china_excel.csv\" :encoding :gbk)\n\n;; :gb18030 (GB18030\u3001\u4e2d\u56fd\u56fd\u5bb6\u898f\u683c\u3001GBK\u4e0a\u4f4d\u4e92\u63db)\n(io/write-file data \"china_official.txt\" :encoding :gb18030)\n\n;; :big5 (Big5\u3001\u53f0\u6e7e\u30fb\u9999\u6e2f\u3001\u7e41\u4f53\u5b57Windows/Excel)\n(io/write-file data \"taiwan_excel.csv\" :encoding :big5)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_9","title":"\u97d3\u56fd\u8a9e","text":"<pre><code>;; :euc-kr (EUC-KR\u3001\u97d3\u56fdWindows/Excel)\n(io/write-file data \"korea_excel.csv\" :encoding :euc-kr)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_10","title":"\u6b27\u5dde","text":"<pre><code>;; :windows-1252 / :cp1252 / :latin1 (\u897f\u6b27\u3001\u7c73\u56fdWindows/Excel)\n(io/write-file data \"europe_excel.csv\" :encoding :windows-1252)\n\n;; :windows-1251 / :cp1251 (\u30ed\u30b7\u30a2\u30fb\u30ad\u30ea\u30eb\u6587\u5b57\u570fWindows/Excel)\n(io/write-file data \"russia_excel.csv\" :encoding :windows-1251)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_11","title":"\u81ea\u52d5\u691c\u51fa","text":"<pre><code>;; :auto (BOM\u691c\u51fa \u2192 UTF-8 \u2192 \u5404\u5730\u57df\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u9806\u6b21\u8a66\u884c)\n(io/read-file \"unknown.txt\" :encoding :auto)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_12","title":"\u66f8\u304d\u8fbc\u307f\u30aa\u30d7\u30b7\u30e7\u30f3","text":""},{"location":"ja/spec/13-stdlib-io/#_13","title":"\u30d5\u30a1\u30a4\u30eb\u5b58\u5728\u6642\u306e\u52d5\u4f5c","text":"<pre><code>;; :if-exists \u30aa\u30d7\u30b7\u30e7\u30f3\n(io/write-file data \"out.txt\" :if-exists :error)      ;; \u5b58\u5728\u3057\u305f\u3089\u30a8\u30e9\u30fc\n(io/write-file data \"out.txt\" :if-exists :skip)       ;; \u5b58\u5728\u3057\u305f\u3089\u30b9\u30ad\u30c3\u30d7\n(io/write-file data \"out.txt\" :if-exists :append)     ;; \u8ffd\u8a18\n(io/write-file data \"out.txt\" :if-exists :overwrite)  ;; \u4e0a\u66f8\u304d\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_14","title":"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u81ea\u52d5\u4f5c\u6210","text":"<pre><code>;; :create-dirs \u30aa\u30d7\u30b7\u30e7\u30f3\n(io/write-file data \"path/to/out.txt\" :create-dirs true)\n\n;; \u8907\u6570\u30aa\u30d7\u30b7\u30e7\u30f3\u7d44\u307f\u5408\u308f\u305b\n(io/write-file data \"backup/data.csv\"\n               :encoding :sjis\n               :if-exists :error\n               :create-dirs true)\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_15","title":"\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u64cd\u4f5c","text":""},{"location":"ja/spec/13-stdlib-io/#_16","title":"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e00\u89a7","text":"<pre><code>;; io/list-dir - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e00\u89a7\u53d6\u5f97\n(io/list-dir \".\")                                ;; \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(io/list-dir \"logs\" :pattern \"*.log\")            ;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u307f\n(io/list-dir \"src\" :pattern \"*.rs\" :recursive true)  ;; \u518d\u5e30\u7684\u306b\u691c\u7d22\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_17","title":"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u64cd\u4f5c","text":"<pre><code>;; io/create-dir - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08\u89aa\u3082\u81ea\u52d5\u4f5c\u6210\uff09\n(io/create-dir \"data/backup\")\n\n;; io/delete-dir - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u524a\u9664\n(io/delete-dir \"temp\")                           ;; \u7a7a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u524a\u9664\n(io/delete-dir \"old_data\" :recursive true)       ;; \u4e2d\u8eab\u3054\u3068\u524a\u9664\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_18","title":"\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c","text":"<pre><code>;; io/copy-file - \u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc\n(io/copy-file \"data.txt\" \"data_backup.txt\")\n\n;; io/move-file - \u30d5\u30a1\u30a4\u30eb\u79fb\u52d5\u30fb\u540d\u524d\u5909\u66f4\n(io/move-file \"old.txt\" \"new.txt\")\n\n;; io/delete-file - \u30d5\u30a1\u30a4\u30eb\u524a\u9664\n(io/delete-file \"temp.txt\")\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_19","title":"\u30e1\u30bf\u30c7\u30fc\u30bf\u53d6\u5f97","text":"<pre><code>;; io/file-info - \u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u53d6\u5f97\n(def info (io/file-info \"data.txt\"))\n(get info \"size\")                                ;; \u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\n(get info \"modified\")                            ;; \u66f4\u65b0\u65e5\u6642\uff08UNIX\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff09\n(get info \"is-dir\")                              ;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\n(get info \"is-file\")                             ;; \u30d5\u30a1\u30a4\u30eb\u304b\n\n;; \u5224\u5b9a\u95a2\u6570\n(io/is-file? \"data.txt\")                         ;; true\n(io/is-dir? \"data\")                              ;; true\n(io/file-exists? \"config.json\")                  ;; true/false\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_20","title":"\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea","text":""},{"location":"ja/spec/13-stdlib-io/#_21","title":"\u81ea\u52d5\u524a\u9664\uff08\u63a8\u5968\uff09","text":"<pre><code>;; io/temp-file - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\uff08\u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306b\u81ea\u52d5\u524a\u9664\uff09\n(let [tmp (io/temp-file)]\n  (io/write-file \"temporary data\" tmp)\n  (process-file tmp))\n;; \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306btmp\u306f\u81ea\u52d5\u7684\u306b\u524a\u9664\u3055\u308c\u308b\n\n;; io/temp-dir - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08\u81ea\u52d5\u524a\u9664\uff09\n(let [tmpdir (io/temp-dir)]\n  (io/write-file \"data1\" (path/join tmpdir \"file1.txt\"))\n  (io/write-file \"data2\" (path/join tmpdir \"file2.txt\"))\n  (process-directory tmpdir))\n;; \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306btmpdir\u3068\u4e2d\u8eab\u306f\u81ea\u52d5\u7684\u306b\u524a\u9664\u3055\u308c\u308b\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#keep","title":"\u624b\u52d5\u524a\u9664\uff08keep\u7248\uff09","text":"<pre><code>;; io/temp-file-keep - \u6c38\u7d9a\u7684\u306a\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n(let [tmp (io/temp-file-keep)]\n  (io/write-file \"persistent data\" tmp)\n  (println f\"Created: {tmp}\")\n  tmp)\n;; =&gt; \"/tmp/.tmpXXXXXX\" \uff08\u524a\u9664\u3055\u308c\u306a\u3044\u3001\u624b\u52d5\u3067\u524a\u9664\u304c\u5fc5\u8981\uff09\n\n;; io/temp-dir-keep - \u6c38\u7d9a\u7684\u306a\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\n(let [tmpdir (io/temp-dir-keep)]\n  (io/create-dir (path/join tmpdir \"subdir\"))\n  tmpdir)\n;; =&gt; \"/tmp/.tmpXXXXXX\" \uff08\u524a\u9664\u3055\u308c\u306a\u3044\uff09\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_22","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/13-stdlib-io/#csv","title":"CSV\u30d5\u30a1\u30a4\u30eb\u51e6\u7406","text":"<pre><code>;; CSV\u3092\u8aad\u307f\u8fbc\u3093\u3067\u51e6\u7406\n(io/read-file \"data.csv\")\n  |&gt; (fn [content] (split content \"\\n\"))\n  |&gt; (map (fn [line] (split line \",\")))\n  |&gt; (filter (fn [row] (&gt; (len row) 2)))\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_23","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u4e26\u5217\u51e6\u7406\n(\"logs\"\n |&gt; (io/list-dir :pattern \"*.log\")\n |&gt; (map io/read-file)\n |&gt; (map process-log)\n |&gt; (reduce merge))\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_24","title":"\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u5909\u63db","text":"<pre><code>;; Shift_JIS \u2192 UTF-8\u5909\u63db\n(io/read-file \"legacy.csv\" :encoding :sjis)\n |&gt; csv/parse\n |&gt; (map transform)\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"modern_utf8.csv\"))\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#excel","title":"\u5404\u56fd\u306eExcel\u5bfe\u5fdc","text":"<pre><code>;; \u65e5\u672c: Excel\u7528CSV\uff08Shift_JIS\uff09\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"japan_excel.csv\" :encoding :sjis)))\n\n;; \u4e2d\u56fd\uff08\u7c21\u4f53\u5b57\uff09: Excel\u7528CSV\uff08GBK\uff09\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"china_excel.csv\" :encoding :gbk)))\n\n;; \u53f0\u6e7e\u30fb\u9999\u6e2f\uff08\u7e41\u4f53\u5b57\uff09: Excel\u7528CSV\uff08Big5\uff09\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"taiwan_excel.csv\" :encoding :big5)))\n\n;; \u591a\u8a00\u8a9e\u6df7\u5728: UTF-16LE\uff08Excel\u63a8\u5968\u3001BOM\u4ed8\u304d\uff09\n(data\n |&gt; csv/stringify\n |&gt; (fn [s] (io/write-file s \"multilang_excel.csv\" :encoding :utf-16le)))\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_25","title":"\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3067\u306e\u30c7\u30fc\u30bf\u51e6\u7406","text":"<pre><code>;; \u5927\u304d\u306a\u30c7\u30fc\u30bf\u3092\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3067\u51e6\u7406\n(defn process-large-data [url]\n  (let [tmp (io/temp-file)]\n    ;; \u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\n    (http/get url :output tmp)\n    ;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u51e6\u7406\n    (let [result (process-file tmp)]\n      ;; \u95a2\u6570\u7d42\u4e86\u5f8c\u3001tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      result)))\n\n;; \u8907\u6570\u306e\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\n(defn merge-files [files output]\n  (let [tmpdir (io/temp-dir)\n        processed (files\n                   |&gt; (map (fn [f]\n                         (let [tmp (path/join tmpdir (path/basename f))]\n                           (io/copy-file f tmp)\n                           (process-file tmp)\n                           tmp))))]\n    ;; \u51e6\u7406\u6e08\u307f\u30d5\u30a1\u30a4\u30eb\u3092\u30de\u30fc\u30b8\n    (merge-all processed output)\n    ;; \u95a2\u6570\u7d42\u4e86\u5f8c\u3001tmpdir\u3068\u4e2d\u8eab\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    output))\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_26","title":"\u5b89\u5168\u306a\u66f8\u304d\u8fbc\u307f","text":"<pre><code>;; \u65e2\u5b58\u30d5\u30a1\u30a4\u30eb\u4fdd\u8b77\n(io/write-file data \"important.txt\"\n               :if-exists :error\n               :create-dirs true)\n\n;; \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u4e0d\u660e\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406\n(io/read-file \"unknown.txt\" :encoding :auto)\n |&gt; process\n |&gt; (fn [s] (io/write-file s \"output.txt\" :encoding :utf-8-bom))\n</code></pre>"},{"location":"ja/spec/13-stdlib-io/#_27","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/13-stdlib-io/#io_1","title":"\u30d5\u30a1\u30a4\u30ebI/O","text":"<ul> <li><code>io/read-file</code> - \u30d5\u30a1\u30a4\u30eb\u5168\u4f53\u3092\u8aad\u307f\u8fbc\u307f</li> <li><code>io/read-lines</code> - \u884c\u3054\u3068\u8aad\u307f\u8fbc\u307f</li> <li><code>io/write-file</code> - \u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u307f\uff08\u4e0a\u66f8\u304d\uff09</li> <li><code>io/append-file</code> - \u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u8a18</li> </ul>"},{"location":"ja/spec/13-stdlib-io/#_28","title":"\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u64cd\u4f5c","text":"<ul> <li><code>io/list-dir</code> - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e00\u89a7\u53d6\u5f97\uff08\u30b0\u30ed\u30d6\u30d1\u30bf\u30fc\u30f3\u5bfe\u5fdc\uff09</li> <li><code>io/create-dir</code> - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210</li> <li><code>io/delete-file</code> - \u30d5\u30a1\u30a4\u30eb\u524a\u9664</li> <li><code>io/delete-dir</code> - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u524a\u9664</li> <li><code>io/copy-file</code> - \u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc</li> <li><code>io/move-file</code> - \u30d5\u30a1\u30a4\u30eb\u79fb\u52d5\u30fb\u540d\u524d\u5909\u66f4</li> </ul>"},{"location":"ja/spec/13-stdlib-io/#_29","title":"\u30e1\u30bf\u30c7\u30fc\u30bf","text":"<ul> <li><code>io/file-info</code> - \u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u53d6\u5f97</li> <li><code>io/file-exists?</code> - \u30d5\u30a1\u30a4\u30eb\u5b58\u5728\u78ba\u8a8d</li> <li><code>io/is-file?</code> - \u30d5\u30a1\u30a4\u30eb\u5224\u5b9a</li> <li><code>io/is-dir?</code> - \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5224\u5b9a</li> </ul>"},{"location":"ja/spec/13-stdlib-io/#_30","title":"\u4e00\u6642\u30d5\u30a1\u30a4\u30eb","text":"<ul> <li><code>io/temp-file</code> - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\uff08\u81ea\u52d5\u524a\u9664\uff09</li> <li><code>io/temp-file-keep</code> - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\uff08\u524a\u9664\u3057\u306a\u3044\uff09</li> <li><code>io/temp-dir</code> - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08\u81ea\u52d5\u524a\u9664\uff09</li> <li><code>io/temp-dir-keep</code> - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08\u524a\u9664\u3057\u306a\u3044\uff09</li> </ul>"},{"location":"ja/spec/14-stdlib-test/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af","text":"<p>\u30b7\u30f3\u30d7\u30eb\u3067\u4f7f\u3044\u3084\u3059\u3044\u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af</p>"},{"location":"ja/spec/14-stdlib-test/#_1","title":"\u6982\u8981","text":"<p>Qi\u306e\u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u3055\u3068\u899a\u3048\u3084\u3059\u3055\u3092\u91cd\u8996\u3057\u305f\u8a2d\u8a08\u3067\u3059\u3002</p> <p>\u7279\u5fb4: - \u30bc\u30ed\u30b3\u30f3\u30d5\u30a3\u30b0\uff08\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4e0d\u8981\uff09 - \u81ea\u52d5\u691c\u51fa\uff08<code>tests/</code>\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u63a2\u7d22\uff09 - Rust/Go\u98a8\u306e\u30b7\u30f3\u30d7\u30eb\u306a\u51fa\u529b - \u7279\u5225\u306a\u69cb\u6587\u306a\u3057\uff08\u901a\u5e38\u306e\u95a2\u6570\u547c\u3073\u51fa\u3057\uff09</p>"},{"location":"ja/spec/14-stdlib-test/#_2","title":"\u30c6\u30b9\u30c8\u5b9f\u884c\u95a2\u6570","text":""},{"location":"ja/spec/14-stdlib-test/#testrun","title":"test/run","text":"<p>\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u8a18\u9332\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/run test-name test-fn)\n</code></pre></p> <p>\u5f15\u6570: - <code>test-name</code> (\u6587\u5b57\u5217): \u30c6\u30b9\u30c8\u306e\u540d\u524d - <code>test-fn</code> (\u95a2\u6570): \u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u95a2\u6570\uff08\u5f15\u6570\u306a\u3057\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code>: \u30c6\u30b9\u30c8\u6210\u529f - <code>false</code>: \u30c6\u30b9\u30c8\u5931\u6557\uff08\u30a8\u30e9\u30fc\u304c\u767a\u751f\uff09</p> <p>\u4f8b: <pre><code>(test/run \"addition\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq 0 (+ 0 0))))\n\n(test/run \"list operations\" (fn []\n  (test/assert-eq 3 (len [1 2 3]))\n  (test/assert-eq 1 (first [1 2 3]))))\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#testrun-all","title":"test/run-all","text":"<p>\u8a18\u9332\u3055\u308c\u305f\u3059\u3079\u3066\u306e\u30c6\u30b9\u30c8\u7d50\u679c\u3092\u8868\u793a\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/run-all)\n</code></pre></p> <p>\u623b\u308a\u5024: - \u6210\u529f\u3057\u305f\u30c6\u30b9\u30c8\u306e\u6570\uff08\u6574\u6570\uff09 - \u5931\u6557\u3057\u305f\u30c6\u30b9\u30c8\u304c\u3042\u308b\u5834\u5408\u306f\u30a8\u30e9\u30fc</p> <p>\u51fa\u529b\u4f8b: <pre><code>\u30c6\u30b9\u30c8\u7d50\u679c:\n===========\n  \u2713 addition\n  \u2713 list operations\n  \u2717 division by zero\n    \u671f\u5f85\u5024: {:error ...}\n    \u5b9f\u969b\u5024: 42\n\n3 \u30c6\u30b9\u30c8, 2 \u6210\u529f, 1 \u5931\u6557\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#testclear","title":"test/clear","text":"<p>\u30c6\u30b9\u30c8\u7d50\u679c\u3092\u30af\u30ea\u30a2\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/clear)\n</code></pre></p> <p>\u623b\u308a\u5024: - <code>nil</code></p> <p>\u4f7f\u7528\u4f8b: <pre><code>(test/clear)  ;; \u30c6\u30b9\u30c8\u7d50\u679c\u3092\u30ea\u30bb\u30c3\u30c8\n;; \u65b0\u3057\u3044\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#_3","title":"\u30a2\u30b5\u30fc\u30b7\u30e7\u30f3\u95a2\u6570","text":""},{"location":"ja/spec/14-stdlib-test/#testassert-eq","title":"test/assert-eq","text":"<p>2\u3064\u306e\u5024\u304c\u7b49\u3057\u3044\u3053\u3068\u3092\u30a2\u30b5\u30fc\u30c8\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/assert-eq expected actual)\n</code></pre></p> <p>\u5f15\u6570: - <code>expected</code>: \u671f\u5f85\u5024 - <code>actual</code>: \u5b9f\u969b\u306e\u5024</p> <p>\u6210\u529f\u6761\u4ef6: - <code>expected</code> \u3068 <code>actual</code> \u304c\u7b49\u3057\u3044\uff08<code>=</code>\u3067\u6bd4\u8f03\uff09</p> <p>\u4f8b: <pre><code>(test/run \"equality tests\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq \"HELLO\" (str/upper \"hello\"))\n  (test/assert-eq [1 2 3] (map inc [0 1 2]))))\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#testassert","title":"test/assert","text":"<p>\u5024\u304c\u771f\u3067\u3042\u308b\u3053\u3068\u3092\u30a2\u30b5\u30fc\u30c8\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/assert value)\n</code></pre></p> <p>\u5f15\u6570: - <code>value</code>: \u30c1\u30a7\u30c3\u30af\u3059\u308b\u5024</p> <p>\u6210\u529f\u6761\u4ef6: - <code>value</code> \u304c\u771f\uff08<code>nil</code>\u3068<code>false</code>\u4ee5\u5916\uff09</p> <p>\u4f8b: <pre><code>(test/run \"truthy tests\" (fn []\n  (test/assert (&gt; 5 3))\n  (test/assert (even? 4))\n  (test/assert (some? [1 2 3]))          ;; \u30d9\u30af\u30bf\u306fnil\u3067\u306a\u3044\n  (test/assert (list/some? even? [2 4 6]))))\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#testassert-not","title":"test/assert-not","text":"<p>\u5024\u304c\u507d\u3067\u3042\u308b\u3053\u3068\u3092\u30a2\u30b5\u30fc\u30c8\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/assert-not value)\n</code></pre></p> <p>\u5f15\u6570: - <code>value</code>: \u30c1\u30a7\u30c3\u30af\u3059\u308b\u5024</p> <p>\u6210\u529f\u6761\u4ef6: - <code>value</code> \u304c\u507d\uff08<code>nil</code>\u307e\u305f\u306f<code>false</code>\uff09</p> <p>\u4f8b: <pre><code>(test/run \"falsy tests\" (fn []\n  (test/assert-not (&lt; 5 3))\n  (test/assert-not (odd? 4))\n  (test/assert-not nil)))\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#testassert-throws","title":"test/assert-throws","text":"<p>\u95a2\u6570\u304c\u4f8b\u5916\u3092\u6295\u3052\u308b\u3053\u3068\u3092\u30a2\u30b5\u30fc\u30c8\u3057\u307e\u3059\u3002</p> <p>\u69cb\u6587: <pre><code>(test/assert-throws test-fn)\n</code></pre></p> <p>\u5f15\u6570: - <code>test-fn</code> (\u95a2\u6570): \u5b9f\u884c\u3059\u308b\u95a2\u6570\uff08\u5f15\u6570\u306a\u3057\uff09</p> <p>\u6210\u529f\u6761\u4ef6: - <code>test-fn</code> \u3092\u5b9f\u884c\u3057\u305f\u3068\u304d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b</p> <p>\u4f8b: <pre><code>(test/run \"exception tests\" (fn []\n  (test/assert-throws (fn [] (/ 10 0)))\n  (test/assert-throws (fn [] (first [])))\n  (test/assert-throws (fn [] (get {} :missing)))))\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#cli","title":"CLI\u30b3\u30de\u30f3\u30c9","text":""},{"location":"ja/spec/14-stdlib-test/#qi-test","title":"qi test","text":"<p>\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <p>\u4f7f\u7528\u65b9\u6cd5: <pre><code># tests/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u3059\u3079\u3066\u306e*.qi\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\nqi test\n\n# \u7279\u5b9a\u306e\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\nqi test tests/core_test.qi\n\n# \u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5b9f\u884c\nqi test tests/core_test.qi tests/pipeline_test.qi\n</code></pre></p> <p>\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u7f6e: <pre><code>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8/\n  tests/\n    core_test.qi\n    pipeline_test.qi\n    http_test.qi\n</code></pre></p> <p>\u51fa\u529b: <pre><code>running 3 test files\n\n\u30c6\u30b9\u30c8\u7d50\u679c:\n===========\n  \u2713 addition\n  \u2713 subtraction\n  \u2713 multiplication\n  \u2713 list operations\n  \u2713 pipeline test\n\n5 \u30c6\u30b9\u30c8, 5 \u6210\u529f, 0 \u5931\u6557\n\nfinished in 0.08s\n</code></pre></p>"},{"location":"ja/spec/14-stdlib-test/#_4","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/14-stdlib-test/#_5","title":"\u57fa\u672c\u7684\u306a\u30c6\u30b9\u30c8","text":"<pre><code>;; tests/core_test.qi\n(test/run \"addition\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq 0 (+ 0 0))\n  (test/assert-eq -1 (+ 1 -2))))\n\n(test/run \"subtraction\" (fn []\n  (test/assert-eq 1 (- 3 2))\n  (test/assert-eq -5 (- 0 5))))\n\n(test/run \"multiplication\" (fn []\n  (test/assert-eq 6 (* 2 3))\n  (test/assert-eq 0 (* 5 0))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_6","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u30c6\u30b9\u30c8","text":"<pre><code>;; tests/pipeline_test.qi\n(test/run \"basic pipeline\" (fn []\n  (test/assert-eq (list 2 3 4) ([1 2 3] |&gt; (map inc)))))\n\n(test/run \"pipeline with multiple steps\" (fn []\n  (test/assert-eq 9 ([1 2 3] |&gt; (map inc) |&gt; sum))))\n\n(test/run \"filter and map\" (fn []\n  (test/assert-eq (list 3 5)\n    ([1 2 3 4 5 6] |&gt; (filter even?) |&gt; (map inc) |&gt; (take 2)))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_7","title":"\u6587\u5b57\u5217\u64cd\u4f5c\u306e\u30c6\u30b9\u30c8","text":"<pre><code>;; tests/string_test.qi\n(test/run \"string upper/lower\" (fn []\n  (test/assert-eq \"HELLO\" (str/upper \"hello\"))\n  (test/assert-eq \"world\" (str/lower \"WORLD\"))))\n\n(test/run \"string trimming\" (fn []\n  (test/assert-eq \"hello\" (str/trim \"  hello  \"))\n  (test/assert-eq \"test\" (str/trim-start \"  test\"))\n  (test/assert-eq \"test\" (str/trim-end \"test  \"))))\n\n(test/run \"string splitting\" (fn []\n  (test/assert-eq (list \"a\" \"b\" \"c\") (str/split \"a,b,c\" \",\"))\n  (test/assert-eq (list \"hello\" \"world\") (str/split \"hello world\" \" \"))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_8","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<pre><code>;; tests/error_test.qi\n(test/run \"division by zero\" (fn []\n  (test/assert-throws (fn [] (/ 10 0)))))\n\n(test/run \"empty list operations\" (fn []\n  (test/assert-throws (fn [] (first [])))\n  (test/assert-throws (fn [] (last [])))))\n\n(test/run \"map key not found\" (fn []\n  (test/assert-throws (fn [] (get {} :missing)))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#http","title":"HTTP\u306e\u30c6\u30b9\u30c8","text":"<pre><code>;; tests/http_test.qi\n(test/run \"http/get success\" (fn []\n  (def result (http/get! \"https://httpbin.org/get\"))  ;; \u8a73\u7d30\u7248\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u53d6\u5f97\n  (test/assert (map? result))\n  (test/assert-eq 200 (get result :status))))\n\n(test/run \"railway pipeline with http\" (fn []\n  (def result\n    (match (try\n             (\"https://httpbin.org/get\"\n              |&gt; http/get  ;; \u30b7\u30f3\u30d7\u30eb\u7248\uff08\u30dc\u30c7\u30a3\u306e\u307f\uff09\n              |&gt;? json/parse))\n      {:error e} -&gt; {:error e}\n      data -&gt; data))\n\n  (match result\n    {:error e} -&gt; (test/assert false)  ;; Should not reach here\n    data -&gt; (test/assert (map? data)))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_9","title":"\u30c7\u30fc\u30bf\u5909\u63db\u306e\u30c6\u30b9\u30c8","text":"<pre><code>;; tests/transform_test.qi\n(test/run \"json round-trip\" (fn []\n  (def original {\"name\" \"Alice\" \"age\" 30})\n  (def result\n    (original\n     |&gt;? json/stringify\n     |&gt;? json/parse))\n\n  (match result\n    {:error e} -&gt; (test/assert false)\n    data -&gt; (test/assert-eq original data))))\n\n(test/run \"map transformations\" (fn []\n  (def users [{:name \"Alice\" :age 30} {:name \"Bob\" :age 25}])\n  (def result (map (fn [u] (update u :age inc)) users))\n\n  (test/assert-eq 31 (get (first result) :age))\n  (test/assert-eq 26 (get (last result) :age))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_10","title":"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/spec/14-stdlib-test/#_11","title":"\u30d5\u30a1\u30a4\u30eb\u69cb\u6210","text":"<pre><code>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8/\n  src/\n    core.qi\n    utils.qi\n  tests/\n    core_test.qi      # src/core.qi\u306e\u30c6\u30b9\u30c8\n    utils_test.qi     # src/utils.qi\u306e\u30c6\u30b9\u30c8\n    integration_test.qi  # \u7d71\u5408\u30c6\u30b9\u30c8\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_12","title":"\u30c6\u30b9\u30c8\u547d\u540d","text":"<pre><code>;; \u2705 \u826f\u3044\u4f8b: \u4f55\u3092\u30c6\u30b9\u30c8\u3057\u3066\u3044\u308b\u304b\u660e\u78ba\n(test/run \"addition with positive numbers\" (fn [] ...))\n(test/run \"string upper converts to uppercase\" (fn [] ...))\n(test/run \"http/get returns 200 for valid URL\" (fn [] ...))\n\n;; \u274c \u60aa\u3044\u4f8b: \u4f55\u3092\u30c6\u30b9\u30c8\u3057\u3066\u3044\u308b\u304b\u4e0d\u660e\n(test/run \"test1\" (fn [] ...))\n(test/run \"check\" (fn [] ...))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_13","title":"\u30c6\u30b9\u30c8\u306e\u7c92\u5ea6","text":"<pre><code>;; \u2705 \u826f\u3044\u4f8b: 1\u3064\u306e\u30c6\u30b9\u30c8\u30671\u3064\u306e\u6a5f\u80fd\u3092\u30c6\u30b9\u30c8\n(test/run \"addition\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq 0 (+ 0 0))))\n\n(test/run \"subtraction\" (fn []\n  (test/assert-eq 1 (- 3 2))))\n\n;; \u274c \u60aa\u3044\u4f8b: 1\u3064\u306e\u30c6\u30b9\u30c8\u3067\u8907\u6570\u306e\u7121\u95a2\u4fc2\u306a\u6a5f\u80fd\u3092\u30c6\u30b9\u30c8\n(test/run \"math\" (fn []\n  (test/assert-eq 3 (+ 1 2))\n  (test/assert-eq \"HELLO\" (str/upper \"hello\"))\n  (test/assert-eq [1 2] (take 2 [1 2 3]))))\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_14","title":"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8","text":"<pre><code>;; \u30a2\u30b5\u30fc\u30b7\u30e7\u30f3\u304c\u5931\u6557\u3057\u305f\u5834\u5408\u3001\u308f\u304b\u308a\u3084\u3059\u3044\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\n(test/run \"example\" (fn []\n  (test/assert-eq 5 (+ 2 2))))\n\n;; \u51fa\u529b:\n;;   \u2717 example\n;;     \u30a2\u30b5\u30fc\u30b7\u30e7\u30f3\u5931\u6557:\n;;   \u671f\u5f85\u5024: 5\n;;   \u5b9f\u969b\u5024: 4\n</code></pre>"},{"location":"ja/spec/14-stdlib-test/#_15","title":"\u5b9f\u884c\u30d5\u30ed\u30fc","text":"<ol> <li>\u30c6\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u691c\u51fa: <code>qi test</code>\u306f<code>tests/</code>\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e<code>*.qi</code>\u30d5\u30a1\u30a4\u30eb\u3092\u691c\u7d22</li> <li>\u30c6\u30b9\u30c8\u5b9f\u884c: \u5404\u30d5\u30a1\u30a4\u30eb\u3092\u9806\u6b21\u30ed\u30fc\u30c9\u30fb\u5b9f\u884c</li> <li>\u7d50\u679c\u53ce\u96c6: <code>test/run</code>\u304c\u547c\u3070\u308c\u308b\u305f\u3073\u306b\u7d50\u679c\u3092\u8a18\u9332</li> <li>\u30ec\u30dd\u30fc\u30c8\u8868\u793a: <code>test/run-all</code>\u3067\u5168\u7d50\u679c\u3092\u8868\u793a</li> <li>\u7d42\u4e86\u30b3\u30fc\u30c9:</li> <li>\u3059\u3079\u3066\u6210\u529f: \u7d42\u4e86\u30b3\u30fc\u30c90</li> <li>1\u3064\u3067\u3082\u5931\u6557: \u7d42\u4e86\u30b3\u30fc\u30c91</li> </ol>"},{"location":"ja/spec/14-stdlib-test/#_16","title":"\u5236\u9650\u4e8b\u9805","text":"<p>\u73fe\u5728\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u672a\u5b9f\u88c5: - \u30ab\u30d0\u30ec\u30c3\u30b8\u8a08\u6e2c - \u30c6\u30b9\u30c8\u306e\u30bf\u30b0\u4ed8\u3051\u30fb\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 - <code>--watch</code>\u30e2\u30fc\u30c9\uff08\u30d5\u30a1\u30a4\u30eb\u5909\u66f4\u6642\u306e\u81ea\u52d5\u518d\u5b9f\u884c\uff09 - \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7/\u30c6\u30a3\u30a2\u30c0\u30a6\u30f3\uff08<code>before</code>/<code>after</code>\uff09 - \u30c6\u30b9\u30c8\u306e\u4e26\u5217\u5b9f\u884c</p> <p>\u3053\u308c\u3089\u306e\u6a5f\u80fd\u306f\u5c06\u6765\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u691c\u8a0e\u3055\u308c\u307e\u3059\u304c\u3001\u57fa\u672c\u7684\u306a\u30c6\u30b9\u30c8\u306b\u306f\u73fe\u5728\u306e\u6a5f\u80fd\u3067\u5341\u5206\u3067\u3059\u3002</p>"},{"location":"ja/spec/14-stdlib-test/#_17","title":"\u8a2d\u8a08\u601d\u60f3","text":"<p>Qi\u306e\u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u3055\u3092\u6700\u512a\u5148\u306b\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ol> <li>\u30bc\u30ed\u30b3\u30f3\u30d5\u30a3\u30b0: \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4e0d\u8981\u3002<code>tests/</code>\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u7f6e\u304f\u3060\u3051</li> <li>\u7279\u5225\u306a\u69cb\u6587\u306a\u3057: \u901a\u5e38\u306e\u95a2\u6570\u547c\u3073\u51fa\u3057\u3067\u30c6\u30b9\u30c8\u3092\u8a18\u8ff0</li> <li>\u6700\u5c0f\u9650\u306eAPI: \u899a\u3048\u308b\u3079\u304d\u95a2\u6570\u306f5\u3064\u3060\u3051</li> <li>\u660e\u78ba\u306a\u51fa\u529b: Rust/Go\u98a8\u306e\u30b7\u30f3\u30d7\u30eb\u3067\u8aad\u307f\u3084\u3059\u3044\u51fa\u529b</li> </ol> <p>\u8907\u96d1\u306a\u6a5f\u80fd\u306f\u5f8c\u56de\u3057\u3002\u307e\u305a\u306f\u57fa\u672c\u7684\u306a\u30c6\u30b9\u30c8\u304c\u66f8\u3051\u308b\u3053\u3068\u304c\u91cd\u8981\u3067\u3059\u3002</p>"},{"location":"ja/spec/15-stdlib-math/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\uff1a\u6570\u5b66\u95a2\u6570","text":"<p>\u6570\u5024\u6f14\u7b97\u30fb\u6570\u5b66\u95a2\u6570</p>"},{"location":"ja/spec/15-stdlib-math/#_2","title":"\u57fa\u672c\u6f14\u7b97","text":"<p>Qi\u306f\u57fa\u672c\u7684\u306a\u7b97\u8853\u6f14\u7b97\u5b50\uff08<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>\uff09\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002 \u3059\u3079\u3066\u306e\u6f14\u7b97\u5b50\u306f\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u306e\u4e21\u65b9\u306b\u5bfe\u5fdc\u3057\u3001\u6d6e\u52d5\u5c0f\u6570\u304c1\u3064\u3067\u3082\u542b\u307e\u308c\u308b\u5834\u5408\u306f\u6d6e\u52d5\u5c0f\u6570\u3067\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>(+ 1 2 3)        ;; =&gt; 6\n(+ 1.5 2 3)      ;; =&gt; 6.5\uff08\u6d6e\u52d5\u5c0f\u6570\u3092\u542b\u3080\uff09\n(- 10 3)         ;; =&gt; 7\n(* 2 3 4)        ;; =&gt; 24\n(/ 10 2)         ;; =&gt; 5\n(% 10 3)         ;; =&gt; 1\uff08\u5270\u4f59\uff09\n(% 10.5 3)       ;; =&gt; 1.5\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_3","title":"\u4fbf\u5229\u306a\u6570\u5024\u95a2\u6570","text":"<pre><code>;; min - \u6700\u5c0f\u5024\n(min 1 2 3)          ;; =&gt; 1\n(min 1.5 2 3)        ;; =&gt; 1.5\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n\n;; max - \u6700\u5927\u5024\n(max 1 2 3)          ;; =&gt; 3\n(max 1.5 2 3)        ;; =&gt; 3\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n\n;; sum - \u5408\u8a08\uff08\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u8981\u7d20\u3092\u5408\u8a08\uff09\n(sum [1 2 3])        ;; =&gt; 6\n(sum [1.5 2 3])      ;; =&gt; 6.5\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n\n;; inc - \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff081\u3092\u52a0\u7b97\uff09\n(inc 5)              ;; =&gt; 6\n(inc 5.5)            ;; =&gt; 6.5\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n\n;; dec - \u30c7\u30af\u30ea\u30e1\u30f3\u30c8\uff081\u3092\u6e1b\u7b97\uff09\n(dec 5)              ;; =&gt; 4\n(dec 5.5)            ;; =&gt; 4.5\uff08\u6d6e\u52d5\u5c0f\u6570\u306b\u3082\u5bfe\u5fdc\uff09\n\n;; abs - \u7d76\u5bfe\u5024\n(abs -5)             ;; =&gt; 5\n(abs -5.5)           ;; =&gt; 5.5\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_4","title":"\u6570\u5b66\u95a2\u6570","text":""},{"location":"ja/spec/15-stdlib-math/#_5","title":"\u3079\u304d\u4e57\u30fb\u5e73\u65b9\u6839","text":"<pre><code>;; math/pow - \u3079\u304d\u4e57\n(math/pow 2 3)      ;; =&gt; 8 (2^3)\n(math/pow 10 2)     ;; =&gt; 100\n(math/pow 2 -1)     ;; =&gt; 0.5\n\n;; math/sqrt - \u5e73\u65b9\u6839\n(math/sqrt 4)       ;; =&gt; 2.0\n(math/sqrt 9)       ;; =&gt; 3.0\n(math/sqrt 2)       ;; =&gt; 1.4142135623730951\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_6","title":"\u4e38\u3081","text":"<pre><code>;; math/round - \u56db\u6368\u4e94\u5165\n(math/round 3.4)    ;; =&gt; 3\n(math/round 3.5)    ;; =&gt; 4\n(math/round -3.5)   ;; =&gt; -4\n\n;; math/floor - \u5207\u308a\u6368\u3066\uff08\u8ca0\u306e\u7121\u9650\u5927\u65b9\u5411\uff09\n(math/floor 3.9)    ;; =&gt; 3\n(math/floor -3.1)   ;; =&gt; -4\n\n;; math/ceil - \u5207\u308a\u4e0a\u3052\uff08\u6b63\u306e\u7121\u9650\u5927\u65b9\u5411\uff09\n(math/ceil 3.1)     ;; =&gt; 4\n(math/ceil -3.9)    ;; =&gt; -3\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_7","title":"\u7bc4\u56f2\u5236\u9650","text":"<pre><code>;; math/clamp - \u5024\u3092\u7bc4\u56f2\u5185\u306b\u5236\u9650\n(math/clamp 5 0 10)     ;; =&gt; 5 (\u7bc4\u56f2\u5185)\n(math/clamp -5 0 10)    ;; =&gt; 0 (\u6700\u5c0f\u5024)\n(math/clamp 15 0 10)    ;; =&gt; 10 (\u6700\u5927\u5024)\n(math/clamp -7 -10 -5)  ;; =&gt; -7 (\u8ca0\u306e\u7bc4\u56f2)\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#feature-std-math","title":"\u4e71\u6570\u751f\u6210\uff08Feature: std-math\uff09","text":"<p>\u4e71\u6570\u95a2\u9023\u306e\u95a2\u6570\u306f<code>std-math</code> feature\u304c\u6709\u52b9\u306a\u5834\u5408\u306b\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002</p> <pre><code>;; math/rand - 0.0\u4ee5\u4e0a1.0\u672a\u6e80\u306e\u4e71\u6570\n(math/rand)              ;; =&gt; 0.7234...\n\n;; math/rand-int - \u6574\u6570\u306e\u4e71\u6570\uff080\u4ee5\u4e0an\u672a\u6e80\uff09\n(math/rand-int 10)       ;; =&gt; 0-9\u306e\u6574\u6570\n\n;; math/random-range - \u7bc4\u56f2\u6307\u5b9a\u306e\u4e71\u6570\n(math/random-range 10 20)  ;; =&gt; 10-20\u306e\u6574\u6570\n\n;; math/shuffle - \u30ea\u30b9\u30c8\u3092\u30b7\u30e3\u30c3\u30d5\u30eb\n(math/shuffle [1 2 3 4 5])  ;; =&gt; [3 1 5 2 4] (\u30e9\u30f3\u30c0\u30e0)\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_8","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528","text":"<p>\u6570\u5b66\u95a2\u6570\u306f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u5024\u306e\u7bc4\u56f2\u5236\u9650\u3068\u4e38\u3081\n(16.5 |&gt; math/sqrt |&gt; math/round)\n;; =&gt; 4\n\n;; \u9023\u7d9a\u8a08\u7b97\n(2 |&gt; (math/pow _ 3) |&gt; (math/clamp _ 0 10))\n;; =&gt; 8\n\n;; \u30c7\u30fc\u30bf\u51e6\u7406\n(map (fn [x] (x |&gt; math/sqrt |&gt; math/round)) [4 9 16 25])\n;; =&gt; (2 3 4 5)\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_9","title":"\u4f7f\u7528\u4f8b","text":""},{"location":"ja/spec/15-stdlib-math/#_10","title":"\u7d71\u8a08\u8a08\u7b97","text":"<pre><code>;; \u5e73\u65b9\u6839\u306e\u5e73\u5747\uff08RMS\uff09\n(defn rms [numbers]\n  (let [squares (map (fn [x] (math/pow x 2)) numbers)\n        sum (reduce + 0 squares)\n        mean (/ sum (len numbers))]\n    (math/sqrt mean)))\n\n(rms [1 2 3 4 5])  ;; =&gt; 3.316...\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_11","title":"\u7bc4\u56f2\u5236\u9650","text":"<pre><code>;; \u30b9\u30b3\u30a2\u30920-100\u306b\u5236\u9650\n(defn normalize-score [score]\n  (math/clamp (math/round score) 0 100))\n\n(map normalize-score [-10 45.7 99.2 150])\n;; =&gt; (0 46 99 100)\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_12","title":"\u4e71\u6570\u306b\u3088\u308b\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0","text":"<pre><code>;; \u30e9\u30f3\u30c0\u30e0\u306a\u30b5\u30f3\u30d7\u30eb\u3092\u53d6\u5f97\n(defn random-sample [n coll]\n  (take n (math/shuffle coll)))\n\n(random-sample 3 [1 2 3 4 5 6 7 8 9 10])\n;; =&gt; (7 2 9) \u306a\u3069\n</code></pre>"},{"location":"ja/spec/15-stdlib-math/#_13","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/15-stdlib-math/#_14","title":"\u57fa\u672c\u6f14\u7b97\u30fb\u6570\u5024\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> \u57fa\u672c\u6f14\u7b97\uff08\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u5bfe\u5fdc\uff09 <code>(+ 1.5 2 3)</code> \u2192 <code>6.5</code> <code>min</code> \u6700\u5c0f\u5024\uff08\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u5bfe\u5fdc\uff09 <code>(min 1.5 2 3)</code> \u2192 <code>1.5</code> <code>max</code> \u6700\u5927\u5024\uff08\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u5bfe\u5fdc\uff09 <code>(max 1.5 2 3)</code> \u2192 <code>3</code> <code>sum</code> \u5408\u8a08\uff08\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u5bfe\u5fdc\uff09 <code>(sum [1.5 2 3])</code> \u2192 <code>6.5</code> <code>inc</code> \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u5bfe\u5fdc\uff09 <code>(inc 5.5)</code> \u2192 <code>6.5</code> <code>dec</code> \u30c7\u30af\u30ea\u30e1\u30f3\u30c8\uff08\u6574\u6570\u30fb\u6d6e\u52d5\u5c0f\u6570\u5bfe\u5fdc\uff09 <code>(dec 5.5)</code> \u2192 <code>4.5</code> <code>abs</code> \u7d76\u5bfe\u5024 <code>(abs -5.5)</code> \u2192 <code>5.5</code>"},{"location":"ja/spec/15-stdlib-math/#_15","title":"\u6570\u5b66\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>math/pow</code> \u3079\u304d\u4e57 <code>(math/pow 2 3)</code> \u2192 <code>8</code> <code>math/sqrt</code> \u5e73\u65b9\u6839 <code>(math/sqrt 16)</code> \u2192 <code>4.0</code> <code>math/round</code> \u56db\u6368\u4e94\u5165 <code>(math/round 3.5)</code> \u2192 <code>4</code> <code>math/floor</code> \u5207\u308a\u6368\u3066 <code>(math/floor 3.9)</code> \u2192 <code>3</code> <code>math/ceil</code> \u5207\u308a\u4e0a\u3052 <code>(math/ceil 3.1)</code> \u2192 <code>4</code> <code>math/clamp</code> \u7bc4\u56f2\u5236\u9650 <code>(math/clamp 15 0 10)</code> \u2192 <code>10</code>"},{"location":"ja/spec/15-stdlib-math/#feature-std-math_1","title":"\u4e71\u6570\u95a2\u6570\uff08Feature: std-math\uff09","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>math/rand</code> \u4e71\u6570(0.0-1.0) <code>(math/rand)</code> \u2192 <code>0.7234...</code> <code>math/rand-int</code> \u6574\u6570\u4e71\u6570 <code>(math/rand-int 10)</code> \u2192 <code>0-9</code> <code>math/random-range</code> \u7bc4\u56f2\u4e71\u6570 <code>(math/random-range 10 20)</code> \u2192 <code>10-20</code> <code>math/shuffle</code> \u30b7\u30e3\u30c3\u30d5\u30eb <code>(math/shuffle [1 2 3])</code> \u2192 <code>[3 1 2]</code>"},{"location":"ja/spec/15-stdlib-math/#_16","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6574\u6570\u3068\u6d6e\u52d5\u5c0f\u6570\u70b9: <code>math/pow</code>\u306f\u6574\u6570\u3092\u8fd4\u3059\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002<code>math/sqrt</code>\u306f\u5e38\u306b\u6d6e\u52d5\u5c0f\u6570\u70b9\u3092\u8fd4\u3057\u307e\u3059\u3002</li> <li>Feature gates: \u4e71\u6570\u95a2\u9023\u306e\u95a2\u6570\uff08<code>rand</code>, <code>rand-int</code>, <code>random-range</code>, <code>shuffle</code>\uff09\u306f<code>std-math</code> feature\u304c\u5fc5\u8981\u3067\u3059\u3002</li> <li>\u7bc4\u56f2\u5236\u9650: <code>math/clamp</code>\u306f\u5f15\u6570\u9806\u5e8f\u304c<code>(value, min, max)</code>\u3067\u3059\u3002</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/","title":"\u8a8d\u8a3c\u30fb\u8a8d\u53ef","text":"<p>JWT\uff08JSON Web Token\uff09\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\u306b\u3088\u308b\u8a8d\u8a3c\u6a5f\u80fd</p> <p>Qi\u306f\u3001\u30e2\u30c0\u30f3\u306aWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u5fc5\u8981\u3068\u3055\u308c\u308b\u8a8d\u8a3c\u6a5f\u80fd\u3092\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u63d0\u4f9b\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/16-stdlib-auth/#_2","title":"\u76ee\u6b21","text":"<ul> <li>\u6982\u8981</li> <li>JWT\uff08JSON Web Token\uff09</li> <li>jwt/sign - \u30c8\u30fc\u30af\u30f3\u751f\u6210</li> <li>jwt/verify - \u30c8\u30fc\u30af\u30f3\u691c\u8a3c</li> <li>jwt/decode - \u30c8\u30fc\u30af\u30f3\u30c7\u30b3\u30fc\u30c9</li> <li>\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5</li> <li>password/hash - \u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\u5316</li> <li>password/verify - \u30d1\u30b9\u30ef\u30fc\u30c9\u691c\u8a3c</li> <li>\u5b9f\u7528\u4f8b</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_3","title":"\u6982\u8981","text":""},{"location":"ja/spec/16-stdlib-auth/#_4","title":"\u63d0\u4f9b\u6a5f\u80fd","text":"<ul> <li>JWT\u8a8d\u8a3c: \u30b9\u30c6\u30fc\u30c8\u30ec\u30b9\u306a\u30c8\u30fc\u30af\u30f3\u30d9\u30fc\u30b9\u8a8d\u8a3c</li> <li>\u30c8\u30fc\u30af\u30f3\u751f\u6210\uff08jwt/sign\uff09</li> <li>\u30c8\u30fc\u30af\u30f3\u691c\u8a3c\uff08jwt/verify\uff09</li> <li>\u30c8\u30fc\u30af\u30f3\u30c7\u30b3\u30fc\u30c9\uff08jwt/decode\uff09</li> <li> <p>HS256/HS384/HS512\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5bfe\u5fdc</p> </li> <li> <p>\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5: Argon2\u306b\u3088\u308b\u5b89\u5168\u306a\u30d1\u30b9\u30ef\u30fc\u30c9\u7ba1\u7406</p> </li> <li>\u30cf\u30c3\u30b7\u30e5\u5316\uff08password/hash\uff09</li> <li>\u691c\u8a3c\uff08password/verify\uff09</li> <li>\u30bd\u30eb\u30c8\u81ea\u52d5\u751f\u6210</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#feature-flag","title":"feature flag","text":"<pre><code># Cargo.toml\nfeatures = [\"auth-jwt\", \"auth-password\"]\n</code></pre> <p>\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\u3067\u3059\u3002</p>"},{"location":"ja/spec/16-stdlib-auth/#jwtjson-web-token","title":"JWT\uff08JSON Web Token\uff09","text":""},{"location":"ja/spec/16-stdlib-auth/#jwtsign-","title":"jwt/sign - \u30c8\u30fc\u30af\u30f3\u751f\u6210","text":"<p>\u30da\u30a4\u30ed\u30fc\u30c9\u3068\u79d8\u5bc6\u9375\u304b\u3089JWT\u30c8\u30fc\u30af\u30f3\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(jwt/sign payload secret)\n(jwt/sign payload secret algorithm)\n(jwt/sign payload secret algorithm exp)\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_5","title":"\u5f15\u6570","text":"<ul> <li><code>payload</code>: \u30de\u30c3\u30d7\uff08\u30c8\u30fc\u30af\u30f3\u306b\u542b\u3081\u308b\u30c7\u30fc\u30bf\uff09</li> <li><code>secret</code>: \u6587\u5b57\u5217\uff08\u7f72\u540d\u7528\u306e\u79d8\u5bc6\u9375\uff09</li> <li><code>algorithm</code>: \u6587\u5b57\u5217\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\u3001\u30c7\u30d5\u30a9\u30eb\u30c8: \"HS256\"\uff09</li> <li>\"HS256\", \"HS384\", \"HS512\" \u306b\u5bfe\u5fdc</li> <li><code>exp</code>: \u6574\u6570\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\u3001\u6709\u52b9\u671f\u9650\u306e\u79d2\u6570\uff09</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_6","title":"\u623b\u308a\u5024","text":"<ul> <li>\u6210\u529f: \u30c8\u30fc\u30af\u30f3\u6587\u5b57\u5217</li> <li>\u5931\u6557: <code>{:error \"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\"}</code></li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_7","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u306fHS256\uff09\n(def result (jwt/sign {:user_id 123 :name \"Alice\"} \"my-secret\"))\n;; =&gt; \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\"\n\n;; \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u6307\u5b9a\n(jwt/sign {:role \"admin\"} \"secret\" \"HS384\")\n\n;; \u6709\u52b9\u671f\u9650\u3092\u6307\u5b9a\uff083600\u79d2 = 1\u6642\u9593\uff09\n(jwt/sign {:user_id 42} \"secret\" \"HS256\" 3600)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n({:user_id 999 :role \"user\"}\n |&gt; (jwt/sign \"my-secret\")\n |&gt;? (fn [token] (println \"Token:\" token)))\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#jwtverify-","title":"jwt/verify - \u30c8\u30fc\u30af\u30f3\u691c\u8a3c","text":"<p>JWT\u30c8\u30fc\u30af\u30f3\u3092\u691c\u8a3c\u3057\u3001\u30da\u30a4\u30ed\u30fc\u30c9\u3092\u53d6\u308a\u51fa\u3057\u307e\u3059\u3002</p> <pre><code>(jwt/verify token secret)\n(jwt/verify token secret algorithm)\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_8","title":"\u5f15\u6570","text":"<ul> <li><code>token</code>: \u6587\u5b57\u5217\uff08\u691c\u8a3c\u3059\u308bJWT\u30c8\u30fc\u30af\u30f3\uff09</li> <li><code>secret</code>: \u6587\u5b57\u5217\uff08\u691c\u8a3c\u7528\u306e\u79d8\u5bc6\u9375\uff09</li> <li><code>algorithm</code>: \u6587\u5b57\u5217\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\u3001\u30c7\u30d5\u30a9\u30eb\u30c8: \"HS256\"\uff09</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_9","title":"\u623b\u308a\u5024","text":"<ul> <li>\u6210\u529f: \u30da\u30a4\u30ed\u30fc\u30c9\u30de\u30c3\u30d7</li> <li>\u5931\u6557: <code>{:error \"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\"}</code></li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_10","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; \u30c8\u30fc\u30af\u30f3\u3092\u691c\u8a3c\u3057\u3066\u30da\u30a4\u30ed\u30fc\u30c9\u3092\u53d6\u5f97\n(def result (jwt/verify token \"my-secret\"))\n;; =&gt; {:user_id 123 :name \"Alice\"}\n\n;; \u691c\u8a3c\u5931\u6557\u306e\u4f8b\n(jwt/verify \"invalid-token\" \"secret\")\n;; =&gt; {:error \"Invalid token\"}\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(token\n |&gt;? (jwt/verify \"my-secret\")\n |&gt;? (fn [payload] (get payload :user_id)))\n;; =&gt; 123\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#jwtdecode-","title":"jwt/decode - \u30c8\u30fc\u30af\u30f3\u30c7\u30b3\u30fc\u30c9","text":"<p>JWT\u30c8\u30fc\u30af\u30f3\u3092\u691c\u8a3c\u305b\u305a\u306b\u30c7\u30b3\u30fc\u30c9\u3057\u307e\u3059\uff08\u7f72\u540d\u691c\u8a3c\u306a\u3057\uff09\u3002</p> <p>\u30c8\u30fc\u30af\u30f3\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306e\u30c7\u30d0\u30c3\u30b0\u7528\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>(jwt/decode token)\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_11","title":"\u5f15\u6570","text":"<ul> <li><code>token</code>: \u6587\u5b57\u5217\uff08\u30c7\u30b3\u30fc\u30c9\u3059\u308bJWT\u30c8\u30fc\u30af\u30f3\uff09</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_12","title":"\u623b\u308a\u5024","text":"<ul> <li>\u6210\u529f: <code>{:header \u30d8\u30c3\u30c0\u30de\u30c3\u30d7 :payload \u30da\u30a4\u30ed\u30fc\u30c9\u30de\u30c3\u30d7}</code></li> <li>\u5931\u6557: <code>{:error \"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\"}</code></li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_13","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; \u30c8\u30fc\u30af\u30f3\u3092\u30c7\u30b3\u30fc\u30c9\uff08\u7f72\u540d\u691c\u8a3c\u306a\u3057\uff09\n(def result (jwt/decode token))\n;; =&gt; {:header {:typ \"JWT\" :alg \"HS256\"}\n;;     :payload {:user_id 123 :name \"Alice\"}}\n\n;; \u30d8\u30c3\u30c0\u30fc\u3060\u3051\u53d6\u5f97\n(jwt/decode token\n |&gt;? (fn [data] (get data :header)))\n;; =&gt; {:typ \"JWT\" :alg \"HS256\"}\n</code></pre> <p>\u26a0\ufe0f \u6ce8\u610f: \u3053\u306e\u95a2\u6570\u306f\u7f72\u540d\u3092\u691c\u8a3c\u3057\u307e\u305b\u3093\u3002\u30c7\u30d0\u30c3\u30b0\u3084\u30c6\u30b9\u30c8\u7528\u9014\u306b\u306e\u307f\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/spec/16-stdlib-auth/#_14","title":"\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5","text":""},{"location":"ja/spec/16-stdlib-auth/#passwordhash-","title":"password/hash - \u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\u5316","text":"<p>\u30d1\u30b9\u30ef\u30fc\u30c9\u3092Argon2\u3067\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u307e\u3059\u3002</p> <p>Argon2\u306f\u3001bcrypt\u3088\u308a\u3082\u9ad8\u901f\u3067\u5b89\u5168\u306a\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3059\u3002</p> <pre><code>(password/hash password)\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_15","title":"\u5f15\u6570","text":"<ul> <li><code>password</code>: \u6587\u5b57\u5217\uff08\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\uff09</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_16","title":"\u623b\u308a\u5024","text":"<ul> <li>\u6210\u529f: \u30cf\u30c3\u30b7\u30e5\u6587\u5b57\u5217\uff08Value::String\uff09</li> <li>\u5931\u6557: \u30a8\u30e9\u30fc\uff08\u4f8b\u5916\uff09</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_17","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; \u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\n(def hash (password/hash \"my-password\"))\n;; =&gt; \"$argon2id$v=19$m=19456,t=2,p=1$...\"\n\n;; \u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3082\u7570\u306a\u308b\u30cf\u30c3\u30b7\u30e5\u304c\u751f\u6210\u3055\u308c\u308b\uff08\u30bd\u30eb\u30c8\u81ea\u52d5\u751f\u6210\uff09\n(def hash1 (password/hash \"test\"))\n(def hash2 (password/hash \"test\"))\n(println (= hash1 hash2))  ;; =&gt; false\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#passwordverify-","title":"password/verify - \u30d1\u30b9\u30ef\u30fc\u30c9\u691c\u8a3c","text":"<p>\u30d1\u30b9\u30ef\u30fc\u30c9\u3068\u30cf\u30c3\u30b7\u30e5\u3092\u6bd4\u8f03\u3057\u3066\u691c\u8a3c\u3057\u307e\u3059\u3002</p> <pre><code>(password/verify password hash)\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_18","title":"\u5f15\u6570","text":"<ul> <li><code>password</code>: \u6587\u5b57\u5217\uff08\u691c\u8a3c\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\uff09</li> <li><code>hash</code>: \u6587\u5b57\u5217\uff08password/hash\u3067\u751f\u6210\u3055\u308c\u305f\u30cf\u30c3\u30b7\u30e5\uff09</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_19","title":"\u623b\u308a\u5024","text":"<ul> <li><code>true</code>: \u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4</li> <li><code>false</code>: \u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e0d\u4e00\u81f4</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_20","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; \u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u691c\u8a3c\n(def hash (password/hash \"my-password\"))\n\n(password/verify \"my-password\" hash)  ;; =&gt; true\n(password/verify \"wrong-password\" hash)  ;; =&gt; false\n\n;; \u4e0d\u6b63\u306a\u30cf\u30c3\u30b7\u30e5\u5f62\u5f0f\u306e\u5834\u5408\u306ffalse\u3092\u8fd4\u3059\n(password/verify \"test\" \"invalid-hash\")  ;; =&gt; false\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_21","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/16-stdlib-auth/#_22","title":"\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd","text":"<pre><code>;; \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n(defn register-user [username password]\n  (let [hash (password/hash password)]\n    {:username username\n     :password_hash hash}))\n\n;; \u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\n(defn login [username password stored-hash]\n  (if (password/verify password stored-hash)\n    (jwt/sign {:username username} \"app-secret\" \"HS256\" 3600)\n    {:error \"Invalid credentials\"}))\n\n;; \u4f7f\u7528\u4f8b\n(def user (register-user \"alice\" \"secret123\"))\n;; =&gt; {:username \"alice\" :password_hash \"$argon2id$...\"}\n\n(def token-result (login \"alice\" \"secret123\" (get user :password_hash)))\n;; =&gt; \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\"\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#api","title":"API\u306e\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2","text":"<pre><code>;; \u30c8\u30fc\u30af\u30f3\u304b\u3089\u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\n(defn authenticate [token]\n  (token\n   |&gt;? (jwt/verify \"app-secret\")\n   |&gt;? (fn [payload] (get payload :username))))\n\n;; \u4fdd\u8b77\u3055\u308c\u305f\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n(defn protected-endpoint [request]\n  (let [auth-header (get-in request [:headers :authorization])\n        token (string/replace-first auth-header \"Bearer \" \"\")\n        auth-result (authenticate token)]\n    (match auth-result\n      {:error _} -&gt; {:status 401 :body \"Unauthorized\"}\n      username -&gt; {:status 200 :body (str \"Hello, \" username)})))\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_23","title":"\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u30d5\u30ed\u30fc","text":"<pre><code>;; \u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\n(defn change-password [old-password new-password stored-hash]\n  (if (password/verify old-password stored-hash)\n    (password/hash new-password)\n    {:error \"Current password is incorrect\"}))\n\n;; \u4f7f\u7528\u4f8b\n(def current-hash \"$argon2id$v=19$m=19456,t=2,p=1$...\")\n(def new-hash (change-password \"old-pass\" \"new-pass\" current-hash))\n;; =&gt; \"$argon2id$v=19$m=19456,t=2,p=1$...\" (\u65b0\u3057\u3044\u30cf\u30c3\u30b7\u30e5)\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_24","title":"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/spec/16-stdlib-auth/#jwt","title":"JWT","text":"<ol> <li>\u79d8\u5bc6\u9375\u306e\u7ba1\u7406</li> <li>\u79d8\u5bc6\u9375\u306f\u74b0\u5883\u5909\u6570\u3067\u7ba1\u7406\u3059\u308b</li> <li> <p>\u5341\u5206\u306b\u9577\u304f\u3001\u30e9\u30f3\u30c0\u30e0\u306a\u6587\u5b57\u5217\u3092\u4f7f\u7528\u3059\u308b</p> </li> <li> <p>\u6709\u52b9\u671f\u9650\u306e\u8a2d\u5b9a</p> </li> <li>\u30c8\u30fc\u30af\u30f3\u306b\u306f\u5fc5\u305a\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\u3059\u308b</li> <li> <p>\u77ed\u3044\u6709\u52b9\u671f\u9650\uff081\u6642\u9593\u4ee5\u5185\uff09\u3092\u63a8\u5968</p> </li> <li> <p>HTTPS\u5fc5\u9808</p> </li> <li>\u30c8\u30fc\u30af\u30f3\u306f\u5fc5\u305aHTTPS\u7d4c\u7531\u3067\u9001\u4fe1\u3059\u308b</li> <li>HTTP\u3067\u306f\u76d7\u8074\u306e\u30ea\u30b9\u30af\u304c\u3042\u308b</li> </ol>"},{"location":"ja/spec/16-stdlib-auth/#_25","title":"\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5","text":"<ol> <li>\u30bd\u30eb\u30c8\u306e\u81ea\u52d5\u751f\u6210</li> <li><code>password/hash</code>\u306f\u81ea\u52d5\u7684\u306b\u30bd\u30eb\u30c8\u3092\u751f\u6210\u3057\u307e\u3059</li> <li> <p>\u540c\u3058\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3082\u7570\u306a\u308b\u30cf\u30c3\u30b7\u30e5\u304c\u751f\u6210\u3055\u308c\u307e\u3059</p> </li> <li> <p>Argon2\u306e\u5229\u70b9</p> </li> <li>bcrypt\u3088\u308a\u9ad8\u901f\u3067\u5b89\u5168</li> <li>\u30e1\u30e2\u30ea\u30cf\u30fc\u30c9\u95a2\u6570\uff08GPU\u653b\u6483\u306b\u5f37\u3044\uff09</li> <li> <p>2015\u5e74\u306ePassword Hashing Competition\u512a\u52dd</p> </li> <li> <p>\u30cf\u30c3\u30b7\u30e5\u306e\u4fdd\u5b58</p> </li> <li>\u30cf\u30c3\u30b7\u30e5\u306f\u305d\u306e\u307e\u307e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3067\u304d\u307e\u3059</li> <li>\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3001\u30bd\u30eb\u30c8\u3001\u30cf\u30c3\u30b7\u30e5\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059</li> </ol>"},{"location":"ja/spec/16-stdlib-auth/#_26","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>11-stdlib-http.md - HTTP\u30b5\u30fc\u30d0\u30fc\u3068\u306e\u7d71\u5408</li> <li>12-stdlib-json.md - JSON\u30c7\u30fc\u30bf\u306e\u6271\u3044</li> <li>08-error-handling.md - Result\u578b\u30d1\u30bf\u30fc\u30f3</li> <li>17-stdlib-database.md - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u7d71\u5408</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#_27","title":"\u5b9f\u88c5\u306e\u8a73\u7d30","text":""},{"location":"ja/spec/16-stdlib-auth/#_28","title":"\u4f7f\u7528\u30af\u30ec\u30fc\u30c8","text":"<ul> <li>jsonwebtoken (v9.2) - JWT\u751f\u6210\u30fb\u691c\u8a3c</li> <li>argon2 (v0.5) - \u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5</li> </ul>"},{"location":"ja/spec/16-stdlib-auth/#feature-flags","title":"feature flags","text":"<pre><code># \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\ndefault = [\"auth-jwt\", \"auth-password\", ...]\n\n# \u500b\u5225\u306b\u7121\u52b9\u5316\u3082\u53ef\u80fd\nminimal = []  # \u8a8d\u8a3c\u6a5f\u80fd\u306a\u3057\n</code></pre>"},{"location":"ja/spec/16-stdlib-auth/#_29","title":"\u307e\u3068\u3081","text":"<p>Qi\u306e\u8a8d\u8a3c\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u5b89\u5168\u306a\u8a8d\u8a3c\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <ul> <li>JWT: \u30b9\u30c6\u30fc\u30c8\u30ec\u30b9\u306a\u30c8\u30fc\u30af\u30f3\u8a8d\u8a3c</li> <li>Argon2: \u30e2\u30c0\u30f3\u3067\u5b89\u5168\u306a\u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5</li> <li>Result\u578b: \u30a8\u30e9\u30fc\u51e6\u7406\u306e\u7d71\u4e00</li> </ul> <p>\u3053\u308c\u3089\u306e\u6a5f\u80fd\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u3001\u30e2\u30c0\u30f3\u306aWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a8d\u8a3c\u30b7\u30b9\u30c6\u30e0\u3092\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/17-stdlib-database/","title":"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff08PostgreSQL/MySQL/SQLite\uff09\u306e\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9</p> <p>Qi\u306f\u3001\u30ea\u30ec\u30fc\u30b7\u30e7\u30ca\u30eb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u7d71\u4e00\u7684\u306a\u30a2\u30af\u30bb\u30b9\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/17-stdlib-database/#_2","title":"\u76ee\u6b21","text":"<ul> <li>\u6982\u8981</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9</li> <li>db/connect - \u63a5\u7d9a</li> <li>db/query - \u30af\u30a8\u30ea\u5b9f\u884c</li> <li>db/exec - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c</li> <li>\u5b9f\u7528\u4f8b</li> <li>\u30a8\u30e9\u30fc\u51e6\u7406</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9</li> <li>\u63a5\u7d9a\u6587\u5b57\u5217\u306e\u5f62\u5f0f</li> <li>\u5b9f\u88c5\u306e\u8a73\u7d30</li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_3","title":"\u6982\u8981","text":""},{"location":"ja/spec/17-stdlib-database/#_4","title":"\u63d0\u4f9b\u6a5f\u80fd","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9: - \u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08db/*\uff09: PostgreSQL/MySQL/SQLite\u5bfe\u5fdc   - \u63a5\u7d9a\u7ba1\u7406\uff08<code>db/connect</code>\uff09   - \u30af\u30a8\u30ea\u5b9f\u884c\uff08<code>db/query</code>\uff09   - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08<code>db/exec</code>\uff09   - \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\uff08<code>db/begin</code>, <code>db/commit</code>, <code>db/rollback</code>\uff09   - \u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea\u5bfe\u5fdc   - \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u900f\u904e\u7684\u306a\u5207\u308a\u66ff\u3048\uff08\u63a5\u7d9aURL\u306e\u307f\u5909\u66f4\uff09</p>"},{"location":"ja/spec/17-stdlib-database/#feature-flag","title":"feature flag","text":"<pre><code># Cargo.toml\nfeatures = [\"db-sqlite\", \"db-postgres\", \"db-mysql\"]\n</code></pre> <p>\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\u3067\u3059\u3002</p>"},{"location":"ja/spec/17-stdlib-database/#_5","title":"\u4f9d\u5b58\u30af\u30ec\u30fc\u30c8","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9: - rusqlite (v0.32) - Pure Rust SQLite\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 - tokio-postgres (v0.7) - Pure Rust PostgreSQL\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 - mysql_async (v0.34) - Pure Rust MySQL\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 - tokio - \u975e\u540c\u671f\u30e9\u30f3\u30bf\u30a4\u30e0</p>"},{"location":"ja/spec/17-stdlib-database/#_6","title":"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9","text":""},{"location":"ja/spec/17-stdlib-database/#_7","title":"\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u8a2d\u8a08","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u30d1\u30bf\u30fc\u30f3\u3067\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fGo\u306e<code>database/sql</code>\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u540c\u3058\u30a2\u30d7\u30ed\u30fc\u30c1\u3067\u3001\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\uff08\u30c9\u30e9\u30a4\u30d0\u30fc\uff09\u3092\u900f\u904e\u7684\u306b\u6271\u3048\u307e\u3059\u3002</p> <pre><code>;; \u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u81ea\u52d5\u5224\u5225\uff09\n(def conn (db/connect \"postgresql://localhost/mydb\"))\n(def conn (db/connect \"mysql://root:pass@localhost/mydb\"))\n(def conn (db/connect \"sqlite:path/to/db.db\"))\n\n;; \u4ee5\u964d\u306e\u30b3\u30fc\u30c9\u306f\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u975e\u4f9d\u5b58\n(db/query conn \"SELECT * FROM users\" [])\n(db/exec conn \"INSERT INTO users (name) VALUES (?)\" [\"Alice\"])\n\n;; \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n(def tx (db/begin conn))\n(db/exec tx \"UPDATE accounts SET balance = balance - 100 WHERE id = 1\" [])\n(db/exec tx \"UPDATE accounts SET balance = balance + 100 WHERE id = 2\" [])\n(db/commit tx)\n</code></pre> <p>\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u5207\u308a\u66ff\u3048: \u63a5\u7d9aURL\u3092\u5909\u66f4\u3059\u308b\u3060\u3051\u3067PostgreSQL\u2194MySQL\u2194SQLite\u9593\u3092\u79fb\u884c\u3067\u304d\u307e\u3059\u3002</p> <p>\u5c02\u7528\u95a2\u6570\u306f\u516c\u958b\u3057\u306a\u3044: <code>db/pg-*</code>, <code>db/my-*</code>\u306e\u3088\u3046\u306a\u5c02\u7528\u95a2\u6570\u306f\u5185\u90e8\u5b9f\u88c5\u7528\u306e\u307f\u3067\u3059\u3002 \u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u8868\u73fe\u3067\u304d\u306a\u3044\u6a5f\u80fd\uff08PostgreSQL\u306eCOPY\u3001MySQL\u306eLOAD DATA\u7b49\uff09\u304c\u5fc5\u8981\u306b\u306a\u3063\u305f\u5834\u5408\u306e\u307f\u8ffd\u52a0\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/17-stdlib-database/#dbconnect-","title":"db/connect - \u63a5\u7d9a","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u63a5\u7d9a\u3057\u3001\u63a5\u7d9aID\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>(db/connect url)\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_8","title":"\u5f15\u6570","text":"<ul> <li><code>url</code>: \u6587\u5b57\u5217\uff08\u63a5\u7d9aURL\uff09</li> <li>PostgreSQL: <code>\"postgresql://user:password@host:port/dbname\"</code></li> <li>MySQL: <code>\"mysql://user:password@host:port/dbname\"</code></li> <li>SQLite: <code>\"sqlite:path/to/db.db\"</code></li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_9","title":"\u623b\u308a\u5024","text":"<ul> <li>\u63a5\u7d9aID\uff08\u6587\u5b57\u5217\uff09</li> <li>\u30a8\u30e9\u30fc\u306e\u5834\u5408: <code>{:error \"message\"}</code></li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_10","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; PostgreSQL\u63a5\u7d9a\n(def db-conn (db/connect \"postgresql://admin:secret@localhost:5432/myapp\"))\n\n;; MySQL\u63a5\u7d9a\n(def db-conn (db/connect \"mysql://root:pass@localhost:3306/mydb\"))\n\n;; SQLite\u63a5\u7d9a\n(def db-conn (db/connect \"sqlite:/path/to/database.db\"))\n\n;; \u63a5\u7d9a\u30a8\u30e9\u30fc\n(def conn (db/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported database URL: invalid-url\"}\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#dbquery-","title":"db/query - \u30af\u30a8\u30ea\u5b9f\u884c","text":"<p>SELECT\u30af\u30a8\u30ea\u3092\u5b9f\u884c\u3057\u3001\u7d50\u679c\u884c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>(db/query conn sql params)\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_11","title":"\u5f15\u6570","text":"<ul> <li><code>conn</code>: \u63a5\u7d9aID\uff08<code>db/connect</code>\u306e\u623b\u308a\u5024\uff09</li> <li><code>sql</code>: SQL\u6587\u5b57\u5217</li> <li><code>params</code>: \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d9\u30af\u30bf</li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_12","title":"\u623b\u308a\u5024","text":"<ul> <li>\u7d50\u679c\u884c\u306e\u30d9\u30af\u30bf\uff08\u5404\u884c\u306f\u30de\u30c3\u30d7\uff09</li> <li>\u30a8\u30e9\u30fc\u306e\u5834\u5408: <code>{:error \"message\"}</code></li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_13","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; \u5168\u30e6\u30fc\u30b6\u30fc\u53d6\u5f97\n(db/query db-conn \"SELECT * FROM users\" [])\n;; =&gt; [{:id 1 :name \"Alice\" :email \"alice@example.com\"}\n;;     {:id 2 :name \"Bob\" :email \"bob@example.com\"}]\n\n;; \u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea\n(db/query db-conn \"SELECT * FROM users WHERE id = $1\" [1])\n;; =&gt; [{:id 1 :name \"Alice\" :email \"alice@example.com\"}]\n\n;; WHERE IN\u53e5\n(db/query db-conn \"SELECT * FROM users WHERE id IN ($1, $2, $3)\" [1 2 3])\n\n;; LIMIT/OFFSET\uff08\u30da\u30fc\u30b8\u30f3\u30b0\uff09\n(db/query db-conn \"SELECT * FROM users LIMIT $1 OFFSET $2\" [10 20])\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#dbexec-","title":"db/exec - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c","text":"<p>INSERT/UPDATE/DELETE\u3092\u5b9f\u884c\u3057\u3001\u5f71\u97ff\u3092\u53d7\u3051\u305f\u884c\u6570\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>(db/exec conn sql params)\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_14","title":"\u5f15\u6570","text":"<ul> <li><code>conn</code>: \u63a5\u7d9aID</li> <li><code>sql</code>: SQL\u6587\u5b57\u5217</li> <li><code>params</code>: \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30d9\u30af\u30bf</li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_15","title":"\u623b\u308a\u5024","text":"<ul> <li>\u5f71\u97ff\u3092\u53d7\u3051\u305f\u884c\u6570\uff08\u6574\u6570\uff09</li> <li>\u30a8\u30e9\u30fc\u306e\u5834\u5408: <code>{:error \"message\"}</code></li> </ul>"},{"location":"ja/spec/17-stdlib-database/#_16","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; INSERT\n(db/exec db-conn \"INSERT INTO users (name, email) VALUES ($1, $2)\" [\"Alice\" \"alice@example.com\"])\n;; =&gt; 1\n\n;; UPDATE\n(db/exec db-conn \"UPDATE users SET name = $1 WHERE id = $2\" [\"Bob\" 1])\n;; =&gt; 1\n\n;; DELETE\n(db/exec db-conn \"DELETE FROM users WHERE id = $1\" [1])\n;; =&gt; 1\n\n;; \u8907\u6570\u884cINSERT\n(db/exec db-conn \"INSERT INTO users (name, email) VALUES ($1, $2), ($3, $4)\" [\"Alice\" \"alice@example.com\" \"Bob\" \"bob@example.com\"])\n;; =&gt; 2\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_17","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/17-stdlib-database/#_18","title":"\u30e6\u30fc\u30b6\u30fc\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0","text":"<pre><code>;; \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\uff08\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff09\n(def db-conn (db/connect \"postgresql://admin:secret@localhost:5432/myapp\"))\n\n;; \u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n(defn create-user [name email password-hash]\n  (db/exec db-conn\n    \"INSERT INTO users (name, email, password_hash, created_at)\n     VALUES ($1, $2, $3, NOW()) RETURNING id\"\n    [name email password-hash]))\n\n;; \u30e6\u30fc\u30b6\u30fc\u691c\u7d22\n(defn find-user-by-email [email]\n  (db/query db-conn\n    \"SELECT id, name, email, created_at FROM users WHERE email = $1\"\n    [email]))\n\n;; \u30e6\u30fc\u30b6\u30fc\u66f4\u65b0\n(defn update-user [user-id name email]\n  (db/exec db-conn\n    \"UPDATE users SET name = $1, email = $2, updated_at = NOW()\n     WHERE id = $3\"\n    [name email user-id]))\n\n;; \u30e6\u30fc\u30b6\u30fc\u524a\u9664\n(defn delete-user [user-id]\n  (db/exec db-conn\n    \"DELETE FROM users WHERE id = $1\"\n    [user-id]))\n\n;; \u4f7f\u7528\u4f8b\n(def result (create-user \"Alice\" \"alice@example.com\" \"$argon2id$...\"))\n;; =&gt; 1\n\n(find-user-by-email \"alice@example.com\")\n;; =&gt; [{:id 1 :name \"Alice\" :email \"alice@example.com\" :created_at \"...\"}]\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_19","title":"\u30da\u30fc\u30b8\u30cd\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>;; \u30da\u30fc\u30b8\u30f3\u30b0\u3055\u308c\u305f\u7d50\u679c\u3092\u53d6\u5f97\n(defn get-users-page [page per-page]\n  (let [offset (* (- page 1) per-page)]\n    (db/query db-conn\n      \"SELECT id, name, email FROM users\n       ORDER BY created_at DESC\n       LIMIT $1 OFFSET $2\"\n      [per-page offset])))\n\n;; \u4f7f\u7528\u4f8b\n(get-users-page 1 10)  ;; 1\u30da\u30fc\u30b8\u76ee\u300110\u4ef6\n;; =&gt; [{:id 100 :name \"Zara\" ...} ...]\n\n(get-users-page 2 10)  ;; 2\u30da\u30fc\u30b8\u76ee\u300110\u4ef6\n;; =&gt; [{:id 90 :name \"Yuki\" ...} ...]\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_20","title":"\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\uff08\u624b\u52d5\uff09","text":"<pre><code>;; \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u4f8b\uff08\u624b\u52d5\u30b3\u30df\u30c3\u30c8\uff09\n(defn transfer-money [from-id to-id amount]\n  (let [conn db-conn]\n    ;; BEGIN\n    (db/exec conn \"BEGIN\" [])\n\n    ;; \u51fa\u91d1\n    (def debit-result\n      (db/exec conn\n        \"UPDATE accounts SET balance = balance - $1 WHERE id = $2\"\n        [amount from-id]))\n\n    ;; \u5165\u91d1\n    (def credit-result\n      (db/exec conn\n        \"UPDATE accounts SET balance = balance + $1 WHERE id = $2\"\n        [amount to-id]))\n\n    ;; \u30b3\u30df\u30c3\u30c8\u307e\u305f\u306f\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n    (match [debit-result credit-result]\n      [1 1] -&gt; (do\n                 (db/exec conn \"COMMIT\" [])\n                 \"Transfer successful\")\n      _ -&gt; (do\n             (db/exec conn \"ROLLBACK\" [])\n             {:error \"Transfer failed\"}))))\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_21","title":"\u96c6\u8a08\u30af\u30a8\u30ea","text":"<pre><code>;; \u30e6\u30fc\u30b6\u30fc\u6570\u3092\u53d6\u5f97\n(defn count-users []\n  (db/query db-conn \"SELECT COUNT(*) as count FROM users\" [])\n  |&gt;? (fn [rows] (get (first rows) :count)))\n\n;; \u30b0\u30eb\u30fc\u30d7\u5316\n(defn count-users-by-status []\n  (db/query db-conn\n    \"SELECT status, COUNT(*) as count\n     FROM users\n     GROUP BY status\"\n    []))\n\n;; \u4f7f\u7528\u4f8b\n(count-users)\n;; =&gt; 1523\n\n(count-users-by-status)\n;; =&gt; [{:status \"active\" :count 1200}\n;;     {:status \"inactive\" :count 323}]\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_22","title":"\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"ja/spec/17-stdlib-database/#_23","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u95a2\u6570\u306f\u6210\u529f\u6642\u306b\u751f\u30c7\u30fc\u30bf\u3001\u5931\u6557\u6642\u306b<code>{:error \"message\"}</code>\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406\n(def result (db/query db-conn \"SELECT * FROM users\" []))\n(if (error? result)\n  (println \"Error:\" (get result :error))\n  (println \"Found\" (count result) \"users\"))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u30a8\u30e9\u30fc\u51e6\u7406\uff08|&gt;?\u3067\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\uff09\n(defn get-user-email [user-id]\n  (db/query db-conn \"SELECT email FROM users WHERE id = $1\" [user-id])\n  |&gt;? (fn [rows]\n        (if (empty? rows)\n          {:error \"User not found\"}\n          (get (first rows) \"email\"))))\n\n;; match\u3067\u306e\u30a8\u30e9\u30fc\u51e6\u7406\n(match (db/query db-conn \"SELECT * FROM users\" [])\n  {:error e} -&gt; (println \"Database error:\" e)\n  rows -&gt; (println \"Found\" (count rows) \"users\"))\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_24","title":"\u63a5\u7d9a\u30a8\u30e9\u30fc","text":"<pre><code>;; \u4e0d\u6b63\u306a\u63a5\u7d9a\u6587\u5b57\u5217\n(def conn (db/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported database URL: invalid-url\"}\n\n;; \u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\n(def conn (db/connect \"postgresql://localhost:9999/db\"))\n;; =&gt; {:error \"Connection failed: connection refused\"}\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_25","title":"\u30af\u30a8\u30ea\u30a8\u30e9\u30fc","text":"<pre><code>;; \u69cb\u6587\u30a8\u30e9\u30fc\n(db/query db-conn \"SELEC * FROM users\" [])\n;; =&gt; {:error \"Query error: syntax error at or near \\\"SELEC\\\"\"}\n\n;; \u30c6\u30fc\u30d6\u30eb\u304c\u5b58\u5728\u3057\u306a\u3044\n(db/query db-conn \"SELECT * FROM nonexistent_table\" [])\n;; =&gt; {:error \"Query error: relation \\\"nonexistent_table\\\" does not exist\"}\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_26","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9","text":""},{"location":"ja/spec/17-stdlib-database/#_27","title":"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\uff08\u672a\u5b9f\u88c5\uff09","text":"<p>\u73fe\u5728\u306e\u5b9f\u88c5\u3067\u306f\u3001\u5404\u30af\u30a8\u30ea\u3054\u3068\u306b\u65b0\u3057\u3044\u63a5\u7d9a\u3092\u78ba\u7acb\u3057\u307e\u3059\u3002</p> <p>\u5c06\u6765\u7684\u306b\u306f\u3001\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u4e88\u5b9a\u3067\u3059\uff1a</p> <pre><code>;; \u5c06\u6765\u306e\u8a08\u753b\n(def pool (db/create-pool \"postgresql://...\" {:max-connections 10}))\n(db/with-connection pool (fn [conn]\n  (db/query conn \"SELECT * FROM users\" [])))\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_28","title":"\u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea","text":"<p>SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u653b\u6483\u3092\u9632\u3050\u305f\u3081\u3001\u5e38\u306b\u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\uff1a</p> <pre><code>;; \u274c \u5371\u967a: SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306e\u8106\u5f31\u6027\n(def user-input \"1 OR 1=1\")\n(db/query db-conn (str \"SELECT * FROM users WHERE id = \" user-input) [])\n\n;; \u2705 \u5b89\u5168: \u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea\n(db/query db-conn \"SELECT * FROM users WHERE id = $1\" [user-input])\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_29","title":"\u63a5\u7d9a\u6587\u5b57\u5217\u306e\u5f62\u5f0f","text":""},{"location":"ja/spec/17-stdlib-database/#postgresql","title":"PostgreSQL","text":"<pre><code>postgresql://[user[:password]@][host][:port][/dbname][?param1=value1&amp;...]\n</code></pre> <p>\u4f8b: <pre><code>;; \u57fa\u672c\n\"postgresql://localhost/mydb\"\n\n;; \u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\n\"postgresql://admin:secret@localhost/mydb\"\n\n;; \u30dd\u30fc\u30c8\u6307\u5b9a\n\"postgresql://admin:secret@localhost:5433/mydb\"\n\n;; SSL\u30e2\u30fc\u30c9\n\"postgresql://admin:secret@localhost/mydb?sslmode=require\"\n</code></pre></p>"},{"location":"ja/spec/17-stdlib-database/#mysql","title":"MySQL","text":"<pre><code>mysql://[user[:password]@][host][:port][/dbname][?param1=value1&amp;...]\n</code></pre> <p>\u4f8b: <pre><code>;; \u57fa\u672c\n\"mysql://root@localhost/mydb\"\n\n;; \u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\n\"mysql://root:pass@localhost/mydb\"\n\n;; \u30dd\u30fc\u30c8\u6307\u5b9a\n\"mysql://root:pass@localhost:3307/mydb\"\n</code></pre></p>"},{"location":"ja/spec/17-stdlib-database/#sqlite","title":"SQLite","text":"<pre><code>sqlite:path/to/database.db\n</code></pre> <p>\u4f8b: <pre><code>;; \u76f8\u5bfe\u30d1\u30b9\n\"sqlite:mydb.db\"\n\n;; \u7d76\u5bfe\u30d1\u30b9\n\"sqlite:/var/lib/myapp/data.db\"\n\n;; \u30a4\u30f3\u30e1\u30e2\u30ea\uff08\u5c06\u6765\u5bfe\u5fdc\uff09\n\"sqlite::memory:\"\n</code></pre></p>"},{"location":"ja/spec/17-stdlib-database/#_30","title":"\u74b0\u5883\u5909\u6570\u304b\u3089\u306e\u8aad\u307f\u8fbc\u307f","text":"<pre><code>;; \u74b0\u5883\u5909\u6570\u304b\u3089\u63a5\u7d9a\u6587\u5b57\u5217\u3092\u53d6\u5f97\uff08\u5c06\u6765\u306e\u8a08\u753b\uff09\n(def db-conn (db/connect (env/get \"DATABASE_URL\")))\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_31","title":"\u5b9f\u88c5\u306e\u8a73\u7d30","text":""},{"location":"ja/spec/17-stdlib-database/#_32","title":"\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u8a2d\u8a08","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff08RDBMS\uff09\u306f\u3001\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u30d1\u30bf\u30fc\u30f3\u3067\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002 \u3053\u308c\u306fGo\u306e<code>database/sql</code>\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u540c\u3058\u30a2\u30d7\u30ed\u30fc\u30c1\u3067\u3001\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\uff08\u30c9\u30e9\u30a4\u30d0\u30fc\uff09\u3092\u900f\u904e\u7684\u306b\u6271\u3048\u307e\u3059\u3002</p> <pre><code>\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08\u30e6\u30fc\u30b6\u30fc\u304c\u4f7f\u3046\uff09:\n- db/connect, db/query, db/exec      ... RDBMS\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\n\n\u5185\u90e8\u30c9\u30e9\u30a4\u30d0\u30fc\uff08\u516c\u958b\u3057\u306a\u3044\uff09:\n- SqliteDriver, PostgresDriver, MysqlDriver\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_33","title":"\u30c9\u30e9\u30a4\u30d0\u30fc\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>// \u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u30c8\u30ec\u30a4\u30c8\npub trait DbDriver: Send + Sync {\n    fn connect(&amp;self, url: &amp;str, opts: &amp;ConnectionOptions)\n        -&gt; DbResult&lt;Arc&lt;dyn DbConnection&gt;&gt;;\n    fn name(&amp;self) -&gt; &amp;str;\n}\n\npub trait DbConnection: Send + Sync {\n    fn query(&amp;self, sql: &amp;str, params: &amp;[Value], opts: &amp;QueryOptions)\n        -&gt; DbResult&lt;Rows&gt;;\n    fn exec(&amp;self, sql: &amp;str, params: &amp;[Value], opts: &amp;QueryOptions)\n        -&gt; DbResult&lt;i64&gt;;\n    fn begin(&amp;self, opts: &amp;TransactionOptions)\n        -&gt; DbResult&lt;Arc&lt;dyn DbTransaction&gt;&gt;;\n    // ...\n}\n\n// \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u5b9f\u88c5\uff08\u5185\u90e8\u306e\u307f\uff09\npub struct SqliteDriver;\npub struct PostgresDriver;\npub struct MysqlDriver;\n\nimpl DbDriver for SqliteDriver { /* ... */ }\nimpl DbConnection for SqliteConnection { /* ... */ }\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_34","title":"\u975e\u540c\u671f\u51e6\u7406","text":"<p>\u5185\u90e8\u7684\u306b\u306f\u975e\u540c\u671fAPI\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001Qi\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u306f\u540c\u671f\u7684\u306aAPI\u3068\u3057\u3066\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <pre><code>// Rust\u3067\u306e\u5b9f\u88c5\uff08\u53c2\u8003\uff09\nlet rt = tokio::runtime::Runtime::new()?;\nrt.block_on(async {\n    let (client, connection) = tokio_postgres::connect(conn_str, NoTls).await?;\n    client.query(query, &amp;params).await\n})\n</code></pre>"},{"location":"ja/spec/17-stdlib-database/#_35","title":"\u30ed\u30fc\u30c9\u30de\u30c3\u30d7","text":""},{"location":"ja/spec/17-stdlib-database/#_36","title":"\u5c06\u6765\u7684\u306b\u5b9f\u88c5\u4e88\u5b9a\u306e\u6a5f\u80fd","text":"<p>RDBMS: - \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb: \u63a5\u7d9a\u306e\u518d\u5229\u7528\u3067\u9ad8\u901f\u5316 - \u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u30af\u30a8\u30ea: \u5927\u91cf\u30c7\u30fc\u30bf\u306e\u52b9\u7387\u7684\u306a\u51e6\u7406 - \u5c02\u7528\u95a2\u6570\u306e\u8ffd\u52a0: \u7d71\u4e00IF\u3067\u8868\u73fe\u3067\u304d\u306a\u3044\u5834\u5408\u306e\u307f   - PostgreSQL: <code>COPY</code>\u3001<code>LISTEN/NOTIFY</code>   - MySQL: <code>LOAD DATA</code>   - SQLite: \u30ab\u30b9\u30bf\u30e0\u95a2\u6570\u3001\u4eee\u60f3\u30c6\u30fc\u30d6\u30eb</p>"},{"location":"ja/spec/17-stdlib-database/#_37","title":"\u307e\u3068\u3081","text":"<p>Qi\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3001\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u30b7\u30f3\u30d7\u30eb\u304b\u3064\u5b89\u5168\u306a\u30a2\u30af\u30bb\u30b9\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/17-stdlib-database/#rdbmsdb","title":"RDBMS\uff08db/*\uff09","text":"<ul> <li>db/connect: PostgreSQL/MySQL/SQLite\u81ea\u52d5\u5224\u5225</li> <li>db/query: SELECT\u30af\u30a8\u30ea\u5b9f\u884c</li> <li>db/exec: INSERT/UPDATE/DELETE\u5b9f\u884c</li> <li>db/begin/commit/rollback: \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3</li> <li>\u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u30af\u30a8\u30ea: SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56</li> <li>\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u900f\u904e\u7684\u5207\u308a\u66ff\u3048: \u63a5\u7d9aURL\u306e\u307f\u5909\u66f4</li> </ul> <p>\u3053\u308c\u3089\u306e\u6a5f\u80fd\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u99c6\u52d5\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/17-stdlib-database/#_38","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>24-stdlib-kvs.md - Key-Value Store\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08Redis\uff09</li> <li>16-stdlib-auth.md - \u8a8d\u8a3c\u6a5f\u80fd\u3068\u306e\u7d71\u5408</li> <li>08-error-handling.md - Result\u578b\u30d1\u30bf\u30fc\u30f3</li> <li>11-stdlib-http.md - Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306eDB\u4f7f\u7528</li> <li>12-stdlib-json.md - JSON\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u30fb\u8aad\u307f\u8fbc\u307f</li> </ul>"},{"location":"ja/spec/18-stdlib-websocket/","title":"18. WebSocket\u901a\u4fe1","text":"<p>Qi\u306fWebSocket\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u6a5f\u80fd\u3092\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u63d0\u4f9b\u3057\u307e\u3059\u3002\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u901a\u4fe1\u304c\u5fc5\u8981\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u30c1\u30e3\u30c3\u30c8\u3001\u901a\u77e5\u3001\u30e9\u30a4\u30d6\u30c7\u30fc\u30bf\u66f4\u65b0\u306a\u3069\uff09\u3067\u6d3b\u7528\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#181","title":"18.1 \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":""},{"location":"ja/spec/18-stdlib-websocket/#websocket","title":"WebSocket\u63a5\u7d9a\u306e\u78ba\u7acb","text":"<pre><code>;; WebSocket\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n(def conn (ws/connect \"ws://localhost:8080/ws\"))\n\n;; TLS\u5bfe\u5fdc\uff08wss://\uff09\n(def conn (ws/connect \"wss://echo.websocket.org\"))\n</code></pre> <p><code>ws/connect</code>\u306f\u63a5\u7d9aID\u3092\u8fd4\u3057\u307e\u3059\u3002\u3053\u306e\u63a5\u7d9aID\u3092\u4f7f\u3063\u3066\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u53d7\u4fe1\u3084\u63a5\u7d9a\u306e\u30af\u30ed\u30fc\u30ba\u3092\u884c\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#_1","title":"\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u4fe1","text":"<pre><code>;; \u30c6\u30ad\u30b9\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\n(ws/send conn \"Hello, WebSocket!\")\n\n;; JSON\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\n(ws/send conn (json/stringify {:type \"chat\" :msg \"Hello\"}))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#_2","title":"\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u53d7\u4fe1","text":"<pre><code>;; \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\uff08\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\uff09\n(def msg (ws/receive conn))\n\n;; \u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7\u306b\u5fdc\u3058\u3066\u51e6\u7406\n(match (get msg :type)\n  \"message\" -&gt; (println (get msg :data))\n  \"close\" -&gt; (println \"\u63a5\u7d9a\u304c\u9589\u3058\u3089\u308c\u307e\u3057\u305f\")\n  \"error\" -&gt; (println (get msg :error)))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#_3","title":"\u63a5\u7d9a\u306e\u30af\u30ed\u30fc\u30ba","text":"<pre><code>;; \u63a5\u7d9a\u3092\u30af\u30ed\u30fc\u30ba\n(ws/close conn)\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#182","title":"18.2 \u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7","text":"<p><code>ws/receive</code>\u306f\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u306e\u30bf\u30a4\u30d7\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30de\u30c3\u30d7\u3092\u8fd4\u3057\u307e\u3059\uff1a</p>"},{"location":"ja/spec/18-stdlib-websocket/#_4","title":"\u30c6\u30ad\u30b9\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8","text":"<pre><code>{:type \"message\" :data \"\u53d7\u4fe1\u3057\u305f\u30c6\u30ad\u30b9\u30c8\"}\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#_5","title":"\u30d0\u30a4\u30ca\u30ea\u30e1\u30c3\u30bb\u30fc\u30b8","text":"<pre><code>{:type \"binary\" :data \"base64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30c7\u30fc\u30bf\"}\n</code></pre> <p>\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u306fbase64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u6587\u5b57\u5217\u3068\u3057\u3066\u8fd4\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#_6","title":"\u30af\u30ed\u30fc\u30ba\u30e1\u30c3\u30bb\u30fc\u30b8","text":"<pre><code>{:type \"close\" :code 1000 :reason \"Normal closure\"}\n</code></pre> <p>\u30b5\u30fc\u30d0\u30fc\u304c\u63a5\u7d9a\u3092\u30af\u30ed\u30fc\u30ba\u3057\u305f\u5834\u5408\u306b\u53d7\u4fe1\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#_7","title":"\u30a8\u30e9\u30fc","text":"<pre><code>{:type \"error\" :error \"\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\"}\n</code></pre> <p>\u901a\u4fe1\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306b\u53d7\u4fe1\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#183","title":"18.3 \u5b9f\u7528\u7684\u306a\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"ja/spec/18-stdlib-websocket/#_8","title":"\u30c1\u30e3\u30c3\u30c8\u30af\u30e9\u30a4\u30a2\u30f3\u30c8","text":"<pre><code>(defn chat-client [url username]\n  (let [conn (ws/connect url)]\n    (if (error? conn)\n      (println f\"\u63a5\u7d9a\u30a8\u30e9\u30fc: {conn}\")\n      (do\n        ;; \u53c2\u52a0\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\n        (ws/send conn (json/stringify {:type \"join\" :user username}))\n\n        ;; \u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\u30eb\u30fc\u30d7\n        (loop []\n          (let [msg (ws/receive conn)]\n            (match (get msg :type)\n              \"message\" -&gt;\n                (do\n                  (let [data (json/parse (get msg :data))]\n                    (println f\"{(get data \\\"user\\\")}: {(get data \\\"msg\\\")}\"))\n                  (recur))\n              \"close\" -&gt; (println \"\u63a5\u7d9a\u304c\u5207\u65ad\u3055\u308c\u307e\u3057\u305f\")\n              \"error\" -&gt; (println f\"\u30a8\u30e9\u30fc: {(get msg :error)}\")\n              _ -&gt; (recur))))\n\n        (ws/close conn)))))\n\n;; \u4f7f\u7528\u4f8b\n(chat-client \"ws://localhost:8080/chat\" \"Alice\")\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#json","title":"JSON\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u53d7\u4fe1","text":"<pre><code>;; JSON\u9001\u4fe1\u30d8\u30eb\u30d1\u30fc\n(defn send-json [conn data]\n  (ws/send conn (json/stringify data)))\n\n;; JSON\u53d7\u4fe1\u30d8\u30eb\u30d1\u30fc\n(defn receive-json [conn]\n  (let [response (ws/receive conn)]\n    (match (get response :type)\n      \"message\" -&gt; {:ok (json/parse (get response :data))}\n      _ -&gt; {:error response})))\n\n;; \u4f7f\u7528\u4f8b\n(def conn (ws/connect \"ws://localhost:8080/api\"))\n(send-json conn {:action \"subscribe\" :channel \"news\"})\n(def msg (receive-json conn))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#_9","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>(defn safe-ws-connect [url max-retries]\n  (loop [retries 0]\n    (let [conn (try (ws/connect url))]\n      (if (error? conn)\n        (if (&lt; retries max-retries)\n          (do\n            (println f\"\u63a5\u7d9a\u5931\u6557\u3002\u30ea\u30c8\u30e9\u30a4 {(+ retries 1)}/{max-retries}\")\n            (recur (+ retries 1)))\n          (do\n            (println \"\u6700\u5927\u30ea\u30c8\u30e9\u30a4\u56de\u6570\u306b\u9054\u3057\u307e\u3057\u305f\")\n            nil))\n        conn))))\n\n;; \u4f7f\u7528\u4f8b\n(def conn (safe-ws-connect \"ws://localhost:8080\" 3))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#_10","title":"\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53d7\u4fe1","text":"<p>WebSocket\u306f\u6a19\u6e96\u3067\u306f\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u3067\u3059\u304c\u3001goroutine\u3068channel\u3092\u4f7f\u3063\u3066\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u5b9f\u88c5\u3067\u304d\u307e\u3059\uff1a</p> <pre><code>(defn ws-receive-timeout [conn timeout-ms]\n  (let [ch (go/chan)\n        timeout-ch (go/timeout timeout-ms)]\n    ;; \u53d7\u4fe1\u3092goroutine\u3067\u5b9f\u884c\n    (go\n      (let [msg (ws/receive conn)]\n        (go/send ch msg)))\n    ;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u307e\u305f\u306f\u53d7\u4fe1\u3092\u5f85\u3064\n    (go/select\n      ch -&gt; (go/recv ch)\n      timeout-ch -&gt; {:error \"timeout\"})))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#184","title":"18.4 \u63a5\u7d9a\u7ba1\u7406","text":""},{"location":"ja/spec/18-stdlib-websocket/#_11","title":"\u8907\u6570\u63a5\u7d9a\u306e\u7ba1\u7406","text":"<p>\u63a5\u7d9aID\u306f\u6574\u6570\u306a\u306e\u3067\u3001\u30de\u30c3\u30d7\u3067\u8907\u6570\u306e\u63a5\u7d9a\u3092\u7ba1\u7406\u3067\u304d\u307e\u3059\uff1a</p> <pre><code>(def connections (atom {}))\n\n(defn add-connection [name url]\n  (let [conn (ws/connect url)]\n    (if (not (error? conn))\n      (do\n        (swap! connections assoc name conn)\n        {:ok conn})\n      {:error conn})))\n\n(defn send-to [name message]\n  (if-let [conn (get @connections name)]\n    (ws/send conn message)\n    (println f\"\u63a5\u7d9a {name} \u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\")))\n\n;; \u4f7f\u7528\u4f8b\n(add-connection :server1 \"ws://server1.com/ws\")\n(add-connection :server2 \"ws://server2.com/ws\")\n(send-to :server1 \"Hello from server1\")\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#185","title":"18.5 \u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u5b9f\u88c5","text":"<p>\u73fe\u5728\u3001Qi\u306fWebSocket\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u6a5f\u80fd\u306e\u307f\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306eWebSocket\u6a5f\u80fd\u306f\u5c06\u6765\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u8ffd\u52a0\u4e88\u5b9a\u3067\u3059\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#186","title":"18.6 \u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9","text":""},{"location":"ja/spec/18-stdlib-websocket/#wsconnect","title":"ws/connect","text":"<pre><code>(ws/connect url) ;=&gt; connection-id\n</code></pre> <p>WebSocket\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002</p> <ul> <li>\u5f15\u6570: <code>url</code> - WebSocket URL\uff08ws://\u307e\u305f\u306fwss://\uff09</li> <li>\u623b\u308a\u5024: \u63a5\u7d9aID\uff08Integer\uff09</li> <li>\u30a8\u30e9\u30fc: \u63a5\u7d9a\u5931\u6557\u6642\u306f\u30a8\u30e9\u30fc\u6587\u5b57\u5217</li> </ul> <p>\u4f8b: <pre><code>(def conn (ws/connect \"wss://echo.websocket.org\"))\n</code></pre></p>"},{"location":"ja/spec/18-stdlib-websocket/#wssend","title":"ws/send","text":"<pre><code>(ws/send conn-id message) ;=&gt; nil\n</code></pre> <p>WebSocket\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002</p> <ul> <li>\u5f15\u6570:</li> <li><code>conn-id</code> - \u63a5\u7d9aID</li> <li><code>message</code> - \u9001\u4fe1\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u6587\u5b57\u5217\uff09</li> <li>\u623b\u308a\u5024: nil</li> <li>\u30a8\u30e9\u30fc: \u9001\u4fe1\u5931\u6557\u6642\u306f\u30a8\u30e9\u30fc\u3092\u6295\u3052\u308b</li> </ul> <p>\u4f8b: <pre><code>(ws/send conn \"Hello, WebSocket!\")\n</code></pre></p>"},{"location":"ja/spec/18-stdlib-websocket/#wsreceive","title":"ws/receive","text":"<pre><code>(ws/receive conn-id) ;=&gt; message-map\n</code></pre> <p>WebSocket\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3057\u307e\u3059\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5c4a\u304f\u307e\u3067\u30d6\u30ed\u30c3\u30af\u3057\u307e\u3059\u3002</p> <ul> <li>\u5f15\u6570: <code>conn-id</code> - \u63a5\u7d9aID</li> <li>\u623b\u308a\u5024: \u30e1\u30c3\u30bb\u30fc\u30b8\u30de\u30c3\u30d7\uff08<code>:type</code>, <code>:data</code>, <code>:code</code>, <code>:reason</code>, <code>:error</code>\uff09</li> <li>\u30a8\u30e9\u30fc: \u53d7\u4fe1\u5931\u6557\u6642\u306f\u30a8\u30e9\u30fc\u3092\u6295\u3052\u308b</li> </ul> <p>\u4f8b: <pre><code>(def msg (ws/receive conn))\n(println (get msg :type)) ;=&gt; \"message\"\n</code></pre></p>"},{"location":"ja/spec/18-stdlib-websocket/#wsclose","title":"ws/close","text":"<pre><code>(ws/close conn-id) ;=&gt; nil\n</code></pre> <p>WebSocket\u63a5\u7d9a\u3092\u30af\u30ed\u30fc\u30ba\u3057\u307e\u3059\u3002</p> <ul> <li>\u5f15\u6570: <code>conn-id</code> - \u63a5\u7d9aID</li> <li>\u623b\u308a\u5024: nil</li> <li>\u30a8\u30e9\u30fc: \u30af\u30ed\u30fc\u30ba\u5931\u6557\u6642\u306f\u30a8\u30e9\u30fc\u3092\u6295\u3052\u308b</li> </ul> <p>\u4f8b: <pre><code>(ws/close conn)\n</code></pre></p>"},{"location":"ja/spec/18-stdlib-websocket/#187","title":"18.7 \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/spec/18-stdlib-websocket/#1","title":"1. \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>WebSocket\u63a5\u7d9a\u306f\u4e0d\u5b89\u5b9a\u306b\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u3001\u9069\u5207\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\uff1a</p> <pre><code>(defn handle-ws-message [conn]\n  (try\n    (let [msg (ws/receive conn)]\n      (match (get msg :type)\n        \"message\" -&gt; (process-message msg)\n        \"error\" -&gt; (log-error msg)\n        \"close\" -&gt; (reconnect)))\n    |&gt;? (fn [result]\n          (if (error? result)\n            (handle-error result)\n            result))))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#2","title":"2. \u518d\u63a5\u7d9a\u30ed\u30b8\u30c3\u30af","text":"<p>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u554f\u984c\u3067\u63a5\u7d9a\u304c\u5207\u308c\u305f\u5834\u5408\u3001\u81ea\u52d5\u7684\u306b\u518d\u63a5\u7d9a\u3059\u308b\u4ed5\u7d44\u307f\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\uff1a</p> <pre><code>(defn auto-reconnect [url]\n  (loop [delay 1000]\n    (let [conn (try (ws/connect url))]\n      (if (error? conn)\n        (do\n          (println f\"\u518d\u63a5\u7d9a\u3092 {delay}ms \u5f8c\u306b\u8a66\u884c...\")\n          (go/sleep delay)\n          (recur (min (* delay 2) 30000))) ;; exponential backoff\n        conn))))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#3","title":"3. \u30ea\u30bd\u30fc\u30b9\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7","text":"<p>\u4f7f\u7528\u5f8c\u306f\u5fc5\u305a\u63a5\u7d9a\u3092\u30af\u30ed\u30fc\u30ba\u3057\u3066\u304f\u3060\u3055\u3044\uff1a</p> <pre><code>(defn with-websocket [url f]\n  (let [conn (ws/connect url)]\n    (if (error? conn)\n      {:error conn}\n      (try\n        (f conn)\n        |&gt; (fn [result]\n             (ws/close conn)\n             result)))))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#188","title":"18.8 \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3","text":""},{"location":"ja/spec/18-stdlib-websocket/#tlsssl","title":"TLS/SSL","text":"<p>\u6a5f\u5bc6\u60c5\u5831\u3092\u6271\u3046\u5834\u5408\u306f\u3001\u5fc5\u305a<code>wss://</code>\uff08WebSocket Secure\uff09\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\uff1a</p> <pre><code>;; \u2705 \u826f\u3044\u4f8b\n(ws/connect \"wss://api.example.com/secure\")\n\n;; \u274c \u60aa\u3044\u4f8b\uff08\u6a5f\u5bc6\u60c5\u5831\u3092\u6271\u3046\u5834\u5408\uff09\n(ws/connect \"ws://api.example.com/secure\")\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#_12","title":"\u8a8d\u8a3c","text":"<p>WebSocket\u63a5\u7d9a\u6642\u306b\u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3\u3092\u542b\u3081\u308b\u5834\u5408\u306f\u3001URL\u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u307e\u305f\u306f\u6700\u521d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u9001\u4fe1\u3057\u307e\u3059\uff1a</p> <pre><code>;; URL\u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u8a8d\u8a3c\n(def conn (ws/connect f\"wss://api.example.com/ws?token={token}\"))\n\n;; \u6700\u521d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u8a8d\u8a3c\n(def conn (ws/connect \"wss://api.example.com/ws\"))\n(ws/send conn (json/stringify {:type \"auth\" :token token}))\n</code></pre>"},{"location":"ja/spec/18-stdlib-websocket/#189","title":"18.9 \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9","text":""},{"location":"ja/spec/18-stdlib-websocket/#pingpong","title":"Ping/Pong\u306e\u81ea\u52d5\u51e6\u7406","text":"<p>Qi\u306eWebSocket\u5b9f\u88c5\u306f\u3001Ping/Pong\u30d5\u30ec\u30fc\u30e0\u3092\u81ea\u52d5\u7684\u306b\u51e6\u7406\u3057\u307e\u3059\u3002\u30e6\u30fc\u30b6\u30fc\u306f\u7279\u5225\u306a\u5bfe\u5fdc\u3092\u884c\u3046\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#_13","title":"\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf","text":"<p>\u30d0\u30a4\u30ca\u30ea\u30e1\u30c3\u30bb\u30fc\u30b8\u306fbase64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u3066\u8fd4\u3055\u308c\u307e\u3059\u3002\u5927\u91cf\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u6271\u3046\u5834\u5408\u306f\u3001\u30a8\u30f3\u30b3\u30fc\u30c9/\u30c7\u30b3\u30fc\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/spec/18-stdlib-websocket/#_14","title":"\u307e\u3068\u3081","text":"<p>Qi\u306eWebSocket\u6a5f\u80fd\u306b\u3088\u308a\u3001\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u901a\u4fe1\u304c\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u307e\u3059\uff1a</p> <ul> <li><code>ws/connect</code> - \u63a5\u7d9a\u306e\u78ba\u7acb</li> <li><code>ws/send</code> - \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1</li> <li><code>ws/receive</code> - \u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\uff08\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\uff09</li> <li><code>ws/close</code> - \u63a5\u7d9a\u306e\u30af\u30ed\u30fc\u30ba</li> </ul> <p>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068\u518d\u63a5\u7d9a\u30ed\u30b8\u30c3\u30af\u3092\u9069\u5207\u306b\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3067\u3001\u5b89\u5b9a\u3057\u305f\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/19-stdlib-validation/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\uff1a\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u30b9\u30ad\u30fc\u30de\u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u691c\u8a3c</p>"},{"location":"ja/spec/19-stdlib-validation/#_2","title":"\u6982\u8981","text":"<p>Qi\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u6a5f\u80fd\u306f\u3001\u30b9\u30ad\u30fc\u30de\uff08\u30de\u30c3\u30d7\uff09\u306b\u57fa\u3065\u3044\u3066\u30c7\u30fc\u30bf\u3092\u691c\u8a3c\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001API\u30ea\u30af\u30a8\u30b9\u30c8\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3001\u30e6\u30fc\u30b6\u30fc\u5165\u529b\u306a\u3069\u306e\u30c7\u30fc\u30bf\u691c\u8a3c\u3092\u5ba3\u8a00\u7684\u306b\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/19-stdlib-validation/#_3","title":"\u4e3b\u306a\u7279\u5fb4","text":"<ul> <li>\u30b9\u30ad\u30fc\u30de\u30d9\u30fc\u30b9: \u30de\u30c3\u30d7\u3067\u30b9\u30ad\u30fc\u30de\u3092\u5b9a\u7fa9</li> <li>Railway Oriented Programming: \u30a8\u30e9\u30fc\u3092\u5024\u3068\u3057\u3066\u8fd4\u3059\uff08<code>{:ok value}</code> \u307e\u305f\u306f <code>{:error ...}</code>\uff09</li> <li>\u578b\u5b89\u5168: \u8907\u6570\u306e\u578b\uff08string, integer, number, boolean, map, vector, list, keyword, symbol, nil, any\uff09\u3092\u30b5\u30dd\u30fc\u30c8</li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u30c7\u30fc\u30bf\u5bfe\u5fdc: \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u3084\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u691c\u8a3c\u304c\u53ef\u80fd</li> <li>\u8a73\u7d30\u306a\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8: \u30a8\u30e9\u30fc\u30b3\u30fc\u30c9\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u542b\u3080</li> </ul>"},{"location":"ja/spec/19-stdlib-validation/#_4","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":""},{"location":"ja/spec/19-stdlib-validation/#_5","title":"\u578b\u30c1\u30a7\u30c3\u30af","text":"<pre><code>;; \u6587\u5b57\u5217\u578b\u306e\u30c1\u30a7\u30c3\u30af\n(def schema {:type \"string\"})\n(validate schema \"hello\")  ;; =&gt; {:ok \"hello\"}\n(validate schema 123)      ;; =&gt; {:error {:code \"type-mismatch\" :message \"string\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n\n;; \u6574\u6570\u578b\u306e\u30c1\u30a7\u30c3\u30af\n(def schema {:type \"integer\"})\n(validate schema 42)    ;; =&gt; {:ok 42}\n(validate schema 3.14)  ;; =&gt; {:error {:code \"type-mismatch\" :message \"integer\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_6","title":"\u5fc5\u9808\u30d5\u30a3\u30fc\u30eb\u30c9\u30c1\u30a7\u30c3\u30af","text":"<pre><code>(def schema {:type \"string\" :required true})\n(validate schema \"test\")  ;; =&gt; {:ok \"test\"}\n(validate schema nil)     ;; =&gt; {:error {:code \"required\" :message \"\u5fc5\u9808\u30d5\u30a3\u30fc\u30eb\u30c9\u3067\u3059\"}}\n\n;; \u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n(def schema {:type \"string\"})\n(validate schema nil)  ;; =&gt; {:ok nil}  ;; \u6210\u529f\uff08\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\uff09\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_7","title":"\u6587\u5b57\u5217\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":""},{"location":"ja/spec/19-stdlib-validation/#_8","title":"\u9577\u3055\u30c1\u30a7\u30c3\u30af","text":"<pre><code>(def username-schema\n  {:type \"string\"\n   :min-length 3\n   :max-length 20})\n\n(validate username-schema \"user123\")     ;; =&gt; {:ok \"user123\"}\n(validate username-schema \"ab\")          ;; =&gt; {:error {:code \"min-length\" :message \"3\u6587\u5b57\u4ee5\u4e0a\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n(validate username-schema \"verylongusernamethatexceedslimit\")\n  ;; =&gt; {:error {:code \"max-length\" :message \"20\u6587\u5b57\u4ee5\u4e0b\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_9","title":"\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff08\u6b63\u898f\u8868\u73fe\uff09","text":"<pre><code>;; \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u691c\u8a3c\n(def email-schema\n  {:type \"string\"\n   :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"})\n\n(validate email-schema \"user@example.com\")  ;; =&gt; {:ok \"user@example.com\"}\n(validate email-schema \"invalid-email\")     ;; =&gt; {:error {:code \"pattern\" :message \"\u30d1\u30bf\u30fc\u30f3\u306b\u4e00\u81f4\u3057\u307e\u305b\u3093: ...\"}}\n\n;; \u82f1\u5c0f\u6587\u5b57\u306e\u307f\n(def lowercase-schema\n  {:type \"string\"\n   :pattern \"^[a-z]+$\"})\n\n(validate lowercase-schema \"hello\")    ;; =&gt; {:ok \"hello\"}\n(validate lowercase-schema \"Hello123\") ;; =&gt; {:error {:code \"pattern\" ...}}\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_10","title":"\u6570\u5024\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":""},{"location":"ja/spec/19-stdlib-validation/#_11","title":"\u7bc4\u56f2\u30c1\u30a7\u30c3\u30af","text":"<pre><code>(def age-schema\n  {:type \"integer\"\n   :min 0\n   :max 150})\n\n(validate age-schema 25)   ;; =&gt; {:ok 25}\n(validate age-schema -5)   ;; =&gt; {:error {:code \"min-value\" :message \"0\u4ee5\u4e0a\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n(validate age-schema 200)  ;; =&gt; {:error {:code \"max-value\" :message \"150\u4ee5\u4e0b\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_12","title":"\u6b63\u306e\u6570\u30c1\u30a7\u30c3\u30af","text":"<pre><code>(def price-schema\n  {:type \"number\"\n   :positive true})\n\n(validate price-schema 100.0)  ;; =&gt; {:ok 100.0}\n(validate price-schema 0)      ;; =&gt; {:error {:code \"positive\" :message \"\u6b63\u306e\u6570\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n(validate price-schema -10.5)  ;; =&gt; {:error {:code \"positive\" ...}}\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_13","title":"\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":""},{"location":"ja/spec/19-stdlib-validation/#_14","title":"\u8981\u7d20\u6570\u30c1\u30a7\u30c3\u30af","text":"<pre><code>(def tags-schema\n  {:type \"vector\"\n   :min-items 1\n   :max-items 5})\n\n(validate tags-schema [\"tag1\" \"tag2\" \"tag3\"])  ;; =&gt; {:ok [\"tag1\" \"tag2\" \"tag3\"]}\n(validate tags-schema [])                      ;; =&gt; {:error {:code \"min-items\" :message \"1\u500b\u4ee5\u4e0a\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n(validate tags-schema [\"a\" \"b\" \"c\" \"d\" \"e\" \"f\"])\n  ;; =&gt; {:error {:code \"max-items\" :message \"5\u500b\u4ee5\u4e0b\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_15","title":"\u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p><code>:fields</code> \u3092\u4f7f\u3063\u3066\u3001\u30de\u30c3\u30d7\u5185\u306e\u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30b9\u30ad\u30fc\u30de\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002</p> <pre><code>(def user-schema\n  {:type \"map\"\n   :fields {:name {:type \"string\" :required true :min-length 1}\n            :age {:type \"integer\" :min 0 :max 150}\n            :email {:type \"string\" :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"}}})\n\n;; \u6b63\u5e38\u306a\u30c7\u30fc\u30bf\n(validate user-schema\n  {:name \"\u592a\u90ce\" :age 25 :email \"taro@example.com\"})\n;; =&gt; {:ok {:name \"\u592a\u90ce\" :age 25 :email \"taro@example.com\"}}\n\n;; \u7a7a\u306e\u540d\u524d\uff08min-length\u30a8\u30e9\u30fc\uff09\n(validate user-schema {:name \"\" :age 25})\n;; =&gt; {:error {:field \":name\" :code \"min-length\" :message \"1\u6587\u5b57\u4ee5\u4e0a\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n\n;; \u540d\u524d\u304c\u6b20\u843d\uff08required\u30a8\u30e9\u30fc\uff09\n(validate user-schema {:age 25})\n;; =&gt; {:error {:field \":name\" :code \"required\" :message \"\u5fc5\u9808\u30d5\u30a3\u30fc\u30eb\u30c9\u3067\u3059\"}}\n\n;; \u5e74\u9f62\u304c\u7bc4\u56f2\u5916\n(validate user-schema {:name \"\u592a\u90ce\" :age 200})\n;; =&gt; {:error {:field \":age\" :code \"max-value\" :message \"150\u4ee5\u4e0b\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\"}}\n\n;; \u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\uff08email\uff09\u306f\u7701\u7565\u53ef\u80fd\n(validate user-schema {:name \"\u592a\u90ce\"})\n;; =&gt; {:ok {:name \"\u592a\u90ce\"}}  ;; age, email\u306fnil\uff08\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\uff09\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_16","title":"\u8907\u96d1\u306a\u30b9\u30ad\u30fc\u30de\u4f8b","text":""},{"location":"ja/spec/19-stdlib-validation/#_17","title":"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u30d5\u30a9\u30fc\u30e0","text":"<pre><code>(def signup-schema\n  {:type \"map\"\n   :fields {:username {:type \"string\" :required true :min-length 3 :max-length 20}\n            :password {:type \"string\" :required true :min-length 8}\n            :email {:type \"string\" :required true :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"}\n            :age {:type \"integer\" :min 13 :max 150}\n            :bio {:type \"string\" :max-length 500}}})\n\n(validate signup-schema\n  {:username \"newuser\"\n   :password \"securepass123\"\n   :email \"user@example.com\"\n   :age 25})\n;; =&gt; {:ok {...}}\n\n(validate signup-schema\n  {:username \"ab\"        ;; \u77ed\u3059\u304e\u308b\n   :password \"short\"     ;; \u77ed\u3059\u304e\u308b\n   :email \"invalid\"})    ;; \u30d1\u30bf\u30fc\u30f3\u4e0d\u4e00\u81f4\n;; =&gt; {:error {:field \":username\" :code \"min-length\" ...}}  ;; \u6700\u521d\u306e\u30a8\u30e9\u30fc\u3092\u8fd4\u3059\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_18","title":"\u30b9\u30ad\u30fc\u30de\u30aa\u30d7\u30b7\u30e7\u30f3\u4e00\u89a7","text":""},{"location":"ja/spec/19-stdlib-validation/#_19","title":"\u5171\u901a\u30aa\u30d7\u30b7\u30e7\u30f3","text":"\u30aa\u30d7\u30b7\u30e7\u30f3 \u578b \u8aac\u660e <code>:type</code> string \u30c7\u30fc\u30bf\u578b: <code>\"string\"</code>, <code>\"integer\"</code>, <code>\"number\"</code>, <code>\"boolean\"</code>, <code>\"map\"</code>, <code>\"vector\"</code>, <code>\"list\"</code>, <code>\"keyword\"</code>, <code>\"symbol\"</code>, <code>\"nil\"</code>, <code>\"any\"</code> <code>:required</code> bool \u5fc5\u9808\u30d5\u30a3\u30fc\u30eb\u30c9\u304b\u3069\u3046\u304b\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: <code>false</code>\uff09"},{"location":"ja/spec/19-stdlib-validation/#_20","title":"\u6587\u5b57\u5217\u5c02\u7528","text":"\u30aa\u30d7\u30b7\u30e7\u30f3 \u578b \u8aac\u660e <code>:min-length</code> integer \u6700\u5c0f\u6587\u5b57\u6570 <code>:max-length</code> integer \u6700\u5927\u6587\u5b57\u6570 <code>:pattern</code> string \u6b63\u898f\u8868\u73fe\u30d1\u30bf\u30fc\u30f3"},{"location":"ja/spec/19-stdlib-validation/#_21","title":"\u6570\u5024\u5c02\u7528","text":"\u30aa\u30d7\u30b7\u30e7\u30f3 \u578b \u8aac\u660e <code>:min</code> integer/float \u6700\u5c0f\u5024 <code>:max</code> integer/float \u6700\u5927\u5024 <code>:positive</code> bool \u6b63\u306e\u6570\u304b\u3069\u3046\u304b\uff080\u3088\u308a\u5927\u304d\u3044\uff09 <code>:integer</code> bool \u6574\u6570\u304b\u3069\u3046\u304b\uff08float\u306e\u5834\u5408\uff09"},{"location":"ja/spec/19-stdlib-validation/#_22","title":"\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u5c02\u7528","text":"\u30aa\u30d7\u30b7\u30e7\u30f3 \u578b \u8aac\u660e <code>:min-items</code> integer \u6700\u5c0f\u8981\u7d20\u6570 <code>:max-items</code> integer \u6700\u5927\u8981\u7d20\u6570"},{"location":"ja/spec/19-stdlib-validation/#_23","title":"\u30de\u30c3\u30d7\u5c02\u7528","text":"\u30aa\u30d7\u30b7\u30e7\u30f3 \u578b \u8aac\u660e <code>:fields</code> map \u30cd\u30b9\u30c8\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u30b9\u30ad\u30fc\u30de\uff08\u30de\u30c3\u30d7\uff09"},{"location":"ja/spec/19-stdlib-validation/#_24","title":"\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9\u4e00\u89a7","text":"\u30b3\u30fc\u30c9 \u8aac\u660e <code>type-mismatch</code> \u578b\u304c\u4e00\u81f4\u3057\u306a\u3044 <code>required</code> \u5fc5\u9808\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u6b20\u843d <code>min-length</code> \u6587\u5b57\u5217\u304c\u77ed\u3059\u304e\u308b <code>max-length</code> \u6587\u5b57\u5217\u304c\u9577\u3059\u304e\u308b <code>pattern</code> \u30d1\u30bf\u30fc\u30f3\u306b\u4e00\u81f4\u3057\u306a\u3044 <code>min-value</code> \u6570\u5024\u304c\u5c0f\u3055\u3059\u304e\u308b <code>max-value</code> \u6570\u5024\u304c\u5927\u304d\u3059\u304e\u308b <code>positive</code> \u6b63\u306e\u6570\u3067\u306a\u3044 <code>min-items</code> \u8981\u7d20\u6570\u304c\u5c11\u306a\u3059\u304e\u308b <code>max-items</code> \u8981\u7d20\u6570\u304c\u591a\u3059\u304e\u308b"},{"location":"ja/spec/19-stdlib-validation/#http","title":"\u4f7f\u7528\u4f8b\uff1aHTTP\u30b5\u30fc\u30d0\u30fc\u3067\u306e\u691c\u8a3c","text":"<pre><code>(def user-create-schema\n  {:type \"map\"\n   :fields {:name {:type \"string\" :required true :min-length 1}\n            :email {:type \"string\" :required true :pattern \"^[^@]+@[^@]+\\\\.[^@]+$\"}}})\n\n(server/start 8080\n  (fn [req]\n    (def result (validate user-create-schema (get req :body)))\n    (match result\n      {:ok data}     (server/json {:status \"ok\" :user data})\n      {:error error} (server/json {:status \"error\" :error error} :status 400))))\n</code></pre>"},{"location":"ja/spec/19-stdlib-validation/#_25","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u30aa\u30d7\u30b7\u30e7\u30ca\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9: <code>:required</code> \u304c <code>false</code> \u307e\u305f\u306f\u672a\u6307\u5b9a\u306e\u5834\u5408\u3001\u30c7\u30fc\u30bf\u304c <code>nil</code> \u3067\u3082\u691c\u8a3c\u306f\u6210\u529f\u3057\u307e\u3059</li> <li>:type \"any\": \u4efb\u610f\u306e\u578b\u3092\u53d7\u3051\u5165\u308c\u307e\u3059\uff08\u578b\u30c1\u30a7\u30c3\u30af\u306a\u3057\uff09</li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7: \u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306f <code>:field</code> \u306b\u542b\u307e\u308c\u307e\u3059\uff08\u4f8b: <code>\":name\"</code>, <code>\":address:city\"</code>\uff09</li> <li>\u6b63\u898f\u8868\u73fe: ripgrep \u306e\u69cb\u6587\u306b\u5f93\u3044\u307e\u3059</li> </ul>"},{"location":"ja/spec/19-stdlib-validation/#_26","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>\u30a8\u30e9\u30fc\u51e6\u7406 - Railway Oriented Programming</li> <li>\u30c7\u30fc\u30bf\u69cb\u9020 - \u30de\u30c3\u30d7\u3068\u30ad\u30fc\u30ef\u30fc\u30c9</li> <li>HTTP\u30b5\u30fc\u30d0\u30fc - \u30b5\u30fc\u30d0\u30fc\u3067\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u6d3b\u7528</li> </ul>"},{"location":"ja/spec/20-stdlib-debug/","title":"\u30c7\u30d0\u30c3\u30b0\u6a5f\u80fd","text":"<p>Qi\u306f\u7d44\u307f\u8fbc\u307f\u306e\u30c7\u30d0\u30c3\u30b0\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u3066\u304a\u308a\u3001\u30c8\u30ec\u30fc\u30b9\u3001\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3001\u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9\u53d6\u5f97\u306a\u3069\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/20-stdlib-debug/#_2","title":"\u6982\u8981","text":"<p>\u30c7\u30d0\u30c3\u30b0\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a</p> <ul> <li>\u30c8\u30ec\u30fc\u30b9\u6a5f\u80fd - \u95a2\u6570\u306e\u547c\u3073\u51fa\u3057\u3068\u7d42\u4e86\u3092\u30ed\u30b0\u306b\u51fa\u529b</li> <li>\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8 - \u5b9f\u884c\u306e\u4e00\u6642\u505c\u6b62</li> <li>\u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9 - \u73fe\u5728\u306e\u30b3\u30fc\u30eb\u30b9\u30bf\u30c3\u30af\u306e\u53d6\u5f97</li> <li>\u30c7\u30d0\u30c3\u30ac\u60c5\u5831 - \u30c7\u30d0\u30c3\u30ac\u306e\u72b6\u614b\u78ba\u8a8d</li> </ul>"},{"location":"ja/spec/20-stdlib-debug/#_3","title":"\u30c7\u30d0\u30c3\u30b0\u95a2\u6570","text":""},{"location":"ja/spec/20-stdlib-debug/#debugtrace","title":"debug/trace","text":"<p>\u30c8\u30ec\u30fc\u30b9\u6a5f\u80fd\u3092\u6709\u52b9/\u7121\u52b9\u306b\u3057\u307e\u3059\u3002</p> <pre><code>(debug/trace enabled)\n</code></pre> <p>\u5f15\u6570: - <code>enabled</code> (boolean) - true=\u6709\u52b9, false=\u7121\u52b9</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>(defn fibonacci [n]\n  (if (&lt;= n 1)\n      n\n      (+ (fibonacci (- n 1)) (fibonacci (- n 2)))))\n\n(debug/trace true)\n(fibonacci 5)\n(debug/trace false)\n</code></pre> <p>\u51fa\u529b\u4f8b: <pre><code>[TRACE] -&gt; fibonacci (test.qi:1)\n[TRACE]   -&gt; fibonacci (test.qi:1)\n[TRACE]     -&gt; fibonacci (test.qi:1)\n[TRACE]     &lt;- fibonacci\n[TRACE]     -&gt; fibonacci (test.qi:1)\n[TRACE]     &lt;- fibonacci\n[TRACE]   &lt;- fibonacci\n[TRACE]   -&gt; fibonacci (test.qi:1)\n[TRACE]   &lt;- fibonacci\n[TRACE] &lt;- fibonacci\n</code></pre></p>"},{"location":"ja/spec/20-stdlib-debug/#debugbreak","title":"debug/break","text":"<p>\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u30c7\u30d0\u30c3\u30ac\u304c\u30a2\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u5b9f\u884c\u304c\u4e00\u6642\u505c\u6b62\u3057\u307e\u3059\u3002</p> <pre><code>(debug/break)\n</code></pre> <p>\u5f15\u6570: \u306a\u3057</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>(defn process-data [data]\n  (println \"Processing:\" data)\n  (debug/break)  ;; \u3053\u3053\u3067\u4e00\u6642\u505c\u6b62\n  (if (&gt; data 100)\n      \"Large\"\n      \"Small\"))\n\n(process-data 150)\n</code></pre>"},{"location":"ja/spec/20-stdlib-debug/#debugstack","title":"debug/stack","text":"<p>\u73fe\u5728\u306e\u30b3\u30fc\u30eb\u30b9\u30bf\u30c3\u30af\u3092\u6587\u5b57\u5217\u3068\u3057\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(debug/stack)\n</code></pre> <p>\u5f15\u6570: \u306a\u3057</p> <p>\u623b\u308a\u5024: string - \u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9</p> <p>\u4f8b:</p> <pre><code>(defn inner []\n  (debug/stack))\n\n(defn middle []\n  (inner))\n\n(defn outer []\n  (middle))\n\n(println (outer))\n</code></pre> <p>\u51fa\u529b\u4f8b: <pre><code>  #0 inner at test.qi:2\n  #1 middle at test.qi:5\n  #2 outer at test.qi:8\n</code></pre></p>"},{"location":"ja/spec/20-stdlib-debug/#debuginfo","title":"debug/info","text":"<p>\u30c7\u30d0\u30c3\u30ac\u306e\u73fe\u5728\u306e\u72b6\u614b\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(debug/info)\n</code></pre> <p>\u5f15\u6570: \u306a\u3057</p> <p>\u623b\u308a\u5024: map - \u30c7\u30d0\u30c3\u30b0\u60c5\u5831</p> <p>\u8fd4\u3055\u308c\u308b\u30de\u30c3\u30d7\u306e\u30ad\u30fc\uff1a - <code>:enabled</code> (boolean) - \u30c7\u30d0\u30c3\u30ac\u304c\u6709\u52b9\u304b\u3069\u3046\u304b - <code>:state</code> (string) - \u30c7\u30d0\u30c3\u30ac\u306e\u72b6\u614b\uff08\"Running\", \"Paused\", etc.\uff09 - <code>:stack-depth</code> (integer) - \u73fe\u5728\u306e\u30b9\u30bf\u30c3\u30af\u306e\u6df1\u3055</p> <p>\u4f8b:</p> <pre><code>(println (debug/info))\n;=&gt; {:enabled false}\n\n;; \u30c7\u30d0\u30c3\u30ac\u304c\u6709\u52b9\u306a\u5834\u5408\n;=&gt; {:enabled true :state \"Running\" :stack-depth 0}\n</code></pre>"},{"location":"ja/spec/20-stdlib-debug/#_4","title":"\u4f7f\u7528\u4f8b","text":""},{"location":"ja/spec/20-stdlib-debug/#_5","title":"\u30a8\u30e9\u30fc\u767a\u751f\u6642\u306e\u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9","text":"<pre><code>(defn error-handler []\n  (println \"Error occurred at:\")\n  (println (debug/stack)))\n\n(defn divide [a b]\n  (if (= b 0)\n      (error-handler)\n      (/ a b)))\n\n(divide 10 0)\n</code></pre>"},{"location":"ja/spec/20-stdlib-debug/#_6","title":"\u30c8\u30ec\u30fc\u30b9\u6a5f\u80fd\u3092\u4f7f\u3063\u305f\u30c7\u30d0\u30c3\u30b0","text":"<pre><code>(defn factorial [n]\n  (if (&lt;= n 1)\n      1\n      (* n (factorial (- n 1)))))\n\n(debug/trace true)\n(println \"Result:\" (factorial 5))\n(debug/trace false)\n</code></pre>"},{"location":"ja/spec/20-stdlib-debug/#_7","title":"\u6761\u4ef6\u4ed8\u304d\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8","text":"<pre><code>(defn process-batch [items]\n  (each (fn [item]\n          (when (&gt; item 1000)\n            (debug/break))  ;; \u5927\u304d\u306a\u5024\u306e\u6642\u3060\u3051\u505c\u6b62\n          (println \"Processing:\" item))\n        items))\n\n(process-batch [10 50 1200 5])\n</code></pre>"},{"location":"ja/spec/20-stdlib-debug/#vscode","title":"VSCode\u30c7\u30d0\u30c3\u30b0\u30b5\u30dd\u30fc\u30c8","text":"<p>Qi\u306fVSCode\u306e\u7d71\u5408\u30c7\u30d0\u30c3\u30ac\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ul> <li>\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u306eGUI\u3067\u306e\u8a2d\u5b9a</li> <li>\u30b9\u30c6\u30c3\u30d7\u5b9f\u884c\uff08Step In, Step Over, Step Out\uff09</li> <li>\u5909\u6570\u306e\u30a4\u30f3\u30b9\u30da\u30af\u30b7\u30e7\u30f3</li> <li>\u30a6\u30a9\u30c3\u30c1\u5f0f\u306e\u8a55\u4fa1</li> <li>\u30b3\u30fc\u30eb\u30b9\u30bf\u30c3\u30af\u306e\u30ca\u30d3\u30b2\u30fc\u30b7\u30e7\u30f3</li> </ul>"},{"location":"ja/spec/20-stdlib-debug/#_8","title":"\u30c7\u30d0\u30c3\u30ac\u306e\u6709\u52b9\u5316","text":"<p>\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30c7\u30d0\u30c3\u30ac\u3092\u6709\u52b9\u5316\u3067\u304d\u307e\u3059\uff1a</p> <pre><code># \u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\nqi --debug script.qi\n\n# DAP\u7d4c\u7531\u3067\u30a2\u30bf\u30c3\u30c1\u53ef\u80fd\uff08\u6307\u5b9a\u30dd\u30fc\u30c8\u3067\u30ea\u30c3\u30b9\u30f3\uff09\nqi --debug-port 5678 script.qi\n</code></pre>"},{"location":"ja/spec/20-stdlib-debug/#_9","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9","text":"<p>\u30c7\u30d0\u30c3\u30b0\u6a5f\u80fd\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u308b\u305f\u3081\u3001\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u74b0\u5883\u3067\u306f\u4f7f\u7528\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\uff1a</p> <ul> <li><code>debug/trace</code> \u3092\u6709\u52b9\u306b\u3059\u308b\u3068\u3001\u3059\u3079\u3066\u306e\u95a2\u6570\u547c\u3073\u51fa\u3057\u3067\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u308b\u305f\u3081\u3001\u5b9f\u884c\u901f\u5ea6\u304c\u5927\u5e45\u306b\u4f4e\u4e0b\u3057\u307e\u3059</li> <li><code>debug/break</code> \u3084 <code>debug/stack</code> \u306f\u6bd4\u8f03\u7684\u8efd\u91cf\u3067\u3059\u304c\u3001\u983b\u7e41\u306b\u547c\u3073\u51fa\u3059\u3079\u304d\u3067\u306f\u3042\u308a\u307e\u305b\u3093</li> <li><code>debug/info</code> \u306f\u8efd\u91cf\u3067\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3078\u306e\u5f71\u97ff\u306f\u307b\u3068\u3093\u3069\u3042\u308a\u307e\u305b\u3093</li> </ul>"},{"location":"ja/spec/20-stdlib-debug/#_10","title":"\u95a2\u9023\u9805\u76ee","text":"<ul> <li>\u30c6\u30b9\u30c8\u6a5f\u80fd - \u30c6\u30b9\u30c8\u3068\u30a2\u30b5\u30fc\u30b7\u30e7\u30f3</li> <li>\u30d7\u30ed\u30d5\u30a1\u30a4\u30ea\u30f3\u30b0 - \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6e2c\u5b9a</li> <li>\u30ed\u30b0\u6a5f\u80fd - \u69cb\u9020\u5316\u30ed\u30b0</li> </ul>"},{"location":"ja/spec/21-stdlib-table/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30c6\u30fc\u30d6\u30eb\u51e6\u7406\uff08table/\uff09","text":"<p>SQL/awk\u30e9\u30a4\u30af\u306a\u30c6\u30fc\u30d6\u30eb\u64cd\u4f5c\u30e9\u30a4\u30d6\u30e9\u30ea</p> <p><code>table</code> \u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3001CSV\u3001JSON\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u7d50\u679c\u306a\u3069\u306e\u8868\u5f62\u5f0f\u30c7\u30fc\u30bf\uff08list of maps\uff09\u3092\u6271\u3046\u305f\u3081\u306e\u4fbf\u5229\u306a\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u65e2\u5b58\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u95a2\u6570\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30b7\u30e5\u30ac\u30fc\u3068\u3057\u3066\u5b9f\u88c5\u3055\u308c\u3066\u304a\u308a\u3001SQL\u7684\u306a\u64cd\u4f5c\u3092\u7c21\u6f54\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/21-stdlib-table/#_1","title":"\u4f7f\u3044\u65b9","text":"<pre><code>(use \"table\" :as table)\n</code></pre>"},{"location":"ja/spec/21-stdlib-table/#_2","title":"\u30b0\u30eb\u30fc\u30d7\u5316","text":""},{"location":"ja/spec/21-stdlib-table/#tablegroup-by","title":"table/group-by","text":"<p>\u30c6\u30fc\u30d6\u30eb\u3092\u30ad\u30fc\u3067\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u307e\u3059\uff08SQL\u306e <code>GROUP BY</code> \u76f8\u5f53\uff09\u3002</p> <pre><code>;; \u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u30b0\u30eb\u30fc\u30d7\u5316\n(def products [\n  {:id 1 :name \"Laptop\" :category \"electronics\" :price 1000}\n  {:id 2 :name \"Mouse\" :category \"electronics\" :price 25}\n  {:id 3 :name \"Book\" :category \"books\" :price 15}])\n\n(table/group-by products :category)\n;=&gt; {\"electronics\" [{...}, {...}], \"books\" [{...}]}\n\n;; \u95a2\u6570\u3067\u30b0\u30eb\u30fc\u30d7\u5316\uff08\u30ab\u30b9\u30bf\u30e0\u30ed\u30b8\u30c3\u30af\uff09\n(table/group-by products\n  (fn [p]\n    (if (&lt; (get p :price) 50)\n      \"cheap\"\n      \"expensive\")))\n;=&gt; {\"cheap\" [{...}, {...}], \"expensive\" [{...}]}\n</code></pre> <p>\u5f15\u6570: - <code>table</code> - \u30c6\u30fc\u30d6\u30eb\u30c7\u30fc\u30bf\uff08list of maps or arrays\uff09 - <code>key-selector</code> - \u30ad\u30fc\u30ef\u30fc\u30c9\uff08<code>:category</code>\uff09\u307e\u305f\u306f\u95a2\u6570</p> <p>\u623b\u308a\u5024: <code>{group-key: [rows...], ...}</code> \u5f62\u5f0f\u306e\u30de\u30c3\u30d7</p> <p>\u5b9f\u88c5: <code>list/group-by</code> \u306e\u30e9\u30c3\u30d1\u30fc</p>"},{"location":"ja/spec/21-stdlib-table/#_3","title":"\u91cd\u8907\u9664\u53bb","text":""},{"location":"ja/spec/21-stdlib-table/#tabledistinct-table","title":"table/distinct-table","text":"<p>\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u91cd\u8907\u884c\u3092\u9664\u53bb\u3057\u307e\u3059\uff08SQL\u306e <code>DISTINCT</code> \u76f8\u5f53\uff09\u3002</p> <pre><code>(def products [\n  {:id 1 :name \"Laptop\" :category \"electronics\" :price 1000}\n  {:id 2 :name \"Mouse\" :category \"electronics\" :price 25}\n  {:id 3 :name \"Laptop\" :category \"electronics\" :price 1000}])  ;; \u91cd\u8907\n\n;; \u5168\u30ab\u30e9\u30e0\u3067\u91cd\u8907\u9664\u53bb\n(table/distinct-table products)\n;=&gt; 3\u884c \u2192 2\u884c\uff08\u5b8c\u5168\u306b\u4e00\u81f4\u3059\u308b\u884c\u3092\u9664\u53bb\uff09\n\n;; \u7279\u5b9a\u30ad\u30fc\u3067\u91cd\u8907\u9664\u53bb\n(table/distinct-table products :name :price)\n;=&gt; :name \u3068 :price \u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u91cd\u8907\u9664\u53bb\n</code></pre> <p>\u5f15\u6570: - <code>table</code> - \u30c6\u30fc\u30d6\u30eb\u30c7\u30fc\u30bf - <code>keys...</code> - \u6bd4\u8f03\u3059\u308b\u30ad\u30fc\uff08\u53ef\u5909\u9577\u5f15\u6570\u3001\u7701\u7565\u6642\u306f\u5168\u30ab\u30e9\u30e0\uff09</p> <p>\u623b\u308a\u5024: \u91cd\u8907\u9664\u53bb\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb</p>"},{"location":"ja/spec/21-stdlib-table/#_4","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/21-stdlib-table/#_5","title":"\u30ab\u30c6\u30b4\u30ea\u5225\u306e\u96c6\u8a08","text":"<pre><code>(use \"table\" :as table)\n\n(def sales-data [\n  {:date \"2024-01-01\" :category \"electronics\" :amount 1000}\n  {:date \"2024-01-01\" :category \"books\" :amount 200}\n  {:date \"2024-01-02\" :category \"electronics\" :amount 1500}\n  {:date \"2024-01-02\" :category \"books\" :amount 300}])\n\n;; \u30ab\u30c6\u30b4\u30ea\u5225\u306b\u30b0\u30eb\u30fc\u30d7\u5316\n(def by-category (table/group-by sales-data :category))\n;=&gt; {\"electronics\" [2 items], \"books\" [2 items]}\n\n;; \u5404\u30b0\u30eb\u30fc\u30d7\u306e\u96c6\u8a08\n(def electronics-items (get by-category \"String(\\\"electronics\\\")\"))\n(def total (reduce (fn [sum item] (+ sum (get item :amount))) 0 electronics-items))\n(println f\"Total: {total}\")\n;=&gt; Total: 2500\n</code></pre>"},{"location":"ja/spec/21-stdlib-table/#_6","title":"\u30c7\u30fc\u30bf\u30af\u30ea\u30fc\u30cb\u30f3\u30b0","text":"<pre><code>;; CSV\u304b\u3089\u30ed\u30fc\u30c9\u3057\u305f\u30c7\u30fc\u30bf\u306e\u91cd\u8907\u9664\u53bb\n(def raw-data (csv/read-file \"users.csv\"))\n(def cleaned (table/distinct-table raw-data :email))\n(println f\"\u91cd\u8907\u9664\u53bb: {(len raw-data)} \u2192 {(len cleaned)} \u4ef6\")\n</code></pre>"},{"location":"ja/spec/21-stdlib-table/#_7","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>(sales-data\n |&gt; (fn [data] (table/group-by data :date))\n |&gt; (fn [grouped] (println f\"\u65e5\u4ed8\u5225: {(len (keys grouped))} \u65e5\u5206\")))\n</code></pre>"},{"location":"ja/spec/21-stdlib-table/#_8","title":"\u3053\u3093\u306a\u6642\u306b\u4f7f\u3046","text":"<ol> <li> <p>CSV\u3084JSON\u304b\u3089\u30ed\u30fc\u30c9\u3057\u305f\u30c7\u30fc\u30bf\u306e\u96c6\u8a08 <pre><code>(def data (csv/read-file \"sales.csv\"))\n(table/group-by data :date)\n</code></pre></p> </li> <li> <p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u7d50\u679c\u306e\u5f8c\u51e6\u7406 <pre><code>(def results (db/query conn \"SELECT * FROM orders\"))\n(table/group-by results :customer_id)\n</code></pre></p> </li> <li> <p>\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u5206\u6790 <pre><code>(def logs (json/parse (io/read-file \"app.log\")))\n(table/group-by logs :level)  ;; ERROR, WARN, INFO \u3054\u3068\u306b\u96c6\u8a08\n</code></pre></p> </li> <li> <p>\u91cd\u8907\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30cb\u30f3\u30b0 <pre><code>(def cleaned (table/distinct-table data :email))\n</code></pre></p> </li> <li> <p>awk/SQL\u7684\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</p> </li> <li>SQL\u306e <code>GROUP BY</code> \u3084 <code>DISTINCT</code> \u3068\u540c\u69d8\u306e\u64cd\u4f5c\u3092Qi\u3067\u5b9f\u73fe</li> </ol>"},{"location":"ja/spec/21-stdlib-table/#_9","title":"\u95a2\u6570\u4e00\u89a7","text":"\u95a2\u6570 \u8aac\u660e SQL\u76f8\u5f53 <code>table/group-by</code> \u30ad\u30fc\u3067\u30b0\u30eb\u30fc\u30d7\u5316 <code>GROUP BY</code> <code>table/distinct-table</code> \u91cd\u8907\u9664\u53bb <code>DISTINCT</code>"},{"location":"ja/spec/21-stdlib-table/#_10","title":"\u53c2\u8003","text":"<ul> <li>\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9: <code>examples/23-table-processing.qi</code></li> <li>\u5b9f\u88c5: <code>std/lib/table.qi</code></li> <li>\u95a2\u9023\u95a2\u6570:</li> <li><code>list/group-by</code> - \u57fa\u5e95\u306e\u30b0\u30eb\u30fc\u30d7\u5316\u95a2\u6570</li> <li><code>distinct</code> - \u91cd\u8907\u9664\u53bb\uff08\u5168\u8981\u7d20\uff09</li> <li><code>filter</code> - \u6761\u4ef6\u30d5\u30a3\u30eb\u30bf\uff08SQL\u306e <code>WHERE</code> \u76f8\u5f53\uff09</li> <li><code>map</code> - \u5c04\u5f71\uff08SQL\u306e <code>SELECT</code> \u76f8\u5f53\uff09</li> <li><code>reduce</code> - \u96c6\u7d04\uff08SQL\u306e <code>SUM</code>, <code>AVG</code> \u76f8\u5f53\uff09</li> </ul>"},{"location":"ja/spec/21-stdlib-table/#_11","title":"\u4eca\u5f8c\u306e\u62e1\u5f35\u4e88\u5b9a","text":"<p>Phase 2 \u4ee5\u964d\u3067\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u691c\u8a0e\u4e2d\uff1a</p> <ul> <li><code>table/select</code> - \u30ab\u30e9\u30e0\u9078\u629e\uff08\u5c04\u5f71\uff09</li> <li><code>table/where</code> - \u6761\u4ef6\u30d5\u30a3\u30eb\u30bf</li> <li><code>table/order-by</code> - \u30bd\u30fc\u30c8</li> <li><code>table/join</code> - \u30c6\u30fc\u30d6\u30eb\u7d50\u5408</li> <li><code>table/aggregate</code> - \u96c6\u7d04\u95a2\u6570\uff08sum, avg, count\u7b49\uff09</li> <li><code>table/pivot</code> - \u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb</li> </ul> <p>\u73fe\u5728\u306e\u5b9f\u88c5\u306fPhase 1\u3068\u3057\u3066\u3001\u6700\u3082\u4f7f\u7528\u983b\u5ea6\u306e\u9ad8\u3044<code>group-by</code>\u3068<code>distinct-table</code>\u306e\u307f\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/22-stdlib-csv/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - CSV\u51e6\u7406\uff08csv/\uff09","text":"<p>RFC 4180\u6e96\u62e0\u306eCSV\u51e6\u7406\u30e9\u30a4\u30d6\u30e9\u30ea</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>csv/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/22-stdlib-csv/#_1","title":"\u30d1\u30fc\u30b9","text":""},{"location":"ja/spec/22-stdlib-csv/#csvparse","title":"csv/parse","text":"<p>CSV\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3057\u3066\u3001\u30ea\u30b9\u30c8\u306e\u30ea\u30b9\u30c8\u5f62\u5f0f\uff08<code>[[string]]</code>\uff09\u306b\u5909\u63db\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(def csv-text \"name,age,city\nAlice,30,Tokyo\nBob,25,Osaka\")\n\n(csv/parse csv-text)\n;=&gt; [[\"name\" \"age\" \"city\"]\n;    [\"Alice\" \"30\" \"Tokyo\"]\n;    [\"Bob\" \"25\" \"Osaka\"]]\n\n;; \u30ab\u30b9\u30bf\u30e0\u533a\u5207\u308a\u6587\u5b57\uff08TSV\uff09\n(def tsv-text \"name\\tage\\tcity\nAlice\\t30\\tTokyo\")\n\n(csv/parse tsv-text :delimiter \"\\t\")\n;=&gt; [[\"name\" \"age\" \"city\"]\n;    [\"Alice\" \"30\" \"Tokyo\"]]\n\n;; \u30af\u30a9\u30fc\u30c8\u3055\u308c\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\uff08RFC 4180\u6e96\u62e0\uff09\n(def quoted-csv \"name,description\n\\\"Alice, Bob\\\",\\\"She said \\\"\\\"hello\\\"\\\"\\\"\")\n\n(csv/parse quoted-csv)\n;=&gt; [[\"name\" \"description\"]\n;    [\"Alice, Bob\" \"She said \\\"hello\\\"\"]]\n</code></pre> <p>\u5f15\u6570: - <code>text</code> - CSV\u5f62\u5f0f\u306e\u6587\u5b57\u5217 - <code>:delimiter</code> - \u30aa\u30d7\u30b7\u30e7\u30f3\u3002\u533a\u5207\u308a\u6587\u5b57\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: <code>\",\"</code>\uff09\u3002\u5358\u4e00\u6587\u5b57\u306e\u307f</p> <p>\u623b\u308a\u5024: \u30ea\u30b9\u30c8\u306e\u30ea\u30b9\u30c8\uff08<code>[[string]]</code>\uff09</p> <p>RFC 4180\u6e96\u62e0\u6a5f\u80fd: - \u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u3067\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u56f2\u307f - \u30af\u30a9\u30fc\u30c8\u5185\u306e <code>\"\"</code> \u306b\u3088\u308b\u30a8\u30b9\u30b1\u30fc\u30d7 - CRLF / LF \u6539\u884c\u306e\u4e21\u5bfe\u5fdc - \u30af\u30a9\u30fc\u30c8\u5185\u306e\u6539\u884c\u3001\u30ab\u30f3\u30de\u3001\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u306e\u4fdd\u6301</p>"},{"location":"ja/spec/22-stdlib-csv/#_2","title":"\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba","text":""},{"location":"ja/spec/22-stdlib-csv/#csvstringify","title":"csv/stringify","text":"<p>\u30ea\u30b9\u30c8\u306e\u30ea\u30b9\u30c8\uff08\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\u306e\u30d9\u30af\u30bf\u30fc\uff09\u3092CSV\u6587\u5b57\u5217\u306b\u5909\u63db\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(def data [\n  [\"name\" \"age\" \"city\"]\n  [\"Alice\" 30 \"Tokyo\"]\n  [\"Bob\" 25 \"Osaka\"]])\n\n(csv/stringify data)\n;=&gt; \"name,age,city\n;    Alice,30,Tokyo\n;    Bob,25,Osaka\"\n\n;; \u69d8\u3005\u306a\u578b\u306b\u5bfe\u5fdc\n(def mixed-data [\n  [\"string\" \"number\" \"float\" \"bool\" \"nil\"]\n  [\"text\" 123 3.14 true nil]])\n\n(csv/stringify mixed-data)\n;=&gt; \"string,number,float,bool,nil\n;    text,123,3.14,true,\"\n\n;; \u7279\u6b8a\u6587\u5b57\u3092\u542b\u3080\u30d5\u30a3\u30fc\u30eb\u30c9\uff08\u81ea\u52d5\u30af\u30a9\u30fc\u30c8\uff09\n(def special-data [\n  [\"name\" \"description\"]\n  [\"Alice, Bob\" \"She said \\\"hello\\\"\"]])\n\n(csv/stringify special-data)\n;=&gt; \"name,description\n;    \\\"Alice, Bob\\\",\\\"She said \\\"\\\"hello\\\"\\\"\\\"\"\n</code></pre> <p>\u5f15\u6570: - <code>data</code> - \u30ea\u30b9\u30c8\u306e\u30ea\u30b9\u30c8\u3001\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\u306e\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: CSV\u5f62\u5f0f\u306e\u6587\u5b57\u5217</p> <p>\u5bfe\u5fdc\u3059\u308b\u578b: - <code>String</code> - \u305d\u306e\u307e\u307e\u51fa\u529b - <code>Integer</code> - \u6587\u5b57\u5217\u306b\u5909\u63db - <code>Float</code> - \u6587\u5b57\u5217\u306b\u5909\u63db - <code>Bool</code> - <code>\"true\"</code> / <code>\"false\"</code> - <code>Nil</code> - \u7a7a\u6587\u5b57\u5217</p> <p>\u81ea\u52d5\u30af\u30a9\u30fc\u30c8: \u4ee5\u4e0b\u3092\u542b\u3080\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u81ea\u52d5\u7684\u306b\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u3067\u56f2\u307e\u308c\u307e\u3059 - \u30ab\u30f3\u30de (<code>,</code>) - \u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8 (<code>\"</code>) - \u6539\u884c (<code>\\n</code>, <code>\\r</code>)</p>"},{"location":"ja/spec/22-stdlib-csv/#_3","title":"\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f","text":""},{"location":"ja/spec/22-stdlib-csv/#csvread-file","title":"csv/read-file","text":"<p>CSV\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u30d1\u30fc\u30b9\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30d5\u30a1\u30a4\u30eb\u304b\u3089\u8aad\u307f\u8fbc\u307f\n(def data (csv/read-file \"users.csv\"))\n\n;; \u30d8\u30c3\u30c0\u30fc\u3068\u30c7\u30fc\u30bf\u3092\u5206\u96e2\n(def headers (first data))\n(def rows (rest data))\n\n(println f\"\u30ab\u30e9\u30e0: {(join \\\", \\\" headers)}\")\n(println f\"\u884c\u6570: {(len rows)}\")\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - CSV\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: \u30ea\u30b9\u30c8\u306e\u30ea\u30b9\u30c8\uff08<code>[[string]]</code>\uff09</p> <p>\u30a8\u30e9\u30fc: \u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u306a\u3044\u3001\u307e\u305f\u306f\u8aad\u307f\u8fbc\u3081\u306a\u3044\u5834\u5408\u306f\u30a8\u30e9\u30fc</p>"},{"location":"ja/spec/22-stdlib-csv/#csvread-stream","title":"csv/read-stream","text":"<p>\u5927\u304d\u306aCSV\u30d5\u30a1\u30a4\u30eb\u3092\u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u3057\u3066\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306b1\u884c\u305a\u3064\u51e6\u7406\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u30b9\u30c8\u30ea\u30fc\u30e0\u3067\u51e6\u7406\n(def stream (csv/read-stream \"large-data.csv\"))\n\n;; \u30d8\u30c3\u30c0\u30fc\u3092\u30b9\u30ad\u30c3\u30d7\u3057\u3066\u51e6\u7406\n(def header (stream/next stream))\n(println f\"\u30ab\u30e9\u30e0: {(join \\\", \\\" header)}\")\n\n;; \u884c\u3054\u3068\u306b\u51e6\u7406\n(stream/for-each stream\n  (fn [row]\n    (println f\"\u51e6\u7406\u4e2d: {(first row)}\")))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u51e6\u7406\n(csv/read-stream \"sales.csv\")\n |&gt; (stream/drop 1)  ;; \u30d8\u30c3\u30c0\u30fc\u30b9\u30ad\u30c3\u30d7\n |&gt; (stream/filter (fn [row] (&gt; (parse-int (nth row 2)) 1000)))\n |&gt; (stream/take 10)\n |&gt; stream/to-list\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - CSV\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: \u30b9\u30c8\u30ea\u30fc\u30e0\uff08\u5404\u8981\u7d20\u306f\u30ea\u30b9\u30c8\uff09</p> <p>\u4f7f\u7528\u4f8b: - \u5927\u5bb9\u91cfCSV\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406\uff08\u6570\u5341MB\u301c\u6570GB\uff09 - \u30e1\u30e2\u30ea\u3092\u7bc0\u7d04\u3057\u306a\u304c\u3089\u306e\u884c\u3054\u3068\u51e6\u7406 - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u30fb\u5909\u63db</p>"},{"location":"ja/spec/22-stdlib-csv/#_4","title":"\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u8fbc\u307f","text":""},{"location":"ja/spec/22-stdlib-csv/#csvwrite-file","title":"csv/write-file","text":"<p>\u30c7\u30fc\u30bf\u3092CSV\u5f62\u5f0f\u3067\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u5bfe\u5fdc\u3002</p> <pre><code>;; \u76f4\u63a5\u66f8\u304d\u8fbc\u307f\n(def data [\n  [\"name\" \"age\" \"city\"]\n  [\"Alice\" 30 \"Tokyo\"]\n  [\"Bob\" 25 \"Osaka\"]])\n\n(csv/write-file data \"output.csv\")\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(data\n |&gt; (map (fn [row] (map str/upper row)))  ;; \u5168\u3066\u5927\u6587\u5b57\u5316\n |&gt; (csv/write-file _ \"output-upper.csv\"))\n\n;; \u30c7\u30fc\u30bf\u5909\u63db\u5f8c\u306b\u4fdd\u5b58\n(csv/read-file \"input.csv\")\n |&gt; (filter (fn [row] (!= (first row) \"name\")))  ;; \u30d8\u30c3\u30c0\u30fc\u9664\u5916\n |&gt; (filter (fn [row] (&gt; (parse-int (nth row 1)) 25)))  ;; age &gt; 25\n |&gt; (csv/write-file _ \"filtered.csv\")\n</code></pre> <p>\u5f15\u6570: - <code>data</code> - \u30ea\u30b9\u30c8\u306e\u30ea\u30b9\u30c8\u3001\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\u306e\u30d9\u30af\u30bf\u30fc - <code>path</code> - \u51fa\u529b\u5148\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: <code>nil</code></p> <p>\u6a5f\u80fd: <code>csv/stringify</code> + <code>io/write-file</code> \u306e\u4fbf\u5229\u95a2\u6570</p>"},{"location":"ja/spec/22-stdlib-csv/#_5","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/22-stdlib-csv/#csv","title":"CSV\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\u3068\u5909\u63db","text":"<pre><code>;; CSV\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3001\u30de\u30c3\u30d7\u306e\u30ea\u30b9\u30c8\u306b\u5909\u63db\n(defn csv-&gt;maps [csv-data]\n  (let [headers (first csv-data)\n        rows (rest csv-data)]\n    (map (fn [row]\n           (zipmap headers row))\n         rows)))\n\n(def users-csv (csv/read-file \"users.csv\"))\n(def users (csv-&gt;maps users-csv))\n;=&gt; [{:name \"Alice\" :age \"30\" :city \"Tokyo\"}\n;    {:name \"Bob\" :age \"25\" :city \"Osaka\"}]\n\n;; \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n(def tokyo-users\n  (filter (fn [u] (= (get u :city) \"Tokyo\"))\n          users))\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_6","title":"\u30c7\u30fc\u30bf\u30af\u30ea\u30fc\u30cb\u30f3\u30b0\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; CSV\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30cb\u30f3\u30b0\n(csv/read-file \"raw-data.csv\")\n |&gt; (map (fn [row]\n           (map str/trim row)))  ;; \u4f59\u5206\u306a\u7a7a\u767d\u9664\u53bb\n |&gt; (filter (fn [row]\n              (not (str/blank? (first row)))))  ;; \u7a7a\u884c\u9664\u5916\n |&gt; (fn [data]\n      (let [headers (first data)\n            rows (rest data)]\n        (cons headers\n              (distinct rows))))  ;; \u91cd\u8907\u884c\u9664\u53bb\n |&gt; (csv/write-file _ \"cleaned-data.csv\")\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_7","title":"\u5927\u5bb9\u91cf\u30d5\u30a1\u30a4\u30eb\u306e\u96c6\u8a08","text":"<pre><code>;; 100\u4e07\u884c\u306eCSV\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u6761\u4ef6\u306b\u5408\u3046\u884c\u3092\u30ab\u30a6\u30f3\u30c8\n(defn count-high-sales [filepath threshold]\n  (let [stream (csv/read-stream filepath)\n        _ (stream/next stream)]  ;; \u30d8\u30c3\u30c0\u30fc\u30b9\u30ad\u30c3\u30d7\n    (stream\n     |&gt; (stream/filter (fn [row]\n                         (&gt; (parse-float (nth row 2)) threshold)))\n     |&gt; stream/count)))\n\n(println f\"\u9ad8\u984d\u53d6\u5f15: {(count-high-sales \\\"sales.csv\\\" 10000)} \u4ef6\")\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#tsv","title":"TSV\u5f62\u5f0f\u306e\u51e6\u7406","text":"<pre><code>;; \u30bf\u30d6\u533a\u5207\u308a\u5f62\u5f0f\uff08TSV\uff09\n(def tsv-text (io/read-file \"data.tsv\"))\n(def data (csv/parse tsv-text :delimiter \"\\t\"))\n\n;; CSV\u306b\u5909\u63db\u3057\u3066\u4fdd\u5b58\n(csv/write-file data \"data.csv\")\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_8","title":"\u30c7\u30fc\u30bf\u306e\u7d50\u5408\u3068\u30a8\u30af\u30b9\u30dd\u30fc\u30c8","text":"<pre><code>;; \u8907\u6570\u306eCSV\u30d5\u30a1\u30a4\u30eb\u3092\u7d50\u5408\n(defn merge-csv-files [files output]\n  (let [headers (-&gt; files\n                    first\n                    csv/read-file\n                    first)\n        all-rows (files\n                  |&gt; (mapcat (fn [f]\n                               (-&gt; f\n                                   csv/read-file\n                                   rest))))]  ;; \u5404\u30d5\u30a1\u30a4\u30eb\u306e\u30d8\u30c3\u30c0\u30fc\u9664\u5916\n    (cons headers all-rows)\n     |&gt; (csv/write-file _ output)))\n\n(merge-csv-files [\"jan.csv\" \"feb.csv\" \"mar.csv\"] \"q1-sales.csv\")\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_9","title":"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30a4\u30f3\u30dd\u30fc\u30c8","text":"<pre><code>;; CSV\u30c7\u30fc\u30bf\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4e00\u62ec\u633f\u5165\n(defn import-csv-to-db [csv-file table-name conn]\n  (let [data (csv/read-file csv-file)\n        headers (first data)\n        rows (rest data)]\n    (doseq [row rows]\n      (let [values (zipmap (map keyword headers) row)\n            sql (str/format \"INSERT INTO {} VALUES ({})\"\n                           table-name\n                           (str/join \", \" (repeat (len row) \"?\")))]\n        (db/execute conn sql (vals values))))))\n\n;; \u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f7f\u3063\u305f\u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306a\u30a4\u30f3\u30dd\u30fc\u30c8\n(defn stream-import-csv-to-db [csv-file table-name conn]\n  (let [stream (csv/read-stream csv-file)\n        headers (stream/next stream)]  ;; \u30d8\u30c3\u30c0\u30fc\u53d6\u5f97\n    (stream/for-each stream\n      (fn [row]\n        (let [values (zipmap (map keyword headers) row)]\n          (db/insert conn table-name values))))))\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_10","title":"\u30a8\u30e9\u30fc\u51e6\u7406","text":"<pre><code>;; \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(try\n  (csv/read-file \"data.csv\")\n  (catch e\n    (println f\"CSV\u306e\u8aad\u307f\u8fbc\u307f\u30a8\u30e9\u30fc: {e}\")\n    []))\n\n;; \u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\u306e\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(try\n  (csv/parse \"invalid\\ncsv\\ndata\")\n  (catch e\n    (println f\"\u30d1\u30fc\u30b9\u30a8\u30e9\u30fc: {e}\")\n    []))\n\n;; \u66f8\u304d\u8fbc\u307f\u30a8\u30e9\u30fc\u306e\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(try\n  (csv/write-file data \"/invalid/path/file.csv\")\n  (catch e\n    (println f\"\u66f8\u304d\u8fbc\u307f\u30a8\u30e9\u30fc: {e}\")\n    nil))\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_11","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30ac\u30a4\u30c9","text":""},{"location":"ja/spec/22-stdlib-csv/#10mb","title":"\u5c0f\u301c\u4e2d\u30b5\u30a4\u30ba\u306e\u30d5\u30a1\u30a4\u30eb\uff08&lt; 10MB\uff09","text":"<pre><code>;; csv/read-file \u3092\u4f7f\u7528\uff08\u30b7\u30f3\u30d7\u30eb\uff09\n(def data (csv/read-file \"data.csv\"))\n(doseq [row data]\n  (process-row row))\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#10mb_1","title":"\u5927\u30b5\u30a4\u30ba\u306e\u30d5\u30a1\u30a4\u30eb\uff08&gt; 10MB\uff09","text":"<pre><code>;; csv/read-stream \u3092\u4f7f\u7528\uff08\u30e1\u30e2\u30ea\u52b9\u7387\u7684\uff09\n(def stream (csv/read-stream \"large-data.csv\"))\n(stream/for-each stream process-row)\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#1gb","title":"\u8d85\u5927\u30b5\u30a4\u30ba\u306e\u30d5\u30a1\u30a4\u30eb\uff08&gt; 1GB\uff09","text":"<pre><code>;; \u30b9\u30c8\u30ea\u30fc\u30e0 + \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\uff08\u4e26\u5217\u51e6\u7406\u53ef\u80fd\uff09\n(csv/read-stream \"huge-data.csv\")\n |&gt; (stream/drop 1)  ;; \u30d8\u30c3\u30c0\u30fc\u30b9\u30ad\u30c3\u30d7\n |&gt; (stream/map parse-row)\n |&gt; (stream/filter valid-row?)\n |&gt; (stream/for-each process-row)\n</code></pre>"},{"location":"ja/spec/22-stdlib-csv/#_12","title":"\u95a2\u6570\u4e00\u89a7","text":"\u95a2\u6570 \u8aac\u660e \u7528\u9014 <code>csv/parse</code> CSV\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9 \u30c6\u30ad\u30b9\u30c8\u304b\u3089\u306e\u30d1\u30fc\u30b9 <code>csv/stringify</code> \u30c7\u30fc\u30bf\u3092CSV\u6587\u5b57\u5217\u306b\u5909\u63db CSV\u6587\u5b57\u5217\u306e\u751f\u6210 <code>csv/read-file</code> CSV\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f \u5c0f\u301c\u4e2d\u30b5\u30a4\u30ba\u30d5\u30a1\u30a4\u30eb <code>csv/read-stream</code> CSV\u30d5\u30a1\u30a4\u30eb\u3092\u30b9\u30c8\u30ea\u30fc\u30e0\u8aad\u307f\u8fbc\u307f \u5927\u30b5\u30a4\u30ba\u30d5\u30a1\u30a4\u30eb <code>csv/write-file</code> \u30c7\u30fc\u30bf\u3092CSV\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u307f \u30d5\u30a1\u30a4\u30eb\u51fa\u529b"},{"location":"ja/spec/22-stdlib-csv/#_13","title":"\u4ed5\u69d8\u6e96\u62e0","text":"<p>\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f RFC 4180 \u306b\u6e96\u62e0\u3057\u3066\u3044\u307e\u3059:</p> <ul> <li>\u2705 CRLF / LF \u6539\u884c\u306e\u30b5\u30dd\u30fc\u30c8</li> <li>\u2705 \u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u306b\u3088\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u56f2\u307f</li> <li>\u2705 <code>\"\"</code> \u306b\u3088\u308b\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u306e\u30a8\u30b9\u30b1\u30fc\u30d7</li> <li>\u2705 \u30af\u30a9\u30fc\u30c8\u5185\u306e\u6539\u884c\u30fb\u30ab\u30f3\u30de\u306e\u4fdd\u6301</li> <li>\u2705 \u30ab\u30b9\u30bf\u30e0\u533a\u5207\u308a\u6587\u5b57\uff08TSV\u7b49\uff09</li> </ul>"},{"location":"ja/spec/22-stdlib-csv/#_14","title":"\u53c2\u8003","text":"<ul> <li>RFC 4180: Common Format and MIME Type for CSV Files</li> <li>\u95a2\u9023\u30e2\u30b8\u30e5\u30fc\u30eb:</li> <li><code>io/</code> - \u30d5\u30a1\u30a4\u30eb\u5165\u51fa\u529b</li> <li><code>str/</code> - \u6587\u5b57\u5217\u64cd\u4f5c</li> <li><code>stream/</code> - \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> <li><code>table/</code> - \u30c6\u30fc\u30d6\u30eb\u51e6\u7406\uff08\u30b0\u30eb\u30fc\u30d7\u5316\u30fb\u96c6\u8a08\uff09</li> </ul>"},{"location":"ja/spec/23-stdlib-env/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u74b0\u5883\u5909\u6570\uff08env/\uff09","text":"<p>\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97\u3001\u8a2d\u5b9a\u3001.env\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\u306a\u3069\u3092\u884c\u3046\u95a2\u6570\u7fa4\u3067\u3059\u3002</p>"},{"location":"ja/spec/23-stdlib-env/#_1","title":"\u6982\u8981","text":"<p><code>env/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a</p> <ul> <li>\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97 - \u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u5909\u6570\u306e\u8aad\u307f\u53d6\u308a</li> <li>\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a - \u30d7\u30ed\u30bb\u30b9\u5185\u3067\u306e\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a</li> <li>\u5168\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97 - \u3059\u3079\u3066\u306e\u74b0\u5883\u5909\u6570\u3092\u30de\u30c3\u30d7\u3068\u3057\u3066\u53d6\u5f97</li> <li>.env\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f - dotenv\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u74b0\u5883\u5909\u6570\u3092\u4e00\u62ec\u8a2d\u5b9a</li> </ul>"},{"location":"ja/spec/23-stdlib-env/#_2","title":"\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97","text":""},{"location":"ja/spec/23-stdlib-env/#envget","title":"env/get","text":"<p>\u74b0\u5883\u5909\u6570\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u5909\u6570\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>(env/get key)\n(env/get key default-value)\n</code></pre> <p>\u5f15\u6570: - <code>key</code> (string) - \u74b0\u5883\u5909\u6570\u540d - <code>default-value</code> (any, optional) - \u5909\u6570\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306e\u623b\u308a\u5024</p> <p>\u623b\u308a\u5024: - string - \u74b0\u5883\u5909\u6570\u306e\u5024 - default-value - \u5909\u6570\u304c\u5b58\u5728\u305b\u305a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408 - nil - \u5909\u6570\u304c\u5b58\u5728\u305b\u305a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408</p> <p>\u4f8b:</p> <pre><code>;; \u74b0\u5883\u5909\u6570\u3092\u53d6\u5f97\n(env/get \"PATH\")\n;; =&gt; \"/usr/local/bin:/usr/bin:/bin\"\n\n;; \u5b58\u5728\u3057\u306a\u3044\u5909\u6570\uff08nil\u3092\u8fd4\u3059\uff09\n(env/get \"NONEXISTENT_VAR\")\n;; =&gt; nil\n\n;; \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u6307\u5b9a\n(env/get \"MISSING_VAR\" \"default-value\")\n;; =&gt; \"default-value\"\n\n;; \u65e2\u5b58\u306e\u5909\u6570\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306f\u7121\u8996\u3055\u308c\u308b\uff09\n(env/get \"PATH\" \"fallback\")\n;; =&gt; \"/usr/local/bin:/usr/bin:/bin\"\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_3","title":"\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a","text":""},{"location":"ja/spec/23-stdlib-env/#envset","title":"env/set","text":"<p>\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u73fe\u5728\u306e\u30d7\u30ed\u30bb\u30b9\u3068\u305d\u306e\u5b50\u30d7\u30ed\u30bb\u30b9\u306b\u5f71\u97ff\u3057\u307e\u3059\u3002</p> <pre><code>(env/set key value)\n</code></pre> <p>\u5f15\u6570: - <code>key</code> (string) - \u74b0\u5883\u5909\u6570\u540d - <code>value</code> (string | number | boolean) - \u8a2d\u5b9a\u3059\u308b\u5024\uff08\u6587\u5b57\u5217\u306b\u5909\u63db\u3055\u308c\u307e\u3059\uff09</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>;; \u6587\u5b57\u5217\u3092\u8a2d\u5b9a\n(env/set \"MY_VAR\" \"my-value\")\n(env/get \"MY_VAR\")\n;; =&gt; \"my-value\"\n\n;; \u6570\u5024\u3092\u8a2d\u5b9a\uff08\u6587\u5b57\u5217\u306b\u5909\u63db\u3055\u308c\u308b\uff09\n(env/set \"PORT\" 8080)\n(env/get \"PORT\")\n;; =&gt; \"8080\"\n\n;; \u771f\u507d\u5024\u3092\u8a2d\u5b9a\n(env/set \"DEBUG\" true)\n(env/get \"DEBUG\")\n;; =&gt; \"true\"\n\n(env/set \"ENABLED\" false)\n(env/get \"ENABLED\")\n;; =&gt; \"false\"\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_4","title":"\u5168\u74b0\u5883\u5909\u6570\u306e\u53d6\u5f97","text":""},{"location":"ja/spec/23-stdlib-env/#envall","title":"env/all","text":"<p>\u3059\u3079\u3066\u306e\u74b0\u5883\u5909\u6570\u3092\u30de\u30c3\u30d7\u3068\u3057\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(env/all)\n</code></pre> <p>\u5f15\u6570: \u306a\u3057</p> <p>\u623b\u308a\u5024: map - \u30ad\u30fc\u304c\u74b0\u5883\u5909\u6570\u540d\u3001\u5024\u304c\u74b0\u5883\u5909\u6570\u306e\u5024</p> <p>\u4f8b:</p> <pre><code>;; \u3059\u3079\u3066\u306e\u74b0\u5883\u5909\u6570\u3092\u53d6\u5f97\n(def env-vars (env/all))\n\n;; \u7279\u5b9a\u306e\u5909\u6570\u3092\u53d6\u5f97\n(get env-vars \"HOME\")\n;; =&gt; \"/home/user\"\n\n;; \u74b0\u5883\u5909\u6570\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\n(count (env/all))\n;; =&gt; 42\n\n;; PATH \u3067\u59cb\u307e\u308b\u74b0\u5883\u5909\u6570\u3092\u62bd\u51fa\n(env/all\n |&gt; keys\n |&gt; (filter (fn [k] (str/starts-with? k \"PATH\"))))\n;; =&gt; [\"PATH\" \"PATHEXT\"]\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#env","title":".env\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f","text":""},{"location":"ja/spec/23-stdlib-env/#envload-dotenv","title":"env/load-dotenv","text":"<p>.env\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002dotenv\u5f62\u5f0f\uff08<code>KEY=VALUE</code>\uff09\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>(env/load-dotenv)\n(env/load-dotenv path)\n</code></pre> <p>\u5f15\u6570: - <code>path</code> (string, optional) - .env\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: \".env\"\uff09</p> <p>\u623b\u308a\u5024: integer - \u8aad\u307f\u8fbc\u307e\u308c\u305f\u74b0\u5883\u5909\u6570\u306e\u6570</p> <p>\u4f8b:</p> <pre><code>;; \u30c7\u30d5\u30a9\u30eb\u30c8\u306e .env \u3092\u8aad\u307f\u8fbc\u307f\n(env/load-dotenv)\n;; =&gt; 5\n\n;; \u30ab\u30b9\u30bf\u30e0\u30d1\u30b9\u3092\u6307\u5b9a\n(env/load-dotenv \".env.local\")\n;; =&gt; 3\n\n;; \u958b\u767a\u74b0\u5883\u7528\u306e\u8a2d\u5b9a\n(env/load-dotenv \".env.development\")\n;; =&gt; 8\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#env_1","title":".env\u30d5\u30a1\u30a4\u30eb\u306e\u5f62\u5f0f","text":"<p><code>.env</code> \u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\uff1a</p> <pre><code># \u30b3\u30e1\u30f3\u30c8\u884c\uff08#\u3067\u59cb\u307e\u308b\uff09\nKEY=VALUE\n\n# \u5024\u306e\u30af\u30aa\u30fc\u30c8\uff08\u30c0\u30d6\u30eb\u307e\u305f\u306f\u30b7\u30f3\u30b0\u30eb\uff09\nDATABASE_URL=\"postgresql://localhost/mydb\"\nAPI_KEY='secret-key-123'\n\n# \u30af\u30aa\u30fc\u30c8\u306a\u3057\nPORT=8080\nDEBUG=true\n\n# \u7a7a\u767d\u306f\u81ea\u52d5\u7684\u306b\u30c8\u30ea\u30e0\n  TRIM_ME  =  value with spaces\n\n# \u7a7a\u884c\u306f\u7121\u8996\u3055\u308c\u308b\n\nNODE_ENV=production\n</code></pre> <p>\u30b5\u30dd\u30fc\u30c8\u6a5f\u80fd: - \u2705 \u57fa\u672c\u7684\u306a <code>KEY=VALUE</code> \u5f62\u5f0f - \u2705 \u30b3\u30e1\u30f3\u30c8\u884c\uff08<code>#</code> \u3067\u59cb\u307e\u308b\uff09 - \u2705 \u5024\u306e\u30af\u30aa\u30fc\u30c8\uff08<code>\"...\"</code> \u307e\u305f\u306f <code>'...'</code>\uff09 - \u2705 \u30ad\u30fc\u3068\u5024\u306e\u524d\u5f8c\u306e\u7a7a\u767d\u3092\u81ea\u52d5\u30c8\u30ea\u30e0 - \u2705 \u7a7a\u884c\u3092\u7121\u8996</p> <p>\u5236\u9650\u4e8b\u9805: - \u274c \u5909\u6570\u5c55\u958b\uff08<code>${VAR}</code> \u5f62\u5f0f\uff09\u306f\u672a\u30b5\u30dd\u30fc\u30c8 - \u274c \u8907\u6570\u884c\u306e\u5024\u306f\u672a\u30b5\u30dd\u30fc\u30c8 - \u274c \u30a8\u30b9\u30b1\u30fc\u30d7\u30b7\u30fc\u30b1\u30f3\u30b9\uff08<code>\\n</code>, <code>\\t</code> \u306a\u3069\uff09\u306f\u672a\u30b5\u30dd\u30fc\u30c8</p>"},{"location":"ja/spec/23-stdlib-env/#_5","title":"\u4f7f\u7528\u4f8b","text":""},{"location":"ja/spec/23-stdlib-env/#_6","title":"\u8a2d\u5b9a\u306e\u8aad\u307f\u8fbc\u307f","text":"<pre><code>;; \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u306b .env \u3092\u8aad\u307f\u8fbc\u307f\n(defn load-config []\n  (let [count (env/load-dotenv)]\n    (println f\"Loaded {count} environment variables\")\n    {:port (str/parse-int (env/get \"PORT\" \"8080\"))\n     :host (env/get \"HOST\" \"localhost\")\n     :debug (= (env/get \"DEBUG\") \"true\")}))\n\n(def config (load-config))\n;; Loaded 5 environment variables\n;; =&gt; {:port 8080 :host \"localhost\" :debug true}\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_7","title":"\u74b0\u5883\u3054\u3068\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb","text":"<pre><code>;; NODE_ENV \u306b\u5fdc\u3058\u3066\u7570\u306a\u308b .env \u3092\u8aad\u307f\u8fbc\u307f\n(defn load-env-for-node-env []\n  (let [node-env (env/get \"NODE_ENV\" \"development\")\n        env-file (str \".env.\" node-env)]\n    (println f\"Loading {env-file}...\")\n    (env/load-dotenv env-file)))\n\n(load-env-for-node-env)\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_8","title":"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u6587\u5b57\u5217\u306e\u53d6\u5f97","text":"<pre><code>;; \u74b0\u5883\u5909\u6570\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u8a2d\u5b9a\u3092\u69cb\u7bc9\n(defn get-db-config []\n  (let [db-url (env/get \"DATABASE_URL\")]\n    (if db-url\n        ;; DATABASE_URL \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u305d\u308c\u3092\u4f7f\u7528\n        {:url db-url}\n        ;; \u306a\u3051\u308c\u3070\u500b\u5225\u306e\u74b0\u5883\u5909\u6570\u304b\u3089\u69cb\u7bc9\n        {:host (env/get \"DB_HOST\" \"localhost\")\n         :port (str/parse-int (env/get \"DB_PORT\" \"5432\"))\n         :database (env/get \"DB_NAME\" \"myapp\")\n         :user (env/get \"DB_USER\" \"postgres\")\n         :password (env/get \"DB_PASSWORD\" \"\")})))\n\n(def db-config (get-db-config))\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_9","title":"\u74b0\u5883\u5909\u6570\u306e\u4e00\u89a7\u8868\u793a","text":"<pre><code>;; \u3059\u3079\u3066\u306e\u74b0\u5883\u5909\u6570\u3092\u6574\u5f62\u3057\u3066\u8868\u793a\n(defn print-env-vars []\n  (env/all\n   |&gt; (map (fn [[k v]] f\"{k} = {v}\"))\n   |&gt; sort\n   |&gt; (each println)))\n\n(print-env-vars)\n;; HOME = /home/user\n;; PATH = /usr/local/bin:/usr/bin\n;; SHELL = /bin/zsh\n;; ...\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_10","title":"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3: \u6a5f\u5bc6\u60c5\u5831\u306e\u30de\u30b9\u30af","text":"<pre><code>;; \u6a5f\u5bc6\u60c5\u5831\u3092\u542b\u3080\u74b0\u5883\u5909\u6570\u3092\u30de\u30b9\u30af\u3057\u3066\u8868\u793a\n(def sensitive-keys [\"PASSWORD\" \"SECRET\" \"KEY\" \"TOKEN\"])\n\n(defn mask-value [key value]\n  (if (any? (fn [s] (str/contains? (str/upper key) s)) sensitive-keys)\n      \"********\"\n      value))\n\n(defn print-env-safe []\n  (env/all\n   |&gt; (map (fn [[k v]] [k (mask-value k v)]))\n   |&gt; (each (fn [[k v]] (println f\"{k} = {v}\")))))\n\n(print-env-safe)\n;; API_KEY = ********\n;; DB_PASSWORD = ********\n;; USER = alice\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_11","title":"\u8a2d\u5b9a\u306e\u691c\u8a3c","text":"<pre><code>;; \u5fc5\u9808\u306e\u74b0\u5883\u5909\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u304b\u30c1\u30a7\u30c3\u30af\n(defn validate-env [required-vars]\n  (let [missing (filter (fn [var] (nil? (env/get var))) required-vars)]\n    (if (empty? missing)\n        :ok\n        {:error \"Missing environment variables\" :missing missing})))\n\n(validate-env [\"PORT\" \"DATABASE_URL\" \"API_KEY\"])\n;; =&gt; {:error \"Missing environment variables\" :missing [\"API_KEY\"]}\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#env_2","title":".env\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7","text":"<pre><code>;; \u73fe\u5728\u306e\u74b0\u5883\u5909\u6570\u3092 .env \u5f62\u5f0f\u3067\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\n(defn save-env-to-file [path keys]\n  (let [lines (map (fn [k]\n                     (let [v (env/get k)]\n                       (if v\n                           f\"{k}={v}\"\n                           nil)))\n                   keys)\n        content (join \"\\n\" (filter some? lines))]\n    (io/write path content)))\n\n;; \u7279\u5b9a\u306e\u30ad\u30fc\u306e\u307f\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n(save-env-to-file \".env.backup\" [\"PORT\" \"HOST\" \"DEBUG\"])\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_12","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"ja/spec/23-stdlib-env/#_13","title":"\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408","text":"<pre><code>(try\n  (env/load-dotenv \"nonexistent.env\")\n  :ok\n  (fn [err]\n    (println \"Error:\" err)\n    :error))\n;; Error: Failed to read .env file 'nonexistent.env': No such file or directory\n;; =&gt; :error\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_14","title":"\u4e0d\u6b63\u306a\u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f","text":"<pre><code>;; .env \u30d5\u30a1\u30a4\u30eb\u306b `KEY=VALUE` \u5f62\u5f0f\u3067\u306a\u3044\u884c\u304c\u3042\u308b\u5834\u5408\n;; \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u884c\u756a\u53f7\u3068\u5185\u5bb9\u304c\u542b\u307e\u308c\u307e\u3059\n\n;; invalid.env \u306e\u5185\u5bb9:\n;; KEY1=VALUE1\n;; INVALID LINE WITHOUT EQUALS\n;; KEY2=VALUE2\n\n(try\n  (env/load-dotenv \"invalid.env\")\n  :ok\n  (fn [err]\n    (println err)))\n;; Invalid format in .env file at line 2: INVALID LINE WITHOUT EQUALS\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_15","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3068\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/spec/23-stdlib-env/#1","title":"\u8d77\u52d5\u6642\u306b1\u5ea6\u3060\u3051\u8aad\u307f\u8fbc\u3080","text":"<pre><code>;; \u274c \u60aa\u3044\u4f8b: \u30ea\u30af\u30a8\u30b9\u30c8\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3080\n(defn handle-request [req]\n  (env/load-dotenv)  ;; \u6bce\u56de\u30d5\u30a1\u30a4\u30ebI/O\u304c\u767a\u751f\n  (let [api-key (env/get \"API_KEY\")]\n    ...))\n\n;; \u2705 \u826f\u3044\u4f8b: \u8d77\u52d5\u6642\u306b1\u5ea6\u3060\u3051\u8aad\u307f\u8fbc\u3080\n(env/load-dotenv)\n\n(defn handle-request [req]\n  (let [api-key (env/get \"API_KEY\")]  ;; \u30e1\u30e2\u30ea\u304b\u3089\u53d6\u5f97\n    ...))\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_16","title":"\u8a2d\u5b9a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30ad\u30e3\u30c3\u30b7\u30e5","text":"<pre><code>;; \u2705 \u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u3092\u8aad\u307f\u8fbc\u3093\u3067\u30ad\u30e3\u30c3\u30b7\u30e5\n(env/load-dotenv)\n\n(def config\n  {:port (str/parse-int (env/get \"PORT\" \"8080\"))\n   :host (env/get \"HOST\" \"localhost\")\n   :db-url (env/get \"DATABASE_URL\")\n   :api-key (env/get \"API_KEY\")})\n\n;; \u4ee5\u964d\u306f config \u304b\u3089\u53d6\u5f97\n(defn start-server []\n  (http/serve (:port config) (:host config) handler))\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_17","title":"\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306e\u8a2d\u5b9a","text":"<pre><code>;; \u274c \u60aa\u3044\u4f8b: nil\u30c1\u30a7\u30c3\u30af\u3092\u7e70\u308a\u8fd4\u3059\n(let [port (env/get \"PORT\")]\n  (if (nil? port)\n      8080\n      (str/parse-int port)))\n\n;; \u2705 \u826f\u3044\u4f8b: env/get \u3067\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u6307\u5b9a\n(str/parse-int (env/get \"PORT\" \"8080\"))\n</code></pre>"},{"location":"ja/spec/23-stdlib-env/#_18","title":"\u95a2\u9023\u9805\u76ee","text":"<ul> <li>\u30d5\u30a1\u30a4\u30ebI/O - \u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u6587\u5b57\u5217\u64cd\u4f5c - \u74b0\u5883\u5909\u6570\u306e\u89e3\u6790</li> <li>\u30a8\u30e9\u30fc\u51e6\u7406 - try/catch\u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>\u30e2\u30b8\u30e5\u30fc\u30eb\u30b7\u30b9\u30c6\u30e0 - \u8a2d\u5b9a\u306e\u7ba1\u7406</li> </ul>"},{"location":"ja/spec/24-stdlib-kvs/","title":"KVS\uff08Key-Value Store\uff09","text":"<p>Redis\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9 - \u30ad\u30e3\u30c3\u30b7\u30e5\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u3001\u30ad\u30e5\u30fc</p> <p>Qi\u306f\u3001Key-Value Store\u3078\u306e\u7d71\u4e00\u7684\u306a\u30a2\u30af\u30bb\u30b9\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u73fe\u5728\u306fRedis\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3001\u5c06\u6765\u7684\u306bMemcached\u7b49\u306e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306b\u3082\u5bfe\u5fdc\u4e88\u5b9a\u3067\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#_1","title":"\u76ee\u6b21","text":"<ul> <li>\u6982\u8981</li> <li>\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u8a2d\u8a08</li> <li>kvs/connect - \u63a5\u7d9a</li> <li>\u57fa\u672c\u64cd\u4f5c</li> <li>\u6570\u5024\u64cd\u4f5c</li> <li>\u30ea\u30b9\u30c8\u64cd\u4f5c</li> <li>\u30cf\u30c3\u30b7\u30e5\u64cd\u4f5c</li> <li>\u30bb\u30c3\u30c8\u64cd\u4f5c</li> <li>\u8907\u6570\u64cd\u4f5c\uff08\u30d0\u30c3\u30c1\u64cd\u4f5c\uff09</li> <li>\u5b9f\u7528\u4f8b</li> <li>\u30a8\u30e9\u30fc\u51e6\u7406</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9</li> <li>\u5b9f\u88c5\u306e\u8a73\u7d30</li> </ul>"},{"location":"ja/spec/24-stdlib-kvs/#_2","title":"\u6982\u8981","text":""},{"location":"ja/spec/24-stdlib-kvs/#_3","title":"\u63d0\u4f9b\u6a5f\u80fd","text":"<p>\u5bfe\u5fdc\u30d0\u30c3\u30af\u30a8\u30f3\u30c9: - Redis: \u30ad\u30e3\u30c3\u30b7\u30e5\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u3001\u30ad\u30e5\u30fc\u3001Pub/Sub   - \u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08<code>kvs/*</code>\uff09   - \u57fa\u672c\u64cd\u4f5c\uff08get/set/del\uff09   - \u6570\u5024\u64cd\u4f5c\uff08incr/decr\uff09   - \u30c7\u30fc\u30bf\u69cb\u9020\uff08\u30ea\u30b9\u30c8\u3001\u30cf\u30c3\u30b7\u30e5\u3001\u30bb\u30c3\u30c8\uff09   - \u8907\u6570\u64cd\u4f5c\uff08mget/mset\uff09   - \u6709\u52b9\u671f\u9650\u8a2d\u5b9a\uff08expire/ttl\uff09</p> <p>\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306e\u5229\u70b9: - \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u81ea\u52d5\u5224\u5225\uff08URL\u89e3\u6790\uff09 - \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u900f\u904e\u7684\u306a\u5207\u308a\u66ff\u3048\uff08\u63a5\u7d9aURL\u306e\u307f\u5909\u66f4\uff09 - \u30b7\u30f3\u30d7\u30eb\u3067\u4e00\u8cab\u3057\u305fAPI - \u5c06\u6765\u7684\u306a\u62e1\u5f35\u6027\uff08Memcached\u3001\u30a4\u30f3\u30e1\u30e2\u30eaKVS\u7b49\uff09</p>"},{"location":"ja/spec/24-stdlib-kvs/#feature-flag","title":"feature flag","text":"<pre><code># Cargo.toml\nfeatures = [\"kvs-redis\"]\n</code></pre> <p>\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\u3067\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#_4","title":"\u4f9d\u5b58\u30af\u30ec\u30fc\u30c8","text":"<ul> <li>redis (v0.27) - Pure Rust Redis\u30af\u30e9\u30a4\u30a2\u30f3\u30c8</li> <li>tokio - \u975e\u540c\u671f\u30e9\u30f3\u30bf\u30a4\u30e0</li> <li>dashmap - \u63a5\u7d9a\u30d7\u30fc\u30eb\uff08\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306aHashMap\uff09</li> </ul>"},{"location":"ja/spec/24-stdlib-kvs/#_5","title":"\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u8a2d\u8a08","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e<code>db/connect</code>\u3068\u540c\u3058\u30d1\u30bf\u30fc\u30f3\u3067\u3001KVS\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u3092\u900f\u904e\u7684\u306b\u6271\u3048\u307e\u3059\u3002</p> <pre><code>;; \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306fURL\u304b\u3089\u81ea\u52d5\u5224\u5225\n(def kvs (kvs/connect \"redis://localhost:6379\"))\n\n;; \u4ee5\u964d\u306e\u30b3\u30fc\u30c9\u306f\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u975e\u4f9d\u5b58\n(kvs/set kvs \"key\" \"value\")\n(kvs/get kvs \"key\")\n\n;; \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u3092\u5909\u66f4\u3059\u308b\u5834\u5408\u3082\u3001\u63a5\u7d9aURL\u3060\u3051\u5909\u3048\u308c\u3070OK\n;; (def kvs (kvs/connect \"memcached://localhost:11211\"))  ;; \u5c06\u6765\u5bfe\u5fdc\n</code></pre> <p>\u8a2d\u8a08\u539f\u5247: - \u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9: <code>kvs/*</code>\u95a2\u6570\u306e\u307f\u516c\u958b - \u5c02\u7528\u95a2\u6570\u306f\u975e\u516c\u958b: <code>kvs/redis-*</code>\u306f\u5185\u90e8\u30c9\u30e9\u30a4\u30d0\u30fc\u7528 - \u62e1\u5f35\u6027: \u7d71\u4e00IF\u3067\u8868\u73fe\u3067\u304d\u306a\u3044\u6a5f\u80fd\uff08Redis Pub/Sub\u7b49\uff09\u304c\u5fc5\u8981\u306b\u306a\u3063\u305f\u5834\u5408\u306e\u307f\u5c02\u7528\u95a2\u6570\u3092\u8ffd\u52a0</p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsconnect-","title":"kvs/connect - \u63a5\u7d9a","text":"<p>KVS\u306b\u63a5\u7d9a\u3057\u3001\u63a5\u7d9a\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/connect url)\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_6","title":"\u5f15\u6570","text":"<ul> <li><code>url</code>: \u6587\u5b57\u5217\uff08\u63a5\u7d9aURL\uff09</li> <li>Redis: <code>\"redis://localhost:6379\"</code></li> <li>Redis\uff08\u8a8d\u8a3c\u4ed8\u304d\uff09: <code>\"redis://:password@localhost:6379\"</code></li> <li>Memcached: <code>\"memcached://localhost:11211\"</code> \uff08\u5c06\u6765\u5bfe\u5fdc\uff09</li> </ul>"},{"location":"ja/spec/24-stdlib-kvs/#_7","title":"\u623b\u308a\u5024","text":"<ul> <li>\u63a5\u7d9aID\uff08\u6587\u5b57\u5217\uff09 - \u5f62\u5f0f: <code>\"KvsConnection:kvs:1\"</code></li> <li>\u30a8\u30e9\u30fc\u306e\u5834\u5408: <code>{:error \"message\"}</code></li> </ul>"},{"location":"ja/spec/24-stdlib-kvs/#_8","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>;; Redis\u63a5\u7d9a\n(def kvs (kvs/connect \"redis://localhost:6379\"))\n;; =&gt; \"KvsConnection:kvs:1\"\n\n;; \u8a8d\u8a3c\u4ed8\u304dRedis\n(def kvs (kvs/connect \"redis://:my-secret-password@localhost:6379\"))\n\n;; \u63a5\u7d9a\u30a8\u30e9\u30fc\u306e\u5834\u5408\n(def kvs (kvs/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported KVS URL: invalid-url\"}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_9","title":"\u63a5\u7d9a\u7ba1\u7406","text":"<ul> <li>\u81ea\u52d5\u63a5\u7d9a\u30d7\u30fc\u30eb: \u540c\u3058URL\u3078\u306e\u8907\u6570\u63a5\u7d9a\u306f\u5185\u90e8\u3067\u5171\u6709</li> <li>\u81ea\u52d5\u518d\u63a5\u7d9a: \u63a5\u7d9a\u65ad\u6642\u306f\u81ea\u52d5\u3067\u518d\u63a5\u7d9a\u3092\u8a66\u884c</li> <li>\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5: \u8907\u6570\u306e\u30b9\u30ec\u30c3\u30c9\u304b\u3089\u540c\u6642\u30a2\u30af\u30bb\u30b9\u53ef\u80fd</li> </ul>"},{"location":"ja/spec/24-stdlib-kvs/#_10","title":"\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"ja/spec/24-stdlib-kvs/#kvsset-","title":"kvs/set - \u5024\u306e\u8a2d\u5b9a","text":"<p>\u30ad\u30fc\u306b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/set conn key value)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID\uff08<code>kvs/connect</code>\u306e\u623b\u308a\u5024\uff09 - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>value</code>: \u5024\uff08\u6587\u5b57\u5217\u3001\u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3001\u771f\u507d\u5024\uff09</p> <p>\u623b\u308a\u5024: - <code>\"OK\"</code> (\u6210\u529f\u6642) - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/set kvs \"user:1\" \"Alice\")\n;; =&gt; \"OK\"\n\n(kvs/set kvs \"counter\" 42)\n;; =&gt; \"OK\"\n\n(kvs/set kvs \"ratio\" 3.14)\n;; =&gt; \"OK\"\n\n(kvs/set kvs \"active\" true)\n;; =&gt; \"OK\"\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsget-","title":"kvs/get - \u5024\u306e\u53d6\u5f97","text":"<p>\u30ad\u30fc\u306e\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/get conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u5024\uff08\u6587\u5b57\u5217\uff09 - \u30ad\u30fc\u304c\u5b58\u5728\u3059\u308b\u5834\u5408 - <code>nil</code> - \u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/get kvs \"user:1\")\n;; =&gt; \"Alice\"\n\n(kvs/get kvs \"nonexistent\")\n;; =&gt; nil\n\n;; \u30a8\u30e9\u30fc\u51e6\u7406\n(def value (kvs/get kvs \"user:1\"))\n(if (nil? value)\n  (println \"Key not found\")\n  (println \"Value:\" value))\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsdel-","title":"kvs/del - \u30ad\u30fc\u306e\u524a\u9664","text":"<p>\u30ad\u30fc\u3092\u524a\u9664\u3057\u307e\u3059\uff08\u95a2\u6570\u540d\u306f<code>kvs/delete</code>\uff09\u3002</p> <pre><code>(kvs/del conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u524a\u9664\u3055\u308c\u305f\u30ad\u30fc\u6570\uff08\u6574\u6570\uff09 - \u901a\u5e38\u306f<code>1</code>\u3001\u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f<code>0</code> - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/del kvs \"user:1\")\n;; =&gt; 1  ;; \u524a\u9664\u6210\u529f\n\n(kvs/del kvs \"nonexistent\")\n;; =&gt; 0  ;; \u524a\u9664\u5bfe\u8c61\u306a\u3057\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsexists-","title":"kvs/exists - \u5b58\u5728\u78ba\u8a8d","text":"<p>\u30ad\u30fc\u304c\u5b58\u5728\u3059\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3057\u307e\u3059\uff08\u95a2\u6570\u540d\u306f<code>kvs/exists?</code>\uff09\u3002</p> <pre><code>(kvs/exists conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code> - \u30ad\u30fc\u304c\u5b58\u5728\u3059\u308b - <code>false</code> - \u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/set kvs \"user:1\" \"Alice\")\n(kvs/exists kvs \"user:1\")\n;; =&gt; true\n\n(kvs/exists kvs \"nonexistent\")\n;; =&gt; false\n\n;; \u6761\u4ef6\u5206\u5c90\n(if (kvs/exists kvs \"cache:data\")\n  (kvs/get kvs \"cache:data\")\n  (do\n    (def data (fetch-from-db))\n    (kvs/set kvs \"cache:data\" data)\n    data))\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvskeys-","title":"kvs/keys - \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1","text":"<p>\u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1\u3059\u308b\u30ad\u30fc\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/keys conn pattern)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>pattern</code>: \u30d1\u30bf\u30fc\u30f3\u6587\u5b57\u5217   - <code>*</code> - \u4efb\u610f\u306e\u6587\u5b57\u5217   - <code>?</code> - 1\u6587\u5b57   - \u4f8b: <code>\"user:*\"</code>, <code>\"cache:2025-*\"</code>, <code>\"session:???\"</code></p> <p>\u623b\u308a\u5024: - \u30ad\u30fc\u540d\u306e\u30d9\u30af\u30bf - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/set kvs \"user:1\" \"Alice\")\n(kvs/set kvs \"user:2\" \"Bob\")\n(kvs/set kvs \"user:3\" \"Charlie\")\n\n(kvs/keys kvs \"user:*\")\n;; =&gt; [\"user:1\" \"user:2\" \"user:3\"]\n\n(kvs/keys kvs \"user:?\")\n;; =&gt; [\"user:1\" \"user:2\" \"user:3\"]\n\n(kvs/keys kvs \"cache:*\")\n;; =&gt; []  ;; \u30de\u30c3\u30c1\u306a\u3057\n</code></pre></p> <p>\u6ce8\u610f: \u672c\u756a\u74b0\u5883\u3067\u5927\u91cf\u306e\u30ad\u30fc\u304c\u3042\u308b\u5834\u5408\u3001<code>kvs/keys</code>\u306f\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u64cd\u4f5c\u306e\u305f\u3081\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u5f71\u97ff\u3057\u307e\u3059\u3002\u4ee3\u308f\u308a\u306bSCAN\u7cfb\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u7528\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u5c06\u6765\u5b9f\u88c5\u4e88\u5b9a\uff09\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsexpire-","title":"kvs/expire - \u6709\u52b9\u671f\u9650\u8a2d\u5b9a","text":"<p>\u30ad\u30fc\u306b\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\u3057\u307e\u3059\uff08\u79d2\u5358\u4f4d\uff09\u3002</p> <pre><code>(kvs/expire conn key seconds)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>seconds</code>: \u6709\u52b9\u671f\u9650\uff08\u6574\u6570\u3001\u79d2\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code> - \u6709\u52b9\u671f\u9650\u8a2d\u5b9a\u6210\u529f - <code>false</code> - \u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>;; \u30bb\u30c3\u30b7\u30e7\u30f3\u306b30\u5206\u306e\u6709\u52b9\u671f\u9650\n(kvs/set kvs \"session:abc123\" \"user-data\")\n(kvs/expire kvs \"session:abc123\" 1800)  ;; 30\u5206 = 1800\u79d2\n;; =&gt; true\n\n;; 1\u6642\u9593\u306e\u6709\u52b9\u671f\u9650\n(kvs/expire kvs \"cache:data\" 3600)\n;; =&gt; true\n\n;; \u5b58\u5728\u3057\u306a\u3044\u30ad\u30fc\n(kvs/expire kvs \"nonexistent\" 60)\n;; =&gt; false\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsttl-","title":"kvs/ttl - \u6b8b\u308a\u6709\u52b9\u671f\u9650\u53d6\u5f97","text":"<p>\u30ad\u30fc\u306e\u6b8b\u308a\u6709\u52b9\u671f\u9650\u3092\u53d6\u5f97\u3057\u307e\u3059\uff08\u79d2\u5358\u4f4d\uff09\u3002</p> <pre><code>(kvs/ttl conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u6b8b\u308a\u79d2\u6570\uff08\u6574\u6570\uff09 - \u6709\u52b9\u671f\u9650\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408 - <code>-1</code> - \u30ad\u30fc\u306f\u5b58\u5728\u3059\u308b\u304c\u3001\u6709\u52b9\u671f\u9650\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044 - <code>-2</code> - \u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/set kvs \"session:abc\" \"data\")\n(kvs/expire kvs \"session:abc\" 3600)\n\n(kvs/ttl kvs \"session:abc\")\n;; =&gt; 3599  ;; \u6b8b\u308a\u7d041\u6642\u9593\n\n;; \u6709\u52b9\u671f\u9650\u306a\u3057\n(kvs/set kvs \"permanent\" \"data\")\n(kvs/ttl kvs \"permanent\")\n;; =&gt; -1\n\n;; \u5b58\u5728\u3057\u306a\u3044\u30ad\u30fc\n(kvs/ttl kvs \"nonexistent\")\n;; =&gt; -2\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#_11","title":"\u6570\u5024\u64cd\u4f5c","text":""},{"location":"ja/spec/24-stdlib-kvs/#kvsincr-","title":"kvs/incr - \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8","text":"<p>\u30ad\u30fc\u306e\u5024\u30921\u5897\u3084\u3057\u307e\u3059\u3002\u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f0\u304b\u3089\u958b\u59cb\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/incr conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u5f8c\u306e\u5024\uff08\u6574\u6570\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>;; \u521d\u56de\uff080\u304b\u3089\u958b\u59cb\uff09\n(kvs/incr kvs \"page-views\")\n;; =&gt; 1\n\n(kvs/incr kvs \"page-views\")\n;; =&gt; 2\n\n(kvs/incr kvs \"page-views\")\n;; =&gt; 3\n\n;; \u65e2\u5b58\u306e\u5024\u304b\u3089\u5897\u52a0\n(kvs/set kvs \"counter\" 100)\n(kvs/incr kvs \"counter\")\n;; =&gt; 101\n</code></pre></p> <p>\u7528\u9014: \u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u30ab\u30a6\u30f3\u30bf\u30fc\u3001\u30e6\u30fc\u30b6\u30fcID\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc\u3001\u30ec\u30fc\u30c8\u5236\u9650\u7b49</p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsdecr-","title":"kvs/decr - \u30c7\u30af\u30ea\u30e1\u30f3\u30c8","text":"<p>\u30ad\u30fc\u306e\u5024\u30921\u6e1b\u3089\u3057\u307e\u3059\u3002\u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f0\u304b\u3089\u958b\u59cb\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/decr conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u30c7\u30af\u30ea\u30e1\u30f3\u30c8\u5f8c\u306e\u5024\uff08\u6574\u6570\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/set kvs \"stock\" 10)\n(kvs/decr kvs \"stock\")\n;; =&gt; 9\n\n(kvs/decr kvs \"stock\")\n;; =&gt; 8\n\n;; \u521d\u56de\uff080\u304b\u3089\u958b\u59cb\uff09\n(kvs/decr kvs \"countdown\")\n;; =&gt; -1\n</code></pre></p> <p>\u7528\u9014: \u5728\u5eab\u7ba1\u7406\u3001\u30c0\u30a6\u30f3\u30ab\u30a6\u30f3\u30bf\u30fc\u7b49</p>"},{"location":"ja/spec/24-stdlib-kvs/#_12","title":"\u30ea\u30b9\u30c8\u64cd\u4f5c","text":"<p>Redis\u306e\u30ea\u30b9\u30c8\u306f\u3001\u4e21\u7aef\u30ad\u30e5\u30fc\uff08deque\uff09\u3068\u3057\u3066\u52d5\u4f5c\u3057\u307e\u3059\u3002FIFO\uff08\u30ad\u30e5\u30fc\uff09\u3001LIFO\uff08\u30b9\u30bf\u30c3\u30af\uff09\u4e21\u65b9\u306e\u7528\u9014\u3067\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#kvslpush-","title":"kvs/lpush - \u5de6\u7aef\u306b\u8981\u7d20\u8ffd\u52a0","text":"<p>\u30ea\u30b9\u30c8\u306e\u5de6\u7aef\uff08\u5148\u982d\uff09\u306b\u8981\u7d20\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/lpush conn key value)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ea\u30b9\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>value</code>: \u8ffd\u52a0\u3059\u308b\u5024\uff08\u6587\u5b57\u5217\u3001\u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3001\u771f\u507d\u5024\uff09</p> <p>\u623b\u308a\u5024: - \u30ea\u30b9\u30c8\u306e\u9577\u3055\uff08\u6574\u6570\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/lpush kvs \"mylist\" \"first\")\n;; =&gt; 1\n\n(kvs/lpush kvs \"mylist\" \"second\")\n;; =&gt; 2\n\n;; \u7d50\u679c: [\"second\" \"first\"]\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsrpush-","title":"kvs/rpush - \u53f3\u7aef\u306b\u8981\u7d20\u8ffd\u52a0","text":"<p>\u30ea\u30b9\u30c8\u306e\u53f3\u7aef\uff08\u672b\u5c3e\uff09\u306b\u8981\u7d20\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/rpush conn key value)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ea\u30b9\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>value</code>: \u8ffd\u52a0\u3059\u308b\u5024\uff08\u6587\u5b57\u5217\u3001\u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3001\u771f\u507d\u5024\uff09</p> <p>\u623b\u308a\u5024: - \u30ea\u30b9\u30c8\u306e\u9577\u3055\uff08\u6574\u6570\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b\uff08\u30ad\u30e5\u30fc - FIFO\uff09: <pre><code>;; \u30bf\u30b9\u30af\u3092\u8ffd\u52a0\n(kvs/rpush kvs \"tasks\" \"task1\")\n;; =&gt; 1\n(kvs/rpush kvs \"tasks\" \"task2\")\n;; =&gt; 2\n(kvs/rpush kvs \"tasks\" \"task3\")\n;; =&gt; 3\n\n;; \u30bf\u30b9\u30af\u3092\u53d6\u5f97\uff08\u5148\u982d\u304b\u3089\uff09\n(kvs/lpop kvs \"tasks\")  ;; =&gt; \"task1\"\n(kvs/lpop kvs \"tasks\")  ;; =&gt; \"task2\"\n(kvs/lpop kvs \"tasks\")  ;; =&gt; \"task3\"\n</code></pre></p> <p>\u4f8b\uff08\u30b9\u30bf\u30c3\u30af - LIFO\uff09: <pre><code>;; \u8981\u7d20\u3092\u7a4d\u3080\n(kvs/lpush kvs \"stack\" \"item1\")\n(kvs/lpush kvs \"stack\" \"item2\")\n(kvs/lpush kvs \"stack\" \"item3\")\n\n;; \u8981\u7d20\u3092\u53d6\u308b\uff08\u6700\u5f8c\u306b\u8ffd\u52a0\u3057\u305f\u3082\u306e\u304b\u3089\uff09\n(kvs/lpop kvs \"stack\")  ;; =&gt; \"item3\"\n(kvs/lpop kvs \"stack\")  ;; =&gt; \"item2\"\n(kvs/lpop kvs \"stack\")  ;; =&gt; \"item1\"\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvslpop-","title":"kvs/lpop - \u5de6\u7aef\u304b\u3089\u8981\u7d20\u53d6\u5f97","text":"<p>\u30ea\u30b9\u30c8\u306e\u5de6\u7aef\uff08\u5148\u982d\uff09\u304b\u3089\u8981\u7d20\u3092\u53d6\u5f97\u3057\u3001\u524a\u9664\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/lpop conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ea\u30b9\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u53d6\u5f97\u3057\u305f\u5024\uff08\u6587\u5b57\u5217\uff09 - <code>nil</code> - \u30ea\u30b9\u30c8\u304c\u7a7a\u3001\u307e\u305f\u306f\u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/rpush kvs \"queue\" \"task1\")\n(kvs/rpush kvs \"queue\" \"task2\")\n\n(kvs/lpop kvs \"queue\")\n;; =&gt; \"task1\"\n\n(kvs/lpop kvs \"queue\")\n;; =&gt; \"task2\"\n\n(kvs/lpop kvs \"queue\")\n;; =&gt; nil  ;; \u7a7a\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvsrpop-","title":"kvs/rpop - \u53f3\u7aef\u304b\u3089\u8981\u7d20\u53d6\u5f97","text":"<p>\u30ea\u30b9\u30c8\u306e\u53f3\u7aef\uff08\u672b\u5c3e\uff09\u304b\u3089\u8981\u7d20\u3092\u53d6\u5f97\u3057\u3001\u524a\u9664\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/rpop conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ea\u30b9\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u53d6\u5f97\u3057\u305f\u5024\uff08\u6587\u5b57\u5217\uff09 - <code>nil</code> - \u30ea\u30b9\u30c8\u304c\u7a7a\u3001\u307e\u305f\u306f\u30ad\u30fc\u304c\u5b58\u5728\u3057\u306a\u3044 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/lpush kvs \"stack\" \"a\")\n(kvs/lpush kvs \"stack\" \"b\")\n(kvs/lpush kvs \"stack\" \"c\")\n\n(kvs/rpop kvs \"stack\")\n;; =&gt; \"a\"  ;; \u6700\u521d\u306b\u8ffd\u52a0\u3057\u305f\u8981\u7d20\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvslrange-","title":"kvs/lrange - \u7bc4\u56f2\u53d6\u5f97","text":"<p>\u30ea\u30b9\u30c8\u306e\u6307\u5b9a\u7bc4\u56f2\u306e\u8981\u7d20\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/lrange conn key start stop)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30ea\u30b9\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>start</code>: \u958b\u59cb\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\uff08\u6574\u6570\u30010\u59cb\u307e\u308a\uff09 - <code>stop</code>: \u7d42\u4e86\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\uff08\u6574\u6570\u3001-1\u3067\u672b\u5c3e\u307e\u3067\uff09</p> <p>\u623b\u308a\u5024: - \u8981\u7d20\u306e\u30d9\u30af\u30bf - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/rpush kvs \"mylist\" \"a\")\n(kvs/rpush kvs \"mylist\" \"b\")\n(kvs/rpush kvs \"mylist\" \"c\")\n(kvs/rpush kvs \"mylist\" \"d\")\n(kvs/rpush kvs \"mylist\" \"e\")\n\n;; \u5168\u8981\u7d20\u53d6\u5f97\n(kvs/lrange kvs \"mylist\" 0 -1)\n;; =&gt; [\"a\" \"b\" \"c\" \"d\" \"e\"]\n\n;; \u6700\u521d\u306e3\u8981\u7d20\n(kvs/lrange kvs \"mylist\" 0 2)\n;; =&gt; [\"a\" \"b\" \"c\"]\n\n;; 2\u756a\u76ee\u304b\u30894\u756a\u76ee\n(kvs/lrange kvs \"mylist\" 1 3)\n;; =&gt; [\"b\" \"c\" \"d\"]\n\n;; \u6700\u5f8c\u306e2\u8981\u7d20\n(kvs/lrange kvs \"mylist\" -2 -1)\n;; =&gt; [\"d\" \"e\"]\n</code></pre></p> <p>\u7528\u9014: \u30da\u30fc\u30b8\u30f3\u30b0\u3001\u5c65\u6b74\u8868\u793a\u3001\u6700\u65b0N\u4ef6\u53d6\u5f97\u7b49</p>"},{"location":"ja/spec/24-stdlib-kvs/#_13","title":"\u30cf\u30c3\u30b7\u30e5\u64cd\u4f5c","text":"<p>Redis\u306e\u30cf\u30c3\u30b7\u30e5\u306f\u3001\u30d5\u30a3\u30fc\u30eb\u30c9-\u5024\u306e\u30da\u30a2\u3092\u6301\u3064\u30de\u30c3\u30d7\u3067\u3059\u3002\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3001\u8a2d\u5b9a\u5024\u7b49\u306e\u69cb\u9020\u5316\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u306b\u9069\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#kvshset-","title":"kvs/hset - \u30d5\u30a3\u30fc\u30eb\u30c9\u8a2d\u5b9a","text":"<p>\u30cf\u30c3\u30b7\u30e5\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/hset conn key field value)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30cf\u30c3\u30b7\u30e5\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>field</code>: \u30d5\u30a3\u30fc\u30eb\u30c9\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>value</code>: \u5024\uff08\u6587\u5b57\u5217\u3001\u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3001\u771f\u507d\u5024\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code> - \u65b0\u898f\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4f5c\u6210 - <code>false</code> - \u65e2\u5b58\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u66f4\u65b0 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>;; \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u4fdd\u5b58\n(kvs/hset kvs \"user:1\" \"name\" \"Alice\")\n;; =&gt; true  ;; \u65b0\u898f\u4f5c\u6210\n\n(kvs/hset kvs \"user:1\" \"email\" \"alice@example.com\")\n;; =&gt; true\n\n(kvs/hset kvs \"user:1\" \"age\" 30)\n;; =&gt; true\n\n;; \u65e2\u5b58\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u66f4\u65b0\n(kvs/hset kvs \"user:1\" \"name\" \"Alice Smith\")\n;; =&gt; false  ;; \u66f4\u65b0\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvshget-","title":"kvs/hget - \u30d5\u30a3\u30fc\u30eb\u30c9\u53d6\u5f97","text":"<p>\u30cf\u30c3\u30b7\u30e5\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u304b\u3089\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/hget conn key field)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30cf\u30c3\u30b7\u30e5\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>field</code>: \u30d5\u30a3\u30fc\u30eb\u30c9\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u5024\uff08\u6587\u5b57\u5217\uff09 - <code>nil</code> - \u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u5b58\u5728\u3057\u306a\u3044 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/hset kvs \"user:1\" \"name\" \"Alice\")\n(kvs/hset kvs \"user:1\" \"email\" \"alice@example.com\")\n\n(kvs/hget kvs \"user:1\" \"name\")\n;; =&gt; \"Alice\"\n\n(kvs/hget kvs \"user:1\" \"email\")\n;; =&gt; \"alice@example.com\"\n\n(kvs/hget kvs \"user:1\" \"nonexistent\")\n;; =&gt; nil\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvshgetall-","title":"kvs/hgetall - \u30cf\u30c3\u30b7\u30e5\u5168\u4f53\u53d6\u5f97","text":"<p>\u30cf\u30c3\u30b7\u30e5\u306e\u5168\u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/hgetall conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30cf\u30c3\u30b7\u30e5\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u30de\u30c3\u30d7\uff08\u30d5\u30a3\u30fc\u30eb\u30c9-\u5024\u306e\u30da\u30a2\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/hset kvs \"user:1\" \"name\" \"Alice\")\n(kvs/hset kvs \"user:1\" \"email\" \"alice@example.com\")\n(kvs/hset kvs \"user:1\" \"age\" \"30\")\n\n(kvs/hgetall kvs \"user:1\")\n;; =&gt; {\"name\" \"Alice\" \"email\" \"alice@example.com\" \"age\" \"30\"}\n\n;; \u30de\u30c3\u30d7\u64cd\u4f5c\n(def user (kvs/hgetall kvs \"user:1\"))\n(get user \"name\")\n;; =&gt; \"Alice\"\n</code></pre></p> <p>\u6ce8\u610f: \u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u304c\u591a\u3044\u5834\u5408\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u5f71\u97ff\u3057\u307e\u3059\u3002\u4ee3\u308f\u308a\u306b<code>kvs/hget</code>\u3067\u5fc5\u8981\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u307f\u53d6\u5f97\u3059\u308b\u3053\u3068\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#_14","title":"\u30bb\u30c3\u30c8\u64cd\u4f5c","text":"<p>Redis\u306e\u30bb\u30c3\u30c8\u306f\u3001\u91cd\u8907\u306e\u306a\u3044\u6587\u5b57\u5217\u306e\u96c6\u5408\u3067\u3059\u3002\u30bf\u30b0\u3001\u30e6\u30cb\u30fc\u30af\u306a\u5024\u306e\u7ba1\u7406\u7b49\u306b\u9069\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#kvssadd-","title":"kvs/sadd - \u30e1\u30f3\u30d0\u30fc\u8ffd\u52a0","text":"<p>\u30bb\u30c3\u30c8\u306b\u30e1\u30f3\u30d0\u30fc\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/sadd conn key member)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30bb\u30c3\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09 - <code>member</code>: \u30e1\u30f3\u30d0\u30fc\uff08\u6587\u5b57\u5217\u3001\u6574\u6570\u3001\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u3001\u771f\u507d\u5024\uff09</p> <p>\u623b\u308a\u5024: - \u8ffd\u52a0\u3055\u308c\u305f\u30e1\u30f3\u30d0\u30fc\u6570\uff08\u6574\u6570\uff09 - \u901a\u5e38\u306f<code>1</code>\u3001\u65e2\u5b58\u306e\u5834\u5408\u306f<code>0</code> - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/sadd kvs \"tags\" \"redis\")\n;; =&gt; 1  ;; \u65b0\u898f\u8ffd\u52a0\n\n(kvs/sadd kvs \"tags\" \"cache\")\n;; =&gt; 1\n\n(kvs/sadd kvs \"tags\" \"nosql\")\n;; =&gt; 1\n\n;; \u65e2\u5b58\u306e\u30e1\u30f3\u30d0\u30fc\n(kvs/sadd kvs \"tags\" \"redis\")\n;; =&gt; 0  ;; \u8ffd\u52a0\u3055\u308c\u306a\u3044\uff08\u91cd\u8907\uff09\n</code></pre></p>"},{"location":"ja/spec/24-stdlib-kvs/#kvssmembers-","title":"kvs/smembers - \u5168\u30e1\u30f3\u30d0\u30fc\u53d6\u5f97","text":"<p>\u30bb\u30c3\u30c8\u306e\u5168\u30e1\u30f3\u30d0\u30fc\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/smembers conn key)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>key</code>: \u30bb\u30c3\u30c8\u306e\u30ad\u30fc\u540d\uff08\u6587\u5b57\u5217\uff09</p> <p>\u623b\u308a\u5024: - \u30e1\u30f3\u30d0\u30fc\u306e\u30d9\u30af\u30bf\uff08\u9806\u5e8f\u306f\u4e0d\u5b9a\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/sadd kvs \"tags\" \"redis\")\n(kvs/sadd kvs \"tags\" \"cache\")\n(kvs/sadd kvs \"tags\" \"nosql\")\n\n(kvs/smembers kvs \"tags\")\n;; =&gt; [\"redis\" \"cache\" \"nosql\"]  ;; \u9806\u5e8f\u306f\u4e0d\u5b9a\n\n;; \u7a7a\u306e\u30bb\u30c3\u30c8\n(kvs/smembers kvs \"nonexistent\")\n;; =&gt; []\n</code></pre></p> <p>\u7528\u9014: \u30bf\u30b0\u4e00\u89a7\u3001\u30e6\u30fc\u30b6\u30fc\u306e\u6a29\u9650\u30ea\u30b9\u30c8\u3001\u30e6\u30cb\u30fc\u30af\u306a\u8a2a\u554f\u8005\u7b49</p>"},{"location":"ja/spec/24-stdlib-kvs/#_15","title":"\u8907\u6570\u64cd\u4f5c\uff08\u30d0\u30c3\u30c1\u64cd\u4f5c\uff09","text":""},{"location":"ja/spec/24-stdlib-kvs/#kvsmget-","title":"kvs/mget - \u8907\u6570\u30ad\u30fc\u4e00\u62ec\u53d6\u5f97","text":"<p>\u8907\u6570\u306e\u30ad\u30fc\u306e\u5024\u3092\u4e00\u62ec\u3067\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/mget conn keys)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>keys</code>: \u30ad\u30fc\u540d\u306e\u30d9\u30af\u30bf</p> <p>\u623b\u308a\u5024: - \u5024\u306e\u30d9\u30af\u30bf\uff08\u5b58\u5728\u3057\u306a\u3044\u30ad\u30fc\u306f<code>nil</code>\uff09 - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/set kvs \"key1\" \"value1\")\n(kvs/set kvs \"key2\" \"value2\")\n(kvs/set kvs \"key3\" \"value3\")\n\n(kvs/mget kvs [\"key1\" \"key2\" \"key3\"])\n;; =&gt; [\"value1\" \"value2\" \"value3\"]\n\n(kvs/mget kvs [\"key1\" \"nonexistent\" \"key3\"])\n;; =&gt; [\"value1\" nil \"value3\"]\n\n;; \u7a7a\u306e\u30d9\u30af\u30bf\n(kvs/mget kvs [])\n;; =&gt; []\n</code></pre></p> <p>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30e1\u30ea\u30c3\u30c8: - \u8907\u6570\u306e\u30ad\u30fc\u30921\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\u3067\u53d6\u5f97 - \u30eb\u30fc\u30d7\u51e6\u7406\u3088\u308a\u9ad8\u901f</p> <pre><code>;; \u274c \u975e\u52b9\u7387\uff083\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\uff09\n(def v1 (kvs/get kvs \"key1\"))\n(def v2 (kvs/get kvs \"key2\"))\n(def v3 (kvs/get kvs \"key3\"))\n\n;; \u2705 \u52b9\u7387\u7684\uff081\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\uff09\n(def [v1 v2 v3] (kvs/mget kvs [\"key1\" \"key2\" \"key3\"]))\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#kvsmset-","title":"kvs/mset - \u8907\u6570\u30ad\u30fc\u4e00\u62ec\u8a2d\u5b9a","text":"<p>\u8907\u6570\u306e\u30ad\u30fc\u3068\u5024\u3092\u4e00\u62ec\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>(kvs/mset conn pairs)\n</code></pre> <p>\u5f15\u6570: - <code>conn</code>: \u63a5\u7d9aID - <code>pairs</code>: \u30ad\u30fc\u3068\u5024\u306e\u30de\u30c3\u30d7</p> <p>\u623b\u308a\u5024: - <code>\"OK\"</code> (\u6210\u529f\u6642) - <code>{:error \"message\"}</code> (\u5931\u6557\u6642)</p> <p>\u4f8b: <pre><code>(kvs/mset kvs {\"key1\" \"value1\" \"key2\" \"value2\" \"key3\" \"value3\"})\n;; =&gt; \"OK\"\n\n;; \u5927\u91cf\u306e\u30ad\u30fc\u3092\u4e00\u5ea6\u306b\u8a2d\u5b9a\n(kvs/mset kvs {\n  \"user:1\" \"Alice\"\n  \"user:2\" \"Bob\"\n  \"user:3\" \"Charlie\"\n  \"cache:1\" \"data1\"\n  \"cache:2\" \"data2\"\n})\n;; =&gt; \"OK\"\n</code></pre></p> <p>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30e1\u30ea\u30c3\u30c8: - \u8907\u6570\u306e\u30ad\u30fc\u30921\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\u3067\u8a2d\u5b9a - \u30eb\u30fc\u30d7\u51e6\u7406\u3088\u308a\u9ad8\u901f - \u30a2\u30c8\u30df\u30c3\u30af\u306b\u5b9f\u884c\u3055\u308c\u308b\uff08\u5168\u3066\u6210\u529f\u3059\u308b\u304b\u3001\u5168\u3066\u5931\u6557\u3059\u308b\uff09</p> <pre><code>;; \u274c \u975e\u52b9\u7387\uff083\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\uff09\n(kvs/set kvs \"key1\" \"value1\")\n(kvs/set kvs \"key2\" \"value2\")\n(kvs/set kvs \"key3\" \"value3\")\n\n;; \u2705 \u52b9\u7387\u7684\uff081\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\uff09\n(kvs/mset kvs {\"key1\" \"value1\" \"key2\" \"value2\" \"key3\" \"value3\"})\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_16","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/24-stdlib-kvs/#_17","title":"\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30e3\u30c3\u30b7\u30e5","text":"<p>Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u306bKVS\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(def kvs (kvs/connect \"redis://localhost:6379\"))\n\n;; \u30bb\u30c3\u30b7\u30e7\u30f3\u4f5c\u6210\n(defn create-session [user-id]\n  (def session-id (str \"session:\" user-id))\n  (def session-data (json/stringify {\n    :user_id user-id\n    :created_at (now)\n    :ip_address \"192.168.1.1\"\n  }))\n  (kvs/set kvs session-id session-data)\n  (kvs/expire kvs session-id 1800)  ;; 30\u5206\u306e\u6709\u52b9\u671f\u9650\n  session-id)\n\n;; \u30bb\u30c3\u30b7\u30e7\u30f3\u53d6\u5f97\n(defn get-session [session-id]\n  (kvs/get kvs session-id)\n  |&gt; (fn [data]\n       (if (nil? data)\n         {:error \"Session not found or expired\"}\n         (json/parse data))))\n\n;; \u30bb\u30c3\u30b7\u30e7\u30f3\u524a\u9664\uff08\u30ed\u30b0\u30a2\u30a6\u30c8\uff09\n(defn destroy-session [session-id]\n  (kvs/del kvs session-id))\n\n;; \u4f7f\u7528\u4f8b\n(def sid (create-session 42))\n;; =&gt; \"session:42\"\n\n(get-session sid)\n;; =&gt; {:user_id 42 :created_at \"2025-01-22T10:30:00Z\" :ip_address \"192.168.1.1\"}\n\n;; 30\u5206\u5f8c\n(get-session sid)\n;; =&gt; {:error \"Session not found or expired\"}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_18","title":"\u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u30ab\u30a6\u30f3\u30bf\u30fc","text":"<p>Web\u30da\u30fc\u30b8\u306e\u30a2\u30af\u30bb\u30b9\u6570\u3092\u8a18\u9332\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u8a18\u9332\n(defn track-page-view [page-url]\n  (kvs/incr kvs (str \"page-views:\" page-url)))\n\n;; \u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u53d6\u5f97\n(defn get-page-views [page-url]\n  (def count-str (kvs/get kvs (str \"page-views:\" page-url)))\n  (if (nil? count-str)\n    0\n    (parse-int count-str)))\n\n;; \u4eba\u6c17\u30da\u30fc\u30b8\u30e9\u30f3\u30ad\u30f3\u30b0\n(defn get-popular-pages []\n  (def keys (kvs/keys kvs \"page-views:*\"))\n  (def counts (kvs/mget kvs keys))\n  (map (fn [key count]\n         {:url (str/replace key \"page-views:\" \"\")\n          :views (parse-int count)})\n       keys counts)\n  |&gt; (sort-by (fn [item] (get item :views)))\n  |&gt; reverse\n  |&gt; (take 10))\n\n;; \u4f7f\u7528\u4f8b\n(track-page-view \"/home\")     ;; =&gt; 1\n(track-page-view \"/home\")     ;; =&gt; 2\n(track-page-view \"/about\")    ;; =&gt; 1\n(track-page-view \"/home\")     ;; =&gt; 3\n\n(get-page-views \"/home\")      ;; =&gt; 3\n(get-page-views \"/about\")     ;; =&gt; 1\n(get-page-views \"/contact\")   ;; =&gt; 0\n\n(get-popular-pages)\n;; =&gt; [{:url \"/home\" :views 3} {:url \"/about\" :views 1}]\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_19","title":"\u30bf\u30b9\u30af\u30ad\u30e5\u30fc\uff08\u30b8\u30e7\u30d6\u30ad\u30e5\u30fc\uff09","text":"<p>\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u30bf\u30b9\u30af\u3092\u30ad\u30e5\u30fc\u3067\u7ba1\u7406\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30bf\u30b9\u30af\u8ffd\u52a0\n(defn enqueue-task [task-type task-data]\n  (def task (json/stringify {\n    :type task-type\n    :data task-data\n    :created_at (now)\n  }))\n  (kvs/rpush kvs \"task-queue\" task))\n\n;; \u30bf\u30b9\u30af\u53d6\u5f97\n(defn dequeue-task []\n  (kvs/lpop kvs \"task-queue\")\n  |&gt; (fn [data]\n       (if (nil? data)\n         nil\n         (json/parse data))))\n\n;; \u30bf\u30b9\u30af\u30ef\u30fc\u30ab\u30fc\n(defn process-tasks []\n  (loop []\n    (def task (dequeue-task))\n    (if (nil? task)\n      (do\n        (println \"No tasks, waiting...\")\n        (sleep 1000)  ;; 1\u79d2\u5f85\u6a5f\n        (recur))\n      (do\n        (println \"Processing task:\" task)\n        (match (get task :type)\n          \"send-email\" -&gt; (send-email (get task :data))\n          \"generate-report\" -&gt; (generate-report (get task :data))\n          _ -&gt; (println \"Unknown task type\"))\n        (recur)))))\n\n;; \u4f7f\u7528\u4f8b\n(enqueue-task \"send-email\" {:to \"user@example.com\" :subject \"Hello\"})\n(enqueue-task \"generate-report\" {:user_id 42})\n\n(dequeue-task)\n;; =&gt; {:type \"send-email\" :data {:to \"user@example.com\" :subject \"Hello\"} :created_at \"...\"}\n\n(dequeue-task)\n;; =&gt; {:type \"generate-report\" :data {:user_id 42} :created_at \"...\"}\n\n(dequeue-task)\n;; =&gt; nil  ;; \u30ad\u30e5\u30fc\u304c\u7a7a\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#rate-limiting","title":"\u30ec\u30fc\u30c8\u5236\u9650\uff08Rate Limiting\uff09","text":"<p>API\u306e\u30ec\u30fc\u30c8\u5236\u9650\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30ec\u30fc\u30c8\u5236\u9650\u30c1\u30a7\u30c3\u30af\uff081\u5206\u9593\u306b10\u30ea\u30af\u30a8\u30b9\u30c8\u307e\u3067\uff09\n(defn check-rate-limit [user-id]\n  (def key (str \"rate-limit:\" user-id))\n  (def count (kvs/incr kvs key))\n\n  ;; \u521d\u56de\u306e\u5834\u5408\u30011\u5206\u9593\u306e\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\n  (if (= count 1)\n    (kvs/expire kvs key 60))\n\n  ;; 10\u3092\u8d85\u3048\u305f\u3089\u5236\u9650\n  (if (&gt; count 10)\n    {:allowed false :remaining 0}\n    {:allowed true :remaining (- 10 count)}))\n\n;; \u4f7f\u7528\u4f8b\n(check-rate-limit 42)\n;; =&gt; {:allowed true :remaining 9}\n\n;; 10\u56de\u30ea\u30af\u30a8\u30b9\u30c8\u5f8c\n(check-rate-limit 42)\n;; =&gt; {:allowed true :remaining 0}\n\n;; 11\u56de\u76ee\n(check-rate-limit 42)\n;; =&gt; {:allowed false :remaining 0}\n\n;; 1\u5206\u5f8c\uff08TTL\u5207\u308c\uff09\n(check-rate-limit 42)\n;; =&gt; {:allowed true :remaining 9}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_20","title":"\u30ad\u30e3\u30c3\u30b7\u30e5\uff08\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30a8\u30ea\u7d50\u679c\uff09","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30a8\u30ea\u7d50\u679c\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u9ad8\u901f\u5316\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u53d6\u5f97\n(defn get-user-with-cache [user-id]\n  (def cache-key (str \"cache:user:\" user-id))\n\n  ;; \u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u78ba\u8a8d\n  (def cached (kvs/get kvs cache-key))\n  (if (not (nil? cached))\n    (do\n      (println \"Cache hit!\")\n      (json/parse cached))\n    (do\n      (println \"Cache miss, fetching from DB...\")\n      ;; DB\u304b\u3089\u53d6\u5f97\n      (def user (db/query db-conn \"SELECT * FROM users WHERE id = $1\" [user-id])\n                 |&gt; first)\n      ;; \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u4fdd\u5b58\uff085\u5206\u9593\uff09\n      (kvs/set kvs cache-key (json/stringify user))\n      (kvs/expire kvs cache-key 300)\n      user)))\n\n;; \u30ad\u30e3\u30c3\u30b7\u30e5\u7121\u52b9\u5316\n(defn invalidate-user-cache [user-id]\n  (kvs/del kvs (str \"cache:user:\" user-id)))\n\n;; \u4f7f\u7528\u4f8b\n(get-user-with-cache 1)\n;; =&gt; Cache miss, fetching from DB...\n;; =&gt; {:id 1 :name \"Alice\" ...}\n\n(get-user-with-cache 1)\n;; =&gt; Cache hit!\n;; =&gt; {:id 1 :name \"Alice\" ...}\n\n;; \u30e6\u30fc\u30b6\u30fc\u66f4\u65b0\u6642\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u524a\u9664\n(update-user 1 \"Alice Smith\")\n(invalidate-user-cache 1)\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_21","title":"\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"ja/spec/24-stdlib-kvs/#_22","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>KVS\u95a2\u6570\u306f\u6210\u529f\u6642\u306b\u751f\u30c7\u30fc\u30bf\u3001\u5931\u6557\u6642\u306b<code>{:error \"message\"}</code>\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406\n(def result (kvs/get kvs \"user:1\"))\n(if (error? result)\n  (println \"Error:\" (get result :error))\n  (println \"Value:\" result))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u30a8\u30e9\u30fc\u51e6\u7406\uff08|&gt;?\u3067\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\uff09\n(defn get-cached-data [key]\n  (kvs/get kvs key)\n  |&gt;? (fn [data]\n        (if (nil? data)\n          {:error \"Cache miss\"}\n          (json/parse data))))\n\n;; match\u3067\u306e\u30a8\u30e9\u30fc\u51e6\u7406\n(match (kvs/get kvs \"user:1\")\n  {:error e} -&gt; (println \"KVS error:\" e)\n  nil -&gt; (println \"Key not found\")\n  value -&gt; (println \"Value:\" value))\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_23","title":"\u63a5\u7d9a\u30a8\u30e9\u30fc","text":"<pre><code>;; \u4e0d\u6b63\u306a\u63a5\u7d9a\u6587\u5b57\u5217\n(def kvs (kvs/connect \"invalid-url\"))\n;; =&gt; {:error \"Unsupported KVS URL: invalid-url\"}\n\n;; \u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\n(def kvs (kvs/connect \"redis://localhost:9999\"))\n;; =&gt; {:error \"Connection error: ...\"}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_24","title":"\u64cd\u4f5c\u30a8\u30e9\u30fc","text":"<pre><code>;; \u578b\u30a8\u30e9\u30fc\uff08\u6587\u5b57\u5217\u4ee5\u5916\u306e\u30ad\u30fc\uff09\n(kvs/get kvs 123)\n;; =&gt; Error: kvs/get (key) expects strings\n\n;; \u4e0d\u6b63\u306a\u5f15\u6570\u6570\n(kvs/set kvs \"key\")\n;; =&gt; Error: kvs/set expects 3 arguments\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_25","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9","text":""},{"location":"ja/spec/24-stdlib-kvs/#_26","title":"\u63a5\u7d9a\u30d7\u30fc\u30eb","text":"<p>Qi\u306ekvs\u5b9f\u88c5\u306f\u81ea\u52d5\u7684\u306b\u63a5\u7d9a\u3092\u30d7\u30fc\u30eb\u3057\u307e\u3059\u3002\u540c\u3058URL\u3078\u306e\u8907\u6570\u306e<code>kvs/connect</code>\u547c\u3073\u51fa\u3057\u306f\u3001\u5185\u90e8\u3067\u540c\u3058\u63a5\u7d9a\u3092\u5171\u6709\u3057\u307e\u3059\u3002</p> <pre><code>;; \u3053\u308c\u3089\u306f\u5185\u90e8\u3067\u540c\u3058\u63a5\u7d9a\u3092\u5171\u6709\n(def kvs1 (kvs/connect \"redis://localhost:6379\"))\n(def kvs2 (kvs/connect \"redis://localhost:6379\"))\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_27","title":"\u81ea\u52d5\u518d\u63a5\u7d9a","text":"<p>\u63a5\u7d9a\u304c\u5207\u65ad\u3055\u308c\u305f\u5834\u5408\u3001\u81ea\u52d5\u7684\u306b\u518d\u63a5\u7d9a\u3092\u8a66\u884c\u3057\u307e\u3059\u3002</p> <pre><code>// Rust\u5b9f\u88c5\uff08\u53c2\u8003\uff09\nasync fn execute_with_retry&lt;T, F, Fut&gt;(url: &amp;str, operation: F) -&gt; redis::RedisResult&lt;T&gt;\nwhere\n    F: Fn(MultiplexedConnection) -&gt; Fut,\n    Fut: std::future::Future&lt;Output = redis::RedisResult&lt;T&gt;&gt;,\n{\n    // \u6700\u521d\u306e\u8a66\u884c\n    let conn = get_or_create_connection(url).await?;\n    let result = operation(conn).await;\n\n    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\u3001\u518d\u63a5\u7d9a\u3057\u3066\u518d\u8a66\u884c\n    if let Err(ref e) = result {\n        if is_connection_error(e) {\n            if let Ok(new_conn) = reconnect(url).await {\n                return operation(new_conn).await;\n            }\n        }\n    }\n\n    result\n}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_28","title":"\u30d0\u30c3\u30c1\u64cd\u4f5c\u306e\u63a8\u5968","text":"<p>\u8907\u6570\u306e\u30ad\u30fc\u3092\u6271\u3046\u5834\u5408\u306f\u3001<code>mget</code>/<code>mset</code>\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>;; \u274c \u975e\u52b9\u7387\uff08N\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\uff09\n(def keys [\"key1\" \"key2\" \"key3\" \"key4\" \"key5\"])\n(map (fn [k] (kvs/get kvs k)) keys)\n\n;; \u2705 \u52b9\u7387\u7684\uff081\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\uff09\n(kvs/mget kvs [\"key1\" \"key2\" \"key3\" \"key4\" \"key5\"])\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_29","title":"\u5b9f\u88c5\u306e\u8a73\u7d30","text":""},{"location":"ja/spec/24-stdlib-kvs/#_30","title":"\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u8a2d\u8a08","text":"<p>KVS\u306f\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u30d1\u30bf\u30fc\u30f3\u3067\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fGo\u306e<code>database/sql</code>\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u540c\u3058\u30a2\u30d7\u30ed\u30fc\u30c1\u3067\u3001\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\uff08\u30c9\u30e9\u30a4\u30d0\u30fc\uff09\u3092\u900f\u904e\u7684\u306b\u6271\u3048\u307e\u3059\u3002</p> <pre><code>\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08\u30e6\u30fc\u30b6\u30fc\u304c\u4f7f\u3046\uff09:\n- kvs/connect, kvs/get, kvs/set, kvs/del, ...\n\n\u5185\u90e8\u30c9\u30e9\u30a4\u30d0\u30fc\uff08\u516c\u958b\u3057\u306a\u3044\uff09:\n- RedisDriver, MemcachedDriver\uff08\u5c06\u6765\uff09\n</code></pre> <p>\u8a2d\u8a08\u539f\u5247: - \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u81ea\u52d5\u5224\u5225: URL\u304b\u3089\u63a5\u7d9a\u5148\u3092\u5224\u5b9a\uff08<code>redis://</code>, <code>memcached://</code>\u7b49\uff09 - \u5c02\u7528\u95a2\u6570\u306f\u975e\u516c\u958b: <code>kvs/redis-*</code>\u306f\u5185\u90e8\u30c9\u30e9\u30a4\u30d0\u30fc\u7528\u306e\u307f - \u62e1\u5f35\u6027: \u7d71\u4e00IF\u3067\u8868\u73fe\u3067\u304d\u306a\u3044\u6a5f\u80fd\uff08Redis Pub/Sub\u3001Lua scripting\u7b49\uff09\u304c\u5fc5\u8981\u306b\u306a\u3063\u305f\u5834\u5408\u306e\u307f\u5c02\u7528\u95a2\u6570\u3092\u8ffd\u52a0</p>"},{"location":"ja/spec/24-stdlib-kvs/#_31","title":"\u30c9\u30e9\u30a4\u30d0\u30fc\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>// KVS\u30c9\u30e9\u30a4\u30d0\u30fc\u30c8\u30ec\u30a4\u30c8\uff08\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff09\npub trait KvsDriver: Send + Sync {\n    fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;String&gt;, String&gt;;\n    fn set(&amp;self, key: &amp;str, value: &amp;str) -&gt; Result&lt;String, String&gt;;\n    fn delete(&amp;self, key: &amp;str) -&gt; Result&lt;i64, String&gt;;\n    fn exists(&amp;self, key: &amp;str) -&gt; Result&lt;bool, String&gt;;\n    fn keys(&amp;self, pattern: &amp;str) -&gt; Result&lt;Vec&lt;String&gt;, String&gt;;\n    fn expire(&amp;self, key: &amp;str, seconds: i64) -&gt; Result&lt;bool, String&gt;;\n    fn ttl(&amp;self, key: &amp;str) -&gt; Result&lt;i64, String&gt;;\n    // ... \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\n}\n\n// Redis\u30c9\u30e9\u30a4\u30d0\u30fc\uff08\u5185\u90e8\u5b9f\u88c5\uff09\n#[cfg(feature = \"kvs-redis\")]\nstruct RedisDriver {\n    url: String,\n}\n\nimpl KvsDriver for RedisDriver {\n    fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;String&gt;, String&gt; {\n        crate::builtins::redis::native_redis_get(&amp;[\n            Value::String(self.url.clone()),\n            Value::String(key.to_string()),\n        ])\n        // ... \u30a8\u30e9\u30fc\u5909\u63db\n    }\n    // ... \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u5b9f\u88c5\n}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_32","title":"\u975e\u540c\u671f\u51e6\u7406","text":"<p>\u5185\u90e8\u7684\u306b\u306f\u975e\u540c\u671fAPI\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u304c\u3001Qi\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u306f\u540c\u671f\u7684\u306aAPI\u3068\u3057\u3066\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <pre><code>// Rust\u3067\u306e\u5b9f\u88c5\uff08\u53c2\u8003\uff09\nuse tokio::runtime::Runtime;\n\nstatic TOKIO_RT: LazyLock&lt;Runtime&gt; =\n    LazyLock::new(|| Runtime::new().expect(\"Failed to create tokio runtime for Redis\"));\n\npub fn native_redis_get(args: &amp;[Value]) -&gt; Result&lt;Value, String&gt; {\n    // ... \u5f15\u6570\u30c1\u30a7\u30c3\u30af\n\n    // \u975e\u540c\u671f\u51e6\u7406\u3092\u540c\u671f\u7684\u306b\u5b9f\u884c\n    TOKIO_RT.block_on(async {\n        let result = execute_with_retry(url, |mut conn| async move {\n            conn.get(key).await\n        }).await;\n\n        match result {\n            Ok(Some(value)) =&gt; Ok(Value::String(value)),\n            Ok(None) =&gt; Ok(Value::Nil),\n            Err(e) =&gt; Ok(Value::error(format!(\"Get error: {}\", e))),\n        }\n    })\n}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_33","title":"\u63a5\u7d9a\u7ba1\u7406","text":"<pre><code>use dashmap::DashMap;\nuse redis::aio::MultiplexedConnection;\nuse std::sync::LazyLock;\n\n// Redis\u63a5\u7d9a\u30d7\u30fc\u30eb\uff08URL \u2192 Connection \u306e\u30de\u30c3\u30d4\u30f3\u30b0\uff09\nstatic REDIS_POOL: LazyLock&lt;DashMap&lt;String, MultiplexedConnection&gt;&gt; =\n    LazyLock::new(DashMap::new);\n\n// \u63a5\u7d9a\u3092\u53d6\u5f97\u307e\u305f\u306f\u65b0\u898f\u4f5c\u6210\nasync fn get_or_create_connection(url: &amp;str) -&gt; Result&lt;MultiplexedConnection, String&gt; {\n    // \u65e2\u5b58\u306e\u63a5\u7d9a\u3092\u53d6\u5f97\n    if let Some(conn) = REDIS_POOL.get(url) {\n        return Ok(conn.clone());\n    }\n\n    // \u65b0\u898f\u63a5\u7d9a\u3092\u4f5c\u6210\n    let client = Client::open(url)?;\n    let conn = client.get_multiplexed_async_connection().await?;\n\n    // \u30d7\u30fc\u30eb\u306b\u4fdd\u5b58\n    REDIS_POOL.insert(url.to_string(), conn.clone());\n\n    Ok(conn)\n}\n</code></pre>"},{"location":"ja/spec/24-stdlib-kvs/#_34","title":"\u30ed\u30fc\u30c9\u30de\u30c3\u30d7","text":""},{"location":"ja/spec/24-stdlib-kvs/#_35","title":"\u5c06\u6765\u7684\u306b\u5b9f\u88c5\u4e88\u5b9a\u306e\u6a5f\u80fd","text":"<p>\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u62e1\u5f35: - Memcached\u5bfe\u5fdc: <code>kvs/connect \"memcached://localhost:11211\"</code> - \u30a4\u30f3\u30e1\u30e2\u30eaKVS: <code>kvs/connect \":memory:\"</code> \uff08Pure Rust\u3001\u4f9d\u5b58\u306a\u3057\u3001\u30c6\u30b9\u30c8\u7528\uff09</p> <p>\u5c02\u7528\u95a2\u6570\u306e\u8ffd\u52a0\uff08\u7d71\u4e00IF\u3067\u8868\u73fe\u3067\u304d\u306a\u3044\u5834\u5408\u306e\u307f\uff09: - Redis Pub/Sub: <code>kvs/subscribe</code>, <code>kvs/publish</code> - Redis Lua scripting: <code>kvs/eval</code>, <code>kvs/evalsha</code> - Redis Sorted Sets: <code>kvs/zadd</code>, <code>kvs/zrange</code> - Redis Streams: <code>kvs/xadd</code>, <code>kvs/xread</code> - Redis HyperLogLog: <code>kvs/pfadd</code>, <code>kvs/pfcount</code></p> <p>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316: - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: \u8907\u6570\u30b3\u30de\u30f3\u30c9\u30921\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5f80\u5fa9\u3067\u5b9f\u884c - \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3: <code>kvs/multi</code>, <code>kvs/exec</code> - \u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0SCAN: <code>kvs/scan</code>\uff08\u5927\u91cf\u30ad\u30fc\u5bfe\u5fdc\uff09</p>"},{"location":"ja/spec/24-stdlib-kvs/#_36","title":"\u307e\u3068\u3081","text":"<p>Qi\u306ekey-value store\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u3001\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u30b7\u30f3\u30d7\u30eb\u304b\u3064\u5b89\u5168\u306a\u30a2\u30af\u30bb\u30b9\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#_37","title":"\u4e3b\u306a\u6a5f\u80fd","text":"<ul> <li>kvs/connect: Redis\u81ea\u52d5\u63a5\u7d9a\uff08\u5c06\u6765Memcached\u7b49\u3082\uff09</li> <li>\u57fa\u672c\u64cd\u4f5c: get/set/del/exists/keys/expire/ttl</li> <li>\u6570\u5024\u64cd\u4f5c: incr/decr</li> <li>\u30ea\u30b9\u30c8: lpush/rpush/lpop/rpop/lrange\uff08\u30ad\u30e5\u30fc\u3001\u30b9\u30bf\u30c3\u30af\uff09</li> <li>\u30cf\u30c3\u30b7\u30e5: hset/hget/hgetall\uff08\u69cb\u9020\u5316\u30c7\u30fc\u30bf\uff09</li> <li>\u30bb\u30c3\u30c8: sadd/smembers\uff08\u30e6\u30cb\u30fc\u30af\u306a\u5024\u306e\u96c6\u5408\uff09</li> <li>\u8907\u6570\u64cd\u4f5c: mget/mset\uff08\u30d0\u30c3\u30c1\u51e6\u7406\uff09</li> <li>\u81ea\u52d5\u518d\u63a5\u7d9a: \u63a5\u7d9a\u65ad\u6642\u306e\u81ea\u52d5\u30ea\u30c8\u30e9\u30a4</li> <li>\u63a5\u7d9a\u30d7\u30fc\u30eb: \u52b9\u7387\u7684\u306a\u63a5\u7d9a\u7ba1\u7406</li> <li>\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u900f\u904e\u7684\u5207\u308a\u66ff\u3048: \u63a5\u7d9aURL\u306e\u307f\u5909\u66f4</li> </ul> <p>\u3053\u308c\u3089\u306e\u6a5f\u80fd\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u3001\u30bf\u30b9\u30af\u30ad\u30e5\u30fc\u3001\u30ec\u30fc\u30c8\u5236\u9650\u7b49\u306e\u5b9f\u88c5\u304c\u7c21\u5358\u306b\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/24-stdlib-kvs/#_38","title":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>17-stdlib-database.md - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u7d71\u4e00\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9</li> <li>11-stdlib-http.md - Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306eKVS\u4f7f\u7528</li> <li>12-stdlib-json.md - JSON\u30c7\u30fc\u30bf\u306e\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba</li> <li>08-error-handling.md - \u30a8\u30e9\u30fc\u51e6\u7406\u30d1\u30bf\u30fc\u30f3</li> </ul>"},{"location":"ja/spec/25-stdlib-log/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30ed\u30b0\u51fa\u529b\uff08log/\uff09","text":"<p>\u69cb\u9020\u5316\u30ed\u30b0\u3068\u8907\u6570\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u5bfe\u5fdc</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>log/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/25-stdlib-log/#_1","title":"\u6982\u8981","text":"<p><code>log/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u3001\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a</p> <ul> <li>4\u6bb5\u968e\u306e\u30ed\u30b0\u30ec\u30d9\u30eb - DEBUG, INFO, WARN, ERROR</li> <li>\u69cb\u9020\u5316\u30ed\u30b0 - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u60c5\u5831\u3092\u30de\u30c3\u30d7\u3067\u8ffd\u52a0</li> <li>\u8907\u6570\u30d5\u30a9\u30fc\u30de\u30c3\u30c8 - \u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3068JSON\u5f62\u5f0f</li> <li>\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u81ea\u52d5\u4ed8\u4e0e - ISO8601\u5f62\u5f0f\uff08UTC\uff09</li> <li>\u30ec\u30d9\u30eb\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 - \u8a2d\u5b9a\u30ec\u30d9\u30eb\u672a\u6e80\u306e\u30ed\u30b0\u306f\u51fa\u529b\u3055\u308c\u306a\u3044</li> </ul> <p>\u3059\u3079\u3066\u306e\u30ed\u30b0\u306f\u6a19\u6e96\u30a8\u30e9\u30fc\u51fa\u529b\uff08stderr\uff09\u306b\u51fa\u529b\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/25-stdlib-log/#_2","title":"\u30ed\u30b0\u30ec\u30d9\u30eb","text":""},{"location":"ja/spec/25-stdlib-log/#4","title":"4\u6bb5\u968e\u306e\u30ec\u30d9\u30eb","text":"<pre><code>;; DEBUG - \u30c7\u30d0\u30c3\u30b0\u60c5\u5831\uff08\u958b\u767a\u6642\u306e\u307f\uff09\n(log/debug \"\u51e6\u7406\u958b\u59cb\")\n\n;; INFO - \u4e00\u822c\u60c5\u5831\uff08\u901a\u5e38\u306e\u52d5\u4f5c\u30ed\u30b0\uff09\n(log/info \"\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\")\n\n;; WARN - \u8b66\u544a\uff08\u554f\u984c\u306e\u53ef\u80fd\u6027\uff09\n(log/warn \"\u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\")\n\n;; ERROR - \u30a8\u30e9\u30fc\uff08\u91cd\u5927\u306a\u554f\u984c\uff09\n(log/error \"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\")\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_3","title":"\u30ec\u30d9\u30eb\u306e\u512a\u5148\u5ea6","text":"<pre><code>DEBUG (0) &lt; INFO (1) &lt; WARN (2) &lt; ERROR (3)\n</code></pre> <p>\u8a2d\u5b9a\u3057\u305f\u30ec\u30d9\u30eb\u672a\u6e80\u306e\u30ed\u30b0\u306f\u51fa\u529b\u3055\u308c\u307e\u305b\u3093\u3002</p> <p>\u30c7\u30d5\u30a9\u30eb\u30c8: <code>INFO</code>\uff08INFO\u30ec\u30d9\u30eb\u4ee5\u4e0a\u306e\u307f\u51fa\u529b\uff09</p>"},{"location":"ja/spec/25-stdlib-log/#_4","title":"\u30ed\u30b0\u51fa\u529b","text":""},{"location":"ja/spec/25-stdlib-log/#logdebug","title":"log/debug","text":"<p>DEBUG\u30ec\u30d9\u30eb\u306e\u30ed\u30b0\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\u958b\u767a\u6642\u306e\u30c7\u30d0\u30c3\u30b0\u60c5\u5831\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(log/debug message)\n(log/debug message context-map)\n</code></pre> <p>\u5f15\u6570: - <code>message</code> (string) - \u30ed\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8 - <code>context-map</code> (map, optional) - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u60c5\u5831</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>;; \u30b7\u30f3\u30d7\u30eb\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\n(log/debug \"\u95a2\u6570\u958b\u59cb\")\n;; [2025-01-15T10:30:45.123+0000] DEBUG \u95a2\u6570\u958b\u59cb\n\n;; \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u4ed8\u304d\n(log/debug \"\u5909\u6570\u306e\u5024\" {:x 10 :y 20})\n;; [2025-01-15T10:30:45.456+0000] DEBUG \u5909\u6570\u306e\u5024 | x=10 y=20\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(defn process-data [data]\n  (log/debug \"\u30c7\u30fc\u30bf\u51e6\u7406\u958b\u59cb\" {:count (len data)})\n  (data\n   |&gt; (map transform)\n   |&gt; (filter valid?)))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#loginfo","title":"log/info","text":"<p>INFO\u30ec\u30d9\u30eb\u306e\u30ed\u30b0\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\u901a\u5e38\u306e\u52d5\u4f5c\u30ed\u30b0\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(log/info message)\n(log/info message context-map)\n</code></pre> <p>\u5f15\u6570: - <code>message</code> (string) - \u30ed\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8 - <code>context-map</code> (map, optional) - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u60c5\u5831</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>;; \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\n(log/info \"HTTP\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\" {:port 8080 :host \"localhost\"})\n;; [2025-01-15T10:30:45.789+0000] INFO HTTP\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5 | port=8080 host=localhost\n\n;; \u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\n(defn handle-request [req]\n  (log/info \"\u30ea\u30af\u30a8\u30b9\u30c8\u53d7\u4fe1\" {:method (get req :method) :path (get req :path)})\n  (process req))\n\n;; \u30d0\u30c3\u30c1\u51e6\u7406\u306e\u9032\u6357\n(doseq [item items]\n  (log/info \"\u30a2\u30a4\u30c6\u30e0\u51e6\u7406\" {:id (get item :id) :status \"processing\"})\n  (process-item item))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#logwarn","title":"log/warn","text":"<p>WARN\u30ec\u30d9\u30eb\u306e\u30ed\u30b0\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\u554f\u984c\u306e\u53ef\u80fd\u6027\u304c\u3042\u308b\u72b6\u6cc1\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(log/warn message)\n(log/warn message context-map)\n</code></pre> <p>\u5f15\u6570: - <code>message</code> (string) - \u30ed\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8 - <code>context-map</code> (map, optional) - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u60c5\u5831</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8b66\u544a\n(log/warn \"\u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\" {:timeout-ms 5000 :retry-count 3})\n;; [2025-01-15T10:30:46.012+0000] WARN \u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8 | timeout-ms=5000 retry-count=3\n\n;; \u30ea\u30c8\u30e9\u30a4\u53ef\u80fd\u306a\u30a8\u30e9\u30fc\n(defn fetch-with-retry [url max-retries]\n  (loop [retries 0]\n    (try\n      (http/get url)\n      (fn [err]\n        (if (&lt; retries max-retries)\n            (do\n              (log/warn \"\u30ea\u30af\u30a8\u30b9\u30c8\u5931\u6557\u3001\u30ea\u30c8\u30e9\u30a4\u4e2d\" {:url url :retry retries :error err})\n              (recur (+ retries 1)))\n            (log/error \"\u6700\u5927\u30ea\u30c8\u30e9\u30a4\u56de\u6570\u306b\u5230\u9054\" {:url url :error err}))))))\n\n;; \u975e\u63a8\u5968\u306e\u6a5f\u80fd\u4f7f\u7528\n(defn old-api [data]\n  (log/warn \"\u975e\u63a8\u5968\u306eAPI\u304c\u4f7f\u7528\u3055\u308c\u307e\u3057\u305f\" {:function \"old-api\"})\n  (process-legacy data))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#logerror","title":"log/error","text":"<p>ERROR\u30ec\u30d9\u30eb\u306e\u30ed\u30b0\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\u91cd\u5927\u306a\u554f\u984c\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>(log/error message)\n(log/error message context-map)\n</code></pre> <p>\u5f15\u6570: - <code>message</code> (string) - \u30ed\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8 - <code>context-map</code> (map, optional) - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u60c5\u5831</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>;; \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u30a8\u30e9\u30fc\n(log/error \"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\" {:error \"connection refused\" :host \"localhost\"})\n;; [2025-01-15T10:30:46.345+0000] ERROR \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557 | error=connection refused host=localhost\n\n;; \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(try\n  (db/connect db-config)\n  (fn [err]\n    (log/error \"DB\u63a5\u7d9a\u30a8\u30e9\u30fc\" {:config db-config :error (str err)})\n    (exit 1)))\n\n;; \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\n(defn validate-user [user]\n  (if (not (get user :email))\n      (do\n        (log/error \"\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\" {:field \"email\" :user-id (get user :id)})\n        false)\n      true))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_5","title":"\u8a2d\u5b9a","text":""},{"location":"ja/spec/25-stdlib-log/#logset-level","title":"log/set-level","text":"<p>\u30ed\u30b0\u30ec\u30d9\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u3057\u305f\u30ec\u30d9\u30eb\u672a\u6e80\u306e\u30ed\u30b0\u306f\u51fa\u529b\u3055\u308c\u307e\u305b\u3093\u3002</p> <pre><code>(log/set-level level-string)\n</code></pre> <p>\u5f15\u6570: - <code>level-string</code> (string) - \u30ed\u30b0\u30ec\u30d9\u30eb\uff08<code>\"debug\"</code>, <code>\"info\"</code>, <code>\"warn\"</code>, <code>\"error\"</code>\uff09</p> <p>\u623b\u308a\u5024: nil</p> <p>\u4f8b:</p> <pre><code>;; \u958b\u767a\u74b0\u5883: \u3059\u3079\u3066\u306e\u30ed\u30b0\u3092\u51fa\u529b\n(log/set-level \"debug\")\n(log/debug \"\u3053\u308c\u306f\u8868\u793a\u3055\u308c\u308b\")\n(log/info \"\u3053\u308c\u3082\u8868\u793a\u3055\u308c\u308b\")\n\n;; \u672c\u756a\u74b0\u5883: INFO\u30ec\u30d9\u30eb\u4ee5\u4e0a\u306e\u307f\n(log/set-level \"info\")\n(log/debug \"\u3053\u308c\u306f\u8868\u793a\u3055\u308c\u306a\u3044\")\n(log/info \"\u3053\u308c\u306f\u8868\u793a\u3055\u308c\u308b\")\n\n;; \u30a8\u30e9\u30fc\u306e\u307f\n(log/set-level \"error\")\n(log/warn \"\u3053\u308c\u306f\u8868\u793a\u3055\u308c\u306a\u3044\")\n(log/error \"\u3053\u308c\u306f\u8868\u793a\u3055\u308c\u308b\")\n\n;; \u74b0\u5883\u5909\u6570\u304b\u3089\u8a2d\u5b9a\n(log/set-level (env/get \"LOG_LEVEL\" \"info\"))\n\n;; \u8b66\u544a\u30ec\u30d9\u30eb\uff08\"warning\" \u3082\u53d7\u3051\u4ed8\u3051\u308b\uff09\n(log/set-level \"warning\")\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#logset-format","title":"log/set-format","text":"<p>\u30ed\u30b0\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>(log/set-format format-string)\n</code></pre> <p>\u5f15\u6570: - <code>format-string</code> (string) - \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\uff08<code>\"text\"</code>, <code>\"plain\"</code>, <code>\"json\"</code>\uff09</p> <p>\u623b\u308a\u5024: nil</p> <p>\u30d5\u30a9\u30fc\u30de\u30c3\u30c8:</p>"},{"location":"ja/spec/25-stdlib-log/#_6","title":"\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09","text":"<pre><code>(log/set-format \"text\")\n(log/info \"\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\" {:port 8080})\n;; [2025-01-15T10:30:45.123+0000] INFO \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5 | port=8080\n</code></pre> <p>\u5f62\u5f0f: <code>[\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7] \u30ec\u30d9\u30eb \u30e1\u30c3\u30bb\u30fc\u30b8 | key1=value1 key2=value2</code></p>"},{"location":"ja/spec/25-stdlib-log/#json","title":"JSON\u5f62\u5f0f","text":"<pre><code>(log/set-format \"json\")\n(log/info \"\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\" {:port 8080})\n;; {\"timestamp\":\"2025-01-15T10:30:45.123+0000\",\"level\":\"INFO\",\"message\":\"\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\",\"port\":\"8080\"}\n</code></pre> <p>\u7528\u9014: - text: \u4eba\u9593\u304c\u8aad\u307f\u3084\u3059\u3044\uff08\u958b\u767a\u74b0\u5883\u3001\u30c7\u30d0\u30c3\u30b0\uff09 - json: \u30ed\u30b0\u96c6\u7d04\u30c4\u30fc\u30eb\u5411\u3051\uff08Elasticsearch, Splunk\u7b49\uff09</p> <p>\u4f8b:</p> <pre><code>;; \u74b0\u5883\u306b\u5fdc\u3058\u3066\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u5909\u66f4\n(let [env (env/get \"ENV\" \"development\")]\n  (if (= env \"production\")\n      (log/set-format \"json\")\n      (log/set-format \"text\")))\n\n;; JSON\u5f62\u5f0f\u3067\u69cb\u9020\u5316\u30ed\u30b0\n(log/set-format \"json\")\n(log/info \"\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5b8c\u4e86\"\n  {:request-id \"req-123\"\n   :user-id 456\n   :duration-ms 234\n   :status 200})\n;; {\"timestamp\":\"2025-01-15T10:30:45.567+0000\",\"level\":\"INFO\",\"message\":\"\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5b8c\u4e86\",\"request-id\":\"req-123\",\"user-id\":\"456\",\"duration-ms\":\"234\",\"status\":\"200\"}\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_7","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/25-stdlib-log/#_8","title":"\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8d77\u52d5\u6642\u306e\u8a2d\u5b9a","text":"<pre><code>;; \u8d77\u52d5\u6642\u306b\u30ed\u30b0\u8a2d\u5b9a\u3092\u521d\u671f\u5316\n(defn init-logging []\n  (let [level (env/get \"LOG_LEVEL\" \"info\")\n        format (env/get \"LOG_FORMAT\" \"text\")]\n    (log/set-level level)\n    (log/set-format format)\n    (log/info \"\u30ed\u30b0\u8a2d\u5b9a\u5b8c\u4e86\" {:level level :format format})))\n\n(init-logging)\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#http","title":"HTTP\u30b5\u30fc\u30d0\u30fc\u306e\u30ed\u30b0","text":"<pre><code>;; \u30ea\u30af\u30a8\u30b9\u30c8/\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30ed\u30b0\n(defn log-request [req]\n  (log/info \"\u30ea\u30af\u30a8\u30b9\u30c8\u53d7\u4fe1\"\n    {:method (get req :method)\n     :path (get req :path)\n     :user-agent (get-in req [:headers \"User-Agent\"])}))\n\n(defn log-response [req res duration-ms]\n  (log/info \"\u30ec\u30b9\u30dd\u30f3\u30b9\u9001\u4fe1\"\n    {:method (get req :method)\n     :path (get req :path)\n     :status (get res :status)\n     :duration-ms duration-ms}))\n\n;; \u30df\u30c9\u30eb\u30a6\u30a7\u30a2\n(defn logging-middleware [handler]\n  (fn [req]\n    (let [start (time/now-ms)]\n      (log-request req)\n      (let [res (handler req)\n            duration (- (time/now-ms) start)]\n        (log-response req res duration)\n        res))))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_9","title":"\u30a8\u30e9\u30fc\u8ffd\u8de1","text":"<pre><code>;; \u30a8\u30e9\u30fc\u8a73\u7d30\u3092\u30ed\u30b0\u306b\u8a18\u9332\n(defn process-with-error-tracking [data]\n  (try\n    (do\n      (log/debug \"\u51e6\u7406\u958b\u59cb\" {:data-size (len data)})\n      (let [result (process data)]\n        (log/info \"\u51e6\u7406\u6210\u529f\" {:result-size (len result)})\n        result))\n    (fn [err]\n      (log/error \"\u51e6\u7406\u5931\u6557\"\n        {:error (str err)\n         :data-size (len data)\n         :stack-trace (get err :stack)})\n      (throw err))))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_10","title":"\u30d0\u30c3\u30c1\u51e6\u7406\u306e\u9032\u6357\u30ed\u30b0","text":"<pre><code>;; \u5927\u91cf\u30c7\u30fc\u30bf\u51e6\u7406\u306e\u9032\u6357\u8868\u793a\n(defn process-batch [items]\n  (let [total (len items)]\n    (log/info \"\u30d0\u30c3\u30c1\u51e6\u7406\u958b\u59cb\" {:total total})\n    (loop [i 0\n           processed 0\n           failed 0]\n      (if (&lt; i total)\n          (let [item (nth items i)\n                result (try\n                         (do\n                           (process-item item)\n                           :ok)\n                         (fn [err]\n                           (log/warn \"\u30a2\u30a4\u30c6\u30e0\u51e6\u7406\u5931\u6557\"\n                             {:index i :item-id (get item :id) :error (str err)})\n                           :error))]\n            (when (= (mod i 100) 0)\n              (log/info \"\u9032\u6357\"\n                {:processed i :total total :percent (/ (* i 100) total)}))\n            (recur\n              (+ i 1)\n              (if (= result :ok) (+ processed 1) processed)\n              (if (= result :error) (+ failed 1) failed)))\n          (log/info \"\u30d0\u30c3\u30c1\u51e6\u7406\u5b8c\u4e86\"\n            {:total total :processed processed :failed failed})))))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_11","title":"\u30c7\u30d0\u30c3\u30b0\u30ed\u30b0","text":"<pre><code>;; \u958b\u767a\u6642\u306e\u30c7\u30d0\u30c3\u30b0\n(defn complex-calculation [x y z]\n  (log/debug \"\u8a08\u7b97\u958b\u59cb\" {:x x :y y :z z})\n\n  (let [step1 (+ x y)]\n    (log/debug \"\u30b9\u30c6\u30c3\u30d71\u5b8c\u4e86\" {:step1 step1})\n\n    (let [step2 (* step1 z)]\n      (log/debug \"\u30b9\u30c6\u30c3\u30d72\u5b8c\u4e86\" {:step2 step2})\n\n      (let [result (/ step2 2)]\n        (log/debug \"\u8a08\u7b97\u5b8c\u4e86\" {:result result})\n        result))))\n\n;; \u672c\u756a\u74b0\u5883\u3067\u306f DEBUG \u30ed\u30b0\u306f\u51fa\u529b\u3055\u308c\u306a\u3044\n(log/set-level \"info\")\n(complex-calculation 10 20 5)  ;; \u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\u306f\u8868\u793a\u3055\u308c\u306a\u3044\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_12","title":"\u69cb\u9020\u5316\u30ed\u30b0\u306e\u6d3b\u7528","text":"<pre><code>;; JSON\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u7d71\u4e00\u3057\u305f\u30ed\u30b0\u69cb\u9020\n(log/set-format \"json\")\n\n;; \u30e6\u30fc\u30b6\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u8ffd\u8de1\n(defn track-user-action [user-id action details]\n  (log/info \"\u30e6\u30fc\u30b6\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\"\n    {:user-id user-id\n     :action action\n     :timestamp (time/now-iso)\n     :details (json/stringify details)}))\n\n(track-user-action 123 \"login\" {:ip \"192.168.1.1\" :device \"mobile\"})\n;; {\"timestamp\":\"2025-01-15T10:30:45.890+0000\",\"level\":\"INFO\",\"message\":\"\u30e6\u30fc\u30b6\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\",\"user-id\":\"123\",\"action\":\"login\",\"details\":\"{\\\"ip\\\":\\\"192.168.1.1\\\",\\\"device\\\":\\\"mobile\\\"}\"}\n\n;; \u30ed\u30b0\u96c6\u7d04\u30c4\u30fc\u30eb\uff08Elasticsearch\u7b49\uff09\u3067\u691c\u7d22\u30fb\u5206\u6790\u304c\u5bb9\u6613\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_13","title":"\u6761\u4ef6\u4ed8\u304d\u30ed\u30b0","text":"<pre><code>;; \u7279\u5b9a\u6761\u4ef6\u3067\u306e\u307f\u30ed\u30b0\u51fa\u529b\n(defn process-with-conditional-log [data]\n  (when (&gt; (len data) 1000)\n    (log/warn \"\u5927\u91cf\u30c7\u30fc\u30bf\u51e6\u7406\" {:size (len data)}))\n\n  (let [result (process data)]\n    (when (empty? result)\n      (log/warn \"\u51e6\u7406\u7d50\u679c\u304c\u7a7a\" {:input-size (len data)}))\n    result))\n\n;; \u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u6642\u306e\u307f\u8a73\u7d30\u30ed\u30b0\n(def debug-mode (= (env/get \"DEBUG\") \"true\"))\n\n(defn debug-log [msg ctx]\n  (when debug-mode\n    (log/debug msg ctx)))\n\n(debug-log \"\u8a73\u7d30\u60c5\u5831\" {:var1 x :var2 y})\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_14","title":"\u30ed\u30b0\u30ec\u30d9\u30eb\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/spec/25-stdlib-log/#debug","title":"DEBUG\u30ec\u30d9\u30eb","text":"<p>\u7528\u9014: \u958b\u767a\u6642\u306e\u30c7\u30d0\u30c3\u30b0\u60c5\u5831</p> <pre><code>;; \u5909\u6570\u306e\u5024\n(log/debug \"\u5909\u6570\u306e\u5024\" {:x x :y y})\n\n;; \u95a2\u6570\u306e\u958b\u59cb/\u7d42\u4e86\n(log/debug \"\u95a2\u6570\u958b\u59cb\" {:function \"process-data\" :args args})\n(log/debug \"\u95a2\u6570\u7d42\u4e86\" {:function \"process-data\" :result result})\n\n;; \u5185\u90e8\u72b6\u614b\n(log/debug \"\u30eb\u30fc\u30d7\u72b6\u614b\" {:iteration i :current-value val})\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#info","title":"INFO\u30ec\u30d9\u30eb","text":"<p>\u7528\u9014: \u901a\u5e38\u306e\u52d5\u4f5c\u30ed\u30b0\u3001\u91cd\u8981\u306a\u30a4\u30d9\u30f3\u30c8</p> <pre><code>;; \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5/\u505c\u6b62\n(log/info \"\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\" {:port 8080})\n(log/info \"\u30b5\u30fc\u30d0\u30fc\u505c\u6b62\")\n\n;; \u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\n(log/info \"\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406\u5b8c\u4e86\" {:path \"/api/users\" :status 200})\n\n;; \u30d0\u30c3\u30c1\u51e6\u7406\u306e\u958b\u59cb/\u5b8c\u4e86\n(log/info \"\u30d0\u30c3\u30c1\u51e6\u7406\u958b\u59cb\" {:job-id \"batch-001\"})\n(log/info \"\u30d0\u30c3\u30c1\u51e6\u7406\u5b8c\u4e86\" {:job-id \"batch-001\" :processed 1000})\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#warn","title":"WARN\u30ec\u30d9\u30eb","text":"<p>\u7528\u9014: \u554f\u984c\u306e\u53ef\u80fd\u6027\u3001\u975e\u63a8\u5968\u306e\u4f7f\u7528</p> <pre><code>;; \u30ea\u30c8\u30e9\u30a4\u53ef\u80fd\u306a\u30a8\u30e9\u30fc\n(log/warn \"\u63a5\u7d9a\u5931\u6557\u3001\u30ea\u30c8\u30e9\u30a4\u4e2d\" {:retry-count 2 :max-retries 5})\n\n;; \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u554f\u984c\n(log/warn \"\u51e6\u7406\u6642\u9593\u304c\u9577\u3044\" {:duration-ms 5000 :threshold-ms 1000})\n\n;; \u975e\u63a8\u5968\u306e\u6a5f\u80fd\n(log/warn \"\u975e\u63a8\u5968API\u306e\u4f7f\u7528\" {:api \"old-api\" :alternative \"new-api\"})\n\n;; \u30c7\u30fc\u30bf\u306e\u554f\u984c\n(log/warn \"\u4e0d\u6b63\u306a\u30c7\u30fc\u30bf\u3092\u30b9\u30ad\u30c3\u30d7\" {:line 123 :reason \"invalid format\"})\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#error","title":"ERROR\u30ec\u30d9\u30eb","text":"<p>\u7528\u9014: \u91cd\u5927\u306a\u554f\u984c\u3001\u51e6\u7406\u5931\u6557</p> <pre><code>;; \u63a5\u7d9a\u30a8\u30e9\u30fc\n(log/error \"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\" {:error err :host db-host})\n\n;; \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\n(log/error \"\u30c7\u30fc\u30bf\u691c\u8a3c\u5931\u6557\" {:field \"email\" :value invalid-email})\n\n;; \u30b7\u30b9\u30c6\u30e0\u30a8\u30e9\u30fc\n(log/error \"\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u8fbc\u307f\u5931\u6557\" {:path file-path :error err})\n\n;; \u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\n(log/error \"\u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\" {:error err :context ctx :stack-trace stack})\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_15","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"ja/spec/25-stdlib-log/#_16","title":"\u30a8\u30e9\u30fc\u6642\u306e\u30ed\u30b0","text":"<pre><code>;; try/catch \u3068\u7d44\u307f\u5408\u308f\u305b\n(try\n  (risky-operation)\n  (fn [err]\n    (log/error \"\u64cd\u4f5c\u5931\u6557\" {:operation \"risky-operation\" :error (str err)})\n    (default-value)))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u30a8\u30e9\u30fc\n(data\n |&gt; (map (fn [x]\n           (try\n             (process x)\n             (fn [err]\n               (log/warn \"\u30a2\u30a4\u30c6\u30e0\u51e6\u7406\u30b9\u30ad\u30c3\u30d7\" {:item x :error (str err)})\n               nil))))\n |&gt; (filter some?))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_17","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u8003\u616e\u4e8b\u9805","text":""},{"location":"ja/spec/25-stdlib-log/#_18","title":"\u30ed\u30b0\u30ec\u30d9\u30eb\u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>;; \u274c \u60aa\u3044\u4f8b: \u5e38\u306b\u6587\u5b57\u5217\u3092\u69cb\u7bc9\n(log/debug (str \"\u5927\u304d\u306a\u30c7\u30fc\u30bf: \" (json/stringify large-data)))\n;; DEBUG \u30ec\u30d9\u30eb\u3067\u306a\u304f\u3066\u3082\u6587\u5b57\u5217\u69cb\u7bc9\u306e\u30b3\u30b9\u30c8\u304c\u304b\u304b\u308b\n\n;; \u2705 \u826f\u3044\u4f8b: \u5fc5\u8981\u306a\u5834\u5408\u306e\u307f\u69cb\u7bc9\n(when (&gt;= (log/current-level) :debug)  ;; \u4eee\u60f3\u306e\u95a2\u6570\n  (log/debug \"\u5927\u304d\u306a\u30c7\u30fc\u30bf\" {:data large-data}))\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_19","title":"\u672c\u756a\u74b0\u5883\u3067\u306e\u8a2d\u5b9a","text":"<pre><code>;; \u672c\u756a\u74b0\u5883\n(log/set-level \"info\")    ;; DEBUG \u30ed\u30b0\u306f\u51fa\u529b\u3057\u306a\u3044\n(log/set-format \"json\")   ;; \u69cb\u9020\u5316\u30ed\u30b0\u3067\u96c6\u7d04\u30fb\u5206\u6790\n\n;; \u958b\u767a\u74b0\u5883\n(log/set-level \"debug\")   ;; \u3059\u3079\u3066\u306e\u30ed\u30b0\u3092\u51fa\u529b\n(log/set-format \"text\")   ;; \u4eba\u9593\u304c\u8aad\u307f\u3084\u3059\u3044\u5f62\u5f0f\n</code></pre>"},{"location":"ja/spec/25-stdlib-log/#_20","title":"\u95a2\u6570\u4e00\u89a7","text":"\u95a2\u6570 \u8aac\u660e \u7528\u9014 <code>log/debug</code> DEBUG\u30ec\u30d9\u30eb\u30ed\u30b0\u51fa\u529b \u30c7\u30d0\u30c3\u30b0\u60c5\u5831 <code>log/info</code> INFO\u30ec\u30d9\u30eb\u30ed\u30b0\u51fa\u529b \u901a\u5e38\u306e\u52d5\u4f5c\u30ed\u30b0 <code>log/warn</code> WARN\u30ec\u30d9\u30eb\u30ed\u30b0\u51fa\u529b \u8b66\u544a <code>log/error</code> ERROR\u30ec\u30d9\u30eb\u30ed\u30b0\u51fa\u529b \u30a8\u30e9\u30fc <code>log/set-level</code> \u30ed\u30b0\u30ec\u30d9\u30eb\u8a2d\u5b9a \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u5236\u5fa1 <code>log/set-format</code> \u30ed\u30b0\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u8a2d\u5b9a \u51fa\u529b\u5f62\u5f0f\u5236\u5fa1"},{"location":"ja/spec/25-stdlib-log/#_21","title":"\u30ed\u30b0\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u8a73\u7d30","text":""},{"location":"ja/spec/25-stdlib-log/#_22","title":"\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f","text":"<pre><code>[2025-01-15T10:30:45.123+0000] INFO \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5 | port=8080 host=localhost\n</code></pre> <p>\u69cb\u6210\u8981\u7d20: - <code>[...]</code> - \u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08ISO8601\u5f62\u5f0f\u3001UTC\uff09 - <code>INFO</code> - \u30ed\u30b0\u30ec\u30d9\u30eb - <code>\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5</code> - \u30e1\u30c3\u30bb\u30fc\u30b8 - <code>| key=value ...</code> - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09</p>"},{"location":"ja/spec/25-stdlib-log/#json_1","title":"JSON\u5f62\u5f0f","text":"<pre><code>{\"timestamp\":\"2025-01-15T10:30:45.123+0000\",\"level\":\"INFO\",\"message\":\"\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\",\"port\":\"8080\",\"host\":\"localhost\"}\n</code></pre> <p>\u30d5\u30a3\u30fc\u30eb\u30c9: - <code>timestamp</code> - \u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08ISO8601\u5f62\u5f0f\u3001UTC\uff09 - <code>level</code> - \u30ed\u30b0\u30ec\u30d9\u30eb - <code>message</code> - \u30e1\u30c3\u30bb\u30fc\u30b8 - \u305d\u306e\u4ed6 - \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30de\u30c3\u30d7\u306e\u30ad\u30fc\u30fb\u5024</p>"},{"location":"ja/spec/25-stdlib-log/#_23","title":"\u95a2\u9023\u9805\u76ee","text":"<ul> <li>\u30a8\u30e9\u30fc\u51e6\u7406 - try/catch\u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>\u74b0\u5883\u5909\u6570 - \u8a2d\u5b9a\u306e\u7ba1\u7406</li> <li>HTTP\u30b5\u30fc\u30d0\u30fc - \u30ea\u30af\u30a8\u30b9\u30c8\u30ed\u30b0</li> <li>\u30c7\u30d0\u30c3\u30b0 - \u30c7\u30d0\u30c3\u30b0\u6a5f\u80fd</li> </ul>"},{"location":"ja/spec/26-stdlib-markdown/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - Markdown\u51e6\u7406\uff08markdown/\uff09","text":"<p>Markdown\u751f\u6210\u30fb\u89e3\u6790\u30e9\u30a4\u30d6\u30e9\u30ea</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>markdown/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/26-stdlib-markdown/#_1","title":"\u6982\u8981","text":"<p><code>markdown/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a</p> <ul> <li>Markdown\u751f\u6210 - \u30d8\u30c3\u30c0\u30fc\u3001\u30ea\u30b9\u30c8\u3001\u30c6\u30fc\u30d6\u30eb\u3001\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u306a\u3069\u306e\u751f\u6210</li> <li>Markdown\u89e3\u6790 - Markdown\u6587\u5b57\u5217\u304b\u3089AST\u3078\u306e\u5909\u63db</li> <li>\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u62bd\u51fa - Markdown\u304b\u3089\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u3092\u62bd\u51fa</li> <li>AST\u64cd\u4f5c - AST\u3092Markdown\u6587\u5b57\u5217\u306b\u518d\u5909\u63db</li> </ul>"},{"location":"ja/spec/26-stdlib-markdown/#_2","title":"\u751f\u6210\u95a2\u6570","text":""},{"location":"ja/spec/26-stdlib-markdown/#markdownheader","title":"markdown/header","text":"<p>Markdown\u30d8\u30c3\u30c0\u30fc\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/header level text)\n</code></pre> <p>\u5f15\u6570: - <code>level</code> (integer) - \u30d8\u30c3\u30c0\u30fc\u30ec\u30d9\u30eb (1-6) - <code>text</code> (string) - \u30d8\u30c3\u30c0\u30fc\u30c6\u30ad\u30b9\u30c8</p> <p>\u623b\u308a\u5024: string - Markdown\u30d8\u30c3\u30c0\u30fc\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>(markdown/header 1 \"Title\")\n;; =&gt; \"# Title\"\n\n(markdown/header 2 \"Subtitle\")\n;; =&gt; \"## Subtitle\"\n\n(markdown/header 3 \"Section\")\n;; =&gt; \"### Section\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n([\"Introduction\" \"Getting Started\" \"Examples\"]\n |&gt; (map-indexed (fn [i text] (markdown/header (+ i 1) text)))\n |&gt; (join \"\\n\\n\"))\n;; =&gt; \"# Introduction\\n\\n## Getting Started\\n\\n### Examples\"\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownlist","title":"markdown/list","text":"<p>Markdown\u7b87\u6761\u66f8\u304d\u30ea\u30b9\u30c8\uff08\u9806\u4e0d\u540c\u30ea\u30b9\u30c8\uff09\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/list items)\n</code></pre> <p>\u5f15\u6570: - <code>items</code> (list | vector) - \u9805\u76ee\u306e\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: string - Markdown\u30ea\u30b9\u30c8\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>(markdown/list [\"Apple\" \"Banana\" \"Cherry\"])\n;; =&gt; \"- Apple\\n- Banana\\n- Cherry\"\n\n;; \u6570\u5024\u3084\u6df7\u5408\u578b\u3082\u81ea\u52d5\u5909\u63db\n(markdown/list [1 2 3])\n;; =&gt; \"- 1\\n- 2\\n- 3\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n([\"Task 1\" \"Task 2\" \"Task 3\"]\n |&gt; markdown/list\n |&gt; println)\n;; - Task 1\n;; - Task 2\n;; - Task 3\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownordered-list","title":"markdown/ordered-list","text":"<p>Markdown\u756a\u53f7\u4ed8\u304d\u30ea\u30b9\u30c8\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/ordered-list items)\n</code></pre> <p>\u5f15\u6570: - <code>items</code> (list | vector) - \u9805\u76ee\u306e\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: string - Markdown\u756a\u53f7\u4ed8\u304d\u30ea\u30b9\u30c8\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>(markdown/ordered-list [\"First\" \"Second\" \"Third\"])\n;; =&gt; \"1. First\\n2. Second\\n3. Third\"\n\n;; \u624b\u9806\u66f8\u3092\u751f\u6210\n(def steps [\"Install Qi\" \"Write code\" \"Run program\"])\n(markdown/ordered-list steps)\n;; =&gt; \"1. Install Qi\\n2. Write code\\n3. Run program\"\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdowntable","title":"markdown/table","text":"<p>Markdown\u30c6\u30fc\u30d6\u30eb\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u6700\u521d\u306e\u884c\u304c\u30d8\u30c3\u30c0\u30fc\u3068\u3057\u3066\u6271\u308f\u308c\u307e\u3059\u3002</p> <pre><code>(markdown/table rows)\n</code></pre> <p>\u5f15\u6570: - <code>rows</code> (list | vector) - \u884c\u306e\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\u3002\u5404\u884c\u3082\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: string - Markdown\u30c6\u30fc\u30d6\u30eb\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u30c6\u30fc\u30d6\u30eb\n(def data [\n  [\"Name\" \"Age\" \"City\"]\n  [\"Alice\" 30 \"Tokyo\"]\n  [\"Bob\" 25 \"Osaka\"]])\n\n(markdown/table data)\n;; =&gt; \"| Name | Age | City |\n;;     | --- | --- | --- |\n;;     | Alice | 30 | Tokyo |\n;;     | Bob | 25 | Osaka |\"\n\n;; CSV\u30c7\u30fc\u30bf\u3092\u30c6\u30fc\u30d6\u30eb\u306b\u5909\u63db\n(csv/read-file \"users.csv\"\n |&gt; markdown/table\n |&gt; io/write \"users.md\")\n</code></pre> <p>\u30a8\u30e9\u30fc: - \u30c6\u30fc\u30d6\u30eb\u304c\u7a7a\u306e\u5834\u5408 - \u884c\u304c\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\u3067\u306a\u3044\u5834\u5408 - \u5217\u6570\u304c\u4e0d\u4e00\u81f4\u306e\u5834\u5408</p>"},{"location":"ja/spec/26-stdlib-markdown/#markdowncode-block","title":"markdown/code-block","text":"<p>Markdown\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/code-block lang code)\n</code></pre> <p>\u5f15\u6570: - <code>lang</code> (string | nil) - \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u540d\uff08nil\u306e\u5834\u5408\u306f\u8a00\u8a9e\u6307\u5b9a\u306a\u3057\uff09 - <code>code</code> (string) - \u30b3\u30fc\u30c9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: string - Markdown\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>;; Qi\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\n(markdown/code-block \"qi\" \"(+ 1 2)\")\n;; =&gt; \"```qi\\n(+ 1 2)\\n```\"\n\n;; JavaScript\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\n(markdown/code-block \"js\" \"console.log('Hello')\")\n;; =&gt; \"```js\\nconsole.log('Hello')\\n```\"\n\n;; \u8a00\u8a9e\u6307\u5b9a\u306a\u3057\n(markdown/code-block nil \"plain text\")\n;; =&gt; \"```\\nplain text\\n```\"\n\n;; \u30d5\u30a1\u30a4\u30eb\u304b\u3089\u8aad\u307f\u8fbc\u3093\u3067\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u306b\n(io/read \"example.qi\"\n |&gt; (markdown/code-block \"qi\" _)\n |&gt; println)\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownlink","title":"markdown/link","text":"<p>Markdown\u30ea\u30f3\u30af\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/link text url)\n</code></pre> <p>\u5f15\u6570: - <code>text</code> (string) - \u30ea\u30f3\u30af\u30c6\u30ad\u30b9\u30c8 - <code>url</code> (string) - \u30ea\u30f3\u30af\u5148URL</p> <p>\u623b\u308a\u5024: string - Markdown\u30ea\u30f3\u30af\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>(markdown/link \"GitHub\" \"https://github.com\")\n;; =&gt; \"[GitHub](https://github.com)\"\n\n(markdown/link \"Documentation\" \"/docs\")\n;; =&gt; \"[Documentation](/docs)\"\n\n;; \u30ea\u30f3\u30af\u30ea\u30b9\u30c8\u3092\u751f\u6210\n(def links [\n  {:name \"Home\" :url \"/\"}\n  {:name \"About\" :url \"/about\"}\n  {:name \"Contact\" :url \"/contact\"}])\n\n(links\n |&gt; (map (fn [l] (markdown/link (get l :name) (:url l))))\n |&gt; markdown/list)\n;; =&gt; \"- [Home](/)\\n- [About](/about)\\n- [Contact](/contact)\"\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownimage","title":"markdown/image","text":"<p>Markdown\u753b\u50cf\u8a18\u6cd5\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/image alt src)\n</code></pre> <p>\u5f15\u6570: - <code>alt</code> (string) - \u4ee3\u66ff\u30c6\u30ad\u30b9\u30c8 - <code>src</code> (string) - \u753b\u50cf\u30d1\u30b9\u307e\u305f\u306fURL</p> <p>\u623b\u308a\u5024: string - Markdown\u753b\u50cf\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>(markdown/image \"Logo\" \"logo.png\")\n;; =&gt; \"![Logo](logo.png)\"\n\n(markdown/image \"Screenshot\" \"https://example.com/img.jpg\")\n;; =&gt; \"![Screenshot](https://example.com/img.jpg)\"\n\n;; \u753b\u50cf\u30ae\u30e3\u30e9\u30ea\u30fc\u3092\u751f\u6210\n(def images [\"img1.png\" \"img2.png\" \"img3.png\"])\n(images\n |&gt; (map-indexed (fn [i src]\n                   (markdown/image f\"Image {(+ i 1)}\" src)))\n |&gt; (join \"\\n\\n\"))\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownjoin","title":"markdown/join","text":"<p>\u8907\u6570\u306eMarkdown\u8981\u7d20\u30922\u3064\u306e\u6539\u884c\u3067\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/join parts)\n</code></pre> <p>\u5f15\u6570: - <code>parts</code> (list | vector) - Markdown\u6587\u5b57\u5217\u306e\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: string - \u7d50\u5408\u3055\u308c\u305fMarkdown\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>;; \u8907\u6570\u306e\u8981\u7d20\u3092\u7d50\u5408\n(markdown/join [\n  (markdown/header 1 \"Report\")\n  (markdown/header 2 \"Summary\")\n  \"This is a summary.\"\n  (markdown/list [\"Item 1\" \"Item 2\"])])\n;; =&gt; \"# Report\\n\\n## Summary\\n\\nThis is a summary.\\n\\n- Item 1\\n- Item 2\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n([\"# Title\" \"Content here\" \"More content\"]\n |&gt; markdown/join\n |&gt; io/write \"document.md\")\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_3","title":"\u89e3\u6790\u95a2\u6570","text":""},{"location":"ja/spec/26-stdlib-markdown/#markdownparse","title":"markdown/parse","text":"<p>Markdown\u6587\u5b57\u5217\u3092AST\u306b\u5909\u63db\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/parse text)\n</code></pre> <p>\u5f15\u6570: - <code>text</code> (string) - Markdown\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: list - \u30d6\u30ed\u30c3\u30af\u8981\u7d20\u306e\u30ea\u30b9\u30c8\u3002\u5404\u8981\u7d20\u306f\u30de\u30c3\u30d7</p> <p>\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u30d6\u30ed\u30c3\u30af\u8981\u7d20: - <code>header</code> - \u30d8\u30c3\u30c0\u30fc\uff08<code>:type \"header\"</code>, <code>:level</code>, <code>:text</code>\uff09 - <code>paragraph</code> - \u6bb5\u843d\uff08<code>:type \"paragraph\"</code>, <code>:text</code>\uff09 - <code>list</code> - \u30ea\u30b9\u30c8\uff08<code>:type \"list\"</code>, <code>:ordered</code>, <code>:items</code>\uff09 - <code>code-block</code> - \u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\uff08<code>:type \"code-block\"</code>, <code>:lang</code>, <code>:code</code>\uff09</p> <p>\u4f8b:</p> <pre><code>(def md-text \"# Title\n\nHello, world!\n\n- Item 1\n- Item 2\n\n```qi\n(+ 1 2)\n```\")\n\n(markdown/parse md-text)\n;; =&gt; [{:type \"header\" :level 1 :text \"Title\"}\n;;     {:type \"paragraph\" :text \"Hello, world!\"}\n;;     {:type \"list\" :ordered false :items [\"Item 1\" \"Item 2\"]}\n;;     {:type \"code-block\" :lang \"qi\" :code \"(+ 1 2)\"}]\n\n;; \u30d8\u30c3\u30c0\u30fc\u306e\u307f\u62bd\u51fa\n(markdown/parse md-text\n |&gt; (filter (fn [block] (= (:type block) \"header\")))\n |&gt; (map (fn [h] (:text h))))\n;; =&gt; [\"Title\"]\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownstringify","title":"markdown/stringify","text":"<p>AST\u3092Markdown\u6587\u5b57\u5217\u306b\u5909\u63db\u3057\u307e\u3059\u3002<code>markdown/parse</code> \u306e\u9006\u64cd\u4f5c\u3067\u3059\u3002</p> <pre><code>(markdown/stringify blocks)\n</code></pre> <p>\u5f15\u6570: - <code>blocks</code> (list | vector) - \u30d6\u30ed\u30c3\u30af\u8981\u7d20\u306e\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: string - Markdown\u6587\u5b57\u5217</p> <p>\u4f8b:</p> <pre><code>(def ast [\n  {:type \"header\" :level 1 :text \"Title\"}\n  {:type \"paragraph\" :text \"Hello, world!\"}\n  {:type \"list\" :ordered false :items [\"Item 1\" \"Item 2\"]}])\n\n(markdown/stringify ast)\n;; =&gt; \"# Title\\n\\nHello, world!\\n\\n- Item 1\\n- Item 2\"\n\n;; \u89e3\u6790\u3057\u3066\u7de8\u96c6\u3057\u3066\u518d\u751f\u6210\n(def modified\n  (markdown/parse original-text\n   |&gt; (map (fn [block]\n             (if (= (:type block) \"header\")\n                 (assoc block :text (str/upper (:text block)))\n                 block)))\n   |&gt; markdown/stringify))\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownextract-code-blocks","title":"markdown/extract-code-blocks","text":"<p>Markdown\u304b\u3089\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u306e\u307f\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002</p> <pre><code>(markdown/extract-code-blocks text)\n</code></pre> <p>\u5f15\u6570: - <code>text</code> (string) - Markdown\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: list - \u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u306e\u30ea\u30b9\u30c8\u3002\u5404\u8981\u7d20\u306f <code>:lang</code> \u3068 <code>:code</code> \u3092\u6301\u3064\u30de\u30c3\u30d7</p> <p>\u4f8b:</p> <pre><code>(def md-doc \"# Examples\n\n```qi\n(+ 1 2)\n</code></pre> <p>Some text here.</p> <pre><code>console.log('Hello')\n```\")\n\n(markdown/extract-code-blocks md-doc)\n;; =&gt; [{:lang \"qi\" :code \"(+ 1 2)\"}\n;;     {:lang \"js\" :code \"console.log('Hello')\"}]\n\n;; Qi\u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u306e\u307f\u5b9f\u884c\n(markdown/extract-code-blocks md-doc\n |&gt; (filter (fn [block] (= (:lang block) \"qi\")))\n |&gt; (each (fn [block] (eval-string (:code block)))))\n\n;; \u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\n(markdown/extract-code-blocks md-doc\n |&gt; (each-indexed (fn [i block]\n                    (io/write f\"code-{i}.{(:lang block)}\"\n                              (:code block)))))\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_4","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/26-stdlib-markdown/#_5","title":"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u751f\u6210","text":"<pre><code>;; \u95a2\u6570\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u81ea\u52d5\u751f\u6210\n(defn gen-function-doc [func-name args desc examples]\n  (markdown/join [\n    (markdown/header 3 func-name)\n    desc\n    (markdown/header 4 \"\u5f15\u6570\")\n    (markdown/list args)\n    (markdown/header 4 \"\u4f8b\")\n    (markdown/code-block \"qi\" (join \"\\n\\n\" examples))]))\n\n(gen-function-doc\n  \"map\"\n  [\"f - \u5909\u63db\u95a2\u6570\" \"coll - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\"]\n  \"\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u9069\u7528\u3057\u307e\u3059\u3002\"\n  [\"(map inc [1 2 3])\" \"(map str/upper [\\\"a\\\" \\\"b\\\"])\"])\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#readme","title":"README\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc","text":"<pre><code>;; \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eREADME\u3092\u751f\u6210\n(defn generate-readme [project]\n  (markdown/join [\n    (markdown/header 1 (get project :name))\n    (:description project)\n    (markdown/header 2 \"Features\")\n    (markdown/list (:features project))\n    (markdown/header 2 \"Installation\")\n    (markdown/code-block \"bash\" (:install-cmd project))\n    (markdown/header 2 \"Usage\")\n    (markdown/code-block (:lang project) (:usage-example project))\n    (markdown/header 2 \"License\")\n    (:license project)]))\n\n(def project-info {\n  :name \"My Project\"\n  :description \"A cool project\"\n  :features [\"Fast\" \"Simple\" \"Reliable\"]\n  :install-cmd \"npm install my-project\"\n  :lang \"js\"\n  :usage-example \"const mp = require('my-project');\\nmp.run();\"\n  :license \"MIT\"})\n\n(generate-readme project-info\n |&gt; io/write \"README.md\")\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_6","title":"\u9759\u7684\u30b5\u30a4\u30c8\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc","text":"<pre><code>;; Markdown\u30d5\u30a1\u30a4\u30eb\u3092\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066HTML\u306b\u5909\u63db\n(defn render-page [md-file template]\n  (let [content (io/read md-file)\n        ast (markdown/parse content)\n        title (-&gt; ast\n                  (filter (fn [b] (= (:type b) \"header\")))\n                  first\n                  :text)\n        body (markdown/stringify ast)]\n    (str/replace template \"{{{title}}}\" title\n     |&gt; (str/replace _ \"{{{body}}}\" body))))\n\n;; \u5168Markdown\u30d5\u30a1\u30a4\u30eb\u3092\u51e6\u7406\n(io/glob \"content/*.md\"\n |&gt; (each (fn [file]\n            (let [html (render-page file (io/read \"template.html\"))\n                  out-file (str/replace file \".md\" \".html\")]\n              (io/write out-file html)))))\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_7","title":"\u30ec\u30dd\u30fc\u30c8\u751f\u6210","text":"<pre><code>;; \u30c7\u30fc\u30bf\u304b\u3089\u30ec\u30dd\u30fc\u30c8\u3092\u81ea\u52d5\u751f\u6210\n(defn generate-sales-report [sales-data]\n  (let [total (reduce + (map :amount sales-data))\n        avg (/ total (count sales-data))\n        top-sales (take 5 (reverse (sort-by :amount sales-data)))]\n    (markdown/join [\n      (markdown/header 1 \"Sales Report\")\n      (markdown/header 2 \"Summary\")\n      f\"Total sales: ${total}\"\n      f\"Average: ${avg}\"\n      (markdown/header 2 \"Top 5 Sales\")\n      (markdown/table\n        (cons [\"Date\" \"Product\" \"Amount\"]\n              (map (fn [s] [(:date s) (:product s) (:amount s)])\n                   top-sales)))])))\n\n(def sales [\n  {:date \"2024-01-01\" :product \"Widget A\" :amount 1500}\n  {:date \"2024-01-02\" :product \"Widget B\" :amount 2000}\n  {:date \"2024-01-03\" :product \"Widget A\" :amount 1200}])\n\n(generate-sales-report sales\n |&gt; io/write \"report.md\")\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_8","title":"\u30d6\u30ed\u30b0\u8a18\u4e8b\u5909\u63db","text":"<pre><code>;; \u30d5\u30ed\u30f3\u30c8\u30de\u30bf\u30fc\u4ed8\u304dMarkdown\u3092\u89e3\u6790\n(defn parse-blog-post [md-text]\n  (let [lines (str/lines md-text)\n        frontmatter-end (index-of lines \"---\" 1)\n        frontmatter (take frontmatter-end (drop 1 lines))\n        content (drop (+ frontmatter-end 1) lines |&gt; (join \"\\n\"))\n        metadata (frontmatter\n                  |&gt; (map (fn [line] (str/split line \":\")))\n                  |&gt; (reduce (fn [acc [k v]]\n                               (assoc acc (keyword (str/trim k))\n                                         (str/trim v)))\n                             {}))]\n    {:metadata metadata\n     :content content\n     :ast (markdown/parse content)}))\n\n(def blog-post \"---\ntitle: My First Post\ndate: 2024-01-01\ntags: qi, programming\n---\n\n# Introduction\n\nThis is my first blog post!\")\n\n(parse-blog-post blog-post)\n;; =&gt; {:metadata {:title \"My First Post\"\n;;                :date \"2024-01-01\"\n;;                :tags \"qi, programming\"}\n;;     :content \"# Introduction\\n\\nThis is my first blog post!\"\n;;     :ast [...]}\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_9","title":"\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u62bd\u51fa","text":"<pre><code>;; \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304b\u3089\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u62bd\u51fa\u3057\u3066\u5b9f\u884c\n(defn extract-and-run-tests [md-file]\n  (let [content (io/read md-file)\n        code-blocks (markdown/extract-code-blocks content)\n        qi-tests (filter (fn [b] (= (:lang b) \"qi\")) code-blocks)]\n    (doseq [test qi-tests]\n      (try\n        (eval-string (:code test))\n        (println \"\u2713 Test passed\")\n        (catch e\n          (println f\"\u2717 Test failed: {e}\"))))))\n\n(extract-and-run-tests \"docs/examples.md\")\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#markdownpdf","title":"Markdown\u2192PDF\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; Markdown\u3092HTML\u306b\u5909\u63db\u3057\u3066PDF\u751f\u6210\n(defn md-to-pdf [md-file pdf-file]\n  (io/read md-file\n   |&gt; markdown/parse\n   |&gt; markdown/stringify\n   |&gt; (str/replace _ \"# \" \"&lt;h1&gt;\" _)  ;; \u7c21\u6613HTML\u5909\u63db\n   |&gt; (str/replace _ \"## \" \"&lt;h2&gt;\" _)\n   |&gt; (fn [html]\n        (sh/exec f\"wkhtmltopdf - {pdf-file}\" :stdin html))))\n\n(md-to-pdf \"document.md\" \"document.pdf\")\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_10","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408\u4f8b","text":"<pre><code>;; CSV\u30c7\u30fc\u30bf\u3092Markdown\u30c6\u30fc\u30d6\u30eb\u306b\u5909\u63db\u3057\u3066\u30ec\u30dd\u30fc\u30c8\u751f\u6210\n(csv/read-file \"sales.csv\"\n |&gt; markdown/table\n |&gt; (fn [table]\n      (markdown/join [\n        (markdown/header 1 \"Sales Data\")\n        table]))\n |&gt; io/write \"sales-report.md\")\n\n;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u5168Markdown\u30d5\u30a1\u30a4\u30eb\u306e\u76ee\u6b21\u3092\u751f\u6210\n(io/glob \"docs/*.md\"\n |&gt; (map (fn [file]\n           (let [content (io/read file)\n                 title (-&gt; content\n                           markdown/parse\n                           (filter (fn [b] (= (:type b) \"header\")))\n                           first\n                           :text)]\n             (markdown/link title file))))\n |&gt; markdown/list\n |&gt; (fn [toc]\n      (markdown/join [\n        (markdown/header 1 \"Table of Contents\")\n        toc]))\n |&gt; io/write \"TOC.md\")\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_11","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>;; \u30c6\u30fc\u30d6\u30eb\u751f\u6210\u306e\u30a8\u30e9\u30fc\u51e6\u7406\n(try\n  (markdown/table [])  ;; \u7a7a\u306e\u30c6\u30fc\u30d6\u30eb\n  (catch e\n    (println f\"Error: {e}\")))\n;; Error: Table cannot be empty\n\n;; \u4e0d\u6b63\u306a\u30d8\u30c3\u30c0\u30fc\u30ec\u30d9\u30eb\n(try\n  (markdown/header 7 \"Invalid\")  ;; \u30ec\u30d9\u30eb\u306f1-6\n  (catch e\n    (println f\"Error: {e}\")))\n;; Error: Header level must be between 1 and 6\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_12","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3068\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/spec/26-stdlib-markdown/#_13","title":"\u5927\u304d\u306a\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u51e6\u7406","text":"<pre><code>;; \u274c \u60aa\u3044\u4f8b: \u6587\u5b57\u5217\u9023\u7d50\u3092\u7e70\u308a\u8fd4\u3059\n(defn generate-large-doc-bad [items]\n  (reduce (fn [acc item]\n            (str acc (markdown/header 3 item) \"\\n\\n\"))\n          \"\"\n          items))\n\n;; \u2705 \u826f\u3044\u4f8b: \u30ea\u30b9\u30c8\u3092\u4f5c\u3063\u3066\u304b\u3089\u4e00\u5ea6\u306b\u7d50\u5408\n(defn generate-large-doc-good [items]\n  (items\n   |&gt; (map (fn [item] (markdown/header 3 item)))\n   |&gt; markdown/join))\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_14","title":"\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6d3b\u7528","text":"<pre><code>;; \u2705 \u30d1\u30fc\u30b9\u7d50\u679c\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\n(def parsed-doc (markdown/parse (io/read \"large-doc.md\")))\n\n;; \u8907\u6570\u56de\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n(def headers (filter (fn [b] (= (:type b) \"header\")) parsed-doc))\n(def lists (filter (fn [b] (= (:type b) \"list\")) parsed-doc))\n(def code-blocks (filter (fn [b] (= (:type b) \"code-block\")) parsed-doc))\n</code></pre>"},{"location":"ja/spec/26-stdlib-markdown/#_15","title":"\u95a2\u6570\u4e00\u89a7","text":"\u95a2\u6570 \u8aac\u660e \u7528\u9014 <code>markdown/header</code> \u30d8\u30c3\u30c0\u30fc\u751f\u6210 <code># Title</code> <code>markdown/list</code> \u7b87\u6761\u66f8\u304d\u30ea\u30b9\u30c8\u751f\u6210 <code>- Item</code> <code>markdown/ordered-list</code> \u756a\u53f7\u4ed8\u304d\u30ea\u30b9\u30c8\u751f\u6210 <code>1. Item</code> <code>markdown/table</code> \u30c6\u30fc\u30d6\u30eb\u751f\u6210 \u30c6\u30fc\u30d6\u30eb\u8a18\u6cd5 <code>markdown/code-block</code> \u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u751f\u6210 <code>```lang\\ncode\\n```</code> <code>markdown/link</code> \u30ea\u30f3\u30af\u751f\u6210 <code>[text](url)</code> <code>markdown/image</code> \u753b\u50cf\u751f\u6210 <code>![alt](src)</code> <code>markdown/join</code> \u8981\u7d20\u7d50\u5408 2\u3064\u306e\u6539\u884c\u3067\u7d50\u5408 <code>markdown/parse</code> Markdown\u2192AST \u69cb\u9020\u89e3\u6790 <code>markdown/stringify</code> AST\u2192Markdown AST\u518d\u69cb\u7bc9 <code>markdown/extract-code-blocks</code> \u30b3\u30fc\u30c9\u30d6\u30ed\u30c3\u30af\u62bd\u51fa <code>```...```</code> \u62bd\u51fa"},{"location":"ja/spec/26-stdlib-markdown/#_16","title":"\u95a2\u9023\u9805\u76ee","text":"<ul> <li>\u6587\u5b57\u5217\u64cd\u4f5c - \u30c6\u30ad\u30b9\u30c8\u51e6\u7406</li> <li>\u30d5\u30a1\u30a4\u30ebI/O - \u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>CSV\u51e6\u7406 - \u30c7\u30fc\u30bf\u5909\u63db</li> </ul>"},{"location":"ja/spec/27-stdlib-path/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30d1\u30b9\u64cd\u4f5c\uff08path/\uff09","text":"<p>\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5bfe\u5fdc\u306e\u30d1\u30b9\u64cd\u4f5c</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>path/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/27-stdlib-path/#_1","title":"\u30d1\u30b9\u7d50\u5408","text":""},{"location":"ja/spec/27-stdlib-path/#pathjoin","title":"path/join","text":"<p>\u8907\u6570\u306e\u30d1\u30b9\u8981\u7d20\u3092\u7d50\u5408\u3057\u3066\u3001\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306b\u9069\u3057\u305f\u30d1\u30b9\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(path/join \"dir\" \"subdir\" \"file.txt\")\n;; Unix: =&gt; \"dir/subdir/file.txt\"\n;; Windows: =&gt; \"dir\\\\subdir\\\\file.txt\"\n\n;; \u7d76\u5bfe\u30d1\u30b9\u3068\u306e\u7d50\u5408\n(path/join \"/usr\" \"local\" \"bin\")\n;; =&gt; \"/usr/local/bin\"\n\n;; \u53ef\u5909\u9577\u5f15\u6570\n(path/join \"a\" \"b\" \"c\" \"d\" \"e\")\n;; =&gt; \"a/b/c/d/e\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u7d44\u307f\u5408\u308f\u305b\n([\"logs\" \"2024\" \"01\" \"app.log\"]\n |&gt; (apply path/join))\n;; =&gt; \"logs/2024/01/app.log\"\n</code></pre> <p>\u5f15\u6570: - <code>parts...</code> - \u7d50\u5408\u3059\u308b\u30d1\u30b9\u8981\u7d20\uff08\u53ef\u5909\u9577\u3001\u6700\u4f4e1\u3064\uff09</p> <p>\u623b\u308a\u5024: \u7d50\u5408\u3055\u308c\u305f\u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0: - Unix/Linux/macOS: <code>/</code> \u533a\u5207\u308a - Windows: <code>\\</code> \u533a\u5207\u308a</p>"},{"location":"ja/spec/27-stdlib-path/#_2","title":"\u30d1\u30b9\u89e3\u6790","text":""},{"location":"ja/spec/27-stdlib-path/#pathbasename","title":"path/basename","text":"<p>\u30d1\u30b9\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u90e8\u5206\uff08\u6700\u5f8c\u306e\u8981\u7d20\uff09\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30d5\u30a1\u30a4\u30eb\u540d\u53d6\u5f97\n(path/basename \"/path/to/file.txt\")\n;; =&gt; \"file.txt\"\n\n;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u53d6\u5f97\n(path/basename \"/path/to/dir\")\n;; =&gt; \"dir\"\n\n;; Windows\u30d1\u30b9\n(path/basename \"C:\\\\Users\\\\Alice\\\\Document.docx\")\n;; =&gt; \"Document.docx\"\n\n;; \u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(path/basename \"/\")\n;; =&gt; \"\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(io/list-dir \"downloads\")\n |&gt; (map path/basename)\n;; =&gt; [\"file1.txt\" \"file2.pdf\" \"image.png\"]\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: \u30d5\u30a1\u30a4\u30eb\u540d\u90e8\u5206\u306e\u6587\u5b57\u5217\uff08\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u7a7a\u6587\u5b57\u5217\uff09</p>"},{"location":"ja/spec/27-stdlib-path/#pathdirname","title":"path/dirname","text":"<p>\u30d1\u30b9\u304b\u3089\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u90e8\u5206\uff08\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u90e8\u5206\u53d6\u5f97\n(path/dirname \"/path/to/file.txt\")\n;; =&gt; \"/path/to\"\n\n;; \u8907\u6570\u968e\u5c64\n(path/dirname \"/a/b/c/d.txt\")\n;; =&gt; \"/a/b/c\"\n\n;; Windows\u30d1\u30b9\n(path/dirname \"C:\\\\Users\\\\Alice\\\\file.txt\")\n;; =&gt; \"C:\\\\Users\\\\Alice\"\n\n;; \u30eb\u30fc\u30c8\u76f4\u4e0b\n(path/dirname \"/file.txt\")\n;; =&gt; \"/\"\n\n;; \u76f8\u5bfe\u30d1\u30b9\n(path/dirname \"dir/file.txt\")\n;; =&gt; \"dir\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u53d6\u5f97\n(file-path\n |&gt; path/dirname\n |&gt; io/create-dir)\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u90e8\u5206\u306e\u6587\u5b57\u5217\uff08\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u7a7a\u6587\u5b57\u5217\uff09</p>"},{"location":"ja/spec/27-stdlib-path/#pathextension","title":"path/extension","text":"<p>\u30d5\u30a1\u30a4\u30eb\u306e\u62e1\u5f35\u5b50\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>;; \u62e1\u5f35\u5b50\u53d6\u5f97\n(path/extension \"file.txt\")\n;; =&gt; \"txt\"\n\n(path/extension \"archive.tar.gz\")\n;; =&gt; \"gz\"\n\n;; \u62e1\u5f35\u5b50\u306a\u3057\n(path/extension \"README\")\n;; =&gt; \"\"\n\n;; \u30c9\u30c3\u30c8\u30d5\u30a1\u30a4\u30eb\n(path/extension \".gitignore\")\n;; =&gt; \"\"\n\n;; \u30d1\u30b9\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n(path/extension \"/path/to/document.pdf\")\n;; =&gt; \"pdf\"\n\n;; \u62e1\u5f35\u5b50\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n(io/list-dir \"src\")\n |&gt; (filter (fn [f] (= (path/extension f) \"rs\")))\n;; =&gt; [\"/path/to/main.rs\" \"/path/to/lib.rs\"]\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: \u62e1\u5f35\u5b50\uff08\u30c9\u30c3\u30c8\u306a\u3057\uff09\u3002\u62e1\u5f35\u5b50\u304c\u306a\u3044\u5834\u5408\u306f\u7a7a\u6587\u5b57\u5217</p> <p>\u6ce8\u610f: \u6700\u5f8c\u306e\u30c9\u30c3\u30c8\u3088\u308a\u5f8c\u306e\u90e8\u5206\u306e\u307f\u3092\u8fd4\u3057\u307e\u3059\uff08<code>file.tar.gz</code> \u2192 <code>\"gz\"</code>\uff09</p>"},{"location":"ja/spec/27-stdlib-path/#pathstem","title":"path/stem","text":"<p>\u30d5\u30a1\u30a4\u30eb\u540d\u304b\u3089\u62e1\u5f35\u5b50\u3092\u9664\u3044\u305f\u90e8\u5206\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>;; \u62e1\u5f35\u5b50\u306a\u3057\u30d5\u30a1\u30a4\u30eb\u540d\n(path/stem \"file.txt\")\n;; =&gt; \"file\"\n\n(path/stem \"document.pdf\")\n;; =&gt; \"document\"\n\n;; \u8907\u6570\u30c9\u30c3\u30c8\n(path/stem \"archive.tar.gz\")\n;; =&gt; \"archive.tar\"\n\n;; \u62e1\u5f35\u5b50\u306a\u3057\n(path/stem \"README\")\n;; =&gt; \"README\"\n\n;; \u30d1\u30b9\u304c\u542b\u307e\u308c\u308b\u5834\u5408\n(path/stem \"/path/to/report.docx\")\n;; =&gt; \"report\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u5909\u63db\n(\"data.csv\"\n |&gt; path/stem\n |&gt; (fn [s] (str s \"_processed.json\")))\n;; =&gt; \"data_processed.json\"\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: \u62e1\u5f35\u5b50\u3092\u9664\u3044\u305f\u30d5\u30a1\u30a4\u30eb\u540d\uff08\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u7a7a\u6587\u5b57\u5217\uff09</p>"},{"location":"ja/spec/27-stdlib-path/#_3","title":"\u30d1\u30b9\u5909\u63db","text":""},{"location":"ja/spec/27-stdlib-path/#pathabsolute","title":"path/absolute","text":"<p>\u76f8\u5bfe\u30d1\u30b9\u3092\u7d76\u5bfe\u30d1\u30b9\u306b\u5909\u63db\u3057\u307e\u3059\u3002</p> <pre><code>;; \u76f8\u5bfe\u30d1\u30b9\u3092\u7d76\u5bfe\u30d1\u30b9\u306b\u5909\u63db\n(path/absolute \"data/file.txt\")\n;; =&gt; \"/Users/alice/project/data/file.txt\"\n\n;; \u65e2\u306b\u7d76\u5bfe\u30d1\u30b9\u306e\u5834\u5408\u306f\u305d\u306e\u307e\u307e\n(path/absolute \"/usr/local/bin\")\n;; =&gt; \"/usr/local/bin\"\n\n;; \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u57fa\u6e96\n(path/absolute \".\")\n;; =&gt; \"/Users/alice/project\"\n\n;; \u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u53c2\u7167\n(path/absolute \"../other\")\n;; =&gt; \"/Users/alice/other\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(relative-paths\n |&gt; (map path/absolute))\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: \u7d76\u5bfe\u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u6ce8\u610f: \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u57fa\u6e96\u306b\u89e3\u6c7a\u3057\u307e\u3059</p>"},{"location":"ja/spec/27-stdlib-path/#pathnormalize","title":"path/normalize","text":"<p>\u30d1\u30b9\u3092\u6b63\u898f\u5316\u3057\u3001<code>.</code> \u3068 <code>..</code> \u3092\u89e3\u6c7a\u3057\u307e\u3059\u3002</p> <pre><code>;; . \u3068 .. \u3092\u89e3\u6c7a\n(path/normalize \"a/./b/../c\")\n;; =&gt; \"a/c\"\n\n(path/normalize \"/path/to/../other/./file.txt\")\n;; =&gt; \"/path/other/file.txt\"\n\n;; \u9023\u7d9a\u30b9\u30e9\u30c3\u30b7\u30e5\u3092\u7d71\u5408\n(path/normalize \"a//b///c\")\n;; =&gt; \"a/b/c\"\n\n;; \u8907\u96d1\u306a\u30d1\u30b9\n(path/normalize \"/a/b/c/../../d/./e/../f\")\n;; =&gt; \"/a/d/f\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(user-input-path\n |&gt; path/normalize\n |&gt; path/absolute)\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: \u6b63\u898f\u5316\u3055\u308c\u305f\u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u6ce8\u610f: - <code>.</code> \u306f\u7121\u8996\u3055\u308c\u307e\u3059 - <code>..</code> \u306f\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\uff08\u30b9\u30bf\u30c3\u30af\u65b9\u5f0f\uff09 - \u30eb\u30fc\u30c8\u3088\u308a\u4e0a\u306b\u306f\u79fb\u52d5\u3057\u307e\u305b\u3093</p>"},{"location":"ja/spec/27-stdlib-path/#_4","title":"\u30d1\u30b9\u5224\u5b9a","text":""},{"location":"ja/spec/27-stdlib-path/#pathis-absolute","title":"path/is-absolute?","text":"<p>\u30d1\u30b9\u304c\u7d76\u5bfe\u30d1\u30b9\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>;; \u7d76\u5bfe\u30d1\u30b9\u5224\u5b9a\n(path/is-absolute? \"/usr/bin\")\n;; =&gt; true\n\n(path/is-absolute? \"relative/path\")\n;; =&gt; false\n\n;; Windows\u30d1\u30b9\n(path/is-absolute? \"C:\\\\Program Files\")\n;; =&gt; true\n\n(path/is-absolute? \"Documents\\\\file.txt\")\n;; =&gt; false\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(paths\n |&gt; (filter path/is-absolute?))\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: <code>true</code> \u307e\u305f\u306f <code>false</code></p> <p>\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5225\u5224\u5b9a: - Unix/Linux/macOS: <code>/</code> \u3067\u59cb\u307e\u308b - Windows: <code>C:\\</code> \u3084 <code>\\\\server\\</code> \u3067\u59cb\u307e\u308b</p>"},{"location":"ja/spec/27-stdlib-path/#pathis-relative","title":"path/is-relative?","text":"<p>\u30d1\u30b9\u304c\u76f8\u5bfe\u30d1\u30b9\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>;; \u76f8\u5bfe\u30d1\u30b9\u5224\u5b9a\n(path/is-relative? \"data/file.txt\")\n;; =&gt; true\n\n(path/is-relative? \"/usr/local\")\n;; =&gt; false\n\n;; \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(path/is-relative? \".\")\n;; =&gt; true\n\n(path/is-relative? \"..\")\n;; =&gt; true\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(paths\n |&gt; (filter path/is-relative?)\n |&gt; (map path/absolute))\n</code></pre> <p>\u5f15\u6570: - <code>path</code> - \u30d1\u30b9\u6587\u5b57\u5217</p> <p>\u623b\u308a\u5024: <code>true</code> \u307e\u305f\u306f <code>false</code></p> <p>\u6ce8\u610f: <code>path/is-absolute?</code> \u306e\u9006\u3067\u3059</p>"},{"location":"ja/spec/27-stdlib-path/#_5","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/27-stdlib-path/#_6","title":"\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u306e\u69cb\u7bc9","text":"<pre><code>;; \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020\u306e\u69cb\u7bc9\n(def project-root \"/Users/alice/project\")\n(def src-dir (path/join project-root \"src\"))\n(def test-dir (path/join project-root \"tests\"))\n(def main-file (path/join src-dir \"main.qi\"))\n\n;; \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(defn user-data-path [username filename]\n  (path/join \"/data\" \"users\" username filename))\n\n(user-data-path \"alice\" \"profile.json\")\n;; =&gt; \"/data/users/alice/profile.json\"\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_7","title":"\u30d5\u30a1\u30a4\u30eb\u540d\u5909\u63db","text":"<pre><code>;; \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u540d\u751f\u6210\n(defn backup-filename [original-path]\n  (let [dir (path/dirname original-path)\n        name (path/stem original-path)\n        ext (path/extension original-path)\n        timestamp (time/now |&gt; time/format \"yyyyMMdd_HHmmss\")]\n    (path/join dir (str name \"_backup_\" timestamp \".\" ext))))\n\n(backup-filename \"/data/document.txt\")\n;; =&gt; \"/data/document_backup_20240115_143025.txt\"\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_8","title":"\u30d1\u30b9\u89e3\u6790\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306e\u53d6\u5f97\n(defn file-info [filepath]\n  {:path filepath\n   :absolute (path/absolute filepath)\n   :dir (path/dirname filepath)\n   :name (path/basename filepath)\n   :stem (path/stem filepath)\n   :ext (path/extension filepath)\n   :is-absolute (path/is-absolute? filepath)})\n\n(file-info \"src/main.qi\")\n;; =&gt; {:path \"src/main.qi\"\n;;     :absolute \"/Users/alice/project/src/main.qi\"\n;;     :dir \"src\"\n;;     :name \"main.qi\"\n;;     :stem \"main\"\n;;     :ext \"qi\"\n;;     :is-absolute false}\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_9","title":"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30c8\u30e9\u30d0\u30fc\u30b9","text":"<pre><code>;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u5168Qi\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\n(defn find-qi-files [dir]\n  (io/list-dir dir :recursive true)\n   |&gt; (filter (fn [f] (= (path/extension f) \"qi\")))\n   |&gt; (map path/absolute))\n\n(find-qi-files \"src\")\n;; =&gt; [\"/project/src/main.qi\"\n;;     \"/project/src/lib.qi\"\n;;     \"/project/src/utils/helpers.qi\"]\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_10","title":"\u5b89\u5168\u306a\u30d1\u30b9\u51e6\u7406","text":"<pre><code>;; \u30e6\u30fc\u30b6\u30fc\u5165\u529b\u306e\u30d1\u30b9\u3092\u691c\u8a3c\n(defn safe-path [base-dir user-input]\n  (let [full-path (-&gt; user-input\n                      path/normalize\n                      (fn [p] (path/join base-dir p))\n                      path/absolute)]\n    ;; \u30d9\u30fc\u30b9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5916\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u9632\u3050\n    (if (str/starts-with? full-path base-dir)\n      full-path\n      (throw \"Invalid path: outside base directory\"))))\n\n(safe-path \"/data/users/alice\" \"../bob/secret.txt\")\n;; \u30a8\u30e9\u30fc: Invalid path: outside base directory\n\n(safe-path \"/data/users/alice\" \"documents/file.txt\")\n;; =&gt; \"/data/users/alice/documents/file.txt\"\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_11","title":"\u62e1\u5f35\u5b50\u5225\u51e6\u7406","text":"<pre><code>;; \u62e1\u5f35\u5b50\u306b\u5fdc\u3058\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u51e6\u7406\n(defn process-file [filepath]\n  (match (path/extension filepath)\n    \"txt\" (io/read-file filepath)\n    \"json\" (-&gt; filepath io/read-file json/parse)\n    \"csv\" (csv/read-file filepath)\n    \"qi\" (load-file filepath)\n    _ (throw (str \"Unsupported file type: \" filepath))))\n\n;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u62ec\u51e6\u7406\n(io/list-dir \"data\")\n |&gt; (map process-file)\n |&gt; (filter some?)\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_12","title":"\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5bfe\u5fdc","text":"<pre><code>;; OS\u306b\u5fdc\u3058\u305f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\n(defn config-path []\n  (let [home (env/get \"HOME\" (env/get \"USERPROFILE\"))]\n    (if (str/contains? (env/get \"OS\" \"\") \"Windows\")\n      (path/join home \"AppData\" \"Roaming\" \"MyApp\" \"config.json\")\n      (path/join home \".config\" \"myapp\" \"config.json\"))))\n\n;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u751f\u6210\n(defn log-path [app-name]\n  (let [log-dir (if (str/contains? (env/get \"OS\" \"\") \"Windows\")\n                  (path/join (env/get \"PROGRAMDATA\") app-name \"logs\")\n                  (path/join \"/var\" \"log\" app-name))]\n    (path/join log-dir (str app-name \".log\"))))\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_13","title":"\u76f8\u5bfe\u30d1\u30b9\u306e\u4e00\u62ec\u5909\u63db","text":"<pre><code>;; \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u5185\u306e\u76f8\u5bfe\u30d1\u30b9\u3092\u7d76\u5bfe\u30d1\u30b9\u306b\u5909\u63db\n(def project-files [\n  \"src/main.qi\"\n  \"tests/test_main.qi\"\n  \"docs/README.md\"])\n\n(def absolute-files\n  (project-files\n   |&gt; (map path/absolute)\n   |&gt; (map path/normalize)))\n</code></pre>"},{"location":"ja/spec/27-stdlib-path/#_14","title":"\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5bfe\u5fdc","text":""},{"location":"ja/spec/27-stdlib-path/#_15","title":"\u30d1\u30b9\u533a\u5207\u308a\u6587\u5b57","text":"<ul> <li>Unix/Linux/macOS: <code>/</code></li> <li>Windows: <code>\\</code>\uff08\u8868\u793a\u306f <code>\\\\</code> \u306e\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\u5fc5\u8981\uff09</li> </ul> <p><code>path/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u81ea\u52d5\u7684\u306b\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u56fa\u6709\u306e\u533a\u5207\u308a\u6587\u5b57\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/27-stdlib-path/#_16","title":"\u7d76\u5bfe\u30d1\u30b9\u306e\u5f62\u5f0f","text":"<p>Unix/Linux/macOS: <pre><code>(path/is-absolute? \"/usr/local/bin\")  ;; =&gt; true\n(path/is-absolute? \"~/Documents\")     ;; =&gt; false\uff08~ \u306f\u5c55\u958b\u3055\u308c\u306a\u3044\uff09\n</code></pre></p> <p>Windows: <pre><code>(path/is-absolute? \"C:\\\\Program Files\")  ;; =&gt; true\n(path/is-absolute? \"\\\\\\\\server\\\\share\")  ;; =&gt; true\uff08UNC\u30d1\u30b9\uff09\n(path/is-absolute? \"relative\\\\path\")     ;; =&gt; false\n</code></pre></p>"},{"location":"ja/spec/27-stdlib-path/#_17","title":"\u30d1\u30b9\u6b63\u898f\u5316\u306e\u9055\u3044","text":"<p>Unix/Linux/macOS: <pre><code>(path/normalize \"/usr/./local/../bin\")\n;; =&gt; \"/usr/bin\"\n</code></pre></p> <p>Windows: <pre><code>(path/normalize \"C:\\\\Users\\\\.\\\\Alice\\\\..\\\\Bob\")\n;; =&gt; \"C:\\\\Users\\\\Bob\"\n</code></pre></p>"},{"location":"ja/spec/27-stdlib-path/#_18","title":"\u95a2\u6570\u4e00\u89a7","text":"\u95a2\u6570 \u8aac\u660e \u7528\u9014 <code>path/join</code> \u30d1\u30b9\u8981\u7d20\u3092\u7d50\u5408 \u30d1\u30b9\u69cb\u7bc9 <code>path/basename</code> \u30d5\u30a1\u30a4\u30eb\u540d\u53d6\u5f97 \u30d5\u30a1\u30a4\u30eb\u540d\u89e3\u6790 <code>path/dirname</code> \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u90e8\u5206\u53d6\u5f97 \u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea <code>path/extension</code> \u62e1\u5f35\u5b50\u53d6\u5f97 \u30d5\u30a1\u30a4\u30eb\u30bf\u30a4\u30d7\u5224\u5b9a <code>path/stem</code> \u62e1\u5f35\u5b50\u306a\u3057\u30d5\u30a1\u30a4\u30eb\u540d \u30d5\u30a1\u30a4\u30eb\u540d\u5909\u63db <code>path/absolute</code> \u7d76\u5bfe\u30d1\u30b9\u306b\u5909\u63db \u30d1\u30b9\u89e3\u6c7a <code>path/normalize</code> \u30d1\u30b9\u6b63\u898f\u5316 <code>.</code> \u3068 <code>..</code> \u306e\u89e3\u6c7a <code>path/is-absolute?</code> \u7d76\u5bfe\u30d1\u30b9\u5224\u5b9a \u30d1\u30b9\u691c\u8a3c <code>path/is-relative?</code> \u76f8\u5bfe\u30d1\u30b9\u5224\u5b9a \u30d1\u30b9\u691c\u8a3c"},{"location":"ja/spec/27-stdlib-path/#_19","title":"\u53c2\u8003","text":"<ul> <li>\u95a2\u9023\u30e2\u30b8\u30e5\u30fc\u30eb:</li> <li><code>io/</code> - \u30d5\u30a1\u30a4\u30eb\u5165\u51fa\u529b</li> <li><code>env/</code> - \u74b0\u5883\u5909\u6570</li> <li><code>str/</code> - \u6587\u5b57\u5217\u64cd\u4f5c</li> <li>\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0:</li> <li>Unix/Linux/macOS\u3001Windows\u4e21\u5bfe\u5fdc</li> <li>Rust\u306e <code>std::path</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u7528</li> </ul>"},{"location":"ja/spec/28-stdlib-stats/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\uff1a\u7d71\u8a08\u95a2\u6570","text":"<p>\u7d71\u8a08\u8a08\u7b97\u30fb\u30c7\u30fc\u30bf\u5206\u6790</p> <p><code>stats/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u7d71\u8a08\u8a08\u7b97\u306e\u305f\u3081\u306e\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u5e73\u5747\u5024\u3001\u4e2d\u592e\u5024\u3001\u5206\u6563\u3001\u6a19\u6e96\u504f\u5dee\u306a\u3069\u306e\u57fa\u672c\u7684\u306a\u7d71\u8a08\u91cf\u3092\u7c21\u5358\u306b\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002</p> <p>\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f <code>std-stats</code> feature \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/28-stdlib-stats/#_2","title":"\u6982\u8981","text":"<p>\u7d71\u8a08\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a</p> <ul> <li>\u4e2d\u5fc3\u50be\u5411\u306e\u6e2c\u5ea6: mean\uff08\u5e73\u5747\uff09, median\uff08\u4e2d\u592e\u5024\uff09, mode\uff08\u6700\u983b\u5024\uff09</li> <li>\u6563\u5e03\u5ea6\u306e\u6e2c\u5ea6: variance\uff08\u5206\u6563\uff09, stddev\uff08\u6a19\u6e96\u504f\u5dee\uff09</li> <li>\u4f4d\u7f6e\u306e\u6e2c\u5ea6: percentile\uff08\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\uff09</li> </ul> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308a\u3001\u6570\u5024\u30c7\u30fc\u30bf\uff08\u6574\u6570\u3068\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff09\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/spec/28-stdlib-stats/#_3","title":"\u4e2d\u5fc3\u50be\u5411\u306e\u6e2c\u5ea6","text":""},{"location":"ja/spec/28-stdlib-stats/#statsmean-","title":"stats/mean - \u5e73\u5747\u5024","text":"<p>\u30c7\u30fc\u30bf\u306e\u7b97\u8853\u5e73\u5747\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u7528\n(stats/mean [1 2 3 4 5])              ;; =&gt; 3.0\n\n;; \u6574\u6570\u3068\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306e\u6df7\u5728\n(stats/mean [1 2.5 3])                ;; =&gt; 2.166666...\n\n;; \u30ea\u30b9\u30c8\u3067\u3082\u4f7f\u7528\u53ef\u80fd\n(stats/mean '(10 20 30))              ;; =&gt; 20.0\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n([1 2 3 4 5] |&gt; stats/mean)           ;; =&gt; 3.0\n</code></pre> <p>\u5f15\u6570: - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff09\uff1a\u6570\u5024\u306e\u307f\u3092\u542b\u3080\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p> <p>\u623b\u308a\u5024: - \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff1a\u7b97\u8853\u5e73\u5747</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408 - \u975e\u6570\u5024\u8981\u7d20\u304c\u542b\u307e\u308c\u308b\u5834\u5408</p>"},{"location":"ja/spec/28-stdlib-stats/#statsmedian-","title":"stats/median - \u4e2d\u592e\u5024","text":"<p>\u30c7\u30fc\u30bf\u3092\u6607\u9806\u306b\u30bd\u30fc\u30c8\u3057\u305f\u969b\u306e\u4e2d\u592e\u306e\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002\u8981\u7d20\u6570\u304c\u5076\u6570\u306e\u5834\u5408\u306f\u3001\u4e2d\u592e2\u3064\u306e\u5024\u306e\u5e73\u5747\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u5947\u6570\u500b\u306e\u30c7\u30fc\u30bf\n(stats/median [1 2 3 4 5])            ;; =&gt; 3.0\n\n;; \u5076\u6570\u500b\u306e\u30c7\u30fc\u30bf\uff08\u4e2d\u592e2\u3064\u306e\u5e73\u5747\uff09\n(stats/median [1 2 3 4])              ;; =&gt; 2.5\n\n;; \u9806\u4e0d\u540c\u306e\u30c7\u30fc\u30bf\uff08\u81ea\u52d5\u7684\u306b\u30bd\u30fc\u30c8\uff09\n(stats/median [5 1 3 2 4])            ;; =&gt; 3.0\n\n;; \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\n(stats/median [1.5 2.0 2.5 3.0])      ;; =&gt; 2.25\n</code></pre> <p>\u5f15\u6570: - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff09\uff1a\u6570\u5024\u306e\u307f\u3092\u542b\u3080\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p> <p>\u623b\u308a\u5024: - \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff1a\u4e2d\u592e\u5024</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408 - \u975e\u6570\u5024\u8981\u7d20\u304c\u542b\u307e\u308c\u308b\u5834\u5408</p>"},{"location":"ja/spec/28-stdlib-stats/#statsmode-","title":"stats/mode - \u6700\u983b\u5024","text":"<p>\u6700\u3082\u983b\u7e41\u306b\u51fa\u73fe\u3059\u308b\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u7528\n(stats/mode [1 2 2 3 3 3])            ;; =&gt; 3\n\n;; \u6574\u6570\n(stats/mode [1 1 1 2 2 3])            ;; =&gt; 1\n\n;; \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\n(stats/mode [1.5 1.5 2.0 2.0 2.0])    ;; =&gt; 2.0\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n([1 2 2 3 3 3] |&gt; stats/mode)         ;; =&gt; 3\n</code></pre> <p>\u5f15\u6570: - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff09\uff1a\u6570\u5024\u306e\u307f\u3092\u542b\u3080\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p> <p>\u623b\u308a\u5024: - \u6570\u5024\uff1a\u6700\u983b\u5024\uff08\u5143\u306e\u30c7\u30fc\u30bf\u578b\u3092\u4fdd\u6301\uff09</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408 - \u975e\u6570\u5024\u8981\u7d20\u304c\u542b\u307e\u308c\u308b\u5834\u5408</p> <p>\u6ce8\u610f: - \u8907\u6570\u306e\u5024\u304c\u540c\u3058\u6700\u5927\u983b\u5ea6\u3092\u6301\u3064\u5834\u5408\u3001\u305d\u306e\u3046\u3061\u306e1\u3064\u304c\u8fd4\u3055\u308c\u307e\u3059\uff08\u3069\u308c\u304c\u8fd4\u3055\u308c\u308b\u304b\u306f\u672a\u5b9a\u7fa9\uff09</p>"},{"location":"ja/spec/28-stdlib-stats/#_4","title":"\u6563\u5e03\u5ea6\u306e\u6e2c\u5ea6","text":""},{"location":"ja/spec/28-stdlib-stats/#statsvariance-","title":"stats/variance - \u5206\u6563","text":"<p>\u30c7\u30fc\u30bf\u306e\u5206\u6563\uff08\u6a19\u672c\u5206\u6563\uff09\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\u5206\u6563\u306f\u30c7\u30fc\u30bf\u306e\u3070\u3089\u3064\u304d\u3092\u8868\u3059\u6307\u6a19\u3067\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u7528\n(stats/variance [1 2 3 4 5])          ;; =&gt; 2.0\n\n;; \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\n(stats/variance [1.0 2.0 3.0])        ;; =&gt; 0.666666...\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n([1 2 3 4 5] |&gt; stats/variance)       ;; =&gt; 2.0\n</code></pre> <p>\u8a08\u7b97\u5f0f: <pre><code>variance = \u03a3(xi - mean)\u00b2 / n\n</code></pre></p> <p>\u5f15\u6570: - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff09\uff1a\u6570\u5024\u306e\u307f\u3092\u542b\u3080\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p> <p>\u623b\u308a\u5024: - \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff1a\u5206\u6563</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408 - \u975e\u6570\u5024\u8981\u7d20\u304c\u542b\u307e\u308c\u308b\u5834\u5408</p>"},{"location":"ja/spec/28-stdlib-stats/#statsstddev-","title":"stats/stddev - \u6a19\u6e96\u504f\u5dee","text":"<p>\u30c7\u30fc\u30bf\u306e\u6a19\u6e96\u504f\u5dee\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\u6a19\u6e96\u504f\u5dee\u306f\u5206\u6563\u306e\u5e73\u65b9\u6839\u3067\u3001\u30c7\u30fc\u30bf\u306e\u3070\u3089\u3064\u304d\u3092\u5143\u306e\u5358\u4f4d\u3067\u8868\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u7528\n(stats/stddev [1 2 3 4 5])            ;; =&gt; 1.414213... (\u221a2)\n\n;; \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\n(stats/stddev [2 4 6 8])              ;; =&gt; 2.236067... (\u221a5)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n([1 2 3 4 5] |&gt; stats/stddev)         ;; =&gt; 1.414213...\n</code></pre> <p>\u8a08\u7b97\u5f0f: <pre><code>stddev = \u221avariance\n</code></pre></p> <p>\u5f15\u6570: - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff09\uff1a\u6570\u5024\u306e\u307f\u3092\u542b\u3080\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p> <p>\u623b\u308a\u5024: - \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff1a\u6a19\u6e96\u504f\u5dee</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408 - \u975e\u6570\u5024\u8981\u7d20\u304c\u542b\u307e\u308c\u308b\u5834\u5408</p>"},{"location":"ja/spec/28-stdlib-stats/#_5","title":"\u4f4d\u7f6e\u306e\u6e2c\u5ea6","text":""},{"location":"ja/spec/28-stdlib-stats/#statspercentile-","title":"stats/percentile - \u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb","text":"<p>\u6307\u5b9a\u3055\u308c\u305f\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u4f4d\u7f6e\u306e\u5024\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\u7dda\u5f62\u88dc\u9593\u6cd5\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>;; 50\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\uff08\u4e2d\u592e\u5024\u3068\u540c\u3058\uff09\n(stats/percentile [1 2 3 4 5] 50)     ;; =&gt; 3.0\n\n;; 95\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\n(stats/percentile [1 2 3 4 5] 95)     ;; =&gt; 4.8\n\n;; 25\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\uff08\u7b2c1\u56db\u5206\u4f4d\u6570\uff09\n(stats/percentile [1 2 3 4 5] 25)     ;; =&gt; 2.0\n\n;; 75\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\uff08\u7b2c3\u56db\u5206\u4f4d\u6570\uff09\n(stats/percentile [1 2 3 4 5] 75)     ;; =&gt; 4.0\n\n;; \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306e\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u5024\n(stats/percentile [1 2 3 4 5] 50.5)   ;; =&gt; 3.02\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n([1 2 3 4 5] |&gt; (stats/percentile _ 95))  ;; =&gt; 4.8\n</code></pre> <p>\u5f15\u6570: - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff09\uff1a\u6570\u5024\u306e\u307f\u3092\u542b\u3080\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 - \u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u5024\uff08\u6574\u6570\u307e\u305f\u306f\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff09\uff1a0\u301c100\u306e\u7bc4\u56f2</p> <p>\u623b\u308a\u5024: - \u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\uff1a\u6307\u5b9a\u3055\u308c\u305f\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u4f4d\u7f6e\u306e\u5024</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408 - \u975e\u6570\u5024\u8981\u7d20\u304c\u542b\u307e\u308c\u308b\u5834\u5408 - \u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u5024\u304c0\u301c100\u306e\u7bc4\u56f2\u5916\u306e\u5834\u5408</p> <p>\u6ce8\u610f: - \u7dda\u5f62\u88dc\u9593\u6cd5\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u3001\u5b9f\u969b\u306e\u30c7\u30fc\u30bf\u306b\u5b58\u5728\u3057\u306a\u3044\u5024\u304c\u8fd4\u3055\u308c\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059</p>"},{"location":"ja/spec/28-stdlib-stats/#_6","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528","text":"<p>\u7d71\u8a08\u95a2\u6570\u306fQi\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3068\u81ea\u7136\u306b\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002</p> <pre><code>;; \u30c7\u30fc\u30bf\u51e6\u7406\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(def data [10 20 30 40 50])\n\n(data\n |&gt; stats/mean\n |&gt; (math/round _))\n;; =&gt; 30\n\n;; \u8907\u6570\u306e\u7d71\u8a08\u91cf\u3092\u8a08\u7b97\n(defn summary-stats [data]\n  {:mean (stats/mean data)\n   :median (stats/median data)\n   :stddev (stats/stddev data)\n   :min (apply min data)\n   :max (apply max data)})\n\n(summary-stats [1 2 3 4 5])\n;; =&gt; {:mean 3.0, :median 3.0, :stddev 1.414..., :min 1, :max 5}\n\n;; \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3068\u7d71\u8a08\n([1 2 3 4 5 6 7 8 9 10]\n |&gt; (filter (fn [x] (&gt; x 5)))\n |&gt; stats/mean)\n;; =&gt; 8.0\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_7","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/28-stdlib-stats/#_8","title":"\u30c7\u30fc\u30bf\u5206\u6790\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u30c6\u30b9\u30c8\u30b9\u30b3\u30a2\u306e\u5206\u6790\n(def test-scores [85 90 78 92 88 76 95 89 84 91])\n\n(defn analyze-scores [scores]\n  (let [sorted (sort scores)\n        n (len scores)]\n    {:count n\n     :mean (stats/mean scores)\n     :median (stats/median scores)\n     :stddev (stats/stddev scores)\n     :min (first sorted)\n     :max (last sorted)\n     :q1 (stats/percentile scores 25)\n     :q3 (stats/percentile scores 75)\n     :p95 (stats/percentile scores 95)}))\n\n(analyze-scores test-scores)\n;; =&gt; {:count 10\n;;     :mean 86.8\n;;     :median 88.5\n;;     :stddev 5.68...\n;;     :min 76\n;;     :max 95\n;;     :q1 83.25\n;;     :q3 91.25\n;;     :p95 94.2}\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_9","title":"\u7570\u5e38\u5024\u691c\u51fa","text":"<pre><code>;; \u6a19\u6e96\u504f\u5dee\u3092\u4f7f\u3063\u305f\u7570\u5e38\u5024\u691c\u51fa\uff083\u30b7\u30b0\u30de\u6cd5\uff09\n(defn detect-outliers [data threshold]\n  (let [m (stats/mean data)\n        sd (stats/stddev data)\n        lower (- m (* threshold sd))\n        upper (+ m (* threshold sd))]\n    (filter (fn [x] (or (&lt; x lower) (&gt; x upper))) data)))\n\n(def data [10 12 11 13 100 12 11 10 12])\n(detect-outliers data 3)\n;; =&gt; [100]  \uff08100\u306f\u7570\u5e38\u5024\uff09\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#z-score","title":"\u6b63\u898f\u5316\uff08z-score\uff09","text":"<pre><code>;; \u30c7\u30fc\u30bf\u3092z-score\u306b\u5909\u63db\uff08\u5e73\u57470\u3001\u6a19\u6e96\u504f\u5dee1\u306b\u6b63\u898f\u5316\uff09\n(defn z-score [data]\n  (let [m (stats/mean data)\n        sd (stats/stddev data)]\n    (map (fn [x] (/ (- x m) sd)) data)))\n\n(z-score [1 2 3 4 5])\n;; =&gt; [-1.414... -0.707... 0.0 0.707... 1.414...]\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_10","title":"\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u306b\u3088\u308b\u30e9\u30f3\u30af\u4ed8\u3051","text":"<pre><code>;; \u30b9\u30b3\u30a2\u306e\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u30e9\u30f3\u30af\u3092\u8a08\u7b97\n(defn percentile-rank [data value]\n  (let [sorted (sort data)\n        n (len sorted)\n        below (len (filter (fn [x] (&lt; x value)) sorted))\n        equal (len (filter (fn [x] (= x value)) sorted))]\n    (* 100.0 (/ (+ below (/ equal 2.0)) n))))\n\n(def scores [70 80 85 90 95])\n(percentile-rank scores 85)\n;; =&gt; 50.0  \uff0885\u306f50\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\uff09\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_11","title":"\u30b0\u30eb\u30fc\u30d7\u5225\u7d71\u8a08","text":"<pre><code>;; \u30ab\u30c6\u30b4\u30ea\u5225\u306e\u7d71\u8a08\u91cf\u3092\u8a08\u7b97\n(def data\n  [{:category \"A\" :value 10}\n   {:category \"A\" :value 20}\n   {:category \"B\" :value 30}\n   {:category \"B\" :value 40}\n   {:category \"B\" :value 50}])\n\n(defn group-stats [data key-fn value-fn]\n  (let [grouped (group-by key-fn data)]\n    (map-vals\n      (fn [items]\n        (let [values (map value-fn items)]\n          {:mean (stats/mean values)\n           :median (stats/median values)\n           :count (len values)}))\n      grouped)))\n\n(group-stats data\n  (fn [x] (get x :category))\n  (fn [x] (get x :value)))\n;; =&gt; {\"A\" {:mean 15.0, :median 15.0, :count 2}\n;;     \"B\" {:mean 40.0, :median 40.0, :count 3}}\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_12","title":"\u79fb\u52d5\u5e73\u5747","text":"<pre><code>;; \u5358\u7d14\u79fb\u52d5\u5e73\u5747\uff08Simple Moving Average\uff09\n(defn moving-average [data window-size]\n  (let [windows (partition window-size 1 data)]\n    (map stats/mean windows)))\n\n(moving-average [1 2 3 4 5 6 7 8 9 10] 3)\n;; =&gt; [2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0]\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_13","title":"\u76f8\u95a2\u4fc2\u6570\u306e\u57fa\u790e\u8a08\u7b97","text":"<pre><code>;; 2\u3064\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u5171\u5206\u6563\u3092\u8a08\u7b97\n(defn covariance [x-data y-data]\n  (let [n (len x-data)\n        x-mean (stats/mean x-data)\n        y-mean (stats/mean y-data)\n        products (map (fn [x y] (* (- x x-mean) (- y y-mean)))\n                      x-data y-data)]\n    (/ (reduce + 0 products) n)))\n\n(def x [1 2 3 4 5])\n(def y [2 4 6 8 10])\n(covariance x y)\n;; =&gt; 4.0\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_14","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u7d71\u8a08\u95a2\u6570\u306f\u4ee5\u4e0b\u306e\u5834\u5408\u306b\u30a8\u30e9\u30fc\u3092\u8fd4\u3057\u307e\u3059\uff1a</p> <pre><code>;; \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n(stats/mean [])\n;; =&gt; Error: stats/mean: collection must not be empty\n\n;; \u975e\u6570\u5024\u8981\u7d20\n(stats/mean [1 2 \"three\" 4])\n;; =&gt; Error: stats/mean: all elements must be numbers\n\n;; \u7121\u52b9\u306a\u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u5024\n(stats/percentile [1 2 3] 150)\n;; =&gt; Error: stats/percentile: invalid percentile (must be 0-100)\n\n;; try/ok\u3092\u4f7f\u3063\u305f\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n(try\n  (stats/mean [])\n  (fn [result]\n    (match result\n      [:ok value] (println f\"Mean: {value}\")\n      [:error msg] (println f\"Error: {msg}\"))))\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_15","title":"\u95a2\u6570\u4e00\u89a7","text":"\u95a2\u6570 \u8aac\u660e \u5f15\u6570 \u623b\u308a\u5024 <code>stats/mean</code> \u7b97\u8853\u5e73\u5747 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3 Float <code>stats/median</code> \u4e2d\u592e\u5024 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3 Float <code>stats/mode</code> \u6700\u983b\u5024 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3 Number <code>stats/variance</code> \u5206\u6563 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3 Float <code>stats/stddev</code> \u6a19\u6e96\u504f\u5dee \u30b3\u30ec\u30af\u30b7\u30e7\u30f3 Float <code>stats/percentile</code> \u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb \u30b3\u30ec\u30af\u30b7\u30e7\u30f3, \u30d1\u30fc\u30bb\u30f3\u30bf\u30a4\u30eb\u5024(0-100) Float"},{"location":"ja/spec/28-stdlib-stats/#_16","title":"\u6570\u5b66\u95a2\u6570\u3068\u306e\u9023\u643a","text":"<p>\u7d71\u8a08\u95a2\u6570\u306f<code>math/</code>\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\u3067\u304d\u307e\u3059\uff1a</p> <pre><code>;; \u5909\u52d5\u4fc2\u6570\uff08Coefficient of Variation\uff09\n(defn cv [data]\n  (let [m (stats/mean data)\n        sd (stats/stddev data)]\n    (* 100.0 (/ sd m))))\n\n(cv [10 12 11 13 12])\n;; =&gt; 10.5...  \uff08\u5909\u52d5\u4fc2\u6570: 10.5%\uff09\n\n;; \u6a19\u6e96\u5316\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\n(defn standardized-range [data]\n  (let [z-scores (z-score data)]\n    {:min (apply min z-scores)\n     :max (apply max z-scores)\n     :range (- (apply max z-scores) (apply min z-scores))}))\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_17","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u95a2\u3059\u308b\u6ce8\u610f","text":"<ul> <li>\u30bd\u30fc\u30c8: <code>median</code>\u3068<code>percentile</code>\u306f\u30c7\u30fc\u30bf\u3092\u30bd\u30fc\u30c8\u3059\u308b\u305f\u3081\u3001O(n log n)\u306e\u6642\u9593\u8a08\u7b97\u91cf\u3067\u3059</li> <li>\u8907\u6570\u56de\u306e\u8a08\u7b97: \u540c\u3058\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u8907\u6570\u306e\u7d71\u8a08\u91cf\u3092\u8a08\u7b97\u3059\u308b\u5834\u5408\u3001\u4e00\u5ea6\u306b\u8a08\u7b97\u3057\u305f\u65b9\u304c\u52b9\u7387\u7684\u3067\u3059</li> <li>\u5927\u898f\u6a21\u30c7\u30fc\u30bf: \u975e\u5e38\u306b\u5927\u304d\u306a\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\uff08100\u4e07\u8981\u7d20\u4ee5\u4e0a\uff09\u306e\u5834\u5408\u3001\u30e1\u30e2\u30ea\u4f7f\u7528\u91cf\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044</li> </ul> <pre><code>;; \u52b9\u7387\u7684\u306a\u8907\u6570\u7d71\u8a08\u91cf\u306e\u8a08\u7b97\n(defn efficient-stats [data]\n  ;; \u4e00\u5ea6\u3060\u3051\u5e73\u5747\u3092\u8a08\u7b97\u3057\u3001\u5206\u6563\u3068\u6a19\u6e96\u504f\u5dee\u3067\u518d\u5229\u7528\n  (let [m (stats/mean data)\n        v (stats/variance data)\n        sd (math/sqrt v)]  ;; variance\u304b\u3089\u8a08\u7b97\n    {:mean m\n     :variance v\n     :stddev sd}))\n</code></pre>"},{"location":"ja/spec/28-stdlib-stats/#_18","title":"\u4eca\u5f8c\u306e\u62e1\u5f35\u4e88\u5b9a","text":"<p>\u5c06\u6765\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u4ee5\u4e0b\u306e\u6a5f\u80fd\u304c\u8ffd\u52a0\u3055\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\uff1a</p> <ul> <li>\u6a19\u672c\u5206\u6563\uff08\u4e0d\u504f\u5206\u6563\uff09\u306e\u30b5\u30dd\u30fc\u30c8</li> <li>\u6b6a\u5ea6\uff08skewness\uff09\u3068\u5c16\u5ea6\uff08kurtosis\uff09</li> <li>\u76f8\u95a2\u4fc2\u6570\uff08correlation coefficient\uff09</li> <li>\u56de\u5e30\u5206\u6790\u306e\u57fa\u672c\u95a2\u6570</li> <li>\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u751f\u6210</li> <li>\u7bb1\u3072\u3052\u56f3\u306e\u30c7\u30fc\u30bf\u8a08\u7b97</li> </ul>"},{"location":"ja/spec/28-stdlib-stats/#_19","title":"\u53c2\u8003","text":"<ul> <li>\u6570\u5b66\u95a2\u6570 - \u6570\u5024\u6f14\u7b97\u30fb\u4e71\u6570\u751f\u6210</li> <li>\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u64cd\u4f5c - filter, map, reduce</li> <li>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 - try/ok, match\u306b\u3088\u308b\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"ja/spec/29-stdlib-stream/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30b9\u30c8\u30ea\u30fc\u30e0\uff08stream/\uff09","text":"<p>\u9045\u5ef6\u8a55\u4fa1\u306b\u3088\u308b\u52b9\u7387\u7684\u306a\u30c7\u30fc\u30bf\u51e6\u7406 - \u30e1\u30e2\u30ea\u3092\u7bc0\u7d04\u3057\u3001\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u6271\u3046</p> <p>Qi\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u5024\u3092\u5fc5\u8981\u306b\u306a\u308b\u307e\u3067\u8a08\u7b97\u3057\u306a\u3044\u9045\u5ef6\u8a55\u4fa1\uff08lazy evaluation\uff09\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u3059\u3002 \u30e1\u30e2\u30ea\u52b9\u7387\u7684\u306b\u5927\u91cf\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3067\u304d\u3001\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\u3082\u6271\u3048\u307e\u3059\u3002</p> <p>\u5b9f\u88c5: <code>src/builtins/stream.rs</code></p> <p>\u7279\u5fb4: - \u9045\u5ef6\u8a55\u4fa1\u306b\u3088\u308a\u5fc5\u8981\u306a\u5206\u3060\u3051\u8a08\u7b97 - \u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\uff08\u7121\u9650\u30ea\u30b9\u30c8\u3001\u7121\u9650\u6570\u5217\u306a\u3069\uff09\u306e\u30b5\u30dd\u30fc\u30c8 - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\uff08<code>|&gt;</code>\uff09\u3068\u306e\u5b8c\u74a7\u306a\u7d71\u5408 - \u30d5\u30a1\u30a4\u30eb/HTTP\u306e\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0I/O\u5bfe\u5fdc</p>"},{"location":"ja/spec/29-stdlib-stream/#_1","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u306f","text":""},{"location":"ja/spec/29-stdlib-stream/#_2","title":"\u901a\u5e38\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3068\u306e\u9055\u3044","text":"<pre><code>;; \u901a\u5e38\u306e\u30ea\u30b9\u30c8: \u3059\u3079\u3066\u306e\u8981\u7d20\u3092\u30e1\u30e2\u30ea\u306b\u4fdd\u6301\n(def nums [1 2 3 4 5 6 7 8 9 10])\n(def squares (map (fn [x] (* x x)) nums))\n;; =&gt; [1 4 9 16 25 36 49 64 81 100] \uff08\u3059\u3079\u3066\u8a08\u7b97\u6e08\u307f\uff09\n\n;; \u30b9\u30c8\u30ea\u30fc\u30e0: \u5fc5\u8981\u306a\u5206\u3060\u3051\u8a08\u7b97\n(def s (stream/range 1 11))\n(def squares-stream (stream/map (fn [x] (* x x)) s))\n;; =&gt; &lt;Stream&gt; \uff08\u307e\u3060\u8a08\u7b97\u3057\u3066\u3044\u306a\u3044\uff09\n\n;; \u6700\u521d\u306e3\u500b\u3060\u3051\u53d6\u5f97\n(stream/realize (stream/take 3 squares-stream))\n;; =&gt; (1 4 9) \uff083\u500b\u3060\u3051\u8a08\u7b97\u3055\u308c\u305f\uff09\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_3","title":"\u30e1\u30ea\u30c3\u30c8","text":"<ol> <li>\u30e1\u30e2\u30ea\u52b9\u7387: \u5fc5\u8981\u306a\u5206\u3060\u3051\u30e1\u30e2\u30ea\u3092\u4f7f\u7528</li> <li>\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020: \u7d42\u308f\u308a\u306e\u306a\u3044\u30c7\u30fc\u30bf\u3092\u8868\u73fe\u53ef\u80fd</li> <li>\u8a08\u7b97\u306e\u6700\u9069\u5316: \u4e0d\u8981\u306a\u8a08\u7b97\u3092\u30b9\u30ad\u30c3\u30d7</li> <li>I/O\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0: \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u5ea6\u306b\u8aad\u307f\u8fbc\u307e\u306a\u3044</li> </ol>"},{"location":"ja/spec/29-stdlib-stream/#_4","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210","text":""},{"location":"ja/spec/29-stdlib-stream/#streamstream-","title":"stream/stream - \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304b\u3089\u30b9\u30c8\u30ea\u30fc\u30e0\u4f5c\u6210","text":"<pre><code>;; \u30ea\u30b9\u30c8\u304b\u3089\u30b9\u30c8\u30ea\u30fc\u30e0\n(def s (stream/stream [1 2 3 4 5]))\n(stream/realize s)  ;; =&gt; (1 2 3 4 5)\n\n;; \u30d9\u30af\u30bf\u30fc\u304b\u3089\u30b9\u30c8\u30ea\u30fc\u30e0\n(def s (stream/stream [10 20 30]))\n(stream/realize s)  ;; =&gt; (10 20 30)\n</code></pre> <p>\u5f15\u6570: - <code>coll</code>: \u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc</p> <p>\u623b\u308a\u5024: Stream</p>"},{"location":"ja/spec/29-stdlib-stream/#streamrange-","title":"stream/range - \u7bc4\u56f2\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>;; 0\u304b\u30899\u307e\u3067\n(def s (stream/range 0 10))\n(stream/realize s)  ;; =&gt; (0 1 2 3 4 5 6 7 8 9)\n\n;; 1\u304b\u30895\u307e\u3067\n(def s (stream/range 1 6))\n(stream/realize s)  ;; =&gt; (1 2 3 4 5)\n\n;; \u7a7a\u306e\u7bc4\u56f2\n(def s (stream/range 5 5))\n(stream/realize s)  ;; =&gt; ()\n</code></pre> <p>\u5f15\u6570: - <code>start</code>: \u958b\u59cb\u5024\uff08\u542b\u3080\uff09 - <code>end</code>: \u7d42\u4e86\u5024\uff08\u542b\u307e\u306a\u3044\uff09</p> <p>\u623b\u308a\u5024: Stream</p>"},{"location":"ja/spec/29-stdlib-stream/#streamiterate-","title":"stream/iterate - \u95a2\u6570\u306e\u53cd\u5fa9\u9069\u7528\u306b\u3088\u308b\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>;; 1, 2, 4, 8, 16, 32, ...\uff082\u500d\u305a\u3064\uff09\n(def s (stream/iterate (fn [x] (* x 2)) 1))\n(stream/realize (stream/take 6 s))  ;; =&gt; (1 2 4 8 16 32)\n\n;; 1, 2, 3, 4, 5, ...\uff081\u305a\u3064\u5897\u52a0\uff09\n(def s (stream/iterate inc 1))\n(stream/realize (stream/take 5 s))  ;; =&gt; (1 2 3 4 5)\n\n;; \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\n(def fib-stream (stream/iterate (fn [[a b]] [b (+ a b)]) [0 1]))\n(stream/realize\n  (stream/take 10 fib-stream)\n  |&gt; (map first))\n;; =&gt; (0 1 1 2 3 5 8 13 21 34)\n</code></pre> <p>\u5f15\u6570: - <code>f</code>: \u5404\u8981\u7d20\u306b\u9069\u7528\u3059\u308b\u95a2\u6570 - <code>initial</code>: \u521d\u671f\u5024</p> <p>\u623b\u308a\u5024: Stream\uff08\u7121\u9650\uff09</p>"},{"location":"ja/spec/29-stdlib-stream/#streamrepeat-","title":"stream/repeat - \u540c\u3058\u5024\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>;; 42\u3092\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\n(def s (stream/repeat 42))\n(stream/realize (stream/take 5 s))  ;; =&gt; (42 42 42 42 42)\n\n;; \u6587\u5b57\u5217\u3092\u7e70\u308a\u8fd4\u3057\n(def s (stream/repeat \"hello\"))\n(stream/realize (stream/take 3 s))  ;; =&gt; (\"hello\" \"hello\" \"hello\")\n</code></pre> <p>\u5f15\u6570: - <code>value</code>: \u7e70\u308a\u8fd4\u3059\u5024</p> <p>\u623b\u308a\u5024: Stream\uff08\u7121\u9650\uff09</p>"},{"location":"ja/spec/29-stdlib-stream/#streamcycle-","title":"stream/cycle - \u30ea\u30b9\u30c8\u3092\u5faa\u74b0\u3059\u308b\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>;; [1 2 3] \u3092\u5faa\u74b0\n(def s (stream/cycle [1 2 3]))\n(stream/realize (stream/take 8 s))  ;; =&gt; (1 2 3 1 2 3 1 2)\n\n;; \u66dc\u65e5\u306e\u5faa\u74b0\n(def days (stream/cycle [\"\u6708\" \"\u706b\" \"\u6c34\" \"\u6728\" \"\u91d1\" \"\u571f\" \"\u65e5\"]))\n(stream/realize (stream/take 10 days))\n;; =&gt; (\"\u6708\" \"\u706b\" \"\u6c34\" \"\u6728\" \"\u91d1\" \"\u571f\" \"\u65e5\" \"\u6708\" \"\u706b\" \"\u6c34\")\n</code></pre> <p>\u5f15\u6570: - <code>coll</code>: \u30ea\u30b9\u30c8\u307e\u305f\u306f\u30d9\u30af\u30bf\u30fc\uff08\u7a7a\u3067\u306a\u3044\u3053\u3068\uff09</p> <p>\u623b\u308a\u5024: Stream\uff08\u7121\u9650\uff09</p> <p>\u30a8\u30e9\u30fc: - \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u6e21\u3059\u3068\u30a8\u30e9\u30fc</p>"},{"location":"ja/spec/29-stdlib-stream/#_5","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":""},{"location":"ja/spec/29-stdlib-stream/#streammap-","title":"stream/map - \u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u9069\u7528","text":"<pre><code>;; \u5404\u8981\u7d20\u30922\u500d\n(def s (stream/range 1 6))\n(def s2 (stream/map (fn [x] (* x 2)) s))\n(stream/realize s2)  ;; =&gt; (2 4 6 8 10)\n\n;; \u6587\u5b57\u5217\u306e\u9577\u3055\u3092\u53d6\u5f97\n(def s (stream/stream [\"hello\" \"world\" \"qi\"]))\n(def s2 (stream/map len s))\n(stream/realize s2)  ;; =&gt; (5 5 2)\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u3082\u9069\u7528\u53ef\u80fd\n(def s (stream/iterate inc 1))\n(def squares (stream/map (fn [x] (* x x)) s))\n(stream/realize (stream/take 5 squares))  ;; =&gt; (1 4 9 16 25)\n</code></pre> <p>\u5f15\u6570: - <code>f</code>: \u5404\u8981\u7d20\u306b\u9069\u7528\u3059\u308b\u95a2\u6570 - <code>stream</code>: \u30b9\u30c8\u30ea\u30fc\u30e0</p> <p>\u623b\u308a\u5024: Stream</p>"},{"location":"ja/spec/29-stdlib-stream/#streamfilter-","title":"stream/filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u306e\u307f","text":"<pre><code>;; \u5076\u6570\u306e\u307f\n(def s (stream/range 1 11))\n(def evens (stream/filter (fn [x] (= (% x 2) 0)) s))\n(stream/realize evens)  ;; =&gt; (2 4 6 8 10)\n\n;; 10\u3088\u308a\u5927\u304d\u3044\u6570\n(def s (stream/range 1 21))\n(def large (stream/filter (fn [x] (&gt; x 10)) s))\n(stream/realize large)  ;; =&gt; (11 12 13 14 15 16 17 18 19 20)\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u304b\u30893\u306e\u500d\u6570\n(def s (stream/iterate inc 1))\n(def multiples (stream/filter (fn [x] (= (% x 3) 0)) s))\n(stream/realize (stream/take 5 multiples))  ;; =&gt; (3 6 9 12 15)\n</code></pre> <p>\u5f15\u6570: - <code>pred</code>: \u8ff0\u8a9e\u95a2\u6570\uff08true\u3092\u8fd4\u3059\u8981\u7d20\u306e\u307f\u6b8b\u3059\uff09 - <code>stream</code>: \u30b9\u30c8\u30ea\u30fc\u30e0</p> <p>\u623b\u308a\u5024: Stream</p>"},{"location":"ja/spec/29-stdlib-stream/#streamtake-n","title":"stream/take - \u6700\u521d\u306en\u500b\u3092\u53d6\u5f97","text":"<pre><code>;; \u6700\u521d\u306e5\u500b\n(def s (stream/range 0 100))\n(def s2 (stream/take 5 s))\n(stream/realize s2)  ;; =&gt; (0 1 2 3 4)\n\n;; \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u6709\u9650\u5316\n(def s (stream/repeat 42))\n(def s2 (stream/take 3 s))\n(stream/realize s2)  ;; =&gt; (42 42 42)\n\n;; 0\u500b\n(def s (stream/range 1 10))\n(def s2 (stream/take 0 s))\n(stream/realize s2)  ;; =&gt; ()\n</code></pre> <p>\u5f15\u6570: - <code>n</code>: \u53d6\u5f97\u3059\u308b\u8981\u7d20\u6570\uff080\u4ee5\u4e0a\u306e\u6574\u6570\uff09 - <code>stream</code>: \u30b9\u30c8\u30ea\u30fc\u30e0</p> <p>\u623b\u308a\u5024: Stream</p>"},{"location":"ja/spec/29-stdlib-stream/#streamdrop-n","title":"stream/drop - \u6700\u521d\u306en\u500b\u3092\u30b9\u30ad\u30c3\u30d7","text":"<pre><code>;; \u6700\u521d\u306e5\u500b\u3092\u30b9\u30ad\u30c3\u30d7\n(def s (stream/range 0 10))\n(def s2 (stream/drop 5 s))\n(stream/realize s2)  ;; =&gt; (5 6 7 8 9)\n\n;; 0\u500b\u30b9\u30ad\u30c3\u30d7\uff08\u4f55\u3082\u3057\u306a\u3044\uff09\n(def s (stream/range 1 4))\n(def s2 (stream/drop 0 s))\n(stream/realize s2)  ;; =&gt; (1 2 3)\n\n;; \u3059\u3079\u3066\u30b9\u30ad\u30c3\u30d7\n(def s (stream/range 1 4))\n(def s2 (stream/drop 10 s))\n(stream/realize s2)  ;; =&gt; ()\n</code></pre> <p>\u5f15\u6570: - <code>n</code>: \u30b9\u30ad\u30c3\u30d7\u3059\u308b\u8981\u7d20\u6570\uff080\u4ee5\u4e0a\u306e\u6574\u6570\uff09 - <code>stream</code>: \u30b9\u30c8\u30ea\u30fc\u30e0</p> <p>\u623b\u308a\u5024: Stream</p>"},{"location":"ja/spec/29-stdlib-stream/#streamrealize-","title":"stream/realize - \u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u30ea\u30b9\u30c8\u306b\u5909\u63db","text":"<pre><code>;; \u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u5b9f\u884c\u3057\u3066\u30ea\u30b9\u30c8\u306b\u5909\u63db\n(def s (stream/range 1 6))\n(stream/realize s)  ;; =&gt; (1 2 3 4 5)\n\n;; \u8907\u96d1\u306a\u5909\u63db\u30c1\u30a7\u30fc\u30f3\u306e\u5b9f\u884c\n(def s (stream/range 1 11))\n(stream/realize\n  (s\n   |&gt; (stream/map (fn [x] (* x x)))\n   |&gt; (stream/filter (fn [x] (&gt; x 20)))))\n;; =&gt; (25 36 49 64 81 100)\n</code></pre> <p>\u5f15\u6570: - <code>stream</code>: \u30b9\u30c8\u30ea\u30fc\u30e0</p> <p>\u623b\u308a\u5024: List</p> <p>\u6ce8\u610f: - \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3092<code>realize</code>\u3059\u308b\u3068\u7121\u9650\u30eb\u30fc\u30d7\u306b\u306a\u308a\u307e\u3059 - \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u5fc5\u305a<code>take</code>\u3067\u6709\u9650\u5316\u3057\u3066\u304b\u3089<code>realize</code>\u3059\u308b\u3053\u3068</p> <pre><code>;; \u274c \u60aa\u3044\u4f8b: \u7121\u9650\u30eb\u30fc\u30d7\n(stream/realize (stream/repeat 42))  ;; \u6c38\u9060\u306b\u7d42\u308f\u3089\u306a\u3044\n\n;; \u2705 \u826f\u3044\u4f8b: take\u3067\u6709\u9650\u5316\n(stream/realize (stream/take 5 (stream/repeat 42)))  ;; OK\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_6","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d71\u5408","text":"<p>Qi\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\uff08<code>|&gt;</code>\uff09\u3067\u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c\u3092\u7c21\u6f54\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/spec/29-stdlib-stream/#_7","title":"\u57fa\u672c\u7684\u306a\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u30b9\u30c8\u30ea\u30fc\u30e0\u4f5c\u6210\u304b\u3089\u5b9f\u884c\u307e\u3067\n[1 2 3 4 5]\n  |&gt; stream/stream\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (&gt; x 10)))\n  |&gt; stream/realize\n;; =&gt; (16 25)\n\n;; \u7bc4\u56f2\u30b9\u30c8\u30ea\u30fc\u30e0\n(stream/range 1 11)\n  |&gt; (stream/map (fn [x] (* x 2)))\n  |&gt; (stream/filter (fn [x] (&gt; x 10)))\n  |&gt; (stream/take 3)\n  |&gt; stream/realize\n;; =&gt; (12 14 16)\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_8","title":"\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; 2\u306e\u3079\u304d\u4e57\u306e\u6700\u521d\u306e10\u500b\n1\n  |&gt; (stream/iterate (fn [x] (* x 2)))\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; =&gt; (1 2 4 8 16 32 64 128 256 512)\n\n;; 3\u306e\u500d\u6570\u3067100\u672a\u6e80\u306e\u3082\u306e\n1\n  |&gt; (stream/iterate inc)\n  |&gt; (stream/filter (fn [x] (= (% x 3) 0)))\n  |&gt; (stream/take-while (fn [x] (&lt; x 100)))\n  |&gt; stream/realize\n;; =&gt; (3 6 9 12 ... 96 99)\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_9","title":"\u8907\u96d1\u306a\u5909\u63db\u30c1\u30a7\u30fc\u30f3","text":"<pre><code>;; 1\u304b\u308999\u307e\u3067\u306e\u5e73\u65b9\u6570\u30673\u306e\u500d\u6570\u306e\u3082\u306e\n(stream/range 1 100)\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/filter (fn [x] (= (% x 3) 0)))\n  |&gt; (stream/take 5)\n  |&gt; stream/realize\n;; =&gt; (9 36 81 144 225)\n\n;; \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\u306e\u5076\u6570\u9805\n(stream/iterate (fn [[a b]] [b (+ a b)]) [0 1])\n  |&gt; (stream/map first)\n  |&gt; (stream/filter (fn [x] (= (% x 2) 0)))\n  |&gt; (stream/take 8)\n  |&gt; stream/realize\n;; =&gt; (0 2 8 34 144 610 2584 10946)\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_10","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/29-stdlib-stream/#_11","title":"\u7d20\u6570\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>;; \u7d20\u6570\u5224\u5b9a\u95a2\u6570\n(defn prime? [n]\n  (if (&lt; n 2)\n    false\n    (not (any? (fn [i] (= (% n i) 0)) (range 2 (+ 1 (sqrt n)))))))\n\n;; \u7d20\u6570\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\n(def primes\n  (2\n   |&gt; (stream/iterate inc)\n   |&gt; (stream/filter prime?)))\n\n;; \u6700\u521d\u306e20\u500b\u306e\u7d20\u6570\n(stream/realize (stream/take 20 primes))\n;; =&gt; (2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71)\n\n;; 100\u672a\u6e80\u306e\u7d20\u6570\n(stream/realize\n  (stream/take-while (fn [x] (&lt; x 100)) primes))\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_12","title":"\u5927\u91cf\u30c7\u30fc\u30bf\u306e\u96c6\u8a08","text":"<pre><code>;; 1\u304b\u3089100\u4e07\u307e\u3067\u306e\u5076\u6570\u306e\u5408\u8a08\uff08\u30e1\u30e2\u30ea\u52b9\u7387\u7684\uff09\n(stream/range 1 1000001)\n  |&gt; (stream/filter (fn [x] (= (% x 2) 0)))\n  |&gt; stream/realize\n  |&gt; (reduce + 0)\n;; =&gt; 250000500000\n\n;; \u901a\u5e38\u306e\u30ea\u30b9\u30c8\u3060\u3068100\u4e07\u500b\u306e\u30e1\u30e2\u30ea\u3092\u6d88\u8cbb\u3059\u308b\u304c\u3001\n;; \u30b9\u30c8\u30ea\u30fc\u30e0\u306a\u3089\u5fc5\u8981\u306a\u5206\u3060\u3051\u8a08\u7b97\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_13","title":"\u30c7\u30fc\u30bf\u51e6\u7406\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u30a8\u30e9\u30fc\u62bd\u51fa\uff08\u6982\u5ff5\uff09\n(defn process-logs [data]\n  (data\n   |&gt; stream/stream\n   |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n   |&gt; (stream/map parse-log-line)\n   |&gt; (stream/take 100)  ; \u6700\u521d\u306e100\u30a8\u30e9\u30fc\n   |&gt; stream/realize))\n\n;; CSV\u30c7\u30fc\u30bf\u306e\u5909\u63db\n(defn process-csv [rows]\n  (rows\n   |&gt; stream/stream\n   |&gt; (stream/drop 1)  ; \u30d8\u30c3\u30c0\u30fc\u30b9\u30ad\u30c3\u30d7\n   |&gt; (stream/map (fn [row] (str/split row \",\")))\n   |&gt; (stream/filter (fn [cols] (&gt; (len cols) 3)))\n   |&gt; (stream/map (fn [cols] {:id (first cols) :name (second cols)}))\n   |&gt; (stream/take 1000)\n   |&gt; stream/realize))\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_14","title":"\u7121\u9650\u30c7\u30fc\u30bf\u751f\u6210","text":"<pre><code>;; \u7121\u9650\u30ab\u30a6\u30f3\u30bf\u30fc\n(def counter (stream/iterate inc 0))\n\n;; \u6642\u523b\u30b9\u30bf\u30f3\u30d7\u306e\u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\uff08\u6982\u5ff5\uff09\n(def timestamps\n  (now)\n   |&gt; (stream/iterate (fn [t] (+ t 1000))))  ; 1\u79d2\u305a\u3064\n\n;; \u30e9\u30f3\u30c0\u30e0\u6570\u5024\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\uff08\u6982\u5ff5\uff09\n(def randoms\n  (stream/iterate (fn [_] (math/rand)) 0))\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_15","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u30e1\u30ea\u30c3\u30c8\u3068\u30c7\u30e1\u30ea\u30c3\u30c8","text":""},{"location":"ja/spec/29-stdlib-stream/#_16","title":"\u30e1\u30ea\u30c3\u30c8","text":"<ol> <li>\u30e1\u30e2\u30ea\u52b9\u7387</li> <li>\u5de8\u5927\u306a\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6271\u3048\u308b</li> <li> <p>\u5fc5\u8981\u306a\u5206\u3060\u3051\u30e1\u30e2\u30ea\u3092\u4f7f\u7528</p> </li> <li> <p>\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020</p> </li> <li>\u7d42\u308f\u308a\u306e\u306a\u3044\u30c7\u30fc\u30bf\u3092\u8868\u73fe\u53ef\u80fd</li> <li> <p>\u6570\u5b66\u7684\u306a\u6982\u5ff5\u3092\u305d\u306e\u307e\u307e\u8868\u73fe</p> </li> <li> <p>\u8a08\u7b97\u306e\u9045\u5ef6</p> </li> <li>\u4e0d\u8981\u306a\u8a08\u7b97\u3092\u30b9\u30ad\u30c3\u30d7</li> <li> <p>\u65e9\u671f\u7d42\u4e86\u304c\u53ef\u80fd\uff08take\uff09</p> </li> <li> <p>\u5408\u6210\u53ef\u80fd</p> </li> <li>map/filter/take\u3092\u81ea\u7531\u306b\u7d44\u307f\u5408\u308f\u305b</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u76f4\u611f\u7684\u306b\u8a18\u8ff0</li> </ol>"},{"location":"ja/spec/29-stdlib-stream/#_17","title":"\u30c7\u30e1\u30ea\u30c3\u30c8","text":"<ol> <li>\u30e9\u30f3\u30c0\u30e0\u30a2\u30af\u30bb\u30b9\u4e0d\u53ef</li> <li>\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u8981\u7d20\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044</li> <li> <p>\u5148\u982d\u304b\u3089\u9806\u756a\u306b\u51e6\u7406\u3059\u308b\u306e\u307f</p> </li> <li> <p>\u518d\u5229\u7528\u4e0d\u53ef</p> </li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u4e00\u5ea6\u3057\u304b\u5b9f\u884c\u3067\u304d\u306a\u3044</li> <li> <p>\u8907\u6570\u56de\u4f7f\u3046\u5834\u5408\u306f\u518d\u751f\u6210\u304c\u5fc5\u8981</p> </li> <li> <p>\u30c7\u30d0\u30c3\u30b0\u304c\u96e3\u3057\u3044</p> </li> <li>\u9045\u5ef6\u8a55\u4fa1\u306e\u305f\u3081\u3001\u3069\u3053\u3067\u8a08\u7b97\u3055\u308c\u308b\u304b\u4e0d\u660e\u77ad</li> <li><code>tap&gt;</code>\u3067\u89b3\u5bdf\u3059\u308b\u3053\u3068</li> </ol>"},{"location":"ja/spec/29-stdlib-stream/#_18","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3","text":""},{"location":"ja/spec/29-stdlib-stream/#_19","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f7f\u3046\u3079\u304d\u5834\u5408","text":"<ul> <li>\u2705 \u5927\u91cf\u30c7\u30fc\u30bf\u306e\u51e6\u7406\uff08\u30d5\u30a1\u30a4\u30eb\u3001\u30ed\u30b0\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\uff09</li> <li>\u2705 \u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\uff08\u6570\u5217\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc\uff09</li> <li>\u2705 \u65e9\u671f\u7d42\u4e86\u304c\u5fc5\u8981\uff08\u6700\u521d\u306en\u500b\u3060\u3051\uff09</li> <li>\u2705 \u30e1\u30e2\u30ea\u304c\u9650\u3089\u308c\u3066\u3044\u308b</li> </ul>"},{"location":"ja/spec/29-stdlib-stream/#_20","title":"\u901a\u5e38\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u3079\u304d\u5834\u5408","text":"<ul> <li>\u274c \u5c0f\u3055\u306a\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\uff08\u6570\u5341\u301c\u6570\u767e\u8981\u7d20\uff09</li> <li>\u274c \u30e9\u30f3\u30c0\u30e0\u30a2\u30af\u30bb\u30b9\u304c\u5fc5\u8981</li> <li>\u274c \u8907\u6570\u56de\u8d70\u67fb\u304c\u5fc5\u8981</li> <li>\u274c \u3059\u3079\u3066\u306e\u8981\u7d20\u3092\u4fdd\u6301\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b</li> </ul>"},{"location":"ja/spec/29-stdlib-stream/#_21","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6bd4\u8f03","text":"<pre><code>;; \u30b9\u30c8\u30ea\u30fc\u30e0: \u30e1\u30e2\u30ea\u52b9\u7387\u7684\u3001\u9045\u5ef6\u8a55\u4fa1\n(stream/range 1 1000001)\n  |&gt; (stream/map (fn [x] (* x x)))\n  |&gt; (stream/take 10)\n  |&gt; stream/realize\n;; =&gt; 10\u500b\u3060\u3051\u8a08\u7b97\u3001\u6b8b\u308a\u306f\u8a08\u7b97\u3057\u306a\u3044\n\n;; \u901a\u5e38\u306e\u30ea\u30b9\u30c8: \u3059\u3079\u3066\u8a08\u7b97\n(range 1 1000001)\n  |&gt; (map (fn [x] (* x x)))\n  |&gt; (take 10)\n;; =&gt; 100\u4e07\u500b\u3059\u3079\u3066\u8a08\u7b97\u3057\u3066\u304b\u308910\u500b\u53d6\u5f97\uff08\u7121\u99c4\uff09\n</code></pre>"},{"location":"ja/spec/29-stdlib-stream/#_22","title":"\u307e\u3068\u3081","text":"<p>Qi\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u9045\u5ef6\u8a55\u4fa1\u306b\u3088\u308a\u4ee5\u4e0b\u3092\u5b9f\u73fe\u3057\u307e\u3059\uff1a</p> <ul> <li>\u30e1\u30e2\u30ea\u52b9\u7387: \u5927\u91cf\u30c7\u30fc\u30bf\u3092\u6271\u3048\u308b</li> <li>\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020: \u6570\u5b66\u7684\u306a\u6982\u5ff5\u3092\u8868\u73fe</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408: <code>|&gt;</code>\u3067\u76f4\u611f\u7684\u306b\u8a18\u8ff0</li> <li>\u65e9\u671f\u7d42\u4e86: \u5fc5\u8981\u306a\u5206\u3060\u3051\u8a08\u7b97</li> </ul> <p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u30d5\u30a1\u30a4\u30ebI/O\u3001\u30c7\u30fc\u30bf\u51e6\u7406\u3001\u7121\u9650\u6570\u5217\u306a\u3069\u3001\u69d8\u3005\u306a\u5834\u9762\u3067\u5a01\u529b\u3092\u767a\u63ee\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/30-stdlib-temp/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff08io/temp\uff09","text":"<p>\u5b89\u5168\u306a\u4e00\u6642\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406</p> <p>\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3068\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\u30fb\u7ba1\u7406\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u81ea\u52d5\u524a\u9664\u6a5f\u80fd\u306b\u3088\u308a\u3001\u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u3092\u9632\u304e\u307e\u3059\u3002</p>"},{"location":"ja/spec/30-stdlib-temp/#_1","title":"\u6982\u8981","text":"<p>\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u4ee5\u4e0b\u306e\u7528\u9014\u3067\u4f7f\u7528\u3055\u308c\u307e\u3059\uff1a</p> <ul> <li>\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u4e00\u6642\u4fdd\u5b58 - \u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u3001\u7d71\u5408\u30c6\u30b9\u30c8</li> <li>\u4e2d\u9593\u30d5\u30a1\u30a4\u30eb\u306e\u751f\u6210 - \u30c7\u30fc\u30bf\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3001\u30d3\u30eb\u30c9\u30d7\u30ed\u30bb\u30b9</li> <li>\u30ad\u30e3\u30c3\u30b7\u30e5\u30d5\u30a1\u30a4\u30eb - \u5916\u90e8API\u7d50\u679c\u3001\u8a08\u7b97\u7d50\u679c\u306e\u4e00\u6642\u4fdd\u5b58</li> <li>\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb - HTTP\u7d4c\u7531\u3067\u53d6\u5f97\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4e00\u6642\u4fdd\u5b58</li> <li>\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea - \u8907\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u4f34\u3046\u51e6\u7406\u306e\u4f5c\u696d\u9818\u57df</li> </ul> <p>\u3059\u3079\u3066\u306e\u4e00\u6642\u30ea\u30bd\u30fc\u30b9\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u306e\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff08<code>/tmp</code> \u7b49\uff09\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/30-stdlib-temp/#_2","title":"\u4e00\u6642\u30d5\u30a1\u30a4\u30eb","text":""},{"location":"ja/spec/30-stdlib-temp/#_3","title":"\u81ea\u52d5\u524a\u9664\uff08\u63a8\u5968\uff09","text":"<pre><code>;; io/temp-file - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\uff08\u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306b\u81ea\u52d5\u524a\u9664\uff09\n(let [tmp (io/temp-file)]\n  (io/write-file \"temporary data\" tmp)\n  (println f\"Created temp file: {tmp}\")\n  (process-file tmp))\n;; \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306b\u30d5\u30a1\u30a4\u30eb\u306f\u81ea\u52d5\u7684\u306b\u524a\u9664\u3055\u308c\u308b\n\n;; \u4f7f\u7528\u4f8b: \u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u51e6\u7406\n(defn download-and-process [url]\n  (let [tmp (io/temp-file)]\n    ;; URL\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n    (http/get url :output tmp)\n    ;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u51e6\u7406\n    (let [result (io/read-file tmp |&gt; parse-data)]\n      ;; \u95a2\u6570\u7d42\u4e86\u5f8c\u3001tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      result)))\n\n;; \u4f7f\u7528\u4f8b: \u8907\u6570\u306e\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\n(defn process-with-temp []\n  (let [tmp1 (io/temp-file)\n        tmp2 (io/temp-file)]\n    (io/write-file \"data 1\" tmp1)\n    (io/write-file \"data 2\" tmp2)\n    (merge-files tmp1 tmp2)))\n;; \u4e21\u65b9\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_4","title":"\u624b\u52d5\u524a\u9664\uff08\u6c38\u7d9a\u5316\uff09","text":"<pre><code>;; io/temp-file-keep - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\uff08\u524a\u9664\u3057\u306a\u3044\uff09\n(let [tmp (io/temp-file-keep)]\n  (io/write-file \"persistent data\" tmp)\n  (println f\"Created: {tmp}\")\n  tmp)\n;; =&gt; \"/tmp/qi-12345.tmp\" \uff08\u524a\u9664\u3055\u308c\u306a\u3044\u3001\u624b\u52d5\u524a\u9664\u304c\u5fc5\u8981\uff09\n\n;; \u4f7f\u7528\u4f8b: \u30e6\u30fc\u30b6\u30fc\u306b\u7d50\u679c\u30d5\u30a1\u30a4\u30eb\u3092\u63d0\u4f9b\n(defn export-to-temp [data]\n  (let [tmp (io/temp-file-keep)]\n    (io/write-file (json/stringify data) tmp :encoding :utf-8-bom)\n    (println f\"Export completed: {tmp}\")\n    (println \"Please move or delete this file when done.\")\n    tmp))\n\n;; \u5f8c\u3067\u624b\u52d5\u524a\u9664\n(io/delete-file tmp)\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_5","title":"\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea","text":""},{"location":"ja/spec/30-stdlib-temp/#_6","title":"\u81ea\u52d5\u524a\u9664\uff08\u63a8\u5968\uff09","text":"<pre><code>;; io/temp-dir - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\uff08\u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306b\u81ea\u52d5\u524a\u9664\uff09\n(let [tmpdir (io/temp-dir)]\n  (println f\"Temp directory: {tmpdir}\")\n  (io/write-file \"data1\" (path/join tmpdir \"file1.txt\"))\n  (io/write-file \"data2\" (path/join tmpdir \"file2.txt\"))\n  (process-directory tmpdir))\n;; \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u4e2d\u8eab\u306f\u81ea\u52d5\u7684\u306b\u524a\u9664\u3055\u308c\u308b\n\n;; \u4f7f\u7528\u4f8b: \u8907\u6570\u30d5\u30a1\u30a4\u30eb\u306e\u4e00\u6642\u51e6\u7406\n(defn process-archive [archive-path]\n  (let [tmpdir (io/temp-dir)]\n    ;; \u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5c55\u958b\n    (archive/extract archive-path tmpdir)\n    ;; \u5c55\u958b\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u51e6\u7406\n    (io/list-dir tmpdir :recursive true)\n      |&gt; (map (fn [f] (path/join tmpdir f)))\n      |&gt; (map process-file)\n      |&gt; (reduce merge)\n    ;; \u95a2\u6570\u7d42\u4e86\u5f8c\u3001tmpdir \u3068\u4e2d\u8eab\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    ))\n\n;; \u4f7f\u7528\u4f8b: \u30d3\u30eb\u30c9\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(defn build-project []\n  (let [build-dir (io/temp-dir)]\n    ;; \u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\n    (io/copy-file \"src/main.qi\" (path/join build-dir \"main.qi\"))\n    (io/copy-file \"src/lib.qi\" (path/join build-dir \"lib.qi\"))\n    ;; \u30d3\u30eb\u30c9\u51e6\u7406\n    (compile-files build-dir)\n    ;; \u6210\u679c\u7269\u3092\u53d6\u5f97\n    (let [output (io/read-file (path/join build-dir \"output.bin\"))]\n      ;; build-dir\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      output)))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_7","title":"\u624b\u52d5\u524a\u9664\uff08\u6c38\u7d9a\u5316\uff09","text":"<pre><code>;; io/temp-dir-keep - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\uff08\u524a\u9664\u3057\u306a\u3044\uff09\n(let [tmpdir (io/temp-dir-keep)]\n  (io/write-file \"file1\" (path/join tmpdir \"data.txt\"))\n  (io/create-dir (path/join tmpdir \"subdir\"))\n  tmpdir)\n;; =&gt; \"/tmp/qi-dir-12345\" \uff08\u524a\u9664\u3055\u308c\u306a\u3044\uff09\n\n;; \u4f7f\u7528\u4f8b: \u30c7\u30d0\u30c3\u30b0\u7528\u306e\u51fa\u529b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(defn export-debug-info []\n  (let [debug-dir (io/temp-dir-keep)]\n    (io/write-file (json/stringify state) (path/join debug-dir \"state.json\"))\n    (io/write-file logs (path/join debug-dir \"logs.txt\"))\n    (println f\"Debug info exported to: {debug-dir}\")\n    debug-dir))\n\n;; \u5f8c\u3067\u624b\u52d5\u524a\u9664\n(io/delete-dir tmpdir :recursive true)\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_8","title":"\u81ea\u52d5\u524a\u9664\u306e\u4ed5\u7d44\u307f","text":""},{"location":"ja/spec/30-stdlib-temp/#_9","title":"\u524a\u9664\u30bf\u30a4\u30df\u30f3\u30b0","text":"<p>\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\u5834\u5408\uff08<code>io/temp-file</code>, <code>io/temp-dir</code>\uff09: - \u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u3068\u304d - \u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u30a8\u30e9\u30fc\u3067\u7d42\u4e86\u3057\u305f\u3068\u304d - REPL\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u7d42\u4e86\u3057\u305f\u3068\u304d</p> <p>\u524a\u9664\u3055\u308c\u306a\u3044\u5834\u5408\uff08<code>io/temp-file-keep</code>, <code>io/temp-dir-keep</code>\uff09: - \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u5f8c\u3082\u6c38\u7d9a\u5316\u3055\u308c\u308b - \u624b\u52d5\u3067\u524a\u9664\u304c\u5fc5\u8981\uff08<code>io/delete-file</code>, <code>io/delete-dir</code>\uff09</p>"},{"location":"ja/spec/30-stdlib-temp/#_10","title":"\u5b9f\u88c5\u306e\u8a73\u7d30","text":"<pre><code>;; \u81ea\u52d5\u524a\u9664\u7248\u306f\u5185\u90e8\u3067\u30cf\u30f3\u30c9\u30eb\u3092\u4fdd\u6301\n;; \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306bOS\u304c\u81ea\u52d5\u524a\u9664\u3059\u308b\n(io/temp-file)    ;; =&gt; \u30cf\u30f3\u30c9\u30eb\u4fdd\u6301 \u2192 \u81ea\u52d5\u524a\u9664\n\n;; keep\u7248\u306f\u6c38\u7d9a\u5316\n(io/temp-file-keep)  ;; =&gt; \u30cf\u30f3\u30c9\u30eb\u89e3\u653e \u2192 \u524a\u9664\u3055\u308c\u306a\u3044\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_11","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ol> <li>\u9577\u6642\u9593\u5b9f\u884c\u30d7\u30ed\u30b0\u30e9\u30e0: REPL\u3084\u5e38\u99d0\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u3001\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u304c\u6e9c\u307e\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b</li> <li>\u30c7\u30a3\u30b9\u30af\u5bb9\u91cf: \u5927\u304d\u306a\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u5927\u91cf\u306b\u4f5c\u6210\u3059\u308b\u5834\u5408\u306f\u6ce8\u610f</li> <li>keep\u7248\u306e\u524a\u9664: <code>io/temp-file-keep</code>\u3067\u4f5c\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u5fc5\u305a\u624b\u52d5\u524a\u9664\u3059\u308b\u3053\u3068</li> <li>\u4e26\u884c\u51e6\u7406: \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u81ea\u52d5\u7684\u306b\u30e6\u30cb\u30fc\u30af\u306b\u306a\u308b\u305f\u3081\u3001\u4e26\u884c\u51e6\u7406\u3067\u3082\u5b89\u5168</li> </ol>"},{"location":"ja/spec/30-stdlib-temp/#_12","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/30-stdlib-temp/#_13","title":"\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u7ba1\u7406","text":"<pre><code>;; \u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u7528\u306e\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\n(defn test-file-processing []\n  (let [tmp (io/temp-file)]\n    ;; \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u66f8\u304d\u8fbc\u307f\n    (io/write-file \"line1\\nline2\\nline3\" tmp)\n    ;; \u95a2\u6570\u3092\u30c6\u30b9\u30c8\n    (let [result (process-file tmp)]\n      (assert (= result [\"line1\" \"line2\" \"line3\"]))\n      ;; tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      true)))\n\n;; \u7d71\u5408\u30c6\u30b9\u30c8\u7528\u306e\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n(defn test-directory-processing []\n  (let [tmpdir (io/temp-dir)]\n    ;; \u30c6\u30b9\u30c8\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u69cb\u9020\u3092\u4f5c\u6210\n    (io/write-file \"config\" (path/join tmpdir \"config.txt\"))\n    (io/create-dir (path/join tmpdir \"data\"))\n    (io/write-file \"data1\" (path/join tmpdir \"data\" \"file1.txt\"))\n    ;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u51e6\u7406\u3092\u30c6\u30b9\u30c8\n    (let [result (process-directory tmpdir)]\n      (assert (= (len result) 2))\n      ;; tmpdir \u3068\u4e2d\u8eab\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      true)))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_14","title":"\u30c7\u30fc\u30bf\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; CSV \u2192 JSON\u5909\u63db\uff08\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f7f\u7528\uff09\n(defn csv-to-json [csv-path json-path]\n  (let [tmp (io/temp-file)]\n    ;; CSV\u3092\u8aad\u307f\u8fbc\u307f\n    (io/read-file csv-path)\n      |&gt; csv/parse\n      ;; \u30c7\u30fc\u30bf\u3092\u5909\u63db\n      |&gt; (map transform-row)\n      ;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306bJSON\u51fa\u529b\n      |&gt; json/stringify\n      |&gt; (fn [s] (io/write-file s tmp))\n    ;; \u691c\u8a3c\n    (validate-json tmp)\n    ;; \u6700\u7d42\u51fa\u529b\n    (io/copy-file tmp json-path)\n    ;; tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    json-path))\n\n;; \u8907\u6570\u30d5\u30a1\u30a4\u30eb\u306e\u7d50\u5408\uff08\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f7f\u7528\uff09\n(defn merge-csv-files [input-files output-path]\n  (let [tmpdir (io/temp-dir)]\n    ;; \u5404\u30d5\u30a1\u30a4\u30eb\u3092\u6b63\u898f\u5316\u3057\u3066\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\n    (input-files\n      |&gt; (map-indexed (fn [i f]\n           (let [normalized (io/read-file f |&gt; normalize-csv)]\n             (io/write-file normalized\n                           (path/join tmpdir f\"file{i}.csv\"))))))\n    ;; \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7d50\u5408\n    (io/list-dir tmpdir)\n      |&gt; (map (fn [f] (path/join tmpdir f)))\n      |&gt; (map io/read-file)\n      |&gt; (join \"\\n\")\n      |&gt; (fn [s] (io/write-file s output-path))\n    ;; tmpdir\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    output-path))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#http","title":"HTTP\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u30ad\u30e3\u30c3\u30b7\u30e5","text":"<pre><code>;; \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n(defn download-large-file [url output-path]\n  (let [tmp (io/temp-file)]\n    ;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n    (http/get url :output tmp :timeout 300)\n    ;; \u30c1\u30a7\u30c3\u30af\u30b5\u30e0\u691c\u8a3c\n    (if (verify-checksum tmp)\n      (do\n        (io/move-file tmp output-path)\n        (println f\"Download completed: {output-path}\")\n        output-path)\n      (do\n        ;; \u30a8\u30e9\u30fc\u6642\u306ftmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n        (error \"Checksum verification failed\")))))\n\n;; \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304dAPI\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\n(defn fetch-with-cache [url cache-duration]\n  (let [cache-file (io/temp-file-keep)\n        cache-age (if (io/file-exists? cache-file)\n                    (- (time/now) (get (io/file-info cache-file) \"modified\"))\n                    cache-duration)]\n    (if (&lt; cache-age cache-duration)\n      ;; \u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u6709\u52b9\n      (io/read-file cache-file)\n      ;; \u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u53e4\u3044\u3001\u518d\u53d6\u5f97\n      (let [data (http/get url |&gt; get \"body\")]\n        (io/write-file data cache-file)\n        data))))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_15","title":"\u30d0\u30c3\u30c1\u51e6\u7406","text":"<pre><code>;; \u5927\u91cf\u30d5\u30a1\u30a4\u30eb\u306e\u4e26\u5217\u51e6\u7406\n(defn parallel-process-files [input-files]\n  (let [tmpdir (io/temp-dir)]\n    ;; \u5404\u30d5\u30a1\u30a4\u30eb\u3092\u4e26\u5217\u51e6\u7406\n    (input-files\n      |&gt; (pmap (fn [f]\n           (let [tmp (path/join tmpdir (path/basename f))]\n             ;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306b\u51e6\u7406\u7d50\u679c\u3092\u4fdd\u5b58\n             (process-file f |&gt; (fn [result] (io/write-file result tmp)))\n             tmp)))\n      ;; \u51e6\u7406\u7d50\u679c\u3092\u53ce\u96c6\n      |&gt; (map io/read-file)\n      ;; tmpdir\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      )))\n\n;; \u4e2d\u9593\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3063\u305f\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u51e6\u7406\n(defn multi-stage-process [input]\n  (let [stage1-file (io/temp-file)\n        stage2-file (io/temp-file)\n        stage3-file (io/temp-file)]\n    ;; Stage 1: \u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30cb\u30f3\u30b0\n    (input\n      |&gt; clean-data\n      |&gt; (fn [s] (io/write-file s stage1-file)))\n    ;; Stage 2: \u30c7\u30fc\u30bf\u306e\u5909\u63db\n    (io/read-file stage1-file\n      |&gt; transform-data\n      |&gt; (fn [s] (io/write-file s stage2-file)))\n    ;; Stage 3: \u30c7\u30fc\u30bf\u306e\u96c6\u8a08\n    (io/read-file stage2-file\n      |&gt; aggregate-data\n      |&gt; (fn [s] (io/write-file s stage3-file)))\n    ;; \u6700\u7d42\u7d50\u679c\u3092\u8fd4\u3059\n    (let [result (io/read-file stage3-file)]\n      ;; \u3059\u3079\u3066\u306e\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      result)))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_16","title":"\u30bb\u30ad\u30e5\u30a2\u306a\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u51e6\u7406","text":"<pre><code>;; \u6a5f\u5bc6\u30c7\u30fc\u30bf\u306e\u4e00\u6642\u4fdd\u5b58\uff08\u81ea\u52d5\u524a\u9664\u4fdd\u8a3c\uff09\n(defn process-sensitive-data [encrypted-data]\n  (let [tmp (io/temp-file)]\n    ;; \u5fa9\u53f7\u5316\u3057\u305f\u30c7\u30fc\u30bf\u3092\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\n    (decrypt encrypted-data |&gt; (fn [s] (io/write-file s tmp)))\n    ;; \u51e6\u7406\n    (let [result (process-data tmp)]\n      ;; tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\uff08\u6a5f\u5bc6\u30c7\u30fc\u30bf\u304c\u6b8b\u3089\u306a\u3044\uff09\n      result)))\n\n;; \u30d1\u30b9\u30ef\u30fc\u30c9\u4fdd\u8b77\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u5c55\u958b\n(defn extract-protected-archive [archive-path password]\n  (let [tmpdir (io/temp-dir)]\n    ;; \u5c55\u958b\n    (archive/extract archive-path tmpdir :password password)\n    ;; \u51e6\u7406\n    (let [result (process-files tmpdir)]\n      ;; tmpdir\u3068\u4e2d\u8eab\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n      result)))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_17","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408","text":"<pre><code>;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3063\u305f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(defn download-convert-upload [source-url target-url]\n  (let [tmp (io/temp-file)]\n    (source-url\n      |&gt; (http/get :output tmp)\n      |&gt; (fn [_] (io/read-file tmp))\n      |&gt; convert-format\n      |&gt; (http/post target-url :body _))\n    ;; tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    ))\n\n;; \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f7f\u3063\u305f\u8907\u96d1\u306a\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(defn batch-convert [input-dir output-dir]\n  (let [tmpdir (io/temp-dir)]\n    (input-dir\n      |&gt; (io/list-dir :pattern \"*.txt\")\n      |&gt; (map (fn [f]\n           ;; \u5404\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u51e6\u7406\n           (let [tmp (path/join tmpdir (path/basename f))]\n             (io/read-file (path/join input-dir f)\n               |&gt; convert-content\n               |&gt; (fn [s] (io/write-file s tmp)))\n             tmp)))\n      ;; \u51e6\u7406\u6e08\u307f\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\n      |&gt; (map (fn [tmp]\n           (io/copy-file tmp (path/join output-dir (path/basename tmp))))))\n    ;; tmpdir\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    ))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_18","title":"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\u4e8b\u9805","text":""},{"location":"ja/spec/30-stdlib-temp/#_19","title":"\u5b89\u5168\u306a\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210","text":"<p>Qi\u306e\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u6a5f\u80fd\u306f\u3001\u4ee5\u4e0b\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5bfe\u7b56\u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\uff1a</p> <ol> <li>\u30e6\u30cb\u30fc\u30af\u306a\u30d5\u30a1\u30a4\u30eb\u540d: \u4e88\u6e2c\u4e0d\u53ef\u80fd\u306a\u30e9\u30f3\u30c0\u30e0\u306a\u540d\u524d\u3092\u4f7f\u7528</li> <li>\u9069\u5207\u306a\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3: \u4ed6\u306e\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u8aad\u307f\u53d6\u308a\u4e0d\u53ef</li> <li>\u81ea\u52d5\u524a\u9664: \u6a5f\u5bc6\u30c7\u30fc\u30bf\u304c\u6b8b\u3089\u306a\u3044</li> <li>TOCTOU\u653b\u6483\u3078\u306e\u5bfe\u7b56: \u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u3068\u540c\u6642\u306b\u30cf\u30f3\u30c9\u30eb\u3092\u53d6\u5f97</li> </ol> <pre><code>;; \u2705 \u5b89\u5168\uff08\u63a8\u5968\uff09\n(let [tmp (io/temp-file)]\n  (io/write-file sensitive-data tmp)\n  (process-file tmp))\n;; \u30d7\u30ed\u30b0\u30e9\u30e0\u7d42\u4e86\u6642\u306b\u81ea\u52d5\u524a\u9664\n\n;; \u274c \u63a8\u5968\u3055\u308c\u306a\u3044\uff08\u624b\u52d5\u524a\u9664\u304c\u5fc5\u8981\u3001\u524a\u9664\u5fd8\u308c\u306e\u30ea\u30b9\u30af\uff09\n(let [tmp \"/tmp/myapp-data.txt\"]\n  (io/write-file sensitive-data tmp)\n  (process-file tmp)\n  (io/delete-file tmp))  ;; \u30a8\u30e9\u30fc\u6642\u306b\u524a\u9664\u3055\u308c\u306a\u3044\u53ef\u80fd\u6027\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_20","title":"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":"<ol> <li>\u81ea\u52d5\u524a\u9664\u7248\u3092\u512a\u5148: <code>io/temp-file</code> \u3068 <code>io/temp-dir</code> \u3092\u4f7f\u7528</li> <li>\u6a5f\u5bc6\u30c7\u30fc\u30bf\u306f\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3067\u51e6\u7406: \u51e6\u7406\u5f8c\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b</li> <li>keep\u7248\u306f\u6700\u5c0f\u9650\u306b: \u672c\u5f53\u306b\u6c38\u7d9a\u5316\u304c\u5fc5\u8981\u306a\u5834\u5408\u306e\u307f\u4f7f\u7528</li> <li>\u30c7\u30a3\u30b9\u30af\u5bb9\u91cf\u3092\u8003\u616e: \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u6271\u3046\u5834\u5408\u306f\u6ce8\u610f</li> <li>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0: <code>try-catch</code>\u3067\u56f2\u3093\u3067\u3082\u81ea\u52d5\u524a\u9664\u306f\u6a5f\u80fd\u3059\u308b</li> </ol> <pre><code>;; \u30a8\u30e9\u30fc\u6642\u3082\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n(defn safe-process [data]\n  (let [tmp (io/temp-file)]\n    (try\n      (do\n        (io/write-file data tmp)\n        (risky-operation tmp))\n      (catch e\n        (println f\"Error: {e}\")\n        ;; tmp\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n        nil))))\n</code></pre>"},{"location":"ja/spec/30-stdlib-temp/#_21","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/30-stdlib-temp/#_22","title":"\u4e00\u6642\u30d5\u30a1\u30a4\u30eb","text":"<ul> <li><code>io/temp-file</code> - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\uff08\u81ea\u52d5\u524a\u9664\uff09</li> <li><code>io/temp-file-keep</code> - \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\uff08\u524a\u9664\u3057\u306a\u3044\uff09</li> </ul>"},{"location":"ja/spec/30-stdlib-temp/#_23","title":"\u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea","text":"<ul> <li><code>io/temp-dir</code> - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08\u81ea\u52d5\u524a\u9664\uff09</li> <li><code>io/temp-dir-keep</code> - \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\uff08\u524a\u9664\u3057\u306a\u3044\uff09</li> </ul>"},{"location":"ja/spec/30-stdlib-temp/#_24","title":"\u307e\u3068\u3081","text":"<ul> <li>\u81ea\u52d5\u524a\u9664\u7248\u3092\u63a8\u5968: \u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u3092\u9632\u3050</li> <li>\u30bb\u30ad\u30e5\u30a2: \u6a5f\u5bc6\u30c7\u30fc\u30bf\u306e\u4e00\u6642\u51e6\u7406\u306b\u6700\u9069</li> <li>\u30b7\u30f3\u30d7\u30eb: \u660e\u793a\u7684\u306a\u524a\u9664\u30b3\u30fc\u30c9\u304c\u4e0d\u8981</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408: Qi\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u5f37\u529b\u306a\u30c7\u30fc\u30bf\u51e6\u7406\u3092\u5b9f\u73fe</li> </ul>"},{"location":"ja/spec/31-stdlib-time/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u65e5\u6642\u51e6\u7406\uff08time/\uff09","text":"<p>24\u4ee5\u4e0a\u306e\u65e5\u6642\u64cd\u4f5c\u95a2\u6570</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>time/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/31-stdlib-time/#_1","title":"\u73fe\u5728\u6642\u523b\u53d6\u5f97","text":""},{"location":"ja/spec/31-stdlib-time/#iso-8601","title":"ISO 8601\u5f62\u5f0f","text":"<pre><code>;; time/now-iso - \u73fe\u5728\u6642\u523b\u3092ISO 8601\u5f62\u5f0f\u3067\u53d6\u5f97\n(time/now-iso)                           ;; =&gt; \"2025-11-10T15:30:45.123456789+00:00\"\n\n;; time/today - \u4eca\u65e5\u306e\u65e5\u4ed8\u3092YYYY-MM-DD\u5f62\u5f0f\u3067\u53d6\u5f97\n(time/today)                             ;; =&gt; \"2025-11-10\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#unix","title":"Unix\u6642\u523b\u5909\u63db","text":"<pre><code>;; time/from-unix - Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08\u79d2\uff09\u3092ISO 8601\u5f62\u5f0f\u306b\u5909\u63db\n(time/from-unix 1699632000)              ;; =&gt; \"2023-11-10T12:00:00+00:00\"\n\n;; time/to-unix - ISO 8601\u5f62\u5f0f\u306e\u6587\u5b57\u5217\u3092Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08\u79d2\uff09\u306b\u5909\u63db\n(time/to-unix \"2023-11-10T12:00:00+00:00\") ;; =&gt; 1699632000\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_2","title":"\u65e5\u6642\u30d5\u30a9\u30fc\u30de\u30c3\u30c8","text":""},{"location":"ja/spec/31-stdlib-time/#format-","title":"format - \u4efb\u610f\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u6587\u5b57\u5217\u5316","text":"<pre><code>;; time/format - \u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u6307\u5b9a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u6587\u5b57\u5217\u5316\n;; \u7b2c1\u5f15\u6570: Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08\u6574\u6570\uff09\u307e\u305f\u306fISO 8601\u6587\u5b57\u5217\n;; \u7b2c2\u5f15\u6570: \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6587\u5b57\u5217\uff08strftime\u5f62\u5f0f\uff09\n\n(time/format 1699632000 \"%Y-%m-%d\")      ;; =&gt; \"2023-11-10\"\n(time/format 1699632000 \"%Y\u5e74%m\u6708%d\u65e5\")  ;; =&gt; \"2023\u5e7411\u670810\u65e5\"\n(time/format 1699632000 \"%H:%M:%S\")      ;; =&gt; \"12:00:00\"\n\n;; ISO 8601\u6587\u5b57\u5217\u3082\u53d7\u3051\u4ed8\u3051\u308b\n(time/format \"2023-11-10T12:00:00+00:00\" \"%Y/%m/%d %H:%M\")\n;; =&gt; \"2023/11/10 12:00\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(time/now-iso\n |&gt; (time/format _ \"%Y-%m-%d %H:%M:%S\")) ;; =&gt; \"2025-11-10 15:30:45\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#strftime","title":"strftime\u5f62\u5f0f\u306e\u4e3b\u8981\u6307\u5b9a\u5b50","text":"\u6307\u5b9a\u5b50 \u610f\u5473 \u4f8b <code>%Y</code> \u5e74\uff084\u6841\uff09 2025 <code>%m</code> \u6708\uff082\u6841\uff09 11 <code>%d</code> \u65e5\uff082\u6841\uff09 10 <code>%H</code> \u6642\uff0824\u6642\u9593\u5236\u30012\u6841\uff09 15 <code>%I</code> \u6642\uff0812\u6642\u9593\u5236\u30012\u6841\uff09 03 <code>%M</code> \u5206\uff082\u6841\uff09 30 <code>%S</code> \u79d2\uff082\u6841\uff09 45 <code>%p</code> AM/PM PM <code>%A</code> \u66dc\u65e5\uff08\u30d5\u30eb\uff09 Sunday <code>%a</code> \u66dc\u65e5\uff08\u7565\uff09 Sun <code>%B</code> \u6708\u540d\uff08\u30d5\u30eb\uff09 November <code>%b</code> \u6708\u540d\uff08\u7565\uff09 Nov"},{"location":"ja/spec/31-stdlib-time/#_3","title":"\u65e5\u6642\u89e3\u6790","text":""},{"location":"ja/spec/31-stdlib-time/#parse-","title":"parse - \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6307\u5b9a\u3067\u30d1\u30fc\u30b9","text":"<pre><code>;; time/parse - \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6587\u5b57\u5217\u3092\u4f7f\u3063\u3066\u65e5\u4ed8\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\n;; \u7b2c1\u5f15\u6570: \u65e5\u4ed8\u6587\u5b57\u5217\n;; \u7b2c2\u5f15\u6570: \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6587\u5b57\u5217\uff08strftime\u5f62\u5f0f\uff09\n;; \u623b\u308a\u5024: Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08\u6574\u6570\uff09\n\n(time/parse \"2023-11-10\" \"%Y-%m-%d\")     ;; =&gt; 1699632000\n(time/parse \"2023\u5e7411\u670810\u65e5\" \"%Y\u5e74%m\u6708%d\u65e5\")\n;; =&gt; 1699632000\n\n(time/parse \"10/11/2023 15:30\" \"%d/%m/%Y %H:%M\")\n;; =&gt; 1699632600\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_4","title":"\u65e5\u6642\u8a08\u7b97","text":""},{"location":"ja/spec/31-stdlib-time/#_5","title":"\u52a0\u7b97","text":"<pre><code>;; time/add-days - \u65e5\u4ed8\u306b\u65e5\u6570\u3092\u52a0\u7b97\n(time/add-days 1699632000 7)             ;; =&gt; 1700236800\uff087\u65e5\u5f8c\uff09\n\n;; time/add-hours - \u65e5\u4ed8\u306b\u6642\u9593\u3092\u52a0\u7b97\n(time/add-hours 1699632000 24)           ;; =&gt; 1699718400\uff0824\u6642\u9593\u5f8c\uff09\n\n;; time/add-minutes - \u65e5\u4ed8\u306b\u5206\u3092\u52a0\u7b97\n(time/add-minutes 1699632000 30)         ;; =&gt; 1699633800\uff0830\u5206\u5f8c\uff09\n\n;; ISO 8601\u6587\u5b57\u5217\u3082\u53d7\u3051\u4ed8\u3051\u308b\n(time/add-days \"2023-11-10T12:00:00+00:00\" 1)\n;; =&gt; 1699718400\uff08\u7fcc\u65e5\uff09\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u7528\n(time/now-iso\n |&gt; time/to-unix\n |&gt; (time/add-days _ 7)\n |&gt; (time/format _ \"%Y-%m-%d\")) ;; =&gt; \"2025-11-17\"\uff087\u65e5\u5f8c\uff09\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_6","title":"\u6e1b\u7b97","text":"<pre><code>;; time/sub-days - \u65e5\u4ed8\u304b\u3089\u65e5\u6570\u3092\u6e1b\u7b97\n(time/sub-days 1699632000 7)             ;; =&gt; 1699027200\uff087\u65e5\u524d\uff09\n\n;; time/sub-hours - \u65e5\u4ed8\u304b\u3089\u6642\u9593\u3092\u6e1b\u7b97\n(time/sub-hours 1699632000 24)           ;; =&gt; 1699545600\uff0824\u6642\u9593\u524d\uff09\n\n;; time/sub-minutes - \u65e5\u4ed8\u304b\u3089\u5206\u3092\u6e1b\u7b97\n(time/sub-minutes 1699632000 30)         ;; =&gt; 1699630200\uff0830\u5206\u524d\uff09\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_7","title":"\u5dee\u5206\u8a08\u7b97","text":"<pre><code>;; time/diff-days - 2\u3064\u306e\u65e5\u4ed8\u306e\u5dee\u3092\u65e5\u6570\u3067\u53d6\u5f97\n(time/diff-days \"2023-11-17T12:00:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; 7\uff08\u65e5\uff09\n\n;; time/diff-hours - 2\u3064\u306e\u65e5\u4ed8\u306e\u5dee\u3092\u6642\u9593\u3067\u53d6\u5f97\n(time/diff-hours \"2023-11-10T15:00:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; 3\uff08\u6642\u9593\uff09\n\n;; time/diff-minutes - 2\u3064\u306e\u65e5\u4ed8\u306e\u5dee\u3092\u5206\u3067\u53d6\u5f97\n(time/diff-minutes \"2023-11-10T12:30:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; 30\uff08\u5206\uff09\n\n;; \u8ca0\u306e\u5024\u3082\u8fd4\u3059\n(time/diff-days \"2023-11-10T12:00:00+00:00\" \"2023-11-17T12:00:00+00:00\")\n;; =&gt; -7\uff08date1\u304cdate2\u3088\u308a\u524d\uff09\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_8","title":"\u65e5\u6642\u6bd4\u8f03","text":"<pre><code>;; time/before? - date1\u304cdate2\u3088\u308a\u524d\u304b\u5224\u5b9a\n(time/before? \"2023-11-10T12:00:00+00:00\" \"2023-11-17T12:00:00+00:00\")\n;; =&gt; true\n\n;; time/after? - date1\u304cdate2\u3088\u308a\u5f8c\u304b\u5224\u5b9a\n(time/after? \"2023-11-17T12:00:00+00:00\" \"2023-11-10T12:00:00+00:00\")\n;; =&gt; true\n\n;; time/between? - date\u304cstart\u301cend\u5185\u304b\u5224\u5b9a\uff08\u5883\u754c\u542b\u3080\uff09\n(time/between? \"2023-11-15T12:00:00+00:00\"\n               \"2023-11-10T12:00:00+00:00\"\n               \"2023-11-20T12:00:00+00:00\")\n;; =&gt; true\n\n;; Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3082\u4f7f\u7528\u53ef\u80fd\n(time/before? 1699632000 1700236800)     ;; =&gt; true\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_9","title":"\u65e5\u6642\u8981\u7d20\u306e\u62bd\u51fa","text":"<pre><code>;; time/year - \u65e5\u4ed8\u304b\u3089\u5e74\u3092\u53d6\u5f97\n(time/year \"2023-11-10T12:00:00+00:00\")  ;; =&gt; 2023\n\n;; time/month - \u65e5\u4ed8\u304b\u3089\u6708\u3092\u53d6\u5f97\uff081-12\uff09\n(time/month \"2023-11-10T12:00:00+00:00\") ;; =&gt; 11\n\n;; time/day - \u65e5\u4ed8\u304b\u3089\u65e5\u3092\u53d6\u5f97\uff081-31\uff09\n(time/day \"2023-11-10T12:00:00+00:00\")   ;; =&gt; 10\n\n;; time/hour - \u65e5\u4ed8\u304b\u3089\u6642\u3092\u53d6\u5f97\uff080-23\uff09\n(time/hour \"2023-11-10T12:00:00+00:00\")  ;; =&gt; 12\n\n;; time/minute - \u65e5\u4ed8\u304b\u3089\u5206\u3092\u53d6\u5f97\uff080-59\uff09\n(time/minute \"2023-11-10T12:35:00+00:00\") ;; =&gt; 35\n\n;; time/second - \u65e5\u4ed8\u304b\u3089\u79d2\u3092\u53d6\u5f97\uff080-59\uff09\n(time/second \"2023-11-10T12:00:45+00:00\") ;; =&gt; 45\n\n;; time/weekday - \u65e5\u4ed8\u304b\u3089\u66dc\u65e5\u3092\u53d6\u5f97\uff080=\u65e5\u66dc, 1=\u6708\u66dc, ..., 6=\u571f\u66dc\uff09\n(time/weekday \"2023-11-10T12:00:00+00:00\") ;; =&gt; 5\uff08\u91d1\u66dc\u65e5\uff09\n\n;; Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3082\u4f7f\u7528\u53ef\u80fd\n(time/year 1699632000)                   ;; =&gt; 2023\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_10","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/31-stdlib-time/#_11","title":"\u30ed\u30b0\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7","text":"<pre><code>;; \u73fe\u5728\u6642\u523b\u3067\u30ed\u30b0\u51fa\u529b\n(defn log [level msg]\n  (println (str/format \"[{}] {} - {}\"\n                       (time/format (time/now-iso) \"%Y-%m-%d %H:%M:%S\")\n                       level\n                       msg)))\n\n(log \"INFO\" \"Application started\")\n;; =&gt; \"[2025-11-10 15:30:45] INFO - Application started\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_12","title":"\u65e5\u6642\u8a08\u7b97\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; 7\u65e5\u5f8c\u306e\u5348\u524d9\u6642\u3092\u8a08\u7b97\n(time/now-iso\n |&gt; time/to-unix\n |&gt; (time/add-days _ 7)\n |&gt; (time/format _ \"%Y-%m-%d 09:00:00\")\n |&gt; (time/parse _ \"%Y-%m-%d %H:%M:%S\"))\n;; =&gt; 1700467200\uff087\u65e5\u5f8c\u306e\u5348\u524d9\u6642\u306eUnix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff09\n\n;; \u55b6\u696d\u65e5\u8a08\u7b97\uff08\u571f\u65e5\u3092\u9664\u304f5\u65e5\u5f8c\uff09\n(defn add-business-days [date days]\n  (let [target (time/add-days date days)]\n    (let [wd (time/weekday target)]\n      (cond\n        (= wd 0) (time/add-days target 1)  ;; \u65e5\u66dc\u2192\u6708\u66dc\n        (= wd 6) (time/add-days target 2)  ;; \u571f\u66dc\u2192\u6708\u66dc\n        :else target))))\n\n(add-business-days (time/to-unix \"2023-11-10T12:00:00+00:00\") 5)\n;; =&gt; \u9031\u672b\u3092\u8003\u616e\u3057\u305f5\u55b6\u696d\u65e5\u5f8c\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_13","title":"\u671f\u9650\u7ba1\u7406","text":"<pre><code>;; \u30bf\u30b9\u30af\u306e\u7de0\u3081\u5207\u308a\u30c1\u30a7\u30c3\u30af\n(defn is-overdue? [due-date]\n  (time/before? due-date (time/now-iso)))\n\n(is-overdue? \"2025-11-01T23:59:59+00:00\") ;; =&gt; true\n\n;; \u7de0\u3081\u5207\u308a\u307e\u3067\u306e\u6b8b\u308a\u65e5\u6570\n(defn days-until [due-date]\n  (time/diff-days due-date (time/now-iso)))\n\n(days-until \"2025-12-25T00:00:00+00:00\") ;; =&gt; 45\uff08\u6b8b\u308a45\u65e5\uff09\n\n;; \u671f\u9650\u5185\u304b\u5224\u5b9a\n(defn is-within-deadline? [start end]\n  (time/between? (time/now-iso) start end))\n\n(is-within-deadline? \"2025-11-01T00:00:00+00:00\" \"2025-12-31T23:59:59+00:00\")\n;; =&gt; true\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_14","title":"\u30c7\u30fc\u30bf\u96c6\u8a08","text":"<pre><code>;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4eca\u65e5\u306e\u30a8\u30e9\u30fc\u3092\u62bd\u51fa\n(defn today-errors [logs]\n  (let [today (time/today)]\n    (logs\n     |&gt; (filter (fn [log]\n              (and\n                (str/contains? log \"ERROR\")\n                (str/starts-with? log today)))))))\n\n(today-errors [\"2025-11-10 10:30 ERROR: DB connection failed\"\n               \"2025-11-09 14:20 ERROR: Timeout\"\n               \"2025-11-10 15:45 ERROR: Invalid input\"])\n;; =&gt; [\"2025-11-10 10:30 ERROR: DB connection failed\"\n;;     \"2025-11-10 15:45 ERROR: Invalid input\"]\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_15","title":"\u6642\u523b\u7bc4\u56f2\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>;; \u7279\u5b9a\u671f\u9593\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u62bd\u51fa\n(defn filter-by-period [events start end]\n  (events\n   |&gt; (filter (fn [evt]\n            (time/between? (get evt :timestamp) start end)))))\n\n(def events [{:timestamp \"2023-11-10T10:00:00+00:00\" :type \"login\"}\n             {:timestamp \"2023-11-15T14:30:00+00:00\" :type \"purchase\"}\n             {:timestamp \"2023-11-20T09:00:00+00:00\" :type \"logout\"}])\n\n(filter-by-period events\n                  \"2023-11-10T00:00:00+00:00\"\n                  \"2023-11-16T00:00:00+00:00\")\n;; =&gt; [{:timestamp \"2023-11-10T10:00:00+00:00\" :type \"login\"}\n;;     {:timestamp \"2023-11-15T14:30:00+00:00\" :type \"purchase\"}]\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_16","title":"\u66dc\u65e5\u5224\u5b9a","text":"<pre><code>;; \u9031\u672b\u5224\u5b9a\n(defn is-weekend? [date]\n  (let [wd (time/weekday date)]\n    (or (= wd 0) (= wd 6))))\n\n(is-weekend? \"2023-11-11T12:00:00+00:00\") ;; =&gt; true\uff08\u571f\u66dc\u65e5\uff09\n(is-weekend? \"2023-11-10T12:00:00+00:00\") ;; =&gt; false\uff08\u91d1\u66dc\u65e5\uff09\n\n;; \u66dc\u65e5\u540d\u3092\u53d6\u5f97\n(def weekdays [\"\u65e5\" \"\u6708\" \"\u706b\" \"\u6c34\" \"\u6728\" \"\u91d1\" \"\u571f\"])\n\n(defn weekday-name [date]\n  (get weekdays (time/weekday date)))\n\n(weekday-name \"2023-11-10T12:00:00+00:00\") ;; =&gt; \"\u91d1\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_17","title":"\u65e5\u6642\u30d0\u30c3\u30c1\u51e6\u7406","text":"<pre><code>;; 1\u6642\u9593\u3054\u3068\u306e\u30c7\u30fc\u30bf\u30dd\u30a4\u30f3\u30c8\u3092\u751f\u6210\n(defn hourly-points [start-date hours]\n  (stream/range 0 hours)\n  |&gt; (map (fn [h] (time/add-hours start-date h)))\n  |&gt; (map (fn [ts] (time/format ts \"%Y-%m-%d %H:00:00\")))\n  |&gt; collect)\n\n(hourly-points (time/to-unix \"2023-11-10T00:00:00+00:00\") 24)\n;; =&gt; [\"2023-11-10 00:00:00\" \"2023-11-10 01:00:00\" ... \"2023-11-10 23:00:00\"]\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_18","title":"\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306b\u3064\u3044\u3066","text":"<p>\u91cd\u8981: \u3059\u3079\u3066\u306e\u6642\u523b\u51e6\u7406\u306fUTC\uff08\u5354\u5b9a\u4e16\u754c\u6642\uff09\u3067\u884c\u308f\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/31-stdlib-time/#iso-8601_1","title":"ISO 8601\u5f62\u5f0f\u306e\u6642\u523b","text":"<ul> <li><code>time/now-iso</code> \u306fUTC\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\uff08<code>+00:00</code>\uff09\u3067\u8fd4\u3057\u307e\u3059</li> <li><code>time/format</code>, <code>time/parse</code> \u306fUTC\u3068\u3057\u3066\u6271\u3044\u307e\u3059</li> <li>\u30ed\u30fc\u30ab\u30eb\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u624b\u52d5\u3067\u8a08\u7b97\u3057\u3066\u304f\u3060\u3055\u3044</li> </ul> <pre><code>;; UTC\u3067\u306e\u73fe\u5728\u6642\u523b\n(time/now-iso)  ;; =&gt; \"2025-11-10T15:30:45+00:00\"\n\n;; \u65e5\u672c\u6642\u9593\uff08UTC+9\uff09\u306b\u5909\u63db\u3057\u305f\u3044\u5834\u5408\n(time/now-iso\n |&gt; time/to-unix\n |&gt; (time/add-hours _ 9)\n |&gt; (time/format _ \"%Y-%m-%d %H:%M:%S JST\"))\n;; =&gt; \"2025-11-11 00:30:45 JST\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_19","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"ja/spec/31-stdlib-time/#_20","title":"\u7121\u52b9\u306a\u65e5\u6642\u6587\u5b57\u5217","text":"<pre><code>;; \u7121\u52b9\u306aISO 8601\u5f62\u5f0f\n(time/to-unix \"invalid-date\")\n;; =&gt; \u30a8\u30e9\u30fc: \"time/to-unix: \u7121\u52b9\u306a\u65e5\u4ed8\u5f62\u5f0f: invalid-date\"\n\n;; \u30d1\u30fc\u30b9\u5931\u6557\n(time/parse \"2023-13-45\" \"%Y-%m-%d\")\n;; =&gt; \u30a8\u30e9\u30fc: \"time/parse: \u65e5\u4ed8\u6587\u5b57\u5217 '2023-13-45' \u3092\u5f62\u5f0f '%Y-%m-%d' \u3067\u30d1\u30fc\u30b9\u3067\u304d\u307e\u305b\u3093\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_21","title":"\u7121\u52b9\u306a\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7","text":"<pre><code>;; \u7bc4\u56f2\u5916\u306eUnix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n(time/from-unix 99999999999999)\n;; =&gt; \u30a8\u30e9\u30fc: \"time/from-unix: \u7121\u52b9\u306a\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3067\u3059\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_22","title":"\u578b\u30a8\u30e9\u30fc","text":"<pre><code>;; \u6587\u5b57\u5217\u4ee5\u5916\u306e\u5f15\u6570\n(time/to-unix 123)\n;; =&gt; \u30a8\u30e9\u30fc: \"time/to-unix: \u6587\u5b57\u5217\u306e\u307f\u3092\u53d7\u3051\u4ed8\u3051\u307e\u3059\"\n\n;; \u6574\u6570\u4ee5\u5916\u306e\u65e5\u6570\n(time/add-days \"2023-11-10T12:00:00+00:00\" \"7\")\n;; =&gt; \u30a8\u30e9\u30fc: \"time/add-days (days): \u6574\u6570\u306e\u307f\u3092\u53d7\u3051\u4ed8\u3051\u307e\u3059\"\n</code></pre>"},{"location":"ja/spec/31-stdlib-time/#_23","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/31-stdlib-time/#_24","title":"\u73fe\u5728\u6642\u523b\u53d6\u5f97","text":"<ul> <li><code>time/now-iso</code> - \u73fe\u5728\u6642\u523b\u3092ISO 8601\u5f62\u5f0f\u3067\u53d6\u5f97</li> <li><code>time/today</code> - \u4eca\u65e5\u306e\u65e5\u4ed8\u3092YYYY-MM-DD\u5f62\u5f0f\u3067\u53d6\u5f97</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#unix_1","title":"Unix\u6642\u523b\u5909\u63db","text":"<ul> <li><code>time/from-unix</code> - Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u2192ISO 8601\u5f62\u5f0f</li> <li><code>time/to-unix</code> - ISO 8601\u5f62\u5f0f\u2192Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_25","title":"\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30fb\u30d1\u30fc\u30b9","text":"<ul> <li><code>time/format</code> - \u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u6307\u5b9a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u6587\u5b57\u5217\u5316</li> <li><code>time/parse</code> - \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u6587\u5b57\u5217\u3092\u4f7f\u3063\u3066\u65e5\u4ed8\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_26","title":"\u65e5\u6642\u8a08\u7b97\uff08\u52a0\u7b97\uff09","text":"<ul> <li><code>time/add-days</code> - \u65e5\u6570\u3092\u52a0\u7b97</li> <li><code>time/add-hours</code> - \u6642\u9593\u3092\u52a0\u7b97</li> <li><code>time/add-minutes</code> - \u5206\u3092\u52a0\u7b97</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_27","title":"\u65e5\u6642\u8a08\u7b97\uff08\u6e1b\u7b97\uff09","text":"<ul> <li><code>time/sub-days</code> - \u65e5\u6570\u3092\u6e1b\u7b97</li> <li><code>time/sub-hours</code> - \u6642\u9593\u3092\u6e1b\u7b97</li> <li><code>time/sub-minutes</code> - \u5206\u3092\u6e1b\u7b97</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_28","title":"\u65e5\u6642\u8a08\u7b97\uff08\u5dee\u5206\uff09","text":"<ul> <li><code>time/diff-days</code> - 2\u3064\u306e\u65e5\u4ed8\u306e\u5dee\u3092\u65e5\u6570\u3067\u53d6\u5f97</li> <li><code>time/diff-hours</code> - 2\u3064\u306e\u65e5\u4ed8\u306e\u5dee\u3092\u6642\u9593\u3067\u53d6\u5f97</li> <li><code>time/diff-minutes</code> - 2\u3064\u306e\u65e5\u4ed8\u306e\u5dee\u3092\u5206\u3067\u53d6\u5f97</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_29","title":"\u65e5\u6642\u6bd4\u8f03","text":"<ul> <li><code>time/before?</code> - date1\u304cdate2\u3088\u308a\u524d\u304b\u5224\u5b9a</li> <li><code>time/after?</code> - date1\u304cdate2\u3088\u308a\u5f8c\u304b\u5224\u5b9a</li> <li><code>time/between?</code> - date\u304cstart\u301cend\u5185\u304b\u5224\u5b9a</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_30","title":"\u65e5\u6642\u8981\u7d20\u62bd\u51fa","text":"<ul> <li><code>time/year</code> - \u5e74\u3092\u53d6\u5f97</li> <li><code>time/month</code> - \u6708\u3092\u53d6\u5f97\uff081-12\uff09</li> <li><code>time/day</code> - \u65e5\u3092\u53d6\u5f97\uff081-31\uff09</li> <li><code>time/hour</code> - \u6642\u3092\u53d6\u5f97\uff080-23\uff09</li> <li><code>time/minute</code> - \u5206\u3092\u53d6\u5f97\uff080-59\uff09</li> <li><code>time/second</code> - \u79d2\u3092\u53d6\u5f97\uff080-59\uff09</li> <li><code>time/weekday</code> - \u66dc\u65e5\u3092\u53d6\u5f97\uff080=\u65e5\u66dc, 1=\u6708\u66dc, ..., 6=\u571f\u66dc\uff09</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_31","title":"\u8a2d\u8a08\u30ce\u30fc\u30c8","text":""},{"location":"ja/spec/31-stdlib-time/#iso-8601_2","title":"ISO 8601\u5f62\u5f0f\u306e\u63a1\u7528","text":"<p>\u3059\u3079\u3066\u306e\u6587\u5b57\u5217\u30d9\u30fc\u30b9\u306e\u65e5\u6642\u8868\u73fe\u306fISO 8601\u5f62\u5f0f\uff08RFC 3339\uff09\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\uff1a</p> <ul> <li>\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u60c5\u5831\u306e\u660e\u793a: <code>+00:00</code>\u306e\u3088\u3046\u306b\u5e38\u306b\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u304c\u542b\u307e\u308c\u308b</li> <li>\u56fd\u969b\u6a19\u6e96: \u30d7\u30ed\u30b0\u30e9\u30e0\u9593\u306e\u30c7\u30fc\u30bf\u4ea4\u63db\u304c\u5bb9\u6613</li> <li>\u30bd\u30fc\u30c8\u53ef\u80fd: \u6587\u5b57\u5217\u6bd4\u8f03\u3067\u3082\u6b63\u3057\u304f\u9806\u5e8f\u4ed8\u3051\u3067\u304d\u308b</li> <li>\u660e\u78ba\u6027: \u65e5\u4ed8\u306e\u66d6\u6627\u3055\u304c\u306a\u3044\uff08MM/DD vs DD/MM\u7b49\uff09</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#unix_2","title":"Unix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3068\u306e\u4e92\u63db\u6027","text":"<ul> <li>\u5916\u90e8\u30b7\u30b9\u30c6\u30e0\u3068\u306e\u9023\u643a\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u683c\u7d0d\u306b\u306fUnix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08\u6574\u6570\uff09\u304c\u4fbf\u5229</li> <li><code>time/to-unix</code>, <code>time/from-unix</code>\u3067\u76f8\u4e92\u5909\u63db\u304c\u53ef\u80fd</li> <li>\u8a08\u7b97\u7d50\u679c\u306f\u57fa\u672c\u7684\u306bUnix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3067\u8fd4\u3059\uff08\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406\u3057\u3084\u3059\u3044\uff09</li> </ul>"},{"location":"ja/spec/31-stdlib-time/#_32","title":"\u5f15\u6570\u306e\u67d4\u8edf\u6027","text":"<p>\u591a\u304f\u306e\u95a2\u6570\u306fUnix\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3068ISO 8601\u6587\u5b57\u5217\u306e\u4e21\u65b9\u3092\u53d7\u3051\u4ed8\u3051\u307e\u3059\uff1a</p> <pre><code>;; \u4e21\u65b9\u3068\u3082\u6709\u52b9\n(time/add-days 1699632000 7)\n(time/add-days \"2023-11-10T12:00:00+00:00\" 7)\n</code></pre> <p>\u3053\u308c\u306b\u3088\u308a\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406\u304c\u30b9\u30e0\u30fc\u30ba\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"ja/spec/32-stdlib-zip/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - ZIP\u5727\u7e2e\u30fb\u89e3\u51cd\uff08zip/\uff09","text":"<p>ZIP/gzip\u5727\u7e2e\u30fb\u89e3\u51cd\u30e9\u30a4\u30d6\u30e9\u30ea</p> <p>ZIP\u5f62\u5f0f\u306b\u3088\u308b\u30a2\u30fc\u30ab\u30a4\u30d6\u4f5c\u6210\u30fb\u5c55\u958b\u3001\u304a\u3088\u3073gzip\u306b\u3088\u308b\u5358\u4e00\u30d5\u30a1\u30a4\u30eb\u5727\u7e2e\u3092\u30b5\u30dd\u30fc\u30c8\u3002</p> <p>Feature Gate: \u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f <code>util-zip</code> feature\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/32-stdlib-zip/#_1","title":"\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"ja/spec/32-stdlib-zip/#zip","title":"ZIP\u4f5c\u6210","text":"<pre><code>;; zip/create - ZIP\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n(zip/create \"backup.zip\" \"data.txt\" \"config.json\")\n;; =&gt; \"backup.zip\"\n\n;; \u8907\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u5727\u7e2e\n(zip/create \"archive.zip\" \"file1.txt\" \"file2.txt\" \"file3.txt\")\n\n;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4e38\u3054\u3068\u5727\u7e2e\n(zip/create \"logs.zip\" \"logs/\")\n;; =&gt; logs\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u518d\u5e30\u7684\u306b\u8ffd\u52a0\u3055\u308c\u308b\n\n;; \u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6df7\u5728\n(zip/create \"backup.zip\" \"README.md\" \"src/\" \"config/\")\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#zip_1","title":"ZIP\u89e3\u51cd","text":"<pre><code>;; zip/extract - ZIP\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\uff08\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5c55\u958b\uff09\n(zip/extract \"backup.zip\")\n;; =&gt; \".\"\n\n;; \u5c55\u958b\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\n(zip/extract \"archive.zip\" \"output/\")\n;; =&gt; \"output/\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(\"backup.zip\" |&gt; zip/extract)\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#zip_2","title":"ZIP\u5185\u5bb9\u78ba\u8a8d","text":"<pre><code>;; zip/list - ZIP\u5185\u5bb9\u4e00\u89a7\u3092\u53d6\u5f97\n(zip/list \"backup.zip\")\n;; =&gt; [\n;;      {:name \"data.txt\" :size 1234 :compressed-size 567 :is-dir false}\n;;      {:name \"config.json\" :size 456 :compressed-size 123 :is-dir false}\n;;      {:name \"logs/\" :size 0 :compressed-size 0 :is-dir true}\n;;    ]\n\n;; \u30d5\u30a1\u30a4\u30eb\u540d\u3060\u3051\u53d6\u5f97\n(zip/list \"backup.zip\"\n |&gt; (map (fn [entry] (get entry \"name\"))))\n;; =&gt; [\"data.txt\" \"config.json\" \"logs/\"]\n\n;; \u5727\u7e2e\u7387\u3092\u8a08\u7b97\n(zip/list \"backup.zip\"\n |&gt; (map (fn [entry]\n           (let [original (get entry \"size\")\n                 compressed (get entry \"compressed-size\")\n                 ratio (if (&gt; original 0)\n                         (* 100 (/ compressed original))\n                         0)]\n             {:name (get entry \"name\")\n              :ratio ratio}))))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#zip_3","title":"\u65e2\u5b58ZIP\u306b\u8ffd\u52a0","text":"<pre><code>;; zip/add - \u65e2\u5b58ZIP\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\n(zip/add \"backup.zip\" \"new-file.txt\")\n;; =&gt; \"backup.zip\"\n\n;; \u8907\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\n(zip/add \"backup.zip\" \"file1.txt\" \"file2.txt\" \"dir/\")\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528\n(\"backup.zip\" |&gt; (zip/add _ \"update.txt\"))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#gzip","title":"gzip\u5727\u7e2e","text":""},{"location":"ja/spec/32-stdlib-zip/#_2","title":"\u57fa\u672c\u64cd\u4f5c","text":"<pre><code>;; zip/gzip - \u30d5\u30a1\u30a4\u30eb\u3092gzip\u5727\u7e2e\n(zip/gzip \"data.txt\")\n;; =&gt; \"data.txt.gz\" \uff08\u81ea\u52d5\u7684\u306b.gz\u62e1\u5f35\u5b50\u304c\u4ed8\u304f\uff09\n\n;; \u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\n(zip/gzip \"data.txt\" \"backup.gz\")\n;; =&gt; \"backup.gz\"\n\n;; zip/gunzip - gzip\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\n(zip/gunzip \"data.txt.gz\")\n;; =&gt; \"data.txt\" \uff08\u81ea\u52d5\u7684\u306b.gz\u62e1\u5f35\u5b50\u304c\u9664\u53bb\u3055\u308c\u308b\uff09\n\n;; \u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\n(zip/gunzip \"backup.gz\" \"restored.txt\")\n;; =&gt; \"restored.txt\"\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_3","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u4f7f\u7528","text":"<pre><code>;; gzip\u5727\u7e2e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(\"data.txt\" |&gt; zip/gzip)\n;; =&gt; \"data.txt.gz\"\n\n;; gzip\u89e3\u51cd\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(\"data.txt.gz\" |&gt; zip/gunzip)\n;; =&gt; \"data.txt\"\n\n;; \u5727\u7e2e\u30fb\u51e6\u7406\u30fb\u89e3\u51cd\u306e\u9023\u9396\n(\"large-data.txt\"\n |&gt; zip/gzip\n |&gt; upload-to-server\n |&gt; download-from-server\n |&gt; zip/gunzip)\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_4","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/32-stdlib-zip/#_5","title":"\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30b7\u30b9\u30c6\u30e0","text":"<pre><code>;; \u65e5\u6b21\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n(defn create-backup [date]\n  (let [backup-name f\"backup-{date}.zip\"]\n    (zip/create backup-name \"data/\" \"config/\" \"logs/\")\n    (println f\"Backup created: {backup-name}\")))\n\n(create-backup \"2024-11-10\")\n;; =&gt; \"Backup created: backup-2024-11-10.zip\"\n\n;; \u8907\u6570\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u500b\u5225\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n(def dirs [\"data\" \"config\" \"logs\"])\n\n(dirs\n |&gt; (map (fn [dir]\n           (let [zip-file f\"{dir}-backup.zip\"]\n             (zip/create zip-file f\"{dir}/\")\n             {:dir dir :file zip-file})))\n |&gt; (map println))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_6","title":"\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>;; \u53e4\u3044\u30ed\u30b0\u3092\u5727\u7e2e\u3057\u3066\u30a2\u30fc\u30ab\u30a4\u30d6\n(defn archive-old-logs [days]\n  (let [cutoff (- (time/now) (* days 86400))]\n    (io/list-dir \"logs\" :pattern \"*.log\")\n    |&gt; (filter (fn [file]\n                 (let [info (io/file-info file)\n                       modified (get info \"modified\")]\n                   (&lt; modified cutoff))))\n    |&gt; (map (fn [file]\n              ;; gzip\u5727\u7e2e\n              (let [gz (zip/gzip file)]\n                ;; \u5143\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n                (io/delete-file file)\n                gz)))))\n\n;; 7\u65e5\u4ee5\u524d\u306e\u30ed\u30b0\u3092\u5727\u7e2e\n(archive-old-logs 7)\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_7","title":"\u914d\u5e03\u7528\u30a2\u30fc\u30ab\u30a4\u30d6\u306e\u4f5c\u6210","text":"<pre><code>;; \u30ea\u30ea\u30fc\u30b9\u7528ZIP\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n(defn create-release [version]\n  (let [archive-name f\"myapp-{version}.zip\"\n        files [\"README.md\"\n               \"LICENSE\"\n               \"bin/\"\n               \"lib/\"\n               \"docs/\"]]\n    ;; \u4e00\u6642\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5fc5\u8981\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\n    (let [tmpdir (io/temp-dir)\n          dest-dir (path/join tmpdir f\"myapp-{version}\")]\n      (io/create-dir dest-dir)\n\n      ;; \u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\n      (files\n       |&gt; (map (fn [file]\n                 (let [dest (path/join dest-dir (path/basename file))]\n                   (if (io/is-dir? file)\n                     (copy-dir-recursive file dest)\n                     (io/copy-file file dest))))))\n\n      ;; ZIP\u3092\u4f5c\u6210\n      (zip/create archive-name dest-dir)\n      archive-name)))\n\n(create-release \"1.0.0\")\n;; =&gt; \"myapp-1.0.0.zip\"\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_8","title":"\u30c7\u30fc\u30bf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30fb\u5c55\u958b","text":"<pre><code>;; Web\u304b\u3089\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u5c55\u958b\n(defn download-and-extract [url dest-dir]\n  (let [tmpfile (io/temp-file)]\n    ;; \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n    (http/get url :output tmpfile)\n\n    ;; \u5c55\u958b\n    (zip/extract tmpfile dest-dir)\n\n    ;; \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306f\u81ea\u52d5\u524a\u9664\u3055\u308c\u308b\n    (println f\"Extracted to: {dest-dir}\")))\n\n(download-and-extract \"https://example.com/data.zip\" \"data/\")\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_9","title":"\u5927\u91cf\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406","text":"<pre><code>;; \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u500b\u5225\u306b\u5727\u7e2e\n(defn compress-all-files [dir]\n  (io/list-dir dir :pattern \"*.*\")\n  |&gt; (filter io/is-file?)\n  |&gt; (map zip/gzip)\n  |&gt; (map println))\n\n(compress-all-files \"documents/\")\n\n;; \u4e26\u5217\u5727\u7e2e\uff08\u5927\u91cf\u30d5\u30a1\u30a4\u30eb\u3092\u9ad8\u901f\u51e6\u7406\uff09\n(defn compress-all-parallel [dir]\n  (io/list-dir dir :pattern \"*.*\")\n  |&gt; (filter io/is-file?)\n  ||&gt; zip/gzip\n  |&gt; (map println))\n\n(compress-all-parallel \"logs/\")\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_10","title":"\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u691c\u8a3c","text":"<pre><code>;; ZIP\u30d5\u30a1\u30a4\u30eb\u306e\u6574\u5408\u6027\u30c1\u30a7\u30c3\u30af\n(defn verify-backup [zip-file expected-files]\n  (let [entries (zip/list zip-file)\n        names (entries |&gt; (map (fn [e] (get e \"name\"))))]\n    (expected-files\n     |&gt; (map (fn [file]\n               (let [found (names |&gt; (filter (fn [n] (str/contains? n file))))]\n                 {:file file\n                  :found (not (empty? found))})))\n     |&gt; (filter (fn [result] (not (get result \"found\")))))))\n\n(def expected [\"data.txt\" \"config.json\" \"logs/\"])\n(let [missing (verify-backup \"backup.zip\" expected)]\n  (if (empty? missing)\n    (println \"Backup verified: all files present\")\n    (do\n      (println \"Missing files:\")\n      (missing |&gt; (map (fn [m] (get m \"file\"))) |&gt; (map println)))))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_11","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"ja/spec/32-stdlib-zip/#_12","title":"\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044","text":"<pre><code>;; try-catch\u3067\u30a8\u30e9\u30fc\u3092\u6355\u6349\n(try\n  (zip/create \"backup.zip\" \"nonexistent.txt\")\n  (catch e\n    (println f\"Error: {e}\")))\n;; =&gt; \"Error: zip/create: path does not exist: 'nonexistent.txt'\"\n\n;; \u4e8b\u524d\u30c1\u30a7\u30c3\u30af\n(defn safe-create-zip [zip-file files]\n  (let [missing (files |&gt; (filter (fn [f] (not (io/file-exists? f)))))]\n    (if (empty? missing)\n      (zip/create zip-file ..files)\n      (do\n        (println \"Missing files:\")\n        (missing |&gt; (map println))\n        :error))))\n\n(safe-create-zip \"backup.zip\" [\"file1.txt\" \"file2.txt\"])\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_13","title":"\u5c55\u958b\u5148\u306e\u4fdd\u8b77","text":"<pre><code>;; \u5c55\u958b\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\n(defn safe-extract [zip-file dest-dir]\n  (if (io/file-exists? dest-dir)\n    (do\n      (println f\"Destination already exists: {dest-dir}\")\n      :skip)\n    (zip/extract zip-file dest-dir)))\n\n;; \u4e0a\u66f8\u304d\u78ba\u8a8d\n(defn extract-with-confirm [zip-file dest-dir]\n  (if (io/file-exists? dest-dir)\n    (do\n      (print f\"Overwrite {dest-dir}? (y/n): \")\n      (let [answer (io/stdin-line)]\n        (if (= answer \"y\")\n          (do\n            (io/delete-dir dest-dir :recursive true)\n            (zip/extract zip-file dest-dir))\n          (println \"Cancelled\"))))\n    (zip/extract zip-file dest-dir)))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_14","title":"\u30c7\u30a3\u30b9\u30af\u5bb9\u91cf\u30c1\u30a7\u30c3\u30af","text":"<pre><code>;; \u5c55\u958b\u524d\u306b\u5bb9\u91cf\u3092\u78ba\u8a8d\n(defn check-space-before-extract [zip-file dest-dir]\n  (let [entries (zip/list zip-file)\n        total-size (entries\n                    |&gt; (map (fn [e] (get e \"size\")))\n                    |&gt; (reduce + 0))]\n    (println f\"Archive size: {total-size} bytes\")\n    ;; TODO: \u30c7\u30a3\u30b9\u30af\u7a7a\u304d\u5bb9\u91cf\u30c1\u30a7\u30c3\u30af\n    (zip/extract zip-file dest-dir)))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_15","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408","text":""},{"location":"ja/spec/32-stdlib-zip/#_16","title":"\u30d5\u30a1\u30a4\u30eb\u51e6\u7406\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u30d5\u30a1\u30a4\u30eb\u3092\u51e6\u7406\u3057\u3066ZIP\u306b\u8ffd\u52a0\n(io/list-dir \"data\" :pattern \"*.txt\")\n|&gt; (map io/read-file)\n|&gt; (map process-text)\n|&gt; (map-indexed (fn [i content]\n                  (let [tmpfile f\"/tmp/processed-{i}.txt\"]\n                    (io/write-file content tmpfile)\n                    tmpfile)))\n|&gt; (fn [files]\n     (zip/create \"processed.zip\" ..files))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_17","title":"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30fb\u5727\u7e2e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u8907\u6570URL\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u5727\u7e2e\n(def urls [\"https://example.com/file1.txt\"\n           \"https://example.com/file2.txt\"])\n\n(urls\n ||&gt; (fn [url]\n       (let [tmpfile (io/temp-file)]\n         (http/get url :output tmpfile)\n         tmpfile))\n |&gt; (fn [files]\n      (zip/create \"downloads.zip\" ..files)))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_18","title":"\u5727\u7e2e\u7387\u6bd4\u8f03","text":"<pre><code>;; \u5404\u30d5\u30a1\u30a4\u30eb\u306e\u5727\u7e2e\u7387\u3092\u30ec\u30dd\u30fc\u30c8\n(defn compression-report [zip-file]\n  (zip/list zip-file)\n  |&gt; (filter (fn [e] (not (get e \"is-dir\"))))\n  |&gt; (map (fn [entry]\n            (let [name (get entry \"name\")\n                  original (get entry \"size\")\n                  compressed (get entry \"compressed-size\")\n                  ratio (if (&gt; original 0)\n                          (- 100 (* 100 (/ compressed original)))\n                          0)]\n              {:name name\n               :original original\n               :compressed compressed\n               :saved (- original compressed)\n               :ratio ratio})))\n  |&gt; (map (fn [r]\n            (println f\"{(get r \\\"name\\\")}: {(get r \\\"ratio\\\")}% saved\"))))\n\n(compression-report \"backup.zip\")\n;; =&gt; data.txt: 54% saved\n;; =&gt; config.json: 32% saved\n;; =&gt; image.png: 2% saved\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_19","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u8003\u616e\u4e8b\u9805","text":""},{"location":"ja/spec/32-stdlib-zip/#_20","title":"\u5927\u91cf\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406","text":"<pre><code>;; \u4e26\u5217\u51e6\u7406\u3067\u9ad8\u901f\u5316\uff08\u305f\u3060\u3057\u3001zip/create\u306f\u9806\u6b21\u5b9f\u884c\u3055\u308c\u308b\uff09\n(defn create-zip-fast [zip-file files]\n  ;; \u30d5\u30a1\u30a4\u30eb\u306e\u5b58\u5728\u78ba\u8a8d\u3092\u4e26\u5217\u5b9f\u884c\n  (let [valid (files ||&gt; io/file-exists? |&gt; (filter identity))]\n    (zip/create zip-file ..valid)))\n\n;; \u5927\u304d\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u5206\u5272\u3057\u3066\u5727\u7e2e\n(defn split-archive [dir max-files]\n  (let [all-files (io/list-dir dir :recursive true)\n        chunks (all-files |&gt; (partition max-files))]\n    (chunks\n     |&gt; (map-indexed (fn [i files]\n                       (let [zip-file f\"archive-part{i}.zip\"]\n                         (zip/create zip-file ..files)\n                         zip-file))))))\n\n(split-archive \"large-dir\" 1000)\n;; =&gt; [\"archive-part0.zip\" \"archive-part1.zip\" ...]\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_21","title":"\u30e1\u30e2\u30ea\u52b9\u7387","text":"<pre><code>;; \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u306fgzip\u3067\u500b\u5225\u5727\u7e2e\uff08ZIP\u3088\u308a\u30e1\u30e2\u30ea\u52b9\u7387\u7684\uff09\n(defn compress-large-files [pattern]\n  (io/list-dir \".\" :pattern pattern)\n  |&gt; (filter (fn [f]\n               (let [info (io/file-info f)]\n                 (&gt; (get info \"size\") 10000000)))) ;; 10MB\u4ee5\u4e0a\n  |&gt; (map zip/gzip)\n  |&gt; (map println))\n\n(compress-large-files \"*.log\")\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_22","title":"\u5727\u7e2e\u30ec\u30d9\u30eb\u306e\u8abf\u6574","text":"<p>\u73fe\u5728\u306e\u5b9f\u88c5\u3067\u306f <code>CompressionMethod::Deflated</code> \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u30ec\u30d9\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002 \u5c06\u6765\u7684\u306b\u306f\u5727\u7e2e\u30ec\u30d9\u30eb\u6307\u5b9a\u306e\u30b5\u30dd\u30fc\u30c8\u304c\u8ffd\u52a0\u3055\u308c\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code>;; \u5c06\u6765\u7684\u306a\u6a5f\u80fd\uff08\u672a\u5b9f\u88c5\uff09\n;; (zip/create \"backup.zip\" \"data/\" :compression :fast)\n;; (zip/create \"backup.zip\" \"data/\" :compression :best)\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_23","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/32-stdlib-zip/#zip_4","title":"ZIP\u64cd\u4f5c","text":"<ul> <li><code>zip/create</code> - ZIP\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\uff08\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5bfe\u5fdc\uff09</li> <li><code>zip/extract</code> - ZIP\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\uff08\u5c55\u958b\u5148\u6307\u5b9a\u53ef\u80fd\uff09</li> <li><code>zip/list</code> - ZIP\u5185\u5bb9\u4e00\u89a7\u3092\u53d6\u5f97\uff08\u30b5\u30a4\u30ba\u30fb\u5727\u7e2e\u7387\u60c5\u5831\u542b\u3080\uff09</li> <li><code>zip/add</code> - \u65e2\u5b58ZIP\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0</li> </ul>"},{"location":"ja/spec/32-stdlib-zip/#gzip_1","title":"gzip\u64cd\u4f5c","text":"<ul> <li><code>zip/gzip</code> - \u30d5\u30a1\u30a4\u30eb\u3092gzip\u5727\u7e2e\uff08\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d\u6307\u5b9a\u53ef\u80fd\uff09</li> <li><code>zip/gunzip</code> - gzip\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\uff08\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u540d\u6307\u5b9a\u53ef\u80fd\uff09</li> </ul>"},{"location":"ja/spec/32-stdlib-zip/#zipgzip","title":"ZIP\u3068gzip\u306e\u4f7f\u3044\u5206\u3051","text":""},{"location":"ja/spec/32-stdlib-zip/#zip_5","title":"ZIP\u5f62\u5f0f\u3092\u4f7f\u3046\u3079\u304d\u5834\u5408","text":"<ul> <li>\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u307e\u3068\u3081\u305f\u3044</li> <li>\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u3092\u4fdd\u6301\u3057\u305f\u3044</li> <li>\u500b\u5225\u30d5\u30a1\u30a4\u30eb\u306e\u53d6\u308a\u51fa\u3057\u304c\u5fc5\u8981</li> <li>Windows/Mac\u3067\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u958b\u304d\u305f\u3044</li> <li>\u914d\u5e03\u7528\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u4f5c\u308a\u305f\u3044</li> </ul>"},{"location":"ja/spec/32-stdlib-zip/#gzip_2","title":"gzip\u5f62\u5f0f\u3092\u4f7f\u3046\u3079\u304d\u5834\u5408","text":"<ul> <li>\u5358\u4e00\u30d5\u30a1\u30a4\u30eb\u306e\u5727\u7e2e</li> <li>Unix/Linux\u3067\u306e\u6a19\u6e96\u7684\u306a\u5727\u7e2e</li> <li>\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u5727\u7e2e\u304c\u5fc5\u8981</li> <li>tar\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\uff08tar.gz\uff09</li> <li>\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3</li> </ul>"},{"location":"ja/spec/32-stdlib-zip/#_24","title":"\u3088\u304f\u3042\u308b\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"ja/spec/32-stdlib-zip/#_25","title":"\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30fb\u30ea\u30b9\u30c8\u30a2","text":"<pre><code>;; \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u4f5c\u6210\n(defn backup [name]\n  (let [timestamp (time/format (time/now) \"%Y%m%d-%H%M%S\")\n        zip-file f\"backup-{name}-{timestamp}.zip\"]\n    (zip/create zip-file \"data/\" \"config/\")\n    (println f\"Backup created: {zip-file}\")\n    zip-file))\n\n;; \u30ea\u30b9\u30c8\u30a2\n(defn restore [zip-file]\n  (let [tmpdir (io/temp-dir)]\n    (zip/extract zip-file tmpdir)\n    ;; \u691c\u8a3c\u5f8c\u306b\u672c\u756a\u74b0\u5883\u3078\u30b3\u30d4\u30fc\n    (println \"Restored to temporary directory\")\n    tmpdir))\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_26","title":"\u30c7\u30fc\u30bf\u914d\u5e03","text":"<pre><code>;; \u30ea\u30ea\u30fc\u30b9\u30d1\u30c3\u30b1\u30fc\u30b8\u4f5c\u6210\n(defn package-release [version files]\n  (let [release-name f\"release-v{version}.zip\"]\n    (zip/create release-name ..files)\n    (println f\"Release package: {release-name}\")\n    release-name))\n\n;; \u914d\u5e03\u7528\u306b\u8907\u6570\u5f62\u5f0f\u3092\u4f5c\u6210\n(defn create-distributions [version]\n  {:zip (zip/create f\"dist-{version}.zip\" \"dist/\")\n   :tar-gz (do\n             (zip/create f\"dist-{version}.tar\" \"dist/\")\n             (zip/gzip f\"dist-{version}.tar\"))})\n</code></pre>"},{"location":"ja/spec/32-stdlib-zip/#_27","title":"\u30ed\u30b0\u7ba1\u7406","text":"<pre><code>;; \u65e5\u6b21\u30ed\u30b0\u30a2\u30fc\u30ab\u30a4\u30d6\n(defn archive-daily-logs []\n  (let [yesterday (time/format (- (time/now) 86400) \"%Y-%m-%d\")\n        log-files (io/list-dir \"logs\" :pattern f\"*{yesterday}*.log\")]\n    (when (not (empty? log-files))\n      (let [archive f\"logs-{yesterday}.zip\"]\n        (zip/create archive ..log-files)\n        ;; \u5143\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n        (log-files |&gt; (map io/delete-file))\n        archive))))\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08cmd/\uff09","text":"<p>\u5916\u90e8\u30b3\u30de\u30f3\u30c9\u3068\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>cmd/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/spec/33-stdlib-cmd/#_1","title":"\u6982\u8981","text":"<p>cmd\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u3001Qi\u8a00\u8a9e\u304b\u3089\u5916\u90e8\u30b3\u30de\u30f3\u30c9\u3084\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306e\u95a2\u6570\u7fa4\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\uff08<code>|&gt;</code>\uff09\u3068\u7d71\u5408\u3055\u308c\u3066\u304a\u308a\u3001\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3068\u3057\u3066\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3092\u6271\u3048\u307e\u3059\u3002</p> <p>\u4e3b\u306a\u6a5f\u80fd: - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u3068\u7d42\u4e86\u30b3\u30fc\u30c9\u53d6\u5f97 - \u6a19\u6e96\u5165\u51fa\u529b\u5236\u5fa1 - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408\uff08Qi \u2192 \u30b3\u30de\u30f3\u30c9 \u2192 Qi\uff09 - \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\uff08\u884c\u5358\u4f4d\u30fb\u30d0\u30a4\u30c8\u5358\u4f4d\uff09 - \u53cc\u65b9\u5411\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30d7\u30ed\u30bb\u30b9</p> <p>\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5bfe\u5fdc: - Unix/Linux/macOS: <code>/bin/sh</code> \u7d4c\u7531\u3067\u30b7\u30a7\u30eb\u30b3\u30de\u30f3\u30c9\u5b9f\u884c - Windows: <code>cmd.exe</code> \u7d4c\u7531\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c</p> <p>\u6ce8\u610f: \u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f <code>cmd-exec</code> feature \u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/spec/33-stdlib-cmd/#_2","title":"\u57fa\u672c\u5b9f\u884c","text":""},{"location":"ja/spec/33-stdlib-cmd/#cmdexec-","title":"cmd/exec - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08\u7d42\u4e86\u30b3\u30fc\u30c9\u3092\u8fd4\u3059\uff09","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\uff08\u6587\u5b57\u5217 or \u30d9\u30af\u30bf\uff09 \u623b\u308a\u5024: \u7d42\u4e86\u30b3\u30fc\u30c9\uff08\u6574\u6570\uff09 \u30a8\u30e9\u30fc: \u30b3\u30de\u30f3\u30c9\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408</p> <pre><code>;; \u30b7\u30a7\u30eb\u7d4c\u7531\uff08\u6587\u5b57\u5217\uff09\n(cmd/exec \"ls -la\")                    ;; =&gt; 0\n(cmd/exec \"false\")                     ;; =&gt; 1\n\n;; \u76f4\u63a5\u5b9f\u884c\uff08\u30d9\u30af\u30bf\uff09\n(cmd/exec [\"ls\" \"-la\"])                ;; =&gt; 0\n(cmd/exec [\"git\" \"status\"])            ;; =&gt; 0\n\n;; \u7d42\u4e86\u30b3\u30fc\u30c9\u3067\u306e\u30a8\u30e9\u30fc\u5224\u5b9a\n(let [code (cmd/exec \"test -f data.txt\")]\n  (if (= code 0)\n    (println \"\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u307e\u3059\")\n    (println \"\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\")))\n</code></pre> <p>\u30b7\u30a7\u30eb vs \u76f4\u63a5\u5b9f\u884c\u306e\u9055\u3044: - \u6587\u5b57\u5217: \u30b7\u30a7\u30eb\u7d4c\u7531\uff08\u30d1\u30a4\u30d7\u3001\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3001\u74b0\u5883\u5909\u6570\u5c55\u958b\u304c\u53ef\u80fd\uff09 - \u30d9\u30af\u30bf: \u76f4\u63a5\u5b9f\u884c\uff08\u30b7\u30a7\u30eb\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56\u3001\u9ad8\u901f\uff09</p>"},{"location":"ja/spec/33-stdlib-cmd/#cmdexec-_1","title":"cmd/exec! - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08\u8a73\u7d30\u7248\uff09","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\uff08\u6587\u5b57\u5217 or \u30d9\u30af\u30bf\uff09 \u623b\u308a\u5024: <code>{:stdout \"...\" :stderr \"...\" :exit 0}</code> \u30de\u30c3\u30d7</p> <pre><code>;; \u30b7\u30a7\u30eb\u7d4c\u7531\u3067\u6a19\u6e96\u51fa\u529b\u30fb\u6a19\u6e96\u30a8\u30e9\u30fc\u30fb\u7d42\u4e86\u30b3\u30fc\u30c9\u3092\u5168\u3066\u53d6\u5f97\n(cmd/exec! \"cat *.txt | grep pattern | wc -l\")\n;; =&gt; {:stdout \"      42\\n\" :stderr \"\" :exit 0}\n\n;; \u76f4\u63a5\u5b9f\u884c\u3067\u3082\u540c\u69d8\n(cmd/exec! [\"ls\" \"-la\"])\n;; =&gt; {:stdout \"total 48\\ndrwxr-xr-x ...\\n\" :stderr \"\" :exit 0}\n\n;; \u30a8\u30e9\u30fc\u6642\u306e\u8a73\u7d30\u60c5\u5831\n(cmd/exec! \"ls non-existent-file\")\n;; =&gt; {:stdout \"\"\n;;     :stderr \"ls: non-existent-file: No such file or directory\\n\"\n;;     :exit 1}\n\n;; \u7d50\u679c\u3092\u5206\u89e3\u3057\u3066\u4f7f\u7528\n(let [result (cmd/exec! \"git status --porcelain\")\n      stdout (get result \"stdout\")\n      exit (get result \"exit\")]\n  (if (= exit 0)\n    (if (str/blank? stdout)\n      (println \"\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u30af\u30ea\u30fc\u30f3\u3067\u3059\")\n      (println f\"\u5909\u66f4\u3042\u308a:\\n{stdout}\"))\n    (println \"git\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u306f\u3042\u308a\u307e\u305b\u3093\")))\n</code></pre> <p>\u3044\u3064\u4f7f\u3046\u304b: - <code>cmd/exec</code> - \u7d42\u4e86\u30b3\u30fc\u30c9\u3060\u3051\u304c\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b7\u30f3\u30d7\u30eb\uff09 - <code>cmd/exec!</code> - \u6a19\u6e96\u51fa\u529b\u3084\u6a19\u6e96\u30a8\u30e9\u30fc\u306e\u5185\u5bb9\u3082\u5fc5\u8981\u306a\u5834\u5408</p>"},{"location":"ja/spec/33-stdlib-cmd/#_3","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408","text":""},{"location":"ja/spec/33-stdlib-cmd/#cmdpipe-","title":"cmd/pipe - \u30b3\u30de\u30f3\u30c9\u306b\u6a19\u6e96\u5165\u529b\u3092\u6e21\u3059","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\u3001[\u5165\u529b\u30c7\u30fc\u30bf\uff08\u6587\u5b57\u5217 or \u30ea\u30b9\u30c8\uff09] \u623b\u308a\u5024: \u6a19\u6e96\u51fa\u529b\uff08\u6587\u5b57\u5217\uff09 \u30a8\u30e9\u30fc: \u7d42\u4e86\u30b3\u30fc\u30c9\u304c0\u4ee5\u5916\u306e\u5834\u5408</p> <pre><code>;; \u30b3\u30de\u30f3\u30c9\u5358\u72ec\u5b9f\u884c\n(cmd/pipe \"ls -la\")\n;; =&gt; \"total 48\\ndrwxr-xr-x  5 user  staff  160 Jan  1 12:00 .\\n...\"\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u5165\u529b\u3092\u6e21\u3059\n(\"hello\\nworld\\n\" |&gt; (cmd/pipe \"sort\"))\n;; =&gt; \"hello\\nworld\\n\"\n\n;; \u30ea\u30b9\u30c8\u3092\u6e21\u3059\uff08\u5404\u8981\u7d20\u304c\u884c\u306b\u306a\u308b\uff09\n([\"line1\" \"line2\" \"line3\"] |&gt; (cmd/pipe \"wc -l\"))\n;; =&gt; \"       3\\n\"\n\n;; \u5b9f\u7528\u4f8b: JSON\u3092jq\u3067\u51e6\u7406\n(http/get \"https://api.example.com/data\")\n  |&gt; (get _ \"body\")\n  |&gt; (cmd/pipe \"jq '.users[] | .name'\")\n  |&gt; str/lines\n  |&gt; (map str/trim)\n;; =&gt; [\"Alice\" \"Bob\" \"Charlie\"]\n\n;; \u5b9f\u7528\u4f8b: \u30c7\u30fc\u30bf\u6574\u5f62\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(io/read-lines \"data.csv\")\n  |&gt; (map (fn [line] (str/split line \",\")))\n  |&gt; (filter (fn [row] (&gt; (len row) 2)))\n  |&gt; (map (fn [row] (join row \"\\t\")))\n  |&gt; (fn [lines] (join lines \"\\n\"))\n  |&gt; (cmd/pipe \"sort -t $'\\t' -k2,2\")\n  |&gt; println\n</code></pre> <p>\u5931\u6557\u6642\u306e\u52d5\u4f5c: <pre><code>;; \u30b3\u30de\u30f3\u30c9\u304c\u5931\u6557\u3059\u308b\u3068\u30a8\u30e9\u30fc\u3092\u6295\u3052\u308b\n(try\n  (cmd/pipe \"grep pattern\" \"no match here\")\n  (catch e\n    (println f\"\u30b3\u30de\u30f3\u30c9\u5931\u6557: {e}\")))\n;; =&gt; \"\u30b3\u30de\u30f3\u30c9\u5931\u6557: Command failed with exit code 1: ...\"\n</code></pre></p>"},{"location":"ja/spec/33-stdlib-cmd/#cmdpipe-_1","title":"cmd/pipe! - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08\u8a73\u7d30\u7248\uff09","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\u3001[\u5165\u529b\u30c7\u30fc\u30bf] \u623b\u308a\u5024: <code>[stdout stderr exitcode]</code> \u30d9\u30af\u30bf</p> <pre><code>;; \u6a19\u6e96\u51fa\u529b\u30fb\u6a19\u6e96\u30a8\u30e9\u30fc\u30fb\u7d42\u4e86\u30b3\u30fc\u30c9\u3092\u5168\u3066\u53d6\u5f97\n(cmd/pipe! \"cat test.txt\")\n;; =&gt; [\"file content\\n\" \"\" 0]\n\n;; \u5206\u5272\u4ee3\u5165\u3067\u4f7f\u7528\n(let [[out err code] (cmd/pipe! \"ls -la\")]\n  (if (= code 0)\n    (println out)\n    (println f\"\u30a8\u30e9\u30fc: {err}\")))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u5165\u529b\u3092\u6e21\u3059\n([\"test\"] |&gt; (cmd/pipe! [\"wc\" \"-l\"]))\n;; =&gt; [\"       1\\n\" \"\" 0]\n\n;; \u5b9f\u7528\u4f8b: \u30d3\u30eb\u30c9\u30c4\u30fc\u30eb\u5b9f\u884c\n(defn build [target]\n  (let [[out err code] (cmd/pipe! f\"cargo build --release --bin {target}\")]\n    (if (= code 0)\n      {:status :ok :output out}\n      {:status :error :message err})))\n\n(build \"qi-lang\")\n;; =&gt; {:status :ok :output \"   Compiling qi-lang v0.1.0\\n...\"}\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#cmdlines-","title":"cmd/lines - \u30c6\u30ad\u30b9\u30c8\u3092\u884c\u306e\u30ea\u30b9\u30c8\u306b\u5206\u5272\uff08\u30d8\u30eb\u30d1\u30fc\uff09","text":"<p>\u5f15\u6570: \u30c6\u30ad\u30b9\u30c8 \u623b\u308a\u5024: \u884c\u306e\u30ea\u30b9\u30c8</p> <pre><code>;; \u30b3\u30de\u30f3\u30c9\u51fa\u529b\u3092\u884c\u306b\u5206\u5272\n(\"a\\nb\\nc\" |&gt; cmd/lines)\n;; =&gt; [\"a\" \"b\" \"c\"]\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u5b9f\u7528\u4f8b\n(cmd/pipe \"ls -1\")\n  |&gt; cmd/lines\n  |&gt; (filter (fn [f] (str/ends-with? f \".qi\")))\n  |&gt; (map (fn [f] (str/replace f \".qi\" \"\")))\n;; =&gt; [\"main\" \"lib\" \"test\"]\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_4","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"ja/spec/33-stdlib-cmd/#cmdstream-lines-","title":"cmd/stream-lines - \u884c\u5358\u4f4d\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\uff08\u6587\u5b57\u5217 or \u30d9\u30af\u30bf\uff09 \u623b\u308a\u5024: Stream\uff08\u5404\u8981\u7d20\u306f\u884c\u6587\u5b57\u5217\uff09</p> <pre><code>;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u3057\u3066\u51e6\u7406\n(def log-stream (cmd/stream-lines \"tail -f /var/log/app.log\"))\n\n;; \u5148\u982d10\u884c\u3092\u53d6\u5f97\n(log-stream |&gt; (stream/take 10) |&gt; realize)\n\n;; \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3057\u306a\u304c\u3089\u51e6\u7406\n(cmd/stream-lines \"cat large.log\")\n  |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n  |&gt; (stream/take 100)\n  |&gt; realize\n  |&gt; (map println)\n\n;; \u5b9f\u7528\u4f8b: \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ed\u30b0\u76e3\u8996\n(defn watch-errors [logfile]\n  (cmd/stream-lines f\"tail -f {logfile}\")\n    |&gt; (stream/filter (fn [line] (str/contains? line \"ERROR\")))\n    |&gt; (stream/map (fn [line]\n         (let [timestamp (time/now)]\n           {:time timestamp :message line})))\n    |&gt; (stream/each send-alert))\n\n(watch-errors \"/var/log/app.log\")\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#cmdstream-bytes-","title":"cmd/stream-bytes - \u30d0\u30a4\u30c8\u5358\u4f4d\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\u3001[\u30c1\u30e3\u30f3\u30af\u30b5\u30a4\u30ba\uff08\u30c7\u30d5\u30a9\u30eb\u30c84096\uff09] \u623b\u308a\u5024: Stream\uff08\u5404\u8981\u7d20\u306fBase64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30d0\u30a4\u30c8\u5217\uff09</p> <pre><code>;; \u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u30c1\u30e3\u30f3\u30af\u5358\u4f4d\u3067\u51e6\u7406\n(cmd/stream-bytes \"cat large-file.bin\")\n  |&gt; (stream/take 10)  ;; \u6700\u521d\u306e10\u30c1\u30e3\u30f3\u30af\uff0840KB\uff09\n  |&gt; realize\n\n;; \u30ab\u30b9\u30bf\u30e0\u30c1\u30e3\u30f3\u30af\u30b5\u30a4\u30ba\uff088KB\uff09\n(cmd/stream-bytes \"curl -L https://example.com/video.mp4\" 8192)\n  |&gt; (stream/each process-chunk)\n\n;; \u5b9f\u7528\u4f8b: \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u9032\u6357\u8868\u793a\n(defn download-with-progress [url output]\n  (let [total (atom 0)]\n    (cmd/stream-bytes f\"curl -L {url}\" 4096)\n      |&gt; (stream/each (fn [chunk]\n           (let [size (len chunk)]\n             (swap! total (fn [t] (+ t size)))\n             (println f\"Downloaded: {@total} bytes\"))))\n      |&gt; (stream/reduce str/concat \"\")\n      |&gt; (fn [data] (io/write-file data output))))\n\n(download-with-progress \"https://example.com/file.zip\" \"/tmp/download.zip\")\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_5","title":"\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30d7\u30ed\u30bb\u30b9","text":""},{"location":"ja/spec/33-stdlib-cmd/#cmdinteractive-","title":"cmd/interactive - \u53cc\u65b9\u5411\u30d7\u30ed\u30bb\u30b9\u8d77\u52d5","text":"<p>\u5f15\u6570: \u30b3\u30de\u30f3\u30c9\uff08\u6587\u5b57\u5217 or \u30d9\u30af\u30bf\uff09 \u623b\u308a\u5024: \u30d7\u30ed\u30bb\u30b9\u30cf\u30f3\u30c9\u30eb\uff08Map\u5f62\u5f0f\uff09</p> <pre><code>;; Python\u30a4\u30f3\u30bf\u30d7\u30ea\u30bf\u3092\u8d77\u52d5\n(def py (cmd/interactive \"python3 -i\"))\n\n;; \u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\n(cmd/write py \"print(1+1)\\n\")\n\n;; \u7d50\u679c\u3092\u8aad\u307f\u53d6\u308a\n(cmd/read-line py)  ;; =&gt; \"2\"\n\n;; \u30d7\u30ed\u30bb\u30b9\u3092\u7d42\u4e86\n(cmd/write py \"exit()\\n\")\n(cmd/wait py)       ;; =&gt; {:exit 0 :stderr \"\"}\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#cmdwrite-","title":"cmd/write - \u30d7\u30ed\u30bb\u30b9\u306b\u66f8\u304d\u8fbc\u307f","text":"<p>\u5f15\u6570: \u30d7\u30ed\u30bb\u30b9\u30cf\u30f3\u30c9\u30eb\u3001\u30c7\u30fc\u30bf\uff08\u6587\u5b57\u5217\uff09 \u623b\u308a\u5024: nil</p> <pre><code>;; REPL\u306b\u8907\u6570\u884c\u9001\u4fe1\n(cmd/write py \"def greet(name):\\n\")\n(cmd/write py \"    return f'Hello, {name}!'\\n\")\n(cmd/write py \"\\n\")\n(cmd/write py \"print(greet('Qi'))\\n\")\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#cmdread-line-1","title":"cmd/read-line - \u30d7\u30ed\u30bb\u30b9\u304b\u30891\u884c\u8aad\u307f\u53d6\u308a","text":"<p>\u5f15\u6570: \u30d7\u30ed\u30bb\u30b9\u30cf\u30f3\u30c9\u30eb \u623b\u308a\u5024: \u8aad\u307f\u53d6\u3063\u305f\u884c\uff08\u6587\u5b57\u5217\uff09\u3001EOF\u306a\u3089<code>nil</code></p> <pre><code>;; \u7d50\u679c\u3092\u8aad\u307f\u53d6\u308a\n(cmd/read-line py)  ;; =&gt; \"Hello, Qi!\"\n\n;; \u5168\u3066\u306e\u51fa\u529b\u3092\u8aad\u307f\u53d6\u308a\n(defn read-all [proc]\n  (loop [lines []]\n    (let [line (cmd/read-line proc)]\n      (if (some? line)\n        (recur (conj lines line))\n        lines))))\n\n(read-all py)  ;; =&gt; [\"line1\" \"line2\" \"line3\"]\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#cmdwait-","title":"cmd/wait - \u30d7\u30ed\u30bb\u30b9\u7d42\u4e86\u3092\u5f85\u3064","text":"<p>\u5f15\u6570: \u30d7\u30ed\u30bb\u30b9\u30cf\u30f3\u30c9\u30eb \u623b\u308a\u5024: <code>{:exit exit_code :stderr \"...\"}</code></p> <pre><code>;; \u30d7\u30ed\u30bb\u30b9\u3092\u7d42\u4e86\u3057\u3066\u7d50\u679c\u3092\u53d6\u5f97\n(cmd/write py \"exit()\\n\")\n(cmd/wait py)\n;; =&gt; {:exit 0 :stderr \"\"}\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_6","title":"\u5b9f\u7528\u4f8b: \u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30b7\u30a7\u30eb","text":"<pre><code>(defn run-script [script-lines]\n  (let [proc (cmd/interactive \"python3 -i\")]\n    ;; \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\n    (script-lines\n     |&gt; (map (fn [line] (cmd/write proc (str line \"\\n\"))))\n     |&gt; realize)\n\n    ;; \u7d50\u679c\u3092\u53ce\u96c6\n    (let [results (loop [acc []]\n                    (let [line (cmd/read-line proc)]\n                      (if (some? line)\n                        (recur (conj acc line))\n                        acc)))]\n      ;; \u30d7\u30ed\u30bb\u30b9\u7d42\u4e86\n      (cmd/write proc \"exit()\\n\")\n      (cmd/wait proc)\n      results)))\n\n(run-script [\"print(1+1)\" \"print('hello')\" \"print(2*3)\"])\n;; =&gt; [\"2\" \"hello\" \"6\"]\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_7","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/33-stdlib-cmd/#_8","title":"\u30d3\u30eb\u30c9\u30c4\u30fc\u30eb\u7d71\u5408","text":"<pre><code>;; Cargo\u30d3\u30eb\u30c9\u5b9f\u884c\n(defn cargo-build [target]\n  (let [[out err code] (cmd/pipe! f\"cargo build --release --bin {target}\")]\n    (if (= code 0)\n      (do\n        (println \"\u30d3\u30eb\u30c9\u6210\u529f!\")\n        (println out)\n        :ok)\n      (do\n        (println \"\u30d3\u30eb\u30c9\u5931\u6557:\")\n        (println err)\n        :error))))\n\n(cargo-build \"qi-lang\")\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#git","title":"Git\u64cd\u4f5c","text":"<pre><code>;; Git\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n(defn git-status []\n  (let [result (cmd/exec! \"git status --porcelain\")]\n    (if (= (get result \"exit\") 0)\n      (let [stdout (get result \"stdout\")]\n        (if (str/blank? stdout)\n          {:clean true :files []}\n          {:clean false :files (str/lines stdout)}))\n      {:error (get result \"stderr\")})))\n\n(git-status)\n;; =&gt; {:clean false :files [\"M src/main.rs\" \"?? new-file.txt\"]}\n\n;; Git\u5909\u66f4\u3092\u30b3\u30df\u30c3\u30c8\n(defn git-commit [message]\n  (do\n    (cmd/exec \"git add .\")\n    (let [code (cmd/exec f\"git commit -m '{message}'\")]\n      (if (= code 0)\n        (println \"\u30b3\u30df\u30c3\u30c8\u6210\u529f!\")\n        (println \"\u30b3\u30df\u30c3\u30c8\u5931\u6557\uff08\u5909\u66f4\u306a\u3057\uff1f\uff09\")))))\n\n(git-commit \"feat: Add new feature\")\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_9","title":"\u30c7\u30fc\u30bf\u51e6\u7406\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; CSV\u3092SQLite\u3067\u51e6\u7406\n(defn process-csv-with-sqlite [csv-file query]\n  (let [db \"/tmp/temp.db\"]\n    ;; CSV\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n    (cmd/exec f\"sqlite3 {db} '.mode csv' '.import {csv-file} data'\")\n\n    ;; SQL\u30af\u30a8\u30ea\u5b9f\u884c\n    (cmd/pipe f\"sqlite3 -csv {db} \\\"{query}\\\"\")\n      |&gt; str/lines\n      |&gt; (map (fn [line] (str/split line \",\")))\n      |&gt; (map (fn [row] (zipmap [\"id\" \"name\" \"value\"] row)))))\n\n(process-csv-with-sqlite \"data.csv\" \"SELECT * FROM data WHERE value &gt; 100\")\n;; =&gt; [{:id \"1\" :name \"Alice\" :value \"120\"} ...]\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_10","title":"\u30b7\u30b9\u30c6\u30e0\u76e3\u8996","text":"<pre><code>;; \u30c7\u30a3\u30b9\u30af\u4f7f\u7528\u91cf\u76e3\u8996\n(defn check-disk-usage []\n  (cmd/pipe \"df -h /\")\n    |&gt; str/lines\n    |&gt; (drop 1)  ;; \u30d8\u30c3\u30c0\u30fc\u3092\u30b9\u30ad\u30c3\u30d7\n    |&gt; first\n    |&gt; (str/split _ \" \")\n    |&gt; (filter (fn [s] (not (str/blank? s))))\n    |&gt; (fn [cols] {:filesystem (nth cols 0)\n                   :size (nth cols 1)\n                   :used (nth cols 2)\n                   :avail (nth cols 3)\n                   :percent (nth cols 4)}))\n\n(check-disk-usage)\n;; =&gt; {:filesystem \"/dev/disk1s1\" :size \"931Gi\" :used \"450Gi\"\n;;     :avail \"481Gi\" :percent \"49%\"}\n\n;; CPU\u4f7f\u7528\u7387\u76e3\u8996\n(defn watch-cpu []\n  (cmd/stream-lines \"top -l 0 -s 1\")\n    |&gt; (stream/filter (fn [line] (str/contains? line \"CPU usage\")))\n    |&gt; (stream/map (fn [line]\n         (let [parts (str/split line \" \")]\n           {:user (nth parts 2) :sys (nth parts 4)})))\n    |&gt; (stream/take 10)\n    |&gt; realize)\n\n(watch-cpu)\n;; =&gt; [{:user \"15.5%\" :sys \"8.2%\"} {:user \"12.3%\" :sys \"6.1%\"} ...]\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_11","title":"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c","text":"<pre><code>;; \u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u8a08\n(defn run-tests []\n  (let [[out err code] (cmd/pipe! \"cargo test -- --nocapture\")]\n    {:passed (str/contains? out \"test result: ok\")\n     :output out\n     :errors err\n     :exit-code code}))\n\n(run-tests)\n;; =&gt; {:passed true :output \"running 15 tests\\n...\" :errors \"\" :exit-code 0}\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_12","title":"\u30de\u30eb\u30c1\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u30b3\u30de\u30f3\u30c9","text":"<pre><code>;; OS\u306b\u5fdc\u3058\u305f\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n(defn list-processes []\n  (if (= (os/platform) \"windows\")\n    (cmd/pipe \"tasklist\")\n    (cmd/pipe \"ps aux\"))\n  |&gt; str/lines)\n\n(list-processes)\n;; Unix: =&gt; [\"USER       PID %CPU %MEM ...\" \"root         1  0.0  0.1 ...\" ...]\n;; Windows: =&gt; [\"Image Name           PID Session Name ...\" \"System Idle Process   0 ...\" ...]\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_13","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"ja/spec/33-stdlib-cmd/#_14","title":"\u30b3\u30de\u30f3\u30c9\u5931\u6557\u306e\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>;; try-catch\u3067\u30a8\u30e9\u30fc\u3092\u6355\u6349\n(try\n  (cmd/pipe \"grep pattern file.txt\")\n  (catch e\n    (println f\"\u691c\u7d22\u5931\u6557: {e}\")\n    nil))\n\n;; pipe!\u3067\u7d42\u4e86\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\n(let [[out err code] (cmd/pipe! \"test -f data.txt\")]\n  (if (= code 0)\n    (println \"\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u307e\u3059\")\n    (println \"\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\")))\n\n;; exec!\u3067\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\n(let [result (cmd/exec! \"ls non-existent\")]\n  (if (= (get result \"exit\") 0)\n    (get result \"stdout\")\n    (do\n      (println f\"\u30a8\u30e9\u30fc: {(get result 'stderr')}\")\n      nil)))\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_15","title":"\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u51e6\u7406","text":"<pre><code>;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c\uff08\u5916\u90e8\u30b3\u30de\u30f3\u30c9\u5229\u7528\uff09\n(defn exec-with-timeout [cmd timeout-sec]\n  (let [timeout-cmd (if (= (os/platform) \"windows\")\n                       f\"timeout /t {timeout-sec} &amp;&amp; {cmd}\"\n                       f\"timeout {timeout-sec} {cmd}\")]\n    (cmd/exec! timeout-cmd)))\n\n(exec-with-timeout \"sleep 10\" 5)\n;; =&gt; {:stdout \"\" :stderr \"timeout: killed\" :exit 124}\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_16","title":"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\u4e8b\u9805","text":""},{"location":"ja/spec/33-stdlib-cmd/#_17","title":"\u30b3\u30de\u30f3\u30c9\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u5bfe\u7b56","text":"<pre><code>;; \u274c \u5371\u967a: \u30e6\u30fc\u30b6\u30fc\u5165\u529b\u3092\u76f4\u63a5\u30b7\u30a7\u30eb\u306b\u6e21\u3059\n(defn bad-search [pattern file]\n  (cmd/pipe f\"grep {pattern} {file}\"))  ;; \u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u53ef\u80fd!\n\n(bad-search \"test; rm -rf /\" \"data.txt\")  ;; \u5371\u967a!\n\n;; \u2705 \u5b89\u5168: \u30d9\u30af\u30bf\u3067\u6e21\u3059\uff08\u30b7\u30a7\u30eb\u7d4c\u7531\u3057\u306a\u3044\uff09\n(defn safe-search [pattern file]\n  (cmd/pipe [\"grep\" pattern file]))\n\n(safe-search \"test; rm -rf /\" \"data.txt\")  ;; \u5b89\u5168\uff08\u30ea\u30c6\u30e9\u30eb\u6587\u5b57\u5217\u3068\u3057\u3066\u6271\u308f\u308c\u308b\uff09\n\n;; \u2705 \u5b89\u5168: \u30a8\u30b9\u30b1\u30fc\u30d7\u51e6\u7406\n(defn escape-shell-arg [s]\n  (str \"'\" (str/replace s \"'\" \"'\\\\''\") \"'\"))\n\n(defn safe-search-shell [pattern file]\n  (cmd/pipe f\"grep {(escape-shell-arg pattern)} {(escape-shell-arg file)}\"))\n\n(safe-search-shell \"test; rm -rf /\" \"data.txt\")  ;; \u5b89\u5168\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_18","title":"\u30d1\u30b9\u691c\u8a3c","text":"<pre><code>;; \u274c \u5371\u967a: \u30d1\u30b9\u30c8\u30e9\u30d0\u30fc\u30b5\u30eb\u653b\u6483\n(defn bad-read-file [filename]\n  (cmd/pipe f\"cat {filename}\"))\n\n(bad-read-file \"../../../etc/passwd\")  ;; \u5371\u967a!\n\n;; \u2705 \u5b89\u5168: \u30d1\u30b9\u691c\u8a3c\n(defn safe-read-file [filename base-dir]\n  (let [fullpath (path/join base-dir filename)\n        canonical (path/canonicalize fullpath)]\n    (if (str/starts-with? canonical base-dir)\n      (cmd/pipe [\"cat\" canonical])\n      (throw \"Invalid path\"))))\n\n(safe-read-file \"../../../etc/passwd\" \"/var/data\")  ;; \u30a8\u30e9\u30fc\n(safe-read-file \"file.txt\" \"/var/data\")  ;; OK\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_19","title":"\u6a29\u9650\u7ba1\u7406","text":"<pre><code>;; \u2705 \u6700\u5c0f\u6a29\u9650\u3067\u5b9f\u884c\n(defn run-sandboxed [cmd]\n  ;; \u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3067\u5b9f\u884c\uff08sudo\u3092\u4f7f\u308f\u306a\u3044\uff09\n  (cmd/exec cmd))\n\n;; \u274c \u5371\u967a: sudo/\u7ba1\u7406\u8005\u6a29\u9650\u3067\u306e\u5b9f\u884c\u306f\u907f\u3051\u308b\n;; (cmd/exec \"sudo rm -rf /\")  ;; \u7d76\u5bfe\u306b\u3084\u3089\u306a\u3044!\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_20","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/33-stdlib-cmd/#_21","title":"\u57fa\u672c\u5b9f\u884c","text":"<ul> <li><code>cmd/exec</code> - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08\u7d42\u4e86\u30b3\u30fc\u30c9\u3092\u8fd4\u3059\uff09</li> <li><code>cmd/exec!</code> - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08\u8a73\u7d30\u7248\u3001stdout/stderr/exit\uff09</li> </ul>"},{"location":"ja/spec/33-stdlib-cmd/#_22","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408","text":"<ul> <li><code>cmd/pipe</code> - \u30b3\u30de\u30f3\u30c9\u306b\u6a19\u6e96\u5165\u529b\u3092\u6e21\u3059\uff08stdout\u3092\u8fd4\u3059\uff09</li> <li><code>cmd/pipe!</code> - \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\uff08[stdout stderr exit]\u3092\u8fd4\u3059\uff09</li> <li><code>cmd/lines</code> - \u30c6\u30ad\u30b9\u30c8\u3092\u884c\u306e\u30ea\u30b9\u30c8\u306b\u5206\u5272</li> </ul>"},{"location":"ja/spec/33-stdlib-cmd/#_23","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":"<ul> <li><code>cmd/stream-lines</code> - \u30b3\u30de\u30f3\u30c9\u306estdout\u3092\u884c\u5358\u4f4d\u3067\u30b9\u30c8\u30ea\u30fc\u30e0\u5316</li> <li><code>cmd/stream-bytes</code> - \u30b3\u30de\u30f3\u30c9\u306estdout\u3092\u30d0\u30a4\u30c8\u5358\u4f4d\u3067\u30b9\u30c8\u30ea\u30fc\u30e0\u5316</li> </ul>"},{"location":"ja/spec/33-stdlib-cmd/#_24","title":"\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30d7\u30ed\u30bb\u30b9","text":"<ul> <li><code>cmd/interactive</code> - \u53cc\u65b9\u5411\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5</li> <li><code>cmd/write</code> - \u30d7\u30ed\u30bb\u30b9\u306estdin\u306b\u66f8\u304d\u8fbc\u307f</li> <li><code>cmd/read-line</code> - \u30d7\u30ed\u30bb\u30b9\u306estdout\u304b\u30891\u884c\u8aad\u307f\u53d6\u308a</li> <li><code>cmd/wait</code> - \u30d7\u30ed\u30bb\u30b9\u7d42\u4e86\u3092\u5f85\u3064</li> </ul>"},{"location":"ja/spec/33-stdlib-cmd/#_25","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316","text":""},{"location":"ja/spec/33-stdlib-cmd/#_26","title":"\u5927\u91cf\u306e\u30b3\u30de\u30f3\u30c9\u5b9f\u884c","text":"<pre><code>;; \u274c \u9045\u3044: \u30b7\u30a7\u30eb\u7d4c\u7531\u3067\u6bce\u56de\u5b9f\u884c\n(files |&gt; (map (fn [f] (cmd/exec f\"wc -l {f}\"))))\n\n;; \u2705 \u901f\u3044: 1\u3064\u306e\u30b3\u30de\u30f3\u30c9\u306b\u307e\u3068\u3081\u308b\n(files |&gt; (fn [fs] (join fs \" \")) |&gt; (cmd/pipe \"wc -l\"))\n\n;; \u2705 \u901f\u3044: \u4e26\u5217\u5b9f\u884c\n(files |&gt; (pmap (fn [f] (cmd/exec [\"wc\" \"-l\" f]))))\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_27","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u3067\u306e\u30e1\u30e2\u30ea\u52b9\u7387\u5316","text":"<pre><code>;; \u274c \u30e1\u30e2\u30ea\u975e\u52b9\u7387: \u5168\u30c7\u30fc\u30bf\u3092\u4e00\u5ea6\u306b\u8aad\u307f\u8fbc\u307f\n(cmd/pipe \"cat large-file.txt\")\n  |&gt; str/lines\n  |&gt; (map process-line)\n\n;; \u2705 \u30e1\u30e2\u30ea\u52b9\u7387\u7684: \u30b9\u30c8\u30ea\u30fc\u30e0\u3067\u51e6\u7406\n(cmd/stream-lines \"cat large-file.txt\")\n  |&gt; (stream/map process-line)\n  |&gt; (stream/take 1000)\n  |&gt; realize\n</code></pre>"},{"location":"ja/spec/33-stdlib-cmd/#_28","title":"\u30c7\u30d0\u30c3\u30b0","text":"<pre><code>;; \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u306e\u30c8\u30ec\u30fc\u30b9\n(defn trace-cmd [cmd]\n  (do\n    (println f\"\u5b9f\u884c: {cmd}\")\n    (let [[out err code] (cmd/pipe! cmd)]\n      (println f\"\u7d42\u4e86\u30b3\u30fc\u30c9: {code}\")\n      (println f\"stdout: {out}\")\n      (println f\"stderr: {err}\")\n      [out err code])))\n\n(trace-cmd \"ls -la\")\n\n;; \u74b0\u5883\u5909\u6570\u306e\u78ba\u8a8d\n(cmd/pipe \"env\")\n  |&gt; str/lines\n  |&gt; (filter (fn [line] (str/starts-with? line \"PATH=\")))\n  |&gt; (map println)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30ea\u30b9\u30c8\u62e1\u5f35\u64cd\u4f5c\uff08list/\uff09","text":"<p>18\u500b\u306e\u30ea\u30b9\u30c8\u62e1\u5f35\u95a2\u6570</p> <p>\u30ea\u30b9\u30c8\u3068\u30d9\u30af\u30bf\u30fc\u306b\u5bfe\u3059\u308b\u9ad8\u5ea6\u306a\u64cd\u4f5c\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u57fa\u672c\u7684\u306a\u64cd\u4f5c\uff08map\u3001filter\u3001reduce\u7b49\uff09\u306fCore\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002</p> <p>\u5b9f\u88c5: <code>src/builtins/list.rs</code></p> <p>\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8: 06-data-structures.md - \u57fa\u672c\u7684\u306a\u30ea\u30b9\u30c8\u64cd\u4f5c</p>"},{"location":"ja/spec/34-stdlib-list/#_1","title":"\u6982\u8981","text":"<p><code>list/</code>\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u3001Core\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u57fa\u672c\u7684\u306a\u30ea\u30b9\u30c8\u64cd\u4f5c\uff08map\u3001filter\u3001reduce\u7b49\uff09\u3092\u88dc\u5b8c\u3059\u308b\u9ad8\u5ea6\u306a\u95a2\u6570\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <p>Core\u3068\u306e\u9055\u3044: - Core: \u57fa\u672c\u64cd\u4f5c\uff08map\u3001filter\u3001reduce\u3001take\u3001drop\u7b49\uff09 - \u30b0\u30ed\u30fc\u30d0\u30eb\u540d\u524d\u7a7a\u9593 - list/: \u62e1\u5f35\u64cd\u4f5c\uff08\u30b0\u30eb\u30fc\u30d7\u5316\u3001\u691c\u7d22\u3001\u5909\u63db\u3001\u8ff0\u8a9e\u7b49\uff09 - <code>list/</code>\u30d7\u30ec\u30d5\u30a3\u30c3\u30af\u30b9\u304c\u5fc5\u8981</p>"},{"location":"ja/spec/34-stdlib-list/#_2","title":"\u6761\u4ef6\u4ed8\u304d\u53d6\u5f97\u30fb\u524a\u9664","text":""},{"location":"ja/spec/34-stdlib-list/#take-while-","title":"take-while - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u8981\u7d20\u3092\u53d6\u5f97","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(take-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])\n;; =&gt; (1 2 3)\n\n;; \u7a7a\u767d\u884c\u307e\u3067\u53d6\u5f97\n(def lines [\"Line 1\" \"Line 2\" \"\" \"Line 3\"])\n(take-while (fn [s] (not (str/blank? s))) lines)\n;; =&gt; (\"Line 1\" \"Line 2\")\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 6 7 4] |&gt; (take-while (fn [x] (&lt; x 5))))\n;; =&gt; (1 2 3)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#drop-while-","title":"drop-while - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u8981\u7d20\u3092\u30b9\u30ad\u30c3\u30d7","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(drop-while (fn [x] (&lt; x 5)) [1 2 3 6 7 4])\n;; =&gt; (6 7 4)\n\n;; \u30d8\u30c3\u30c0\u30fc\u884c\u3092\u30b9\u30ad\u30c3\u30d7\n(def lines [\"# Header\" \"---\" \"Content 1\" \"Content 2\"])\n(drop-while (fn [s] (str/starts-with? s \"#\")) lines)\n;; =&gt; (\"---\" \"Content 1\" \"Content 2\")\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 6 7 4] |&gt; (drop-while (fn [x] (&lt; x 5))))\n;; =&gt; (6 7 4)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_3","title":"\u5206\u5272\u30fb\u7d50\u5408","text":""},{"location":"ja/spec/34-stdlib-list/#listsplit-at-","title":"list/split-at - \u6307\u5b9a\u4f4d\u7f6e\u3067\u30ea\u30b9\u30c8\u3092\u5206\u5272","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/split-at 2 [1 2 3 4 5])\n;; =&gt; [(1 2) (3 4 5)]\n\n;; \u5148\u982d3\u500b\u3068\u6b8b\u308a\u306b\u5206\u5272\n(list/split-at 3 [\"a\" \"b\" \"c\" \"d\" \"e\"])\n;; =&gt; [(\"a\" \"b\" \"c\") (\"d\" \"e\")]\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4 5] |&gt; (list/split-at 2))\n;; =&gt; [(1 2) (3 4 5)]\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listchunk-","title":"list/chunk - \u56fa\u5b9a\u30b5\u30a4\u30ba\u3067\u5206\u5272","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/chunk 2 [1 2 3 4 5 6])\n;; =&gt; ((1 2) (3 4) (5 6))\n\n;; 3\u500b\u305a\u3064\u5206\u5272\n(list/chunk 3 [1 2 3 4 5 6 7 8])\n;; =&gt; ((1 2 3) (4 5 6) (7 8))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4 5 6] |&gt; (list/chunk 2))\n;; =&gt; ((1 2) (3 4) (5 6))\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listinterleave-2","title":"list/interleave - 2\u3064\u306e\u30ea\u30b9\u30c8\u3092\u4ea4\u4e92\u306b\u7d50\u5408","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/interleave [1 2 3] [4 5 6])\n;; =&gt; (1 4 2 5 3 6)\n\n;; \u77ed\u3044\u65b9\u306b\u5408\u308f\u305b\u3066\u7d50\u5408\n(list/interleave [1 2] [4 5 6 7])\n;; =&gt; (1 4 2 5)\n\n;; \u30ad\u30fc\u3068\u5024\u3092\u4ea4\u4e92\u306b\u914d\u7f6e\n(list/interleave [:a :b :c] [1 2 3])\n;; =&gt; (:a 1 :b 2 :c 3)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listzipmap-2","title":"list/zipmap - 2\u3064\u306e\u30ea\u30b9\u30c8\u304b\u3089\u30de\u30c3\u30d7\u3092\u751f\u6210","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/zipmap [:a :b :c] [1 2 3])\n;; =&gt; {:a 1, :b 2, :c 3}\n\n;; \u30ad\u30fc\u3068\u5024\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30de\u30c3\u30d7\u751f\u6210\n(def keys [:name :age :email])\n(def values [\"Alice\" 30 \"alice@example.com\"])\n(list/zipmap keys values)\n;; =&gt; {:name \"Alice\", :age 30, :email \"alice@example.com\"}\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_4","title":"\u53d6\u5f97\u30fb\u9078\u629e","text":""},{"location":"ja/spec/34-stdlib-list/#listtake-nth-n","title":"list/take-nth - n\u756a\u76ee\u3054\u3068\u306b\u53d6\u5f97","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/take-nth 2 [1 2 3 4 5 6])\n;; =&gt; (1 3 5)\n\n;; 3\u500b\u304a\u304d\u306b\u53d6\u5f97\n(list/take-nth 3 [0 1 2 3 4 5 6 7 8 9])\n;; =&gt; (0 3 6 9)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4 5 6] |&gt; (list/take-nth 2))\n;; =&gt; (1 3 5)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listdrop-last-n","title":"list/drop-last - \u672b\u5c3en\u500b\u3092\u524a\u9664","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/drop-last 2 [1 2 3 4 5])\n;; =&gt; (1 2 3)\n\n;; \u672b\u5c3e1\u500b\u3092\u524a\u9664\n(list/drop-last 1 [1 2 3])\n;; =&gt; (1 2)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4 5] |&gt; (list/drop-last 2))\n;; =&gt; (1 2 3)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_5","title":"\u691c\u7d22\u30fb\u63a2\u7d22","text":""},{"location":"ja/spec/34-stdlib-list/#find-","title":"find - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u6700\u521d\u306e\u8981\u7d20","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(find (fn [x] (&gt; x 5)) [1 7 3])\n;; =&gt; 7\n\n;; \u5076\u6570\u3092\u691c\u7d22\n(find even? [1 3 4 5])\n;; =&gt; 4\n\n;; \u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408\u306fnil\n(find (fn [x] (&gt; x 10)) [1 2 3])\n;; =&gt; nil\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 7 3] |&gt; (find (fn [x] (&gt; x 5))))\n;; =&gt; 7\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listfind-index-","title":"list/find-index - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u6700\u521d\u306e\u8981\u7d20\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/find-index (fn [x] (&gt; x 5)) [1 7 3])\n;; =&gt; 1\n\n;; \u5076\u6570\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u691c\u7d22\n(list/find-index even? [1 3 4 5])\n;; =&gt; 2\n\n;; \u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408\u306fnil\n(list/find-index (fn [x] (&gt; x 10)) [1 2 3])\n;; =&gt; nil\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_6","title":"\u8ff0\u8a9e\uff08\u5168\u4f53\u30c1\u30a7\u30c3\u30af\uff09","text":""},{"location":"ja/spec/34-stdlib-list/#listevery-","title":"list/every? - \u3059\u3079\u3066\u306e\u8981\u7d20\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/every? (fn [x] (&gt; x 0)) [1 2 3])\n;; =&gt; true\n\n;; \u3059\u3079\u3066\u5076\u6570\u304b\u30c1\u30a7\u30c3\u30af\n(list/every? even? [2 4 6])\n;; =&gt; true\n\n;; 1\u3064\u3067\u3082\u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\n(list/every? even? [2 4 5])\n;; =&gt; false\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3] |&gt; (list/every? (fn [x] (&gt; x 0))))\n;; =&gt; true\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listsome-","title":"list/some? - \u3044\u305a\u308c\u304b\u306e\u8981\u7d20\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/some? (fn [x] (&gt; x 5)) [1 7 3])\n;; =&gt; true\n\n;; \u3044\u305a\u308c\u304b\u5076\u6570\u304c\u3042\u308b\u304b\u30c1\u30a7\u30c3\u30af\n(list/some? even? [1 3 5])\n;; =&gt; false\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 7 3] |&gt; (list/some? (fn [x] (&gt; x 5))))\n;; =&gt; true\n</code></pre> <p>\u6ce8: <code>some?</code>\uff081\u5f15\u6570\uff09\u306fCore\u8ff0\u8a9e\u95a2\u6570\u3068\u3057\u3066\u3001nil\u3067\u306a\u3044\u304b\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u8ff0\u8a9e\u3067\u3059\u3002<code>list/some?</code>\u306f2\u5f15\u6570\u3067\u3001\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5bfe\u3059\u308b\u8ff0\u8a9e\u30c1\u30a7\u30c3\u30af\u3067\u3059\u3002</p>"},{"location":"ja/spec/34-stdlib-list/#_7","title":"\u30bd\u30fc\u30c8\u30fb\u96c6\u7d04","text":""},{"location":"ja/spec/34-stdlib-list/#listsort-by-","title":"list/sort-by - \u30ad\u30fc\u95a2\u6570\u3067\u30bd\u30fc\u30c8","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/sort-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; ({:name \"Bob\" :age 25} {:name \"Alice\" :age 30})\n\n;; \u6587\u5b57\u5217\u9577\u3067\u30bd\u30fc\u30c8\n(list/sort-by len [\"zzz\" \"a\" \"bb\"])\n;; =&gt; (\"a\" \"bb\" \"zzz\")\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}]\n |&gt; (list/sort-by (fn [u] (get u :age))))\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listmax-by-","title":"list/max-by - \u30ad\u30fc\u95a2\u6570\u3067\u6700\u5927\u5024\u3092\u53d6\u5f97","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/max-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; {:name \"Alice\" :age 30}\n\n;; \u6587\u5b57\u5217\u9577\u304c\u6700\u5927\u306e\u3082\u306e\u3092\u53d6\u5f97\n(list/max-by len [\"a\" \"bbb\" \"cc\"])\n;; =&gt; \"bbb\"\n\n;; \u7a7a\u30ea\u30b9\u30c8\u306e\u5834\u5408\u306fnil\n(list/max-by identity [])\n;; =&gt; nil\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listmin-by-","title":"list/min-by - \u30ad\u30fc\u95a2\u6570\u3067\u6700\u5c0f\u5024\u3092\u53d6\u5f97","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/min-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; {:name \"Bob\" :age 25}\n\n;; \u6587\u5b57\u5217\u9577\u304c\u6700\u5c0f\u306e\u3082\u306e\u3092\u53d6\u5f97\n(list/min-by len [\"aaa\" \"b\" \"cc\"])\n;; =&gt; \"b\"\n\n;; \u7a7a\u30ea\u30b9\u30c8\u306e\u5834\u5408\u306fnil\n(list/min-by identity [])\n;; =&gt; nil\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listsum-by-","title":"list/sum-by - \u30ad\u30fc\u95a2\u6570\u3067\u5408\u8a08","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/sum-by (fn [u] (get u :age))\n  [{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}])\n;; =&gt; 55\n\n;; \u6587\u5b57\u5217\u9577\u306e\u5408\u8a08\n(list/sum-by len [\"a\" \"bb\" \"ccc\"])\n;; =&gt; 6\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([{:name \"Bob\" :age 25} {:name \"Alice\" :age 30}]\n |&gt; (list/sum-by (fn [u] (get u :age))))\n;; =&gt; 55\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_8","title":"\u30b0\u30eb\u30fc\u30d7\u5316\u30fb\u983b\u5ea6","text":""},{"location":"ja/spec/34-stdlib-list/#listfrequencies-","title":"list/frequencies - \u51fa\u73fe\u983b\u5ea6\u3092\u96c6\u8a08","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/frequencies [1 2 2 3 3 3])\n;; =&gt; {\"1\" 1, \"2\" 2, \"3\" 3}\n\n;; \u6587\u5b57\u5217\u306e\u983b\u5ea6\n(list/frequencies [\"a\" \"b\" \"a\" \"c\" \"b\" \"a\"])\n;; =&gt; {\"a\" 3, \"b\" 2, \"c\" 1}\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 2 3 3 3] |&gt; list/frequencies)\n;; =&gt; {\"1\" 1, \"2\" 2, \"3\" 3}\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listpartition-by-","title":"list/partition-by - \u9023\u7d9a\u3059\u308b\u5024\u3092\u8ff0\u8a9e\u95a2\u6570\u3067\u30b0\u30eb\u30fc\u30d7\u5316","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/partition-by even? [1 1 2 2 3 3])\n;; =&gt; ((1 1) (2 2) (3 3))\n\n;; \u9023\u7d9a\u3059\u308b\u540c\u3058\u5024\u3067\u30b0\u30eb\u30fc\u30d7\u5316\n(list/partition-by identity [1 1 2 2 2 3 3])\n;; =&gt; ((1 1) (2 2 2) (3 3))\n\n;; \u6587\u5b57\u5217\u9577\u3067\u30b0\u30eb\u30fc\u30d7\u5316\n(list/partition-by len [\"a\" \"b\" \"cc\" \"dd\" \"eee\"])\n;; =&gt; ((\"a\" \"b\") (\"cc\" \"dd\") (\"eee\"))\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_9","title":"\u5909\u63db\u30fb\u52a0\u5de5","text":""},{"location":"ja/spec/34-stdlib-list/#keep-nilmap","title":"keep - nil\u3092\u9664\u5916\u3057\u3066map","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(keep (fn [x] (when (even? x) (* x 2))) [1 2 3 4])\n;; =&gt; (4 8)\n\n;; nil\u3092\u8fd4\u3059\u8981\u7d20\u306f\u9664\u5916\u3055\u308c\u308b\n(keep (fn [x] (when (&gt; x 2) x)) [1 2 3 4])\n;; =&gt; (3 4)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 2 3 4] |&gt; (keep (fn [x] (when (even? x) (* x 2)))))\n;; =&gt; (4 8)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#listdedupe-","title":"list/dedupe - \u9023\u7d9a\u3059\u308b\u91cd\u8907\u3092\u524a\u9664","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(list/dedupe [1 1 2 2 3 3])\n;; =&gt; (1 2 3)\n\n;; \u975e\u9023\u7d9a\u306e\u91cd\u8907\u306f\u6b8b\u308b\n(list/dedupe [1 2 1 2])\n;; =&gt; (1 2 1 2)\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046\n([1 1 2 2 3 3] |&gt; list/dedupe)\n;; =&gt; (1 2 3)\n</code></pre> <p>distinct \u3068\u306e\u9055\u3044: - <code>distinct</code>: \u3059\u3079\u3066\u306e\u91cd\u8907\u3092\u524a\u9664\uff08<code>[1 2 1 2]</code> \u2192 <code>[1 2]</code>\uff09 - <code>list/dedupe</code>: \u9023\u7d9a\u3059\u308b\u91cd\u8907\u306e\u307f\u524a\u9664\uff08<code>[1 2 1 2]</code> \u2192 <code>(1 2 1 2)</code>\uff09</p>"},{"location":"ja/spec/34-stdlib-list/#_10","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/34-stdlib-list/#_11","title":"\u30c7\u30fc\u30bf\u5206\u6790\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<pre><code>;; \u5076\u6570\u306e\u307f\u53d6\u5f97\u3057\u3066\u5408\u8a08\n([1 2 3 4 5 6]\n |&gt; (filter even?)\n |&gt; (reduce + 0))\n;; =&gt; 12\n\n;; \u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u96c6\u8a08\n(def data [1 1 2 2 2 3 3])\n(data\n |&gt; list/frequencies)\n;; =&gt; {\"1\" 2, \"2\" 3, \"3\" 2}\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_12","title":"\u30e6\u30fc\u30b6\u30fc\u691c\u7d22\u30fb\u96c6\u8a08","text":"<pre><code>(def users [\n  {:name \"Alice\" :age 30 :dept \"Sales\"}\n  {:name \"Bob\" :age 25 :dept \"Dev\"}\n  {:name \"Carol\" :age 35 :dept \"Sales\"}\n])\n\n;; \u6700\u5e74\u9577\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u53d6\u5f97\n(users |&gt; (list/max-by (fn [u] (get u :age))))\n;; =&gt; {:name \"Carol\" :age 35 :dept \"Sales\"}\n\n;; \u5e74\u9f62\u306e\u5408\u8a08\n(users |&gt; (list/sum-by (fn [u] (get u :age))))\n;; =&gt; 90\n\n;; \u90e8\u7f72\u304cSales\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u691c\u7d22\n(users |&gt; (find (fn [u] (= (get u :dept) \"Sales\"))))\n;; =&gt; {:name \"Alice\" :age 30 :dept \"Sales\"}\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_13","title":"\u30c7\u30fc\u30bf\u5909\u63db","text":"<pre><code>;; CSV\u30c7\u30fc\u30bf\u30922\u5217\u305a\u3064\u51e6\u7406\n(def csv-row [\"Name\" \"Alice\" \"Age\" \"30\" \"City\" \"Tokyo\"])\n(csv-row |&gt; (list/chunk 2))\n;; =&gt; ((\"Name\" \"Alice\") (\"Age\" \"30\") (\"City\" \"Tokyo\"))\n\n;; \u30ad\u30fc\u3068\u5024\u304b\u3089\u30de\u30c3\u30d7\u3092\u751f\u6210\n(list/zipmap [:name :age :city] [\"Alice\" 30 \"Tokyo\"])\n;; =&gt; {:name \"Alice\", :age 30, :city \"Tokyo\"}\n\n;; 3\u500b\u304a\u304d\u306b\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\n(def large-data (range 1000))\n(large-data |&gt; (list/take-nth 100))\n;; =&gt; (0 100 200 300 400 500 600 700 800 900)\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_14","title":"\u30ed\u30b0\u89e3\u6790","text":"<pre><code>;; \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u51e6\u7406\n(def logs [\n  \"INFO: Starting...\"\n  \"INFO: Connected\"\n  \"ERROR: Connection lost\"\n  \"INFO: Retrying...\"\n])\n\n;; ERROR\u30ed\u30b0\u3092\u691c\u7d22\n(logs |&gt; (find (fn [s] (str/starts-with? s \"ERROR:\"))))\n;; =&gt; \"ERROR: Connection lost\"\n\n;; \u3059\u3079\u3066INFO\u304b\u30c1\u30a7\u30c3\u30af\n(logs |&gt; (list/every? (fn [s] (str/starts-with? s \"INFO:\"))))\n;; =&gt; false\n\n;; \u3044\u305a\u308c\u304bERROR\u304c\u3042\u308b\u304b\u30c1\u30a7\u30c3\u30af\n(logs |&gt; (list/some? (fn [s] (str/starts-with? s \"ERROR:\"))))\n;; =&gt; true\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_15","title":"\u30d0\u30c3\u30c1\u51e6\u7406","text":"<pre><code>;; \u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092100\u4ef6\u305a\u3064\u51e6\u7406\n(def data (range 1000))\n\n(data\n |&gt; (list/chunk 100)\n |&gt; (each (fn [batch]\n            (println f\"Processing batch of {(len batch)} items...\")\n            ;; \u30d0\u30c3\u30c1\u51e6\u7406\u30ed\u30b8\u30c3\u30af\n            )))\n</code></pre>"},{"location":"ja/spec/34-stdlib-list/#_16","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/34-stdlib-list/#_17","title":"\u6761\u4ef6\u4ed8\u304d\u53d6\u5f97\u30fb\u524a\u9664","text":"<ul> <li><code>take-while</code> - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u8981\u7d20\u3092\u53d6\u5f97</li> <li><code>drop-while</code> - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u8981\u7d20\u3092\u30b9\u30ad\u30c3\u30d7</li> <li><code>list/drop-last</code> - \u672b\u5c3en\u500b\u3092\u524a\u9664</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_18","title":"\u5206\u5272\u30fb\u7d50\u5408","text":"<ul> <li><code>list/split-at</code> - \u6307\u5b9a\u4f4d\u7f6e\u3067\u5206\u5272</li> <li><code>list/chunk</code> - \u56fa\u5b9a\u30b5\u30a4\u30ba\u3067\u5206\u5272</li> <li><code>list/interleave</code> - 2\u3064\u306e\u30ea\u30b9\u30c8\u3092\u4ea4\u4e92\u306b\u7d50\u5408</li> <li><code>list/zipmap</code> - 2\u3064\u306e\u30ea\u30b9\u30c8\u304b\u3089\u30de\u30c3\u30d7\u3092\u751f\u6210</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_19","title":"\u53d6\u5f97\u30fb\u9078\u629e","text":"<ul> <li><code>list/take-nth</code> - n\u756a\u76ee\u3054\u3068\u306b\u53d6\u5f97</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_20","title":"\u691c\u7d22\u30fb\u63a2\u7d22","text":"<ul> <li><code>find</code> - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u6700\u521d\u306e\u8981\u7d20</li> <li><code>list/find-index</code> - \u6761\u4ef6\u3092\u6e80\u305f\u3059\u6700\u521d\u306e\u8981\u7d20\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_21","title":"\u8ff0\u8a9e","text":"<ul> <li><code>list/every?</code> - \u3059\u3079\u3066\u306e\u8981\u7d20\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b</li> <li><code>list/some?</code> - \u3044\u305a\u308c\u304b\u306e\u8981\u7d20\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_22","title":"\u30bd\u30fc\u30c8\u30fb\u96c6\u7d04","text":"<ul> <li><code>list/sort-by</code> - \u30ad\u30fc\u95a2\u6570\u3067\u30bd\u30fc\u30c8</li> <li><code>list/max-by</code> - \u30ad\u30fc\u95a2\u6570\u3067\u6700\u5927\u5024\u3092\u53d6\u5f97</li> <li><code>list/min-by</code> - \u30ad\u30fc\u95a2\u6570\u3067\u6700\u5c0f\u5024\u3092\u53d6\u5f97</li> <li><code>list/sum-by</code> - \u30ad\u30fc\u95a2\u6570\u3067\u5408\u8a08</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_23","title":"\u30b0\u30eb\u30fc\u30d7\u5316\u30fb\u983b\u5ea6","text":"<ul> <li><code>list/frequencies</code> - \u51fa\u73fe\u983b\u5ea6\u3092\u96c6\u8a08</li> <li><code>list/partition-by</code> - \u9023\u7d9a\u3059\u308b\u5024\u3092\u8ff0\u8a9e\u95a2\u6570\u3067\u30b0\u30eb\u30fc\u30d7\u5316</li> </ul>"},{"location":"ja/spec/34-stdlib-list/#_24","title":"\u5909\u63db\u30fb\u52a0\u5de5","text":"<ul> <li><code>keep</code> - nil\u3092\u9664\u5916\u3057\u3066map</li> <li><code>list/dedupe</code> - \u9023\u7d9a\u3059\u308b\u91cd\u8907\u3092\u524a\u9664</li> </ul>"},{"location":"ja/spec/35-stdlib-map/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u30de\u30c3\u30d7\u62e1\u5f35\uff08map/\uff09","text":"<p>\u9ad8\u5ea6\u306a\u30de\u30c3\u30d7\u64cd\u4f5c\u95a2\u6570</p> <p>\u5b9f\u88c5: <code>src/builtins/map.rs</code></p> <p>\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u3001\u57fa\u672c\u7684\u306a\u30de\u30c3\u30d7\u64cd\u4f5c\uff08<code>get</code>, <code>keys</code>, <code>vals</code>, <code>assoc</code>, <code>dissoc</code>, <code>merge</code>, <code>get-in</code>, <code>update</code>, <code>update-in</code>\uff09\u306b\u52a0\u3048\u3066\u3001\u3088\u308a\u9ad8\u5ea6\u306a\u30de\u30c3\u30d7\u64cd\u4f5c\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <p>\u57fa\u672c\u95a2\u6570\u3068\u306e\u9055\u3044: - \u57fa\u672c\u95a2\u6570\uff08<code>src/builtins/core_collections.rs</code>\uff09: \u30b3\u30a2\u6a5f\u80fd\u3068\u3057\u3066\u5e38\u306b\u5229\u7528\u53ef\u80fd   - <code>get</code>, <code>keys</code>, <code>vals</code>, <code>assoc</code>, <code>dissoc</code>, <code>merge</code>   - <code>get-in</code>, <code>update</code>, <code>update-in</code> - \u62e1\u5f35\u95a2\u6570\uff08\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\uff09: \u7279\u5b9a\u306e\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u5411\u3051\u306e\u9ad8\u5ea6\u306a\u64cd\u4f5c   - \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u306e\u5909\u66f4\uff08<code>assoc-in</code>, <code>dissoc-in</code>\uff09   - \u30ad\u30fc\u30fb\u5024\u306e\u4e00\u62ec\u5909\u63db\uff08<code>update-keys</code>, <code>update-vals</code>\uff09   - \u30ad\u30fc\u306e\u9078\u629e\uff08<code>select-keys</code>\uff09</p>"},{"location":"ja/spec/35-stdlib-map/#_1","title":"\u30ad\u30fc\u306e\u9078\u629e","text":""},{"location":"ja/spec/35-stdlib-map/#select-keys-","title":"select-keys - \u6307\u5b9a\u3057\u305f\u30ad\u30fc\u306e\u307f\u62bd\u51fa","text":"<p>\u6307\u5b9a\u3057\u305f\u30ad\u30fc\u306e\u307f\u3092\u542b\u3080\u65b0\u3057\u3044\u30de\u30c3\u30d7\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(map/select-keys {:a 1 :b 2 :c 3} [:a :c])\n;; =&gt; {:a 1, :c 3}\n\n;; \u5b58\u5728\u3057\u306a\u3044\u30ad\u30fc\u306f\u7121\u8996\u3055\u308c\u308b\n(map/select-keys {:a 1 :b 2} [:a :x :y])\n;; =&gt; {:a 1}\n\n;; \u7a7a\u306e\u30ad\u30fc\u30ea\u30b9\u30c8\u306f\u7a7a\u30de\u30c3\u30d7\u3092\u8fd4\u3059\n(map/select-keys {:a 1 :b 2} [])\n;; =&gt; {}\n\n;; Vector\u3067\u3082\u30ea\u30b9\u30c8\u3067\u3082\u6307\u5b9a\u53ef\u80fd\n(map/select-keys {:a 1 :b 2 :c 3} (list :b :c))\n;; =&gt; {:b 2, :c 3}\n</code></pre> <p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046:</p> <pre><code>;; API\u30ec\u30b9\u30dd\u30f3\u30b9\u304b\u3089\u5fc5\u8981\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u307f\u62bd\u51fa\n(user\n |&gt; (map/select-keys _ [:id :name :email]))\n\n;; \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u53d6\u5f97\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u306e\u6574\u5f62\n(records\n |&gt; (map (fn [r] (map/select-keys r [:user_id :created_at :status]))))\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_2","title":"\u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u306e\u5909\u66f4","text":""},{"location":"ja/spec/35-stdlib-map/#assoc-in-","title":"assoc-in - \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306b\u5024\u3092\u8a2d\u5b9a","text":"<p>\u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306e\u30d1\u30b9\u306b\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4e2d\u9593\u306e\u30de\u30c3\u30d7\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u81ea\u52d5\u7684\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(map/assoc-in {} [:user :profile :name] \"Alice\")\n;; =&gt; {:user {:profile {:name \"Alice\"}}}\n\n;; \u65e2\u5b58\u306e\u30de\u30c3\u30d7\u306b\u8ffd\u52a0\n(map/assoc-in {:user {:age 30}} [:user :name] \"Bob\")\n;; =&gt; {:user {:age 30, :name \"Bob\"}}\n\n;; \u6df1\u3044\u30cd\u30b9\u30c8\n(map/assoc-in {} [:app :config :db :host] \"localhost\")\n;; =&gt; {:app {:config {:db {:host \"localhost\"}}}}\n\n;; \u65e2\u5b58\u306e\u5024\u3092\u4e0a\u66f8\u304d\n(map/assoc-in {:user {:name \"Alice\"}} [:user :name] \"Bob\")\n;; =&gt; {:user {:name \"Bob\"}}\n</code></pre> <p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046:</p> <pre><code>;; \u8a2d\u5b9a\u306e\u6bb5\u968e\u7684\u306a\u69cb\u7bc9\n({}\n |&gt; (map/assoc-in _ [:server :port] 8080)\n |&gt; (map/assoc-in _ [:server :host] \"0.0.0.0\")\n |&gt; (map/assoc-in _ [:db :host] \"localhost\")\n |&gt; (map/assoc-in _ [:db :port] 5432))\n;; =&gt; {:server {:port 8080, :host \"0.0.0.0\"},\n;;     :db {:host \"localhost\", :port 5432}}\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#dissoc-in-","title":"dissoc-in - \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u304b\u3089\u30ad\u30fc\u3092\u524a\u9664","text":"<p>\u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306e\u30d1\u30b9\u306b\u3042\u308b\u30ad\u30fc\u3092\u524a\u9664\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(map/dissoc-in {:user {:name \"Alice\" :age 30}} [:user :age])\n;; =&gt; {:user {:name \"Alice\"}}\n\n;; \u6df1\u3044\u30cd\u30b9\u30c8\n(map/dissoc-in {:a {:b {:c 1 :d 2}}} [:a :b :c])\n;; =&gt; {:a {:b {:d 2}}}\n\n;; \u6700\u5f8c\u306e\u30ad\u30fc\u3092\u524a\u9664\u3059\u308b\u3068\u7a7a\u30de\u30c3\u30d7\u304c\u6b8b\u308b\n(map/dissoc-in {:a {:b {:c 1}}} [:a :b :c])\n;; =&gt; {:a {:b {}}}\n\n;; \u5b58\u5728\u3057\u306a\u3044\u30d1\u30b9\u306f\u4f55\u3082\u3057\u306a\u3044\n(map/dissoc-in {:a 1} [:x :y :z])\n;; =&gt; {:a 1}\n</code></pre> <p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046:</p> <pre><code>;; \u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u60c5\u5831\u306e\u524a\u9664\n(user-data\n |&gt; (map/dissoc-in _ [:credentials :password])\n |&gt; (map/dissoc-in _ [:private :ssn]))\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_3","title":"\u30ad\u30fc\u30fb\u5024\u306e\u4e00\u62ec\u5909\u63db","text":""},{"location":"ja/spec/35-stdlib-map/#update-keys-","title":"update-keys - \u30de\u30c3\u30d7\u306e\u3059\u3079\u3066\u306e\u30ad\u30fc\u306b\u95a2\u6570\u3092\u9069\u7528","text":"<p>\u30de\u30c3\u30d7\u306e\u3059\u3079\u3066\u306e\u30ad\u30fc\u306b\u95a2\u6570\u3092\u9069\u7528\u3057\u3001\u65b0\u3057\u3044\u30de\u30c3\u30d7\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(map/update-keys str/upper {:name \"Alice\" :age 30})\n;; =&gt; {\"NAME\" \"Alice\", \"AGE\" 30}\n\n;; \u30ad\u30fc\u306e\u6b63\u898f\u5316\n(map/update-keys str/lower {:Name \"Alice\" :AGE 30})\n;; =&gt; {\"name\" \"Alice\", \"age\" 30}\n\n;; \u30ad\u30fc\u306e\u5909\u63db\n(map/update-keys (fn [k] (str \"prefix_\" k)) {:a 1 :b 2})\n;; =&gt; {\"prefix_a\" 1, \"prefix_b\" 2}\n\n;; \u30ad\u30fc\u30ef\u30fc\u30c9\u304b\u3089\u6587\u5b57\u5217\u3078\n(map/update-keys name {:name \"Alice\" :age 30})\n;; =&gt; {\"name\" \"Alice\", \"age\" 30}\n</code></pre> <p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046:</p> <pre><code>;; JSON\u30ad\u30fc\u306e\u6b63\u898f\u5316\n(json-data\n |&gt; (map/update-keys _ str/lower)\n |&gt; (map/update-keys _ (fn [k] (str/replace k \"-\" \"_\"))))\n\n;; \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30ab\u30e9\u30e0\u540d\u306e\u5909\u63db\n(db-record\n |&gt; (map/update-keys _ str/snake))\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#update-vals-","title":"update-vals - \u30de\u30c3\u30d7\u306e\u3059\u3079\u3066\u306e\u5024\u306b\u95a2\u6570\u3092\u9069\u7528","text":"<p>\u30de\u30c3\u30d7\u306e\u3059\u3079\u3066\u306e\u5024\u306b\u95a2\u6570\u3092\u9069\u7528\u3057\u3001\u65b0\u3057\u3044\u30de\u30c3\u30d7\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(map/update-vals inc {:a 1 :b 2})\n;; =&gt; {:a 2, :b 3}\n\n;; \u5024\u306e\u578b\u5909\u63db\n(map/update-vals str {:a 1 :b 2 :c 3})\n;; =&gt; {:a \"1\", :b \"2\", :c \"3\"}\n\n;; \u5024\u306e\u6b63\u898f\u5316\n(map/update-vals str/trim {:name \"  Alice  \" :city \"  Tokyo  \"})\n;; =&gt; {:name \"Alice\", :city \"Tokyo\"}\n\n;; \u6570\u5024\u306e\u5909\u63db\n(map/update-vals (fn [x] (* x 2)) {:a 10 :b 20 :c 30})\n;; =&gt; {:a 20, :b 40, :c 60}\n</code></pre> <p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u4f7f\u3046:</p> <pre><code>;; \u4fa1\u683c\u306e\u8a08\u7b97\n(prices\n |&gt; (map/update-vals _ (fn [p] (* p 1.1))))  ;; 10%\u5897\n\n;; \u30c7\u30fc\u30bf\u306e\u6b63\u898f\u5316\n(form-data\n |&gt; (map/update-vals _ str/trim)\n |&gt; (map/update-vals _ str/lower))\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_4","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/35-stdlib-map/#_5","title":"\u8a2d\u5b9a\u30de\u30fc\u30b8","text":"<pre><code>;; \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3068\u30e6\u30fc\u30b6\u30fc\u8a2d\u5b9a\u3092\u30de\u30fc\u30b8\n(def default-config\n  {:server {:host \"localhost\" :port 8080}\n   :db {:host \"localhost\" :port 5432}\n   :cache {:ttl 3600}})\n\n(def user-config\n  {:server {:port 3000}\n   :db {:host \"db.example.com\"}})\n\n;; \u6bb5\u968e\u7684\u306a\u30de\u30fc\u30b8\n(default-config\n |&gt; (map/assoc-in _ [:server :port] (get-in user-config [:server :port]))\n |&gt; (map/assoc-in _ [:db :host] (get-in user-config [:db :host])))\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#api","title":"API\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u6574\u5f62","text":"<pre><code>;; \u5fc5\u8981\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u307f\u62bd\u51fa\u3057\u3066\u30ad\u30fc\u3092\u5909\u63db\n(defn format-user-response [user]\n  (user\n   |&gt; (map/select-keys _ [:id :name :email :created_at])\n   |&gt; (map/update-keys _ str/camel)))\n\n(format-user-response\n  {:id 1 :name \"Alice\" :email \"alice@example.com\"\n   :created_at \"2024-01-01\" :password_hash \"...\" :salt \"...\"})\n;; =&gt; {\"id\" 1, \"name\" \"Alice\", \"email\" \"alice@example.com\",\n;;     \"createdAt\" \"2024-01-01\"}\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_6","title":"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30ec\u30b3\u30fc\u30c9\u306e\u5909\u63db","text":"<pre><code>;; \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u53d6\u5f97\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u3092\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u7528\u306b\u5909\u63db\n(defn transform-records [records]\n  (records\n   |&gt; (map (fn [r]\n             (r\n              |&gt; (map/select-keys _ [:user_id :username :status :created_at])\n              |&gt; (map/update-keys _ str/camel)\n              |&gt; (map/update-vals _ (fn [v]\n                                      (if (string? v)\n                                        (str/trim v)\n                                        v))))))))\n\n(transform-records\n  [{:user_id 1 :username \" alice \" :status \"active\" :created_at \"2024-01-01\" :internal_id 999}\n   {:user_id 2 :username \" bob \" :status \"inactive\" :created_at \"2024-01-02\" :internal_id 1000}])\n;; =&gt; [{\"userId\" 1, \"username\" \"alice\", \"status\" \"active\", \"createdAt\" \"2024-01-01\"}\n;;     {\"userId\" 2, \"username\" \"bob\", \"status\" \"inactive\", \"createdAt\" \"2024-01-02\"}]\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_7","title":"\u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u60c5\u5831\u306e\u524a\u9664","text":"<pre><code>;; \u30ed\u30b0\u51fa\u529b\u524d\u306b\u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u60c5\u5831\u3092\u524a\u9664\n(defn sanitize-for-log [data]\n  (data\n   |&gt; (map/dissoc-in _ [:user :credentials :password])\n   |&gt; (map/dissoc-in _ [:user :credentials :api_key])\n   |&gt; (map/dissoc-in _ [:payment :card_number])\n   |&gt; (map/dissoc-in _ [:payment :cvv])))\n\n(sanitize-for-log\n  {:user {:name \"Alice\"\n          :credentials {:username \"alice\" :password \"secret\" :api_key \"xyz123\"}}\n   :payment {:card_number \"1234-5678-9012-3456\" :cvv \"123\" :amount 1000}})\n;; =&gt; {:user {:name \"Alice\", :credentials {:username \"alice\"}},\n;;     :payment {:amount 1000}}\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_8","title":"\u8a2d\u5b9a\u306e\u52d5\u7684\u69cb\u7bc9","text":"<pre><code>;; \u74b0\u5883\u5909\u6570\u304b\u3089\u8a2d\u5b9a\u3092\u69cb\u7bc9\n(defn build-config [env]\n  ({}\n   |&gt; (map/assoc-in _ [:server :host] (get env \"SERVER_HOST\" \"localhost\"))\n   |&gt; (map/assoc-in _ [:server :port] (str/parse-int (get env \"SERVER_PORT\" \"8080\")))\n   |&gt; (map/assoc-in _ [:db :host] (get env \"DB_HOST\" \"localhost\"))\n   |&gt; (map/assoc-in _ [:db :port] (str/parse-int (get env \"DB_PORT\" \"5432\")))\n   |&gt; (map/assoc-in _ [:db :name] (get env \"DB_NAME\" \"app\"))\n   |&gt; (map/assoc-in _ [:cache :enabled] (= (get env \"CACHE_ENABLED\" \"true\") \"true\"))\n   |&gt; (map/assoc-in _ [:cache :ttl] (str/parse-int (get env \"CACHE_TTL\" \"3600\")))))\n</code></pre>"},{"location":"ja/spec/35-stdlib-map/#_9","title":"\u95a2\u6570\u4e00\u89a7","text":""},{"location":"ja/spec/35-stdlib-map/#_10","title":"\u30ad\u30fc\u9078\u629e","text":"<ul> <li><code>map/select-keys</code> - \u6307\u5b9a\u3057\u305f\u30ad\u30fc\u306e\u307f\u62bd\u51fa</li> </ul>"},{"location":"ja/spec/35-stdlib-map/#_11","title":"\u30cd\u30b9\u30c8\u64cd\u4f5c","text":"<ul> <li><code>map/assoc-in</code> - \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u306b\u5024\u3092\u8a2d\u5b9a</li> <li><code>map/dissoc-in</code> - \u30cd\u30b9\u30c8\u3057\u305f\u30de\u30c3\u30d7\u304b\u3089\u30ad\u30fc\u3092\u524a\u9664</li> </ul>"},{"location":"ja/spec/35-stdlib-map/#_12","title":"\u4e00\u62ec\u5909\u63db","text":"<ul> <li><code>map/update-keys</code> - \u3059\u3079\u3066\u306e\u30ad\u30fc\u306b\u95a2\u6570\u3092\u9069\u7528</li> <li><code>map/update-vals</code> - \u3059\u3079\u3066\u306e\u5024\u306b\u95a2\u6570\u3092\u9069\u7528</li> </ul>"},{"location":"ja/spec/35-stdlib-map/#_13","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30ce\u30fc\u30c8","text":"<ul> <li>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f\u65b0\u3057\u3044\u30de\u30c3\u30d7\u3092\u8fd4\u3057\u307e\u3059\uff08\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff09</li> <li><code>update-keys</code>\u3068<code>update-vals</code>\u306f\u95a2\u6570\u3092\u5404\u8981\u7d20\u306b\u9069\u7528\u3059\u308b\u305f\u3081\u3001\u5927\u304d\u306a\u30de\u30c3\u30d7\u3067\u306f\u51e6\u7406\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059</li> <li><code>assoc-in</code>\u306f\u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u518d\u5e30\u7684\u306b\u30b3\u30d4\u30fc\u3059\u308b\u305f\u3081\u3001\u6df1\u3044\u30cd\u30b9\u30c8\u3067\u306f\u51e6\u7406\u30b3\u30b9\u30c8\u304c\u9ad8\u304f\u306a\u308a\u307e\u3059</li> <li>\u983b\u7e41\u306b\u66f4\u65b0\u3059\u308b\u5834\u5408\u306f\u3001\u30a2\u30c8\u30e0\uff08<code>atom</code>\uff09\u3084\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\uff08<code>agent</code>\uff09\u306e\u5229\u7528\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044</li> </ul>"},{"location":"ja/spec/36-stdlib-set/","title":"\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - \u96c6\u5408\u6f14\u7b97\uff08set/\uff09","text":"<p>\u6570\u5b66\u7684\u306a\u96c6\u5408\u6f14\u7b97\u3092\u63d0\u4f9b\u3059\u308b\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea</p> <p>\u3059\u3079\u3066\u306e\u95a2\u6570\u306f <code>set/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5c5e\u3057\u307e\u3059\u3002</p> <p>\u5b9f\u88c5: <code>src/builtins/set.rs</code> Feature: <code>std-set</code></p>"},{"location":"ja/spec/36-stdlib-set/#_1","title":"\u6982\u8981","text":"<p>\u96c6\u5408\uff08Set\uff09\u3068\u306f\u3001\u91cd\u8907\u306e\u306a\u3044\u8981\u7d20\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002Qi\u8a00\u8a9e\u3067\u306f\u3001<code>set/</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u6570\u5b66\u7684\u306a\u96c6\u5408\u6f14\u7b97\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <p>\u5185\u90e8\u7684\u306b\u306f <code>HashSet</code> \u3092\u4f7f\u7528\u3057\u3066\u9ad8\u901f\u306a\u5224\u5b9a\u30fb\u6f14\u7b97\u3092\u5b9f\u73fe\u3057\u3066\u304a\u308a\u3001\u5165\u529b\u3068\u3057\u3066List\u3084Vector\u3092\u53d7\u3051\u53d6\u308a\u307e\u3059\u3002</p>"},{"location":"ja/spec/36-stdlib-set/#_2","title":"\u4e3b\u306a\u7528\u9014","text":"<ul> <li>\u91cd\u8907\u6392\u9664 - \u30ea\u30b9\u30c8\u304b\u3089\u91cd\u8907\u3092\u524a\u9664</li> <li>\u5171\u901a\u9805\u691c\u7d22 - \u8907\u6570\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5171\u901a\u3059\u308b\u8981\u7d20\u3092\u62bd\u51fa</li> <li>\u5dee\u5206\u691c\u51fa - \u4e00\u65b9\u306b\u306e\u307f\u5b58\u5728\u3059\u308b\u8981\u7d20\u3092\u7279\u5b9a</li> <li>\u96c6\u5408\u95a2\u4fc2\u306e\u5224\u5b9a - \u90e8\u5206\u96c6\u5408\u3001\u4e0a\u4f4d\u96c6\u5408\u3001\u4e92\u3044\u306b\u7d20\u306e\u5224\u5b9a</li> </ul>"},{"location":"ja/spec/36-stdlib-set/#_3","title":"\u96c6\u5408\u6f14\u7b97","text":""},{"location":"ja/spec/36-stdlib-set/#setunion-","title":"set/union - \u548c\u96c6\u5408","text":"<p>\u8907\u6570\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u548c\u96c6\u5408\u3092\u8fd4\u3057\u307e\u3059\uff08\u91cd\u8907\u306f\u81ea\u52d5\u7684\u306b\u524a\u9664\u3055\u308c\u307e\u3059\uff09\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/union [1 2] [2 3])\n;; =&gt; [1 2 3]\n\n;; 3\u3064\u4ee5\u4e0a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3082\u53ef\u80fd\n(set/union [1 2] [2 3] [3 4])\n;; =&gt; [1 2 3 4]\n\n;; \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n(set/union)\n;; =&gt; []\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/union (list 1 2) [2 3] (list 3 4))\n;; =&gt; [1 2 3 4]\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>...collections</code>: 0\u500b\u4ee5\u4e0a\u306eList/Vector</p> <p>\u623b\u308a\u5024: - List\uff08\u91cd\u8907\u3092\u9664\u3044\u305f\u5168\u8981\u7d20\uff09</p>"},{"location":"ja/spec/36-stdlib-set/#setintersect-","title":"set/intersect - \u7a4d\u96c6\u5408","text":"<p>\u5168\u3066\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5171\u901a\u3059\u308b\u8981\u7d20\u306e\u307f\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/intersect [1 2 3] [2 3 4])\n;; =&gt; [2 3]\n\n;; 3\u3064\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5171\u901a\u8981\u7d20\n(set/intersect [1 2 3 4] [2 3 4 5] [3 4 5 6])\n;; =&gt; [3 4]\n\n;; \u5171\u901a\u8981\u7d20\u304c\u306a\u3044\u5834\u5408\n(set/intersect [1 2] [3 4])\n;; =&gt; []\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/intersect (list 1 2 3) [2 3 4])\n;; =&gt; [2 3]\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>collection1</code>: \u6700\u521d\u306eList/Vector\uff08\u5fc5\u9808\uff09 - <code>collection2</code>: 2\u3064\u76ee\u306eList/Vector\uff08\u5fc5\u9808\uff09 - <code>...more</code>: \u8ffd\u52a0\u306eList/Vector\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09</p> <p>\u623b\u308a\u5024: - List\uff08\u5168\u3066\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5171\u901a\u3059\u308b\u8981\u7d20\uff09</p>"},{"location":"ja/spec/36-stdlib-set/#setdifference-","title":"set/difference - \u5dee\u96c6\u5408","text":"<p>\u7b2c1\u5f15\u6570\u304b\u3089\u3001\u7b2c2\u5f15\u6570\u4ee5\u964d\u306e\u8981\u7d20\u3092\u5168\u3066\u9664\u3044\u305f\u96c6\u5408\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/difference [1 2 3] [2])\n;; =&gt; [1 3]\n\n;; \u8907\u6570\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u9664\u5916\n(set/difference [1 2 3 4 5] [2 3] [4])\n;; =&gt; [1 5]\n\n;; \u9664\u5916\u3059\u308b\u8981\u7d20\u304c\u306a\u3044\u5834\u5408\n(set/difference [1 2 3] [4 5])\n;; =&gt; [1 2 3]\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/difference (list 1 2 3 4) [2 4])\n;; =&gt; [1 3]\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>base</code>: \u30d9\u30fc\u30b9\u3068\u306a\u308bList/Vector\uff08\u5fc5\u9808\uff09 - <code>exclude1</code>: \u9664\u5916\u3059\u308bList/Vector\uff08\u5fc5\u9808\uff09 - <code>...more</code>: \u8ffd\u52a0\u3067\u9664\u5916\u3059\u308bList/Vector\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09</p> <p>\u623b\u308a\u5024: - List\uff08base\u304b\u3089\u6307\u5b9a\u3055\u308c\u305f\u8981\u7d20\u3092\u9664\u3044\u305f\u7d50\u679c\uff09</p>"},{"location":"ja/spec/36-stdlib-set/#setsymmetric-difference-","title":"set/symmetric-difference - \u5bfe\u79f0\u5dee","text":"<p>\u3069\u3061\u3089\u304b\u4e00\u65b9\u306b\u306e\u307f\u5b58\u5728\u3059\u308b\u8981\u7d20\u306e\u96c6\u5408\u3092\u8fd4\u3057\u307e\u3059\uff08\u6392\u4ed6\u7684\u8ad6\u7406\u548c\uff09\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/symmetric-difference [1 2 3] [2 3 4])\n;; =&gt; [1 4]\n\n;; \u5171\u901a\u8981\u7d20\u304c\u306a\u3044\u5834\u5408\u306f\u5168\u3066\u542b\u307e\u308c\u308b\n(set/symmetric-difference [1 2] [3 4])\n;; =&gt; [1 2 3 4]\n\n;; \u5168\u3066\u5171\u901a\u306e\u5834\u5408\u306f\u7a7a\n(set/symmetric-difference [1 2] [1 2])\n;; =&gt; []\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/symmetric-difference (list 1 2 3) [2 3 4])\n;; =&gt; [1 4]\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>set1</code>: \u6700\u521d\u306eList/Vector\uff08\u5fc5\u9808\uff09 - <code>set2</code>: 2\u3064\u76ee\u306eList/Vector\uff08\u5fc5\u9808\uff09</p> <p>\u623b\u308a\u5024: - List\uff08\u3069\u3061\u3089\u304b\u4e00\u65b9\u306b\u306e\u307f\u5b58\u5728\u3059\u308b\u8981\u7d20\uff09</p> <p>\u6570\u5b66\u7684\u610f\u5473: <pre><code>A \u25b3 B = (A - B) \u222a (B - A)\n      = (A \u222a B) - (A \u2229 B)\n</code></pre></p>"},{"location":"ja/spec/36-stdlib-set/#_4","title":"\u96c6\u5408\u95a2\u4fc2\u306e\u5224\u5b9a","text":""},{"location":"ja/spec/36-stdlib-set/#setsubset-","title":"set/subset? - \u90e8\u5206\u96c6\u5408\u5224\u5b9a","text":"<p>\u7b2c1\u5f15\u6570\u304c\u7b2c2\u5f15\u6570\u306e\u90e8\u5206\u96c6\u5408\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/subset? [1 2] [1 2 3])\n;; =&gt; true\n\n;; \u540c\u3058\u96c6\u5408\u306f\u90e8\u5206\u96c6\u5408\n(set/subset? [1 2] [1 2])\n;; =&gt; true\n\n;; \u90e8\u5206\u96c6\u5408\u3067\u306a\u3044\u5834\u5408\n(set/subset? [1 2 3] [1 2])\n;; =&gt; false\n\n;; \u7a7a\u96c6\u5408\u306f\u5168\u3066\u306e\u96c6\u5408\u306e\u90e8\u5206\u96c6\u5408\n(set/subset? [] [1 2 3])\n;; =&gt; true\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/subset? (list 1 2) [1 2 3 4])\n;; =&gt; true\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>subset</code>: \u90e8\u5206\u96c6\u5408\u5019\u88dc\u306eList/Vector\uff08\u5fc5\u9808\uff09 - <code>superset</code>: \u89aa\u96c6\u5408\u5019\u88dc\u306eList/Vector\uff08\u5fc5\u9808\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code>: subset\u306e\u5168\u8981\u7d20\u304csuperset\u306b\u542b\u307e\u308c\u308b - <code>false</code>: \u305d\u308c\u4ee5\u5916</p> <p>\u6570\u5b66\u7684\u610f\u5473: <pre><code>A \u2286 B \u21d4 \u2200x \u2208 A, x \u2208 B\n</code></pre></p>"},{"location":"ja/spec/36-stdlib-set/#setsuperset-","title":"set/superset? - \u4e0a\u4f4d\u96c6\u5408\u5224\u5b9a","text":"<p>\u7b2c1\u5f15\u6570\u304c\u7b2c2\u5f15\u6570\u306e\u4e0a\u4f4d\u96c6\u5408\uff08\u30b9\u30fc\u30d1\u30fc\u30bb\u30c3\u30c8\uff09\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/superset? [1 2 3] [1 2])\n;; =&gt; true\n\n;; \u540c\u3058\u96c6\u5408\u306f\u4e0a\u4f4d\u96c6\u5408\n(set/superset? [1 2] [1 2])\n;; =&gt; true\n\n;; \u4e0a\u4f4d\u96c6\u5408\u3067\u306a\u3044\u5834\u5408\n(set/superset? [1 2] [1 2 3])\n;; =&gt; false\n\n;; \u5168\u3066\u306e\u96c6\u5408\u306f\u7a7a\u96c6\u5408\u306e\u4e0a\u4f4d\u96c6\u5408\n(set/superset? [1 2 3] [])\n;; =&gt; true\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/superset? (list 1 2 3 4) [1 2])\n;; =&gt; true\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>superset</code>: \u4e0a\u4f4d\u96c6\u5408\u5019\u88dc\u306eList/Vector\uff08\u5fc5\u9808\uff09 - <code>subset</code>: \u90e8\u5206\u96c6\u5408\u5019\u88dc\u306eList/Vector\uff08\u5fc5\u9808\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code>: subset\u306e\u5168\u8981\u7d20\u304csuperset\u306b\u542b\u307e\u308c\u308b - <code>false</code>: \u305d\u308c\u4ee5\u5916</p> <p>\u6ce8: <code>set/superset?(A, B)</code> \u306f <code>set/subset?(B, A)</code> \u3068\u540c\u3058\u610f\u5473\u3067\u3059\u3002</p> <p>\u6570\u5b66\u7684\u610f\u5473: <pre><code>A \u2287 B \u21d4 B \u2286 A\n</code></pre></p>"},{"location":"ja/spec/36-stdlib-set/#setdisjoint-","title":"set/disjoint? - \u4e92\u3044\u306b\u7d20\u5224\u5b9a","text":"<p>2\u3064\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5171\u901a\u8981\u7d20\u304c\u306a\u3044\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>;; \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n(set/disjoint? [1 2] [3 4])\n;; =&gt; true\n\n;; \u5171\u901a\u8981\u7d20\u304c\u3042\u308b\u5834\u5408\n(set/disjoint? [1 2 3] [3 4 5])\n;; =&gt; false\n\n;; \u7a7a\u96c6\u5408\u306f\u5168\u3066\u306e\u96c6\u5408\u3068\u4e92\u3044\u306b\u7d20\n(set/disjoint? [] [1 2 3])\n;; =&gt; true\n\n;; List\u3068Vector\u306e\u6df7\u5728\u3082\u53ef\u80fd\n(set/disjoint? (list 1 2) [3 4])\n;; =&gt; true\n</code></pre> <p>\u30d1\u30e9\u30e1\u30fc\u30bf: - <code>set1</code>: \u6700\u521d\u306eList/Vector\uff08\u5fc5\u9808\uff09 - <code>set2</code>: 2\u3064\u76ee\u306eList/Vector\uff08\u5fc5\u9808\uff09</p> <p>\u623b\u308a\u5024: - <code>true</code>: \u5171\u901a\u8981\u7d20\u304c1\u3064\u3082\u306a\u3044 - <code>false</code>: \u5c11\u306a\u304f\u3068\u30821\u3064\u306e\u5171\u901a\u8981\u7d20\u304c\u3042\u308b</p> <p>\u6570\u5b66\u7684\u610f\u5473: <pre><code>A \u2229 B = \u2205\n</code></pre></p>"},{"location":"ja/spec/36-stdlib-set/#_5","title":"\u5b9f\u7528\u4f8b","text":""},{"location":"ja/spec/36-stdlib-set/#_6","title":"\u91cd\u8907\u6392\u9664","text":"<pre><code>;; \u30ea\u30b9\u30c8\u304b\u3089\u91cd\u8907\u3092\u524a\u9664\n(def items [1 2 2 3 3 3 4])\n\n;; \u81ea\u5206\u81ea\u8eab\u3068\u306e\u548c\u96c6\u5408 = \u91cd\u8907\u6392\u9664\n(set/union items)\n;; =&gt; [1 2 3 4]\n\n;; distinct\u3068\u306e\u9055\u3044\uff08set/union\u306f\u9806\u5e8f\u304c\u4e0d\u5b9a\uff09\n(distinct items)\n;; =&gt; [1 2 3 4]\uff08\u5165\u529b\u306e\u9806\u5e8f\u3092\u7dad\u6301\uff09\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_7","title":"\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u7ba1\u7406","text":"<pre><code>;; \u30e6\u30fc\u30b6\u30fc\u304c\u6301\u3064\u6a29\u9650\n(def user-permissions [:read :write :delete])\n\n;; \u5fc5\u8981\u306a\u6a29\u9650\n(def required-permissions [:read :write])\n\n;; \u5fc5\u8981\u306a\u6a29\u9650\u3092\u5168\u3066\u6301\u3063\u3066\u3044\u308b\u304b\n(set/subset? required-permissions user-permissions)\n;; =&gt; true\n\n;; \u7ba1\u7406\u8005\u6a29\u9650\u3092\u6301\u3063\u3066\u3044\u308b\u304b\n(set/superset? user-permissions [:admin])\n;; =&gt; false\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_8","title":"\u30bf\u30b0\u691c\u7d22","text":"<pre><code>;; \u8a18\u4e8b\u306e\u30bf\u30b0\n(def article1-tags [:programming :rust :web])\n(def article2-tags [:programming :python :cli])\n(def article3-tags [:rust :systems])\n\n;; \u300cprogramming\u300d\u307e\u305f\u306f\u300crust\u300d\u306e\u30bf\u30b0\u3092\u6301\u3064\u8a18\u4e8b\u3092\u691c\u7d22\n(def search-tags [:programming :rust])\n\n;; article1\u3068search-tags\u306b\u5171\u901a\u30bf\u30b0\u304c\u3042\u308b\u304b\n(not (set/disjoint? article1-tags search-tags))\n;; =&gt; true\uff08:programming \u3068 :rust \u304c\u5171\u901a\uff09\n\n;; \u5168\u3066\u306e\u30bf\u30b0\u3092\u96c6\u7d04\n(set/union article1-tags article2-tags article3-tags)\n;; =&gt; [:programming :rust :web :python :cli :systems]\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_9","title":"\u30c7\u30fc\u30bf\u6bd4\u8f03\u30fb\u5dee\u5206\u691c\u51fa","text":"<pre><code>;; \u65e7\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30e6\u30fc\u30b6\u30fcID\n(def old-users [101 102 103 104 105])\n\n;; \u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30e6\u30fc\u30b6\u30fcID\n(def new-users [103 104 105 106 107])\n\n;; \u524a\u9664\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\n(set/difference old-users new-users)\n;; =&gt; [101 102]\n\n;; \u8ffd\u52a0\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\n(set/difference new-users old-users)\n;; =&gt; [106 107]\n\n;; \u5909\u66f4\u306e\u3042\u3063\u305f\u30e6\u30fc\u30b6\u30fc\uff08\u524a\u9664 + \u8ffd\u52a0\uff09\n(set/symmetric-difference old-users new-users)\n;; =&gt; [101 102 106 107]\n\n;; \u5909\u66f4\u306e\u306a\u3044\u30e6\u30fc\u30b6\u30fc\n(set/intersect old-users new-users)\n;; =&gt; [103 104 105]\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_10","title":"\u30de\u30eb\u30c1\u6761\u4ef6\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>;; \u6761\u4ef6\u3054\u3068\u306b\u8a72\u5f53\u3059\u308bID\u3092\u30d5\u30a3\u30eb\u30bf\n(def active-users [1 2 3 4 5])\n(def premium-users [3 4 5 6])\n(def verified-users [2 3 5 7])\n\n;; \u30a2\u30af\u30c6\u30a3\u30d6\u304b\u3064\u30d7\u30ec\u30df\u30a2\u30e0\u306a\u30e6\u30fc\u30b6\u30fc\n(set/intersect active-users premium-users)\n;; =&gt; [3 4 5]\n\n;; \u30a2\u30af\u30c6\u30a3\u30d6\u3060\u304c\u30d7\u30ec\u30df\u30a2\u30e0\u3067\u306a\u3044\u30e6\u30fc\u30b6\u30fc\n(set/difference active-users premium-users)\n;; =&gt; [1 2]\n\n;; \u30d7\u30ec\u30df\u30a2\u30e0\u307e\u305f\u306f\u8a8d\u8a3c\u6e08\u307f\u306e\u30e6\u30fc\u30b6\u30fc\n(set/union premium-users verified-users)\n;; =&gt; [3 4 5 6 2 7]\n\n;; 3\u3064\u306e\u6761\u4ef6\u5168\u3066\u3092\u6e80\u305f\u3059\u30e6\u30fc\u30b6\u30fc\n(set/intersect active-users premium-users verified-users)\n;; =&gt; [3 5]\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_11","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u306e\u7d71\u5408","text":"<pre><code>;; \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u304b\u3089\u7279\u5b9a\u306e\u5f79\u5272\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\n(def users [\n  {:id 1 :roles [:admin :user]}\n  {:id 2 :roles [:user :guest]}\n  {:id 3 :roles [:admin :moderator]}\n  {:id 4 :roles [:user]}\n])\n\n;; \u7ba1\u7406\u8005\u304b\u30e2\u30c7\u30ec\u30fc\u30bf\u30fc\u306eID\u3092\u62bd\u51fa\n(users\n |&gt; (filter (fn [u]\n              (not (set/disjoint? (:roles u) [:admin :moderator]))))\n |&gt; (map :id))\n;; =&gt; [1 3]\n\n;; \u8907\u6570\u306e\u5fc5\u9808\u6a29\u9650\u3092\u5168\u3066\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\n(def required-perms [:read :write :execute])\n\n(users\n |&gt; (filter (fn [u]\n              (set/subset? required-perms (:roles u))))\n |&gt; (map :id))\n;; =&gt; \uff08\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30e6\u30fc\u30b6\u30fc\u304c\u3044\u308c\u3070\u8fd4\u5374\uff09\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_12","title":"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u8003\u616e","text":""},{"location":"ja/spec/36-stdlib-set/#_13","title":"\u5185\u90e8\u5b9f\u88c5","text":"<ul> <li>\u5168\u3066\u306e\u96c6\u5408\u6f14\u7b97\u306f <code>HashSet</code> \u30d9\u30fc\u30b9\u3067\u9ad8\u901f\u52d5\u4f5c</li> <li>\u8981\u7d20\u306e\u5224\u5b9a\u306f O(1) \u306e\u5e73\u5747\u8a08\u7b97\u91cf</li> <li>\u96c6\u5408\u6f14\u7b97\u5168\u4f53\u306f O(n) \u306e\u8a08\u7b97\u91cf\uff08n = \u8981\u7d20\u6570\uff09</li> </ul>"},{"location":"ja/spec/36-stdlib-set/#_14","title":"\u5927\u91cf\u30c7\u30fc\u30bf\u3067\u306e\u4f7f\u7528","text":"<pre><code>;; \u6570\u4e07\u4ef6\u306eID\u30ea\u30b9\u30c8\u3067\u3082\u9ad8\u901f\n(def old-ids (range 100000))\n(def new-ids (range 50000 150000))\n\n;; O(n) \u3067\u5dee\u5206\u3092\u8a08\u7b97\n(set/difference old-ids new-ids)\n;; =&gt; (0 1 2 ... 49999)\n\n;; \u983b\u7e41\u306b\u5224\u5b9a\u3059\u308b\u5834\u5408\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u6d3b\u7528\n(def common-ids (set/intersect old-ids new-ids))\n\n;; common\u306b\u542b\u307e\u308c\u308b\u304b\u3092\u9ad8\u901f\u5224\u5b9a\uff08\u5916\u90e8\u95a2\u6570\u3068\u306e\u7d44\u307f\u5408\u308f\u305b\uff09\n(contains? (to-vector common-ids) 75000)\n;; =&gt; true\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_15","title":"\u65e2\u5b58\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u95a2\u6570\u3068\u306e\u4f7f\u3044\u5206\u3051","text":""},{"location":"ja/spec/36-stdlib-set/#distinct-vs-setunion","title":"distinct vs set/union","text":"<pre><code>;; distinct - \u9806\u5e8f\u3092\u7dad\u6301\u3057\u3066\u91cd\u8907\u524a\u9664\n(distinct [3 1 2 1 3])\n;; =&gt; [3 1 2]\n\n;; set/union - \u9806\u5e8f\u306f\u4e0d\u5b9a\uff08\u30cf\u30c3\u30b7\u30e5\u30d9\u30fc\u30b9\uff09\n(set/union [3 1 2 1 3])\n;; =&gt; [3 1 2] \u307e\u305f\u306f [1 2 3]\uff08\u5b9f\u88c5\u4f9d\u5b58\uff09\n</code></pre> <p>\u9078\u3073\u65b9: - \u9806\u5e8f\u304c\u91cd\u8981 \u2192 <code>distinct</code> - \u9806\u5e8f\u304c\u4e0d\u8981\u3067\u9ad8\u901f\u6027\u91cd\u8996 \u2192 <code>set/union</code></p>"},{"location":"ja/spec/36-stdlib-set/#filter-vs-setintersect","title":"filter vs set/intersect","text":"<pre><code>(def allowed-ids [1 2 3])\n(def all-items [{:id 1} {:id 2} {:id 4}])\n\n;; filter - \u8907\u96d1\u306a\u6761\u4ef6\u304c\u53ef\u80fd\n(all-items |&gt; (filter (fn [item] (some? (find (fn [id] (= id (:id item))) allowed-ids)))))\n\n;; \u5358\u7d14\u306aID\u7167\u5408\u306a\u3089 set/intersect \u304c\u7c21\u6f54\n(def item-ids (all-items |&gt; (map :id)))\n(set/intersect item-ids allowed-ids)\n;; =&gt; [1 2]\n</code></pre>"},{"location":"ja/spec/36-stdlib-set/#_16","title":"\u307e\u3068\u3081","text":"\u95a2\u6570 \u8aac\u660e \u6570\u5b66\u8a18\u53f7 <code>set/union</code> \u548c\u96c6\u5408 A \u222a B <code>set/intersect</code> \u7a4d\u96c6\u5408 A \u2229 B <code>set/difference</code> \u5dee\u96c6\u5408 A - B <code>set/symmetric-difference</code> \u5bfe\u79f0\u5dee A \u25b3 B <code>set/subset?</code> \u90e8\u5206\u96c6\u5408\u5224\u5b9a A \u2286 B <code>set/superset?</code> \u4e0a\u4f4d\u96c6\u5408\u5224\u5b9a A \u2287 B <code>set/disjoint?</code> \u4e92\u3044\u306b\u7d20\u5224\u5b9a A \u2229 B = \u2205 <p>Qi\u306e\u96c6\u5408\u6f14\u7b97\u306e\u7279\u5fb4: - List\u3068Vector\u306e\u4e21\u65b9\u3092\u30b5\u30dd\u30fc\u30c8 - \u623b\u308a\u5024\u306f\u5e38\u306bList - <code>HashSet</code> \u30d9\u30fc\u30b9\u306e\u9ad8\u901f\u6f14\u7b97 - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u7d71\u5408\u53ef\u80fd - 0\u5f15\u6570\u3084\u5358\u4e00\u5f15\u6570\u3082\u30b5\u30dd\u30fc\u30c8\uff08union\u3001difference\u306a\u3069\uff09</p>"},{"location":"ja/spec/QUICK-REFERENCE/","title":"Qi\u8a00\u8a9e \u30af\u30a4\u30c3\u30af\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9","text":"<p>1\u30da\u30fc\u30b8\u3067\u5b66\u3076Qi\u306e\u57fa\u672c</p>"},{"location":"ja/spec/QUICK-REFERENCE/#_1","title":"\ud83d\udccc \u57fa\u672c\u69cb\u6587","text":""},{"location":"ja/spec/QUICK-REFERENCE/#_2","title":"\u30c7\u30fc\u30bf\u578b","text":"<pre><code>42                ;; \u6574\u6570\n3.14              ;; \u6d6e\u52d5\u5c0f\u6570\u70b9\n\"hello\"           ;; \u6587\u5b57\u5217\nf\"Hello, {name}\"  ;; f-string\uff08\u6587\u5b57\u5217\u88dc\u9593\uff09\ntrue / false      ;; \u771f\u507d\u5024\nnil               ;; nil\n:keyword          ;; \u30ad\u30fc\u30ef\u30fc\u30c9\n[1 2 3]           ;; \u30d9\u30af\u30bf\n'(1 2 3)          ;; \u30ea\u30b9\u30c8\uff08\u30af\u30aa\u30fc\u30c8\u5fc5\u9808\uff09\n{:name \"Alice\"}   ;; \u30de\u30c3\u30d7\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_3","title":"\u5b9a\u7fa9","text":"<pre><code>(def x 42)                          ;; \u5909\u6570\u5b9a\u7fa9\n(defn greet [name] (str \"Hello, \" name))  ;; \u95a2\u6570\u5b9a\u7fa9\n(let [x 10 y 20] (+ x y))          ;; \u30ed\u30fc\u30ab\u30eb\u675f\u7e1b\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_4","title":"\u5236\u5fa1\u69cb\u9020","text":"<pre><code>(if (&gt; x 10) \"big\" \"small\")        ;; if\n(do (println \"1\") (println \"2\"))   ;; \u9806\u6b21\u5b9f\u884c\n(loop [i 0] (if (&lt; i 10) (recur (inc i)) i))  ;; \u30eb\u30fc\u30d7\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_5","title":"\u26a1 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\uff08\u2605\u30a6\u30ea\uff09","text":"<pre><code>;; |&gt; - \u9010\u6b21\u30d1\u30a4\u30d7\n(data |&gt; parse |&gt; transform |&gt; save)\n\n;; |&gt;? - Railway Pipeline\uff08\u30a8\u30e9\u30fc\u51e6\u7406\uff09\n(input |&gt;? validate |&gt;? parse |&gt;? process)\n;; {:error ...} \u3067\u30b7\u30e7\u30fc\u30c8\u30b5\u30fc\u30ad\u30c3\u30c8\u3001\u305d\u308c\u4ee5\u5916\u306f\u6210\u529f\n\n;; ||&gt; - \u4e26\u5217\u30d1\u30a4\u30d7\uff08\u81ea\u52d5\u7684\u306bpmap\u5316\uff09\n([1 2 3 4] ||&gt; heavy-process)  ;; \u4e26\u5217\u5b9f\u884c\n\n;; ~&gt; - \u975e\u540c\u671f\u30d1\u30a4\u30d7\uff08goroutine\u98a8\uff09\n(def result (data ~&gt; transform))\n(go/recv! result)\n\n;; tap&gt; - \u526f\u4f5c\u7528\u30bf\u30c3\u30d7\uff08\u30c7\u30d0\u30c3\u30b0\u7528\uff09\n(data |&gt; parse |&gt; (tap print) |&gt; save)\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_6","title":"\ud83d\udd00 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff08\u2605\u30a6\u30ea\uff09","text":"<pre><code>(match value\n  {:ok data} -&gt; (process data)\n  {:error e} -&gt; (log e)\n  _ -&gt; \"default\")\n\n;; \u30ac\u30fc\u30c9\u6761\u4ef6\n(match x\n  n when (&gt; n 0) -&gt; \"positive\"\n  n when (&lt; n 0) -&gt; \"negative\"\n  _ -&gt; \"zero\")\n\n;; \u30d9\u30af\u30bf\u306e\u5206\u89e3\n(match [1 2 3]\n  [a b c] -&gt; (+ a b c))  ;; =&gt; 6\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_7","title":"\ud83d\ude80 \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\uff08\u2605\u30a6\u30ea\uff09","text":""},{"location":"ja/spec/QUICK-REFERENCE/#goroutine","title":"goroutine\u98a8","text":"<pre><code>;; \u30c1\u30e3\u30cd\u30eb\u4f5c\u6210\n(def ch (go/chan))\n\n;; \u9001\u53d7\u4fe1\n(go/send! ch 42)\n(def val (go/recv! ch))  ;; =&gt; 42\n\n;; goroutine\u3067\u5b9f\u884c\n(go/run (println \"async!\"))\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#mapfilterreduce","title":"\u4e26\u5217map/filter/reduce","text":"<pre><code>(pmap (fn [x] (* x 2)) [1 2 3 4])     ;; \u4e26\u5217map\n(pfilter even? [1 2 3 4])              ;; \u4e26\u5217filter\n(preduce + [1 2 3 4] 0)                ;; \u4e26\u5217reduce (fn collection init)\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#atom","title":"Atom\uff08\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406\uff09","text":"<pre><code>(def counter (atom 0))\n(swap! counter inc)        ;; =&gt; 1\n(reset! counter 0)         ;; =&gt; 0\n(deref counter)            ;; =&gt; 0 \u307e\u305f\u306f @counter\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_8","title":"\ud83d\udce6 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u64cd\u4f5c","text":""},{"location":"ja/spec/QUICK-REFERENCE/#_9","title":"\u30a2\u30af\u30bb\u30b9","text":"<pre><code>(first [1 2 3])            ;; =&gt; 1\n(rest [1 2 3])             ;; =&gt; (2 3)\n(last [1 2 3])             ;; =&gt; 3\n(nth [10 20 30] 1)         ;; =&gt; 20\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_10","title":"\u5909\u63db","text":"<pre><code>(map inc [1 2 3])          ;; =&gt; [2 3 4]\n(filter even? [1 2 3 4])   ;; =&gt; [2 4]\n(reduce + 0 [1 2 3])       ;; =&gt; 6\n(take 2 [1 2 3 4])         ;; =&gt; [1 2]\n(drop 2 [1 2 3 4])         ;; =&gt; [3 4]\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_11","title":"\u9023\u7d50\u30fb\u30bd\u30fc\u30c8","text":"<pre><code>(concat [1 2] [3 4])       ;; =&gt; [1 2 3 4]\n(cons 0 [1 2 3])           ;; =&gt; [0 1 2 3]\n(sort [3 1 4])             ;; =&gt; [1 3 4]\n(reverse [1 2 3])          ;; =&gt; [3 2 1]\n(distinct [1 2 2 3])       ;; =&gt; [1 2 3]\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_12","title":"\ud83d\udd0d \u8ff0\u8a9e\u95a2\u6570","text":"<pre><code>;; \u578b\u30c1\u30a7\u30c3\u30af\n(nil? x) (number? x) (string? x) (list? x) (vector? x) (map? x)\n\n;; \u72b6\u614b\u30c1\u30a7\u30c3\u30af\n(some? x)      ;; nil\u3067\u306a\u3044\n(empty? coll)  ;; \u7a7a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n(error? x)     ;; {:error ...} \u5f62\u5f0f\n\n;; \u6570\u5024\u8ff0\u8a9e\n(even? 2) (odd? 3) (positive? 1) (negative? -1) (zero? 0)\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_13","title":"\u26a0\ufe0f \u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"ja/spec/QUICK-REFERENCE/#railway-pipeline","title":"Railway Pipeline\uff08\u63a8\u5968\uff09","text":"<pre><code>(defn divide [x y]\n  (if (= y 0)\n    {:error \"division by zero\"}\n    (/ x y)))\n\n(10 |&gt;? (fn [x] (divide 100 x)))  ;; =&gt; 10\n(0 |&gt;? (fn [x] (divide 100 x)))   ;; =&gt; {:error \"division by zero\"}\n\n;; error?\u8ff0\u8a9e\u3067\u5224\u5b9a\n(if (error? result)\n  (log \"\u30a8\u30e9\u30fc\")\n  (process result))\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#defer","title":"defer\uff08\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\uff09","text":"<pre><code>(defn process-file [path]\n  (let [f (open path)]\n    (do\n      (defer (close f))  ;; \u95a2\u6570\u7d42\u4e86\u6642\u306b\u5fc5\u305a\u5b9f\u884c\n      (read f))))\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#httpjson","title":"\ud83c\udf10 HTTP\u30fbJSON","text":""},{"location":"ja/spec/QUICK-REFERENCE/#http","title":"HTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8","text":"<pre><code>;; \u30b7\u30f3\u30d7\u30eb\u7248\uff08\u30dc\u30c7\u30a3\u306e\u307f\uff09\n(def resp (http/get \"https://api.example.com/data\"))\n(def data (json/parse resp))\n\n;; \u8a73\u7d30\u7248\uff08\u30b9\u30c6\u30fc\u30bf\u30b9\u30fb\u30d8\u30c3\u30c0\u30fc\u30fb\u30dc\u30c7\u30a3\uff09\n(def resp (http/get! \"https://api.example.com/data\"))\n(def data (json/parse (get resp :body)))\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#http_1","title":"HTTP\u30b5\u30fc\u30d0\u30fc","text":"<pre><code>(defn handler [req]\n  (server/json {:message \"Hello, World!\"}))\n\n(comment\n  (server/serve handler {:port 3000})\n  )\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#io","title":"\ud83d\udcc1 \u30d5\u30a1\u30a4\u30ebI/O","text":"<pre><code>(io/read-file \"data.txt\")                ;; \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\n(io/write-file \"output.txt\" \"content\")   ;; \u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u8fbc\u307f\n(io/read-lines \"data.txt\")               ;; \u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u307f\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_14","title":"\ud83e\uddee \u6570\u5b66\u95a2\u6570","text":"<pre><code>(math/pow 2 3)      ;; =&gt; 8\n(math/sqrt 16)      ;; =&gt; 4.0\n(math/round 3.14)   ;; =&gt; 3.0\n(math/rand)         ;; \u30e9\u30f3\u30c0\u30e0 [0.0, 1.0)\n(math/rand-int 10)  ;; \u30e9\u30f3\u30c0\u30e0\u6574\u6570 [0, 10)\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_15","title":"\ud83e\uddea \u30c6\u30b9\u30c8","text":"<pre><code>(test/assert-eq (+ 1 2) 3)\n(test/assert (&gt; 5 3))\n(test/assert-throws (fn [] (error \"test\")))\n\n;; \u30c6\u30b9\u30c8\u5b9f\u884c\n(test/run)\n</code></pre>"},{"location":"ja/spec/QUICK-REFERENCE/#_16","title":"\u30ea\u30b9\u30c8\u3068\u30d9\u30af\u30bf\u306e\u4f7f\u3044\u5206\u3051","text":"<ul> <li>\u30d9\u30af\u30bf <code>[...]</code>: \u30c7\u30d5\u30a9\u30eb\u30c8\uff08JSON\u4e92\u63db\u3001\u9ad8\u901f\uff09</li> <li>\u30ea\u30b9\u30c8 <code>'(...)</code>: \u518d\u5e30\u7684\u51e6\u7406\u3001Lisp\u7684\u306a\u51e6\u7406</li> </ul>"},{"location":"ja/spec/QUICK-REFERENCE/#_17","title":"\u4e26\u5217\u5316\u306e\u76ee\u5b89","text":"<ul> <li>\u4f7f\u3046: CPU\u96c6\u7d04\u7684\u3001I/O\u5f85\u3061\u3001\u8981\u7d20\u6570100+</li> <li>\u4f7f\u308f\u306a\u3044: \u8efd\u91cf\u51e6\u7406\u3001\u8981\u7d20\u657010\u672a\u6e80</li> </ul>"},{"location":"ja/spec/QUICK-REFERENCE/#_18","title":"\u30a8\u30e9\u30fc\u51e6\u7406\u306e\u9078\u629e","text":"<ul> <li>Railway Pipeline (<code>|&gt;?</code>): API\u3001\u30d5\u30a1\u30a4\u30ebIO\u3001\u30d1\u30fc\u30b9</li> <li>try/catch: \u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\u3001\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3\u30e9\u30a4\u30d6\u30e9\u30ea</li> </ul>"},{"location":"ja/spec/QUICK-REFERENCE/#_19","title":"\ud83d\udcda \u8a73\u7d30\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<p>\u5b8c\u5168\u306a\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306f docs/spec/ \u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <ul> <li>02-flow-pipes.md - \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50</li> <li>03-concurrency.md - \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>04-match.md - \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</li> <li>06-data-structures.md - \u30c7\u30fc\u30bf\u69cb\u9020</li> <li>08-error-handling.md - \u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"ja/tutorial/","title":"Qi\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","text":"<p>\u30bc\u30ed\u304b\u3089\u5b66\u3076Qi\u8a00\u8a9e - \u5b9f\u8df5\u7684\u306a\u30b3\u30fc\u30c9\u4f8b\u3067\u8eab\u306b\u3064\u3051\u308b</p> <p>\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u3001Qi\u306e\u4e3b\u8981\u6a5f\u80fd\u3092\u6bb5\u968e\u7684\u306b\u5b66\u3079\u308b\u3088\u3046\u306b\u69cb\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5404\u7ae0\u306f\u72ec\u7acb\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u8208\u5473\u306e\u3042\u308b\u90e8\u5206\u304b\u3089\u59cb\u3081\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/#_1","title":"\ud83d\udcda \u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u4e00\u89a7","text":""},{"location":"ja/tutorial/#1","title":"1. \u306f\u3058\u3081\u306e\u4e00\u6b69 \u2b50 \u5fc5\u8aad","text":"<ul> <li>\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u74b0\u5883\u69cb\u7bc9</li> <li>\u6700\u521d\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c</li> <li>REPL\u306e\u4f7f\u3044\u65b9</li> <li>\u57fa\u672c\u7684\u306a\u30c7\u30fc\u30bf\u578b\u3068\u6f14\u7b97</li> </ul> <p>\u6240\u8981\u6642\u9593: 15\u5206</p>"},{"location":"ja/tutorial/#2-qi","title":"2. \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u8003\u3048\u308b \u2b50 Qi\u306e\u771f\u9ac4","text":"<ul> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 (<code>|&gt;</code>)</li> <li>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b</li> <li>\u95a2\u6570\u5408\u6210\u3068\u30c1\u30a7\u30fc\u30f3</li> <li>\u5b9f\u7528\u4f8b: \u30c6\u30ad\u30b9\u30c8\u51e6\u7406\u3001\u30c7\u30fc\u30bf\u5909\u63db</li> </ul> <p>\u6240\u8981\u6642\u9593: 20\u5206</p>"},{"location":"ja/tutorial/#3","title":"3. \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u30de\u30b9\u30bf\u30fc\u3059\u308b","text":"<ul> <li><code>match</code>\u5f0f\u306e\u57fa\u672c</li> <li>\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u5206\u89e3</li> <li>\u30ac\u30fc\u30c9\u6761\u4ef6</li> <li>\u5b9f\u7528\u4f8b: \u30b3\u30de\u30f3\u30c9\u51e6\u7406\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> </ul> <p>\u6240\u8981\u6642\u9593: 25\u5206</p>"},{"location":"ja/tutorial/#4","title":"4. \u30a8\u30e9\u30fc\u3092\u512a\u96c5\u306b\u6271\u3046 \u2b50 \u91cd\u8981","text":"<ul> <li>Railway Pipeline (<code>|&gt;?</code>)</li> <li><code>try</code>\u3068<code>error?</code>\u8ff0\u8a9e</li> <li>\u30a8\u30e9\u30fc\u4f1d\u64ad\u306e\u8a2d\u8a08</li> <li>\u5b9f\u7528\u4f8b: \u30d5\u30a1\u30a4\u30eb\u51e6\u7406\u3001API\u547c\u3073\u51fa\u3057</li> </ul> <p>\u6240\u8981\u6642\u9593: 30\u5206</p>"},{"location":"ja/tutorial/#5-qi","title":"5. \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u7c21\u5358\u306b \u2b50 Qi\u306e\u5f37\u307f","text":"<ul> <li>\u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 (<code>||&gt;</code>)</li> <li>goroutine\u98a8\u306e\u4e26\u884c\u51e6\u7406</li> <li>\u30c1\u30e3\u30cd\u30eb\u901a\u4fe1</li> <li>\u5b9f\u7528\u4f8b: \u4e26\u5217\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3001\u30c7\u30fc\u30bf\u51e6\u7406</li> </ul> <p>\u6240\u8981\u6642\u9593: 35\u5206</p>"},{"location":"ja/tutorial/#6-webapi","title":"6. Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068API","text":"<ul> <li>HTTP\u30b5\u30fc\u30d0\u30fc\u306e\u69cb\u7bc9</li> <li>JSON API</li> <li>\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3068\u30df\u30c9\u30eb\u30a6\u30a7\u30a2</li> <li>\u5b9f\u7528\u4f8b: RESTful API\u3001CRUD\u64cd\u4f5c</li> </ul> <p>\u6240\u8981\u6642\u9593: 40\u5206</p>"},{"location":"ja/tutorial/#_2","title":"\ud83c\udfaf \u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"ja/tutorial/#1_1","title":"\u521d\u5fc3\u8005\u5411\u3051\uff081\u6642\u9593\uff09","text":"<ol> <li>\u306f\u3058\u3081\u306e\u4e00\u6b69\uff0815\u5206\uff09</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u8003\u3048\u308b\uff0820\u5206\uff09</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u30de\u30b9\u30bf\u30fc\u3059\u308b\uff0825\u5206\uff09</li> </ol>"},{"location":"ja/tutorial/#2","title":"\u5b9f\u8df5\u8005\u5411\u3051\uff082\u6642\u9593\uff09","text":"<p>\u4e0a\u8a18\u306b\u52a0\u3048\u3066\uff1a 4. \u30a8\u30e9\u30fc\u3092\u512a\u96c5\u306b\u6271\u3046\uff0830\u5206\uff09 5. \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u7c21\u5358\u306b\uff0835\u5206\uff09</p>"},{"location":"ja/tutorial/#web3","title":"Web\u958b\u767a\u8005\u5411\u3051\uff083\u6642\u9593\uff09","text":"<p>\u5168\u3066\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb</p>"},{"location":"ja/tutorial/#_3","title":"\ud83d\udca1 \u5b66\u7fd2\u306e\u30b3\u30c4","text":"<ol> <li> <p>REPL\u3067\u8a66\u3059: \u5168\u3066\u306e\u30b3\u30fc\u30c9\u4f8b\u306fREPL\u3067\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059    <pre><code>qi  # REPL\u3092\u8d77\u52d5\n</code></pre></p> </li> <li> <p>\u30b3\u30fc\u30c9\u3092\u5909\u3048\u3066\u307f\u308b: \u4f8b\u3092\u30b3\u30d4\u30da\u3059\u308b\u3060\u3051\u3067\u306a\u304f\u3001\u6570\u5024\u3084\u30c7\u30fc\u30bf\u3092\u5909\u3048\u3066\u5b9f\u9a13\u3057\u307e\u3057\u3087\u3046</p> </li> <li> <p>\u30a8\u30e9\u30fc\u3092\u6050\u308c\u306a\u3044: \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u65e5\u672c\u8a9e\u3067\u8868\u793a\u3055\u308c\u307e\u3059\uff08<code>QI_LANG=ja</code>\uff09</p> </li> <li> <p>\u5c0f\u3055\u304f\u59cb\u3081\u308b: \u6700\u521d\u304b\u3089\u8907\u96d1\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3053\u3046\u3068\u305b\u305a\u3001\u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u59cb\u3081\u307e\u3057\u3087\u3046</p> </li> </ol>"},{"location":"ja/tutorial/#_4","title":"\ud83d\udcd6 \u305d\u306e\u4ed6\u306e\u30ea\u30bd\u30fc\u30b9","text":"<ul> <li>\u30af\u30a4\u30c3\u30af\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 - 1\u30da\u30fc\u30b8\u3067\u5168\u6a5f\u80fd\u3092\u78ba\u8a8d</li> <li>\u5b8c\u5168\u306a\u8a00\u8a9e\u4ed5\u69d8 - \u8a73\u7d30\u306a\u4ed5\u69d8\u66f8</li> <li>\u95a2\u6570\u7d22\u5f15 - 200+\u306e\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9</li> <li>\u30b9\u30bf\u30a4\u30eb\u30ac\u30a4\u30c9 - \u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u898f\u7d04</li> </ul>"},{"location":"ja/tutorial/#_5","title":"\ud83d\ude80 \u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u7d42\u3048\u305f\u3089\uff1a</p> <ol> <li>examples/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u5b9f\u8df5\u7684\u306a\u30b3\u30fc\u30c9\u3092\u898b\u308b</li> <li>\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u59cb\u3081\u308b</li> <li>\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306b\u53c2\u52a0\u3059\u308b\uff08GitHub Issues\u3001Discussions\uff09</li> </ol> <p>\u305d\u308c\u3067\u306f\u3001\u306f\u3058\u3081\u306e\u4e00\u6b69\u304b\u3089\u59cb\u3081\u307e\u3057\u3087\u3046\uff01</p>"},{"location":"ja/tutorial/00-lisp-basics/","title":"Lisp\u7cfb\u8a00\u8a9e\u306e\u57fa\u790e","text":"<p>Qi\u306fLisp\u7cfb\u8a00\u8a9e\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001Lisp\u7cfb\u8a00\u8a9e\u306b\u521d\u3081\u3066\u89e6\u308c\u308b\u65b9\u5411\u3051\u306b\u3001\u62ec\u5f27\u306e\u8aad\u307f\u65b9\u3084\u57fa\u672c\u7684\u306a\u8003\u3048\u65b9\u3092\u8aac\u660e\u3057\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/00-lisp-basics/#_1","title":"\u76ee\u6b21","text":"<ul> <li>Lisp\u7cfb\u8a00\u8a9e\u3068\u306f</li> <li>\u62ec\u5f27\u306e\u8aad\u307f\u65b9</li> <li>\u95a2\u6570\u547c\u3073\u51fa\u3057</li> <li>\u4ed6\u306e\u8a00\u8a9e\u3068\u306e\u6bd4\u8f03</li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u5f0f</li> <li>\u306a\u305c\u3053\u306e\u66f8\u304d\u65b9\u306a\u306e\u304b</li> <li>\u6b21\u306e\u30b9\u30c6\u30c3\u30d7</li> </ul>"},{"location":"ja/tutorial/00-lisp-basics/#lisp_1","title":"Lisp\u7cfb\u8a00\u8a9e\u3068\u306f","text":"<p>Lisp\uff08List Processing\uff09\u306f\u30011958\u5e74\u306b\u751f\u307e\u308c\u305f\u6b74\u53f2\u3042\u308b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u30d5\u30a1\u30df\u30ea\u30fc\u3067\u3059\u3002</p> <p>\u7279\u5fb4: - \u62ec\u5f27\u3067\u5f0f\u3092\u56f2\u3080: \u3059\u3079\u3066\u304c\u30ea\u30b9\u30c8\uff08\u62ec\u5f27\u3067\u56f2\u307e\u308c\u305f\u5f0f\uff09 - \u524d\u7f6e\u8a18\u6cd5: \u6f14\u7b97\u5b50\u304c\u5148\u982d\u306b\u6765\u308b - \u30b7\u30f3\u30d7\u30eb\u306a\u6587\u6cd5: \u899a\u3048\u308b\u3053\u3068\u304c\u5c11\u306a\u3044 - \u30b3\u30fc\u30c9\u3068\u30c7\u30fc\u30bf\u304c\u540c\u3058: \u30d7\u30ed\u30b0\u30e9\u30e0\u81ea\u4f53\u304c\u30c7\u30fc\u30bf\u69cb\u9020</p> <p>\u4ee3\u8868\u7684\u306aLisp\u7cfb\u8a00\u8a9e: - Common Lisp - Scheme - Clojure\uff08JVM\u4e0a\u306eLisp\uff09 - Racket - \u305d\u3057\u3066\u3001Qi\uff01</p>"},{"location":"ja/tutorial/00-lisp-basics/#_2","title":"\u62ec\u5f27\u306e\u8aad\u307f\u65b9","text":""},{"location":"ja/tutorial/00-lisp-basics/#_3","title":"\u57fa\u672c\u30eb\u30fc\u30eb","text":"<pre><code>(\u95a2\u6570\u540d \u5f15\u65701 \u5f15\u65702 \u5f15\u65703)\n</code></pre> <p>\u62ec\u5f27\u306e\u4e2d\u306e\u6700\u521d\u306e\u8981\u7d20\u304c\u95a2\u6570\u540d\u3001\u6b8b\u308a\u304c\u5f15\u6570\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/00-lisp-basics/#_4","title":"\u4f8b: \u8db3\u3057\u7b97","text":"<pre><code>(+ 1 2 3)\n;; =&gt; 6\n</code></pre> <p>\u3053\u308c\u306f\u300c1\u30682\u30683\u3092\u8db3\u3059\u300d\u3068\u3044\u3046\u610f\u5473\u3067\u3059\u3002</p> <p>\u4ed6\u306e\u8a00\u8a9e\u3068\u306e\u6bd4\u8f03:</p> \u8a00\u8a9e \u66f8\u304d\u65b9 JavaScript <code>1 + 2 + 3</code> Python <code>1 + 2 + 3</code> Qi (Lisp) <code>(+ 1 2 3)</code>"},{"location":"ja/tutorial/00-lisp-basics/#_5","title":"\u95a2\u6570\u547c\u3073\u51fa\u3057","text":""},{"location":"ja/tutorial/00-lisp-basics/#_6","title":"\u5358\u7d14\u306a\u4f8b","text":"<pre><code>;; \u639b\u3051\u7b97\n(* 2 3)\n;; =&gt; 6\n\n;; \u5272\u308a\u7b97\n(/ 10 2)\n;; =&gt; 5\n\n;; \u6587\u5b57\u5217\u3092\u51fa\u529b\n(println \"Hello, World!\")\n;; =&gt; Hello, World!\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_7","title":"\u8907\u6570\u306e\u5f15\u6570","text":"<p>Lisp\u3067\u306f\u3001\u591a\u304f\u306e\u95a2\u6570\u304c\u8907\u6570\u306e\u5f15\u6570\u3092\u53d6\u308c\u307e\u3059\u3002</p> <pre><code>;; \u8907\u6570\u306e\u6570\u3092\u8db3\u3059\n(+ 1 2 3 4 5)\n;; =&gt; 15\n\n;; \u8907\u6570\u306e\u6570\u3092\u639b\u3051\u308b\n(* 2 3 4)\n;; =&gt; 24\n\n;; \u6700\u5927\u5024\u3092\u6c42\u3081\u308b\n(max 10 5 8 20 3)\n;; =&gt; 20\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_8","title":"\u4ed6\u306e\u8a00\u8a9e\u3068\u306e\u6bd4\u8f03","text":""},{"location":"ja/tutorial/00-lisp-basics/#1","title":"\u4f8b1: \u8db3\u3057\u7b97","text":"<p>JavaScript: <pre><code>1 + 2 + 3\n</code></pre></p> <p>Python: <pre><code>1 + 2 + 3\n</code></pre></p> <p>Qi: <pre><code>(+ 1 2 3)\n</code></pre></p>"},{"location":"ja/tutorial/00-lisp-basics/#2","title":"\u4f8b2: \u95a2\u6570\u547c\u3073\u51fa\u3057","text":"<p>JavaScript: <pre><code>Math.max(10, 5, 8)\n</code></pre></p> <p>Python: <pre><code>max(10, 5, 8)\n</code></pre></p> <p>Qi: <pre><code>(max 10 5 8)\n</code></pre></p> <p>Qi\u3067\u306f\u30ab\u30f3\u30de\u304c\u4e0d\u8981\u3067\u3059\uff01</p>"},{"location":"ja/tutorial/00-lisp-basics/#_9","title":"\u30cd\u30b9\u30c8\u3057\u305f\u5f0f","text":"<p>\u62ec\u5f27\u306e\u4e2d\u306b\u62ec\u5f27\u3092\u5165\u308c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff08\u30cd\u30b9\u30c8\uff09\u3002</p>"},{"location":"ja/tutorial/00-lisp-basics/#_10","title":"\u4f8b: \u8a08\u7b97\u306e\u30cd\u30b9\u30c8","text":"<pre><code>(+ 1 (* 2 3))\n;; =&gt; 7\n</code></pre> <p>\u8aad\u307f\u65b9: 1. \u5185\u5074\u304b\u3089\u8aad\u3080: <code>(* 2 3)</code> \u2192 <code>6</code> 2. \u5916\u5074\u3092\u8a08\u7b97: <code>(+ 1 6)</code> \u2192 <code>7</code></p> <p>\u4ed6\u306e\u8a00\u8a9e\u3068\u306e\u6bd4\u8f03:</p> \u8a00\u8a9e \u66f8\u304d\u65b9 JavaScript/Python <code>1 + (2 * 3)</code> Qi (Lisp) <code>(+ 1 (* 2 3))</code>"},{"location":"ja/tutorial/00-lisp-basics/#_11","title":"\u3082\u3046\u5c11\u3057\u8907\u96d1\u306a\u4f8b","text":"<pre><code>(* (+ 1 2) (+ 3 4))\n;; =&gt; 21\n</code></pre> <p>\u8aad\u307f\u65b9: 1. <code>(+ 1 2)</code> \u2192 <code>3</code> 2. <code>(+ 3 4)</code> \u2192 <code>7</code> 3. <code>(* 3 7)</code> \u2192 <code>21</code></p> <p>\u4ed6\u306e\u8a00\u8a9e\u3068\u306e\u6bd4\u8f03:</p> \u8a00\u8a9e \u66f8\u304d\u65b9 JavaScript/Python <code>(1 + 2) * (3 + 4)</code> Qi (Lisp) <code>(* (+ 1 2) (+ 3 4))</code>"},{"location":"ja/tutorial/00-lisp-basics/#_12","title":"\u306a\u305c\u3053\u306e\u66f8\u304d\u65b9\u306a\u306e\u304b","text":""},{"location":"ja/tutorial/00-lisp-basics/#_13","title":"\u30e1\u30ea\u30c3\u30c8","text":""},{"location":"ja/tutorial/00-lisp-basics/#1_1","title":"1. \u4e00\u8cab\u6027","text":"<p>\u3059\u3079\u3066\u304c\u540c\u3058\u30d1\u30bf\u30fc\u30f3: <code>(\u95a2\u6570 \u5f15\u6570...)</code></p> <pre><code>(+ 1 2)           ;; \u6f14\u7b97\u5b50\n(println \"Hi\")    ;; \u95a2\u6570\n(if true 1 2)     ;; \u6761\u4ef6\u5206\u5c90\n(def x 10)        ;; \u5909\u6570\u5b9a\u7fa9\n</code></pre> <p>\u3059\u3079\u3066\u540c\u3058\u66f8\u304d\u65b9\u3067\u3059\uff01</p>"},{"location":"ja/tutorial/00-lisp-basics/#2_1","title":"2. \u62e1\u5f35\u3057\u3084\u3059\u3044","text":"<p>\u65b0\u3057\u3044\u6f14\u7b97\u5b50\u3092\u8ffd\u52a0\u3057\u3066\u3082\u3001\u6587\u6cd5\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002</p> <pre><code>;; \u65e2\u5b58\u306e\u6f14\u7b97\u5b50\n(+ 1 2 3)\n\n;; \u30ab\u30b9\u30bf\u30e0\u6f14\u7b97\u5b50\uff08\u4eee\uff09\n(my-operator 1 2 3)\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#3","title":"3. \u62ec\u5f27\u304c\u3042\u3044\u307e\u3044\u3055\u3092\u6d88\u3059","text":"<p>\u6f14\u7b97\u5b50\u306e\u512a\u5148\u9806\u4f4d\u3092\u899a\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u305b\u3093\u3002</p> <p>\u4ed6\u306e\u8a00\u8a9e\uff08\u66d6\u6627\uff09: <pre><code>1 + 2 * 3  ;; 7? 9? \u3069\u3063\u3061\uff1f\n</code></pre></p> <p>Qi\uff08\u660e\u78ba\uff09: <pre><code>(+ 1 (* 2 3))  ;; 7\n(* (+ 1 2) 3)  ;; 9\n</code></pre></p>"},{"location":"ja/tutorial/00-lisp-basics/#4","title":"4. \u5f37\u529b\u306a\u30de\u30af\u30ed","text":"<p>\u30b3\u30fc\u30c9\u304c\u30c7\u30fc\u30bf\u306a\u306e\u3067\u3001\u30b3\u30fc\u30c9\u3092\u751f\u6210\u3059\u308b\u30b3\u30fc\u30c9\u304c\u66f8\u304d\u3084\u3059\u3044\uff08\u4e0a\u7d1a\u8005\u5411\u3051\uff09\u3002</p>"},{"location":"ja/tutorial/00-lisp-basics/#repl","title":"\u5b9f\u8df5: REPL\u3067\u8a66\u3057\u3066\u307f\u3088\u3046","text":"<p>REPL\u3092\u8d77\u52d5\u3057\u3066\u3001\u5b9f\u969b\u306b\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>qi\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_14","title":"\u57fa\u672c\u7684\u306a\u8a08\u7b97","text":"<pre><code>qi:1&gt; (+ 1 2)\n3\n\nqi:2&gt; (* 5 6)\n30\n\nqi:3&gt; (+ 1 (* 2 3))\n7\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_15","title":"\u5909\u6570\u3092\u5b9a\u7fa9","text":"<pre><code>qi:4&gt; (def x 10)\n10\n\nqi:5&gt; (def y 5)\n5\n\nqi:6&gt; (+ x y)\n15\n\nqi:7&gt; (* x y)\n50\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_16","title":"\u95a2\u6570\u3092\u5b9a\u7fa9","text":"<pre><code>qi:8&gt; (defn square [n] (* n n))\nFunction(square)\n\nqi:9&gt; (square 5)\n25\n\nqi:10&gt; (square 10)\n100\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_17","title":"\u30cd\u30b9\u30c8\u3057\u305f\u8a08\u7b97","text":"<pre><code>qi:11&gt; (square (+ 2 3))\n25\n\nqi:12&gt; (+ (square 3) (square 4))\n25\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_18","title":"\u3088\u304f\u3042\u308b\u8cea\u554f","text":""},{"location":"ja/tutorial/00-lisp-basics/#q","title":"Q: \u62ec\u5f27\u304c\u591a\u3059\u304e\u307e\u305b\u3093\u304b\uff1f","text":"<p>A: \u6700\u521d\u306f\u591a\u304f\u611f\u3058\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3059\u3050\u306b\u6163\u308c\u307e\u3059\uff01\u30a8\u30c7\u30a3\u30bf\u306e\u62ec\u5f27\u5bfe\u5fdc\u6a5f\u80fd\u3092\u4f7f\u3048\u3070\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002</p> <p>\u307e\u305f\u3001Qi\u306b\u306f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u304c\u3042\u308b\u306e\u3067\u3001\u62ec\u5f27\u3092\u6e1b\u3089\u305b\u307e\u3059\uff1a</p> <pre><code>;; \u62ec\u5f27\u304c\u591a\u3044\n(reduce + 0 (filter (fn [x] (&gt; x 5)) (map (fn [x] (* x 2)) [1 2 3 4 5 6 7 8 9 10])))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u30b9\u30c3\u30ad\u30ea\n([1 2 3 4 5 6 7 8 9 10]\n |&gt; (map (fn [x] (* x 2)))\n |&gt; (filter (fn [x] (&gt; x 5)))\n |&gt; (reduce + 0))\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#q_1","title":"Q: \u306a\u305c <code>+</code> \u304c\u524d\u306b\u3042\u308b\u306e\u3067\u3059\u304b\uff1f","text":"<p>A: \u3053\u308c\u3092\u524d\u7f6e\u8a18\u6cd5\uff08prefix notation\uff09\u3068\u8a00\u3044\u307e\u3059\u3002\u30e1\u30ea\u30c3\u30c8\u306f\uff1a</p> <ol> <li>\u8907\u6570\u306e\u5f15\u6570\u3092\u81ea\u7136\u306b\u66f8\u3051\u308b: <code>(+ 1 2 3 4 5)</code></li> <li>\u512a\u5148\u9806\u4f4d\u304c\u660e\u78ba: \u62ec\u5f27\u3067\u56f2\u307e\u308c\u3066\u3044\u308b\u306e\u3067</li> <li>\u4e00\u8cab\u6027: \u95a2\u6570\u3082\u6f14\u7b97\u5b50\u3082\u540c\u3058\u30eb\u30fc\u30eb</li> </ol>"},{"location":"ja/tutorial/00-lisp-basics/#q_2","title":"Q: \u30ab\u30f3\u30de\u306f\u3069\u3053\u3067\u3059\u304b\uff1f","text":"<p>A: Lisp\u3067\u306f\u30ab\u30f3\u30de\u304c\u4e0d\u8981\u3067\u3059\u3002\u30b9\u30da\u30fc\u30b9\u3067\u5341\u5206\u3067\u3059\u3002</p> <pre><code>;; \u2713 OK\n(max 10 5 8)\n\n;; \u2717 \u30ab\u30f3\u30de\u306f\u66f8\u304b\u306a\u3044\n(max 10, 5, 8)  ;; \u30a8\u30e9\u30fc\u3067\u306f\u306a\u3044\u304c\u3001\u30ab\u30f3\u30de\u304c\u5909\u6570\u540d\u3068\u3057\u3066\u89e3\u91c8\u3055\u308c\u308b\n</code></pre>"},{"location":"ja/tutorial/00-lisp-basics/#_19","title":"\u307e\u3068\u3081","text":"<p>Lisp\u7cfb\u8a00\u8a9e\u306e\u57fa\u672c\u3092\u7406\u89e3\u3057\u307e\u3057\u305f\uff1a</p> <ul> <li>\u2705 \u62ec\u5f27\u3067\u5f0f\u3092\u56f2\u3080: <code>(\u95a2\u6570 \u5f15\u6570...)</code></li> <li>\u2705 \u524d\u7f6e\u8a18\u6cd5: \u6f14\u7b97\u5b50\u304c\u5148\u982d</li> <li>\u2705 \u30cd\u30b9\u30c8: \u62ec\u5f27\u306e\u4e2d\u306b\u62ec\u5f27</li> <li>\u2705 \u4e00\u8cab\u6027: \u3059\u3079\u3066\u540c\u3058\u30d1\u30bf\u30fc\u30f3</li> <li>\u2705 \u30ab\u30f3\u30de\u4e0d\u8981: \u30b9\u30da\u30fc\u30b9\u3067\u533a\u5207\u308b</li> </ul> <p>\u6163\u308c\u308b\u3068\u3001\u3053\u306e\u4e00\u8cab\u6027\u304c\u5fc3\u5730\u3088\u304f\u306a\u308a\u307e\u3059\uff01</p>"},{"location":"ja/tutorial/00-lisp-basics/#_20","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Lisp\u7cfb\u8a00\u8a9e\u306e\u57fa\u672c\u3092\u7406\u89e3\u3057\u305f\u3089\u3001Qi\u3092\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <p>\u27a1\ufe0f \u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb: Qi\u3092\u306f\u3058\u3081\u3088\u3046</p>"},{"location":"ja/tutorial/00-lisp-basics/#lisp_2","title":"\u53c2\u8003: \u4ed6\u306eLisp\u7cfb\u8a00\u8a9e","text":"<p>\u8208\u5473\u304c\u3042\u308c\u3070\u3001\u4ed6\u306eLisp\u7cfb\u8a00\u8a9e\u3082\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff1a</p> <ul> <li>Clojure - JVM\u4e0a\u3067\u52d5\u304f\u30e2\u30c0\u30f3\u306aLisp\u3001Web\u958b\u767a\u306b\u4eba\u6c17</li> <li>Racket - \u6559\u80b2\u5411\u3051\u306b\u8a2d\u8a08\u3055\u308c\u305fLisp\u3001\u512a\u308c\u305f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Common Lisp - \u53e4\u5178\u7684\u306aLisp\u3001\u5f37\u529b\u3060\u304c\u5b66\u7fd2\u66f2\u7dda\u304c\u6025</li> <li>Scheme - \u30b7\u30f3\u30d7\u30eb\u3067\u7f8e\u3057\u3044Lisp\u3001\u5b66\u8853\u7684\u306b\u4eba\u6c17</li> </ul> <p>Qi\u306f\u3053\u308c\u3089\u306eLisp\u304b\u3089\u5f71\u97ff\u3092\u53d7\u3051\u3064\u3064\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u4e26\u884c\u51e6\u7406\u306b\u7279\u5316\u3057\u305f\u72ec\u81ea\u306e\u9032\u5316\u3092\u9042\u3052\u3066\u3044\u307e\u3059\u3002</p> <p>Happy Lisping with Qi! \ud83d\ude80</p>"},{"location":"ja/tutorial/01-getting-started/","title":"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb: Qi\u3092\u306f\u3058\u3081\u3088\u3046","text":"<p>\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001Qi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\u304b\u3089\u5b9f\u884c\u307e\u3067\u3001\u5b9f\u969b\u306b\u624b\u3092\u52d5\u304b\u3057\u306a\u304c\u3089\u5b66\u3093\u3067\u3044\u304d\u307e\u3059\u3002</p> <p>\ud83d\udcda Lisp\u7cfb\u8a00\u8a9e\u304c\u521d\u3081\u3066\u306e\u65b9\u3078 Qi\u306fLisp\u7cfb\u8a00\u8a9e\u3067\u3059\u3002\u62ec\u5f27\u306e\u66f8\u304d\u65b9\u306b\u6163\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001\u307e\u305a\u4ee5\u4e0b\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\uff1a \u27a1\ufe0f Lisp\u7cfb\u8a00\u8a9e\u306e\u57fa\u790e - \u62ec\u5f27\u306e\u8aad\u307f\u65b9\u30fb\u57fa\u672c\u7684\u306a\u8003\u3048\u65b9\uff085\u5206\u3067\u8aad\u3081\u307e\u3059\uff09</p>"},{"location":"ja/tutorial/01-getting-started/#_1","title":"\u76ee\u6b21","text":"<ul> <li>\u74b0\u5883\u306e\u78ba\u8a8d</li> <li>\u306f\u3058\u3081\u3066\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8</li> <li>\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u308b</li> <li>HTTP\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u308b</li> <li>REPL\u3067\u8a66\u3059</li> <li>\u6b21\u306e\u30b9\u30c6\u30c3\u30d7</li> </ul>"},{"location":"ja/tutorial/01-getting-started/#_2","title":"\u74b0\u5883\u306e\u78ba\u8a8d","text":"<p>\u307e\u305a\u3001Qi\u304c\u6b63\u3057\u304f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002</p> <pre><code>qi --version\n</code></pre> <p>\u30d0\u30fc\u30b8\u30e7\u30f3\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3067\u3059\u3002</p> <pre><code>Qi Programming Language v0.1.0\n</code></pre> <p>\u30d8\u30eb\u30d7\u3082\u898b\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>qi --help\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_3","title":"\u306f\u3058\u3081\u3066\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8","text":""},{"location":"ja/tutorial/01-getting-started/#_4","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210","text":"<p>`qi new`\u30b3\u30de\u30f3\u30c9\u3067\u65b0\u3057\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>qi new hello-qi\n</code></pre> <p>\u3044\u304f\u3064\u304b\u306e\u8cea\u554f\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002Enter\u30ad\u30fc\u3092\u62bc\u3059\u3068\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002</p> <pre><code>\u65b0\u3057\u3044Qi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d [hello-qi]:\n\u30d0\u30fc\u30b8\u30e7\u30f3 [0.1.0]:\n\u8aac\u660e (\u7701\u7565\u53ef): My first Qi project\n\u8457\u8005\u540d (\u7701\u7565\u53ef): Your Name\n\u30e9\u30a4\u30bb\u30f3\u30b9 [MIT]:\n\n\u65b0\u3057\u3044Qi\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f: hello-qi\n\n\u6b21\u306e\u30b9\u30c6\u30c3\u30d7:\n  cd hello-qi\n  qi main.qi\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_5","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u9020","text":"<p>\u4f5c\u6210\u3055\u308c\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>cd hello-qi\nls -la\n</code></pre> <p>\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u3059\uff1a</p> <pre><code>hello-qi/\n\u251c\u2500\u2500 qi.toml         # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n\u251c\u2500\u2500 main.qi         # \u30e1\u30a4\u30f3\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 src/            # \u30e9\u30a4\u30d6\u30e9\u30ea\u30b3\u30fc\u30c9\n\u2502   \u2514\u2500\u2500 lib.qi\n\u251c\u2500\u2500 examples/       # \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u2514\u2500\u2500 example.qi\n\u2514\u2500\u2500 tests/          # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n    \u2514\u2500\u2500 test.qi\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#qitoml","title":"qi.toml\u3092\u898b\u3066\u307f\u308b","text":"<p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>cat qi.toml\n</code></pre> <pre><code>[project]\nname = \"hello-qi\"\nversion = \"0.1.0\"\ndescription = \"My first Qi project\"\nauthors = [\"Your Name\"]\nlicense = \"MIT\"\nqi-version = \"0.1.0\"\n\n[dependencies]\n\n[features]\ndefault = []\n</code></pre> <p>\u3053\u308c\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3067\u3059\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/01-getting-started/#_6","title":"\u5b9f\u884c\u3057\u3066\u307f\u308b","text":"<p>\u3055\u3063\u305d\u304f\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>qi main.qi\n</code></pre> <p>\u51fa\u529b\uff1a <pre><code>Hello, Qi!\n\u3053\u3093\u306b\u3061\u306f\u3001hello-qi\u3055\u3093\uff01\nVector([Integer(16), Integer(25)])\n</code></pre></p> <p>\u6210\u529f\u3067\u3059\uff01\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u751f\u6210\u3057\u305f\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f\u3002</p>"},{"location":"ja/tutorial/01-getting-started/#_7","title":"\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u308b","text":""},{"location":"ja/tutorial/01-getting-started/#mainqi","title":"main.qi\u3092\u7de8\u96c6","text":"<p>`main.qi`\u3092\u958b\u3044\u3066\u3001\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>;; main.qi - \u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\n\n(println \"Hello, Qi!\")\n\n;; \u6328\u62f6\u95a2\u6570\n(defn greet [name]\n  (str \"\u3053\u3093\u306b\u3061\u306f\u3001\" name \"\u3055\u3093\uff01\"))\n\n;; \u95a2\u6570\u3092\u4f7f\u7528\n(println (greet \"hello-qi\"))\n\n;; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u4f8b\n(println ([1 2 3 4 5]\n          |&gt; (map (fn [x] (* x x)))\n          |&gt; (filter (fn [x] (&gt; x 10)))))\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_8","title":"\u81ea\u5206\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0","text":"<p>\u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5f8c\u306b\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>;; \u81ea\u5206\u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9\n(println \"\\n=== \u81ea\u5206\u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9 ===\")\n\n;; \u5076\u6570\u3092\u30d5\u30a3\u30eb\u30bf\u3057\u3066\u5408\u8a08\n(def numbers [1 2 3 4 5 6 7 8 9 10])\n(def sum-of-evens\n  (numbers\n   |&gt; (filter (fn [x] (= (% x 2) 0)))\n   |&gt; (reduce + 0)))\n\n(println f\"\u5076\u6570\u306e\u5408\u8a08: {sum-of-evens}\")\n\n;; \u30de\u30c3\u30d7\u306e\u30c7\u30fc\u30bf\u51e6\u7406\n(def users [\n  {:name \"Alice\" :age 30}\n  {:name \"Bob\" :age 25}\n  {:name \"Charlie\" :age 35}\n])\n\n(def adult-names\n  (users\n   |&gt; (filter (fn [u] (&gt;= (get u :age) 30)))\n   |&gt; (map (fn [u] (get u :name)))))\n\n(println f\"30\u6b73\u4ee5\u4e0a: {adult-names}\")\n</code></pre> <p>\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\uff1a</p> <pre><code>qi main.qi\n</code></pre> <p>\u51fa\u529b\uff1a <pre><code>...\n=== \u81ea\u5206\u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9 ===\n\u5076\u6570\u306e\u5408\u8a08: 30\n30\u6b73\u4ee5\u4e0a: Vector([String(\"Alice\"), String(\"Charlie\")])\n</code></pre></p>"},{"location":"ja/tutorial/01-getting-started/#qi_1","title":"Qi\u306e\u7279\u5fb4\u3092\u4f53\u9a13","text":"<p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 `|&gt;`: <pre><code>[1 2 3 4 5]\n|&gt; (map (fn [x] (* x 2)))\n|&gt; (filter (fn [x] (&gt; x 5)))\n|&gt; (reduce + 0)\n</code></pre></p> <p>\u30c7\u30fc\u30bf\u3092\u5de6\u304b\u3089\u53f3\u306b\u6d41\u3059\u3088\u3046\u306b\u66f8\u3051\u307e\u3059\uff01</p>"},{"location":"ja/tutorial/01-getting-started/#http","title":"HTTP\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u308b","text":"<p>\u6b21\u306f\u3001HTTP\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"ja/tutorial/01-getting-started/#_9","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210","text":"<p>`http-server`\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3044\u307e\u3059\uff1a</p> <pre><code>cd ..\nqi new myapi --template http-server\ncd myapi\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_10","title":"\u69cb\u9020\u3092\u78ba\u8a8d","text":"<pre><code>cat qi.toml\n</code></pre> <p>`[features]`\u306b\u6ce8\u76ee\uff1a <pre><code>[features]\ndefault = [\"http-server\", \"format-json\"]\n</code></pre></p> <p>HTTP\u6a5f\u80fd\u3068JSON\u6a5f\u80fd\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/01-getting-started/#_11","title":"\u30b5\u30fc\u30d0\u30fc\u30b3\u30fc\u30c9\u3092\u898b\u308b","text":"<pre><code>cat main.qi\n</code></pre> <pre><code>;; myapi - HTTP Server\n;;\n;; JSON API\u30b5\u30fc\u30d0\u30fc\n;; \u5b9f\u884c: qi main.qi\n\n(println \"=== myapi HTTP Server ===\")\n\n;; \u30eb\u30fc\u30c8\u30cf\u30f3\u30c9\u30e9\u30fc\n(defn handle-root [req]\n  (server/json {:message \"Welcome to myapi!\"\n                :version \"0.1.0\"\n                :endpoints [\"/api/hello\" \"/api/users\"]}))\n\n;; Hello API\u30cf\u30f3\u30c9\u30e9\u30fc\n(defn handle-hello [req]\n  (let [name (get (get req :params) \"name\" \"World\")]\n    (server/json {:message (str \"Hello, \" name \"!\")})))\n\n;; Users API\u30cf\u30f3\u30c9\u30e9\u30fc\n(defn handle-users [req]\n  (server/json {:users [{:id 1 :name \"Alice\"}\n                        {:id 2 :name \"Bob\"}\n                        {:id 3 :name \"Charlie\"}]}))\n\n;; \u30e1\u30a4\u30f3\u30cf\u30f3\u30c9\u30e9\u30fc\uff08\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\uff09\n(defn handler [req]\n  (let [path (get req :path)]\n    (match path\n      \"/\" -&gt; (handle-root req)\n      \"/api/hello\" -&gt; (handle-hello req)\n      \"/api/users\" -&gt; (handle-users req)\n      _ -&gt; (server/json {:error \"Not Found\"} 404))))\n\n;; \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\n(def port 3000)\n(println f\"Starting server on http://localhost:{port}\")\n(println \"Press Ctrl+C to stop\")\n\n(server/serve port handler)\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_12","title":"\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5","text":"<pre><code>qi main.qi\n</code></pre> <p>\u51fa\u529b\uff1a <pre><code>=== myapi HTTP Server ===\nStarting server on http://localhost:3000\nPress Ctrl+C to stop\nListening on http://0.0.0.0:3000\n</code></pre></p>"},{"location":"ja/tutorial/01-getting-started/#api","title":"API\u3092\u30c6\u30b9\u30c8","text":"<p>\u5225\u306e\u30bf\u30fc\u30df\u30ca\u30eb\u3067\uff1a</p> <pre><code># \u30eb\u30fc\u30c8\ncurl http://localhost:3000/\n\n# Hello API\ncurl http://localhost:3000/api/hello\ncurl http://localhost:3000/api/hello?name=Alice\n\n# Users API\ncurl http://localhost:3000/api/users\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_13","title":"\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u307f\u308b","text":"<p>`main.qi`\u306b\u65b0\u3057\u3044\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff1a</p> <pre><code>;; Status API\u30cf\u30f3\u30c9\u30e9\u30fc\uff08\u8ffd\u52a0\uff09\n(defn handle-status [req]\n  (server/json {:status \"ok\"\n                :uptime 123\n                :version \"0.1.0\"}))\n\n;; handler\u306b\u8ffd\u52a0\n(defn handler [req]\n  (let [path (get req :path)]\n    (match path\n      \"/\" -&gt; (handle-root req)\n      \"/api/hello\" -&gt; (handle-hello req)\n      \"/api/users\" -&gt; (handle-users req)\n      \"/api/status\" -&gt; (handle-status req)  ; \u8ffd\u52a0\n      _ -&gt; (server/json {:error \"Not Found\"} 404))))\n</code></pre> <p>\u30b5\u30fc\u30d0\u30fc\u3092\u518d\u8d77\u52d5\uff08Ctrl+C\u3067\u505c\u6b62\u3057\u3066\u518d\u5b9f\u884c\uff09\u3057\u3066\u3001\u30c6\u30b9\u30c8\uff1a</p> <pre><code>curl http://localhost:3000/api/status\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#repl","title":"REPL\u3067\u8a66\u3059","text":""},{"location":"ja/tutorial/01-getting-started/#repl_1","title":"REPL\u3092\u8d77\u52d5","text":"<pre><code>qi\n</code></pre> <pre><code>Qi Programming Language v0.1.0\nPress Ctrl+C to interrupt, Ctrl+D to exit\nType :help for available commands\n\nqi:1&gt;\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_14","title":"\u57fa\u672c\u7684\u306a\u8a08\u7b97","text":"<pre><code>qi:1&gt; (+ 1 2 3)\n6\n\nqi:2&gt; (* 2 (+ 3 4))\n14\n\nqi:3&gt; (/ 10 3)\n3\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_15","title":"\u5909\u6570\u3068\u95a2\u6570\u3092\u5b9a\u7fa9","text":"<pre><code>qi:4&gt; (def x 10)\n10\n\nqi:5&gt; (defn square [n] (* n n))\nFunction(square)\n\nqi:6&gt; (square x)\n100\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_16","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u8a66\u3059","text":"<pre><code>qi:7&gt; ([1 2 3 4 5] |&gt; (map (fn [x] (* x 2))))\nVector([Integer(2), Integer(4), Integer(6), Integer(8), Integer(10)])\n\nqi:8&gt; ([1 2 3 4 5]\n        |&gt; (map (fn [x] (* x 2)))\n        |&gt; (filter (fn [x] (&gt; x 5)))\n        |&gt; (reduce + 0))\n30\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#repl_2","title":"REPL\u30b3\u30de\u30f3\u30c9","text":"<pre><code>qi:9&gt; :help\n\u5229\u7528\u53ef\u80fd\u306a\u30b3\u30de\u30f3\u30c9:\n  :help                    \u30d8\u30eb\u30d7\u3092\u8868\u793a\n  :doc &lt;name&gt;              Show documentation for a function\n  :vars                    \u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5909\u6570\u3092\u8868\u793a\n  ...\n\nqi:10&gt; :vars\n\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5909\u6570:\n  x\n\nqi:11&gt; :funcs\n\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u95a2\u6570:\n  square\n\nqi:12&gt; :doc map\n(\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u8868\u793a\u3055\u308c\u307e\u3059)\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_17","title":"\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9","text":"<pre><code>qi:13&gt; :load src/lib.qi\nLoading src/lib.qi...\nLoaded\n\nqi:14&gt; (greet \"REPL\")\n\"\u3053\u3093\u306b\u3061\u306f\u3001REPL\u3055\u3093\uff01\"\n</code></pre>"},{"location":"ja/tutorial/01-getting-started/#_18","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\uff01\u3053\u308c\u3067Qi\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u3092\u30de\u30b9\u30bf\u30fc\u3057\u307e\u3057\u305f\u3002</p>"},{"location":"ja/tutorial/01-getting-started/#_19","title":"\u3055\u3089\u306b\u5b66\u3076","text":"<ul> <li>\u8a00\u8a9e\u4ed5\u69d8 - Qi\u8a00\u8a9e\u306e\u5168\u6a5f\u80fd\u3092\u5b66\u3076</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 - `|&gt;`, `|&gt;?`, `||&gt;`, `~&gt;`</li> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406 - `go`, `chan`</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 - `match`\u5f0f</li> <li> <p>\u30a8\u30e9\u30fc\u51e6\u7406 - `try`, `defer`</p> </li> <li> <p>\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea - 60\u4ee5\u4e0a\u306e\u7d44\u307f\u8fbc\u307f\u95a2\u6570</p> </li> <li>\u6587\u5b57\u5217\u64cd\u4f5c</li> <li>HTTP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8/\u30b5\u30fc\u30d0\u30fc</li> <li>JSON/YAML\u51e6\u7406</li> <li> <p>\u30d5\u30a1\u30a4\u30ebI/O</p> </li> <li> <p>CLI\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 - `qi`\u30b3\u30de\u30f3\u30c9\u306e\u8a73\u7d30</p> </li> <li> <p>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u7ba1\u7406 - qi.toml\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3001\u30ab\u30b9\u30bf\u30de\u30a4\u30ba</p> </li> </ul>"},{"location":"ja/tutorial/01-getting-started/#_20","title":"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30a2\u30a4\u30c7\u30a2","text":"<ul> <li>CLI\u30c4\u30fc\u30eb: \u30d5\u30a1\u30a4\u30eb\u51e6\u7406\u3001\u30c7\u30fc\u30bf\u5909\u63db</li> <li>WebAPI: RESTful API\u3001\u30de\u30a4\u30af\u30ed\u30b5\u30fc\u30d3\u30b9</li> <li>\u30c7\u30fc\u30bf\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: \u30ed\u30b0\u89e3\u6790\u3001ETL\u51e6\u7406</li> <li>\u81ea\u52d5\u5316\u30b9\u30af\u30ea\u30d7\u30c8: \u30bf\u30b9\u30af\u81ea\u52d5\u5316\u3001\u30d0\u30c3\u30c1\u51e6\u7406</li> </ul>"},{"location":"ja/tutorial/01-getting-started/#_21","title":"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3","text":"<ul> <li>GitHub\u30ea\u30dd\u30b8\u30c8\u30ea - Issue\u5831\u544a\u3001PR\u6b53\u8fce\uff01</li> <li>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u6539\u5584\u63d0\u6848\u3082\u5927\u6b53\u8fce\u3067\u3059</li> </ul> <p>Happy coding with Qi! \ud83d\ude80</p>"},{"location":"ja/tutorial/02-pipelines/","title":"\u7b2c2\u7ae0: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u8003\u3048\u308b","text":"<p>\u6240\u8981\u6642\u9593: 20\u5206</p> <p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306f\u3001Qi\u306e\u6700\u3082\u5f37\u529b\u306a\u6a5f\u80fd\u306e\u4e00\u3064\u3067\u3059\u3002\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u76f4\u611f\u7684\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/02-pipelines/#_1","title":"\u306a\u305c\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u304b\uff1f","text":"<p>\u5f93\u6765\u306e\u30cd\u30b9\u30c8\u3057\u305f\u95a2\u6570\u547c\u3073\u51fa\u3057\u306f\u3001\u8aad\u307f\u306b\u304f\u304f\u306a\u308a\u304c\u3061\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/02-pipelines/#_2","title":"\u30cd\u30b9\u30c8\u3057\u305f\u66f8\u304d\u65b9\uff08\u8aad\u307f\u306b\u304f\u3044\uff09","text":"<pre><code>(str/upper (str/reverse (str/trim \"  hello  \")))\n; =&gt; \"OLLEH\"\n</code></pre> <p>\u5185\u5074\u304b\u3089\u5916\u5074\u3078\u8aad\u3080\u5fc5\u8981\u304c\u3042\u308a\u3001\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u304c\u5206\u304b\u308a\u306b\u304f\u3044\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/02-pipelines/#_3","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u66f8\u304f\uff08\u8aad\u307f\u3084\u3059\u3044\uff09","text":"<pre><code>(\"  hello  \"\n |&gt; str/trim\n |&gt; str/reverse\n |&gt; str/upper)\n; =&gt; \"OLLEH\"\n</code></pre> <p>\u30c7\u30fc\u30bf\u304c\u5de6\u304b\u3089\u53f3\u306b\u6d41\u308c\u308b\u306e\u3067\u3001\u51e6\u7406\u306e\u9806\u5e8f\u304c\u4e00\u76ee\u77ad\u7136\u3067\u3059\uff01</p>"},{"location":"ja/tutorial/02-pipelines/#_4","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 <code>|&gt;</code>","text":"<p><code>|&gt;</code>\u306f\u3001\u5de6\u306e\u5024\u3092\u53f3\u306e\u95a2\u6570\u306b\u6e21\u3057\u307e\u3059\u3002</p> <pre><code>qi&gt; (10 |&gt; inc)\n; =&gt; 11\n\nqi&gt; (5 |&gt; (* 2))\n; =&gt; 10\n\nqi&gt; (5 |&gt; (fn [x] (* x 2)))\n; =&gt; 10\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#1","title":"\u5b9f\u7528\u4f8b1: \u6570\u5024\u51e6\u7406","text":"<pre><code>qi&gt; (10\n     |&gt; (+ 5)        ; 10 + 5 = 15\n     |&gt; (* 2)        ; 15 * 2 = 30\n     |&gt; (- 10))      ; 30 - 10 = 20\n; =&gt; 20\n</code></pre> <p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c: <pre><code>10 \u2192 15 \u2192 30 \u2192 20\n</code></pre></p>"},{"location":"ja/tutorial/02-pipelines/#2_1","title":"\u5b9f\u7528\u4f8b2: \u6587\u5b57\u5217\u51e6\u7406","text":"<pre><code>qi&gt; (\"hello world\"\n     |&gt; str/upper        ; \"HELLO WORLD\"\n     |&gt; (str/replace \" \" \"-\")  ; \"HELLO-WORLD\"\n     |&gt; (str/concat \"!\"))      ; \"HELLO-WORLD!\"\n; =&gt; \"HELLO-WORLD!\"\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#3","title":"\u5b9f\u7528\u4f8b3: \u30ea\u30b9\u30c8\u51e6\u7406","text":"<pre><code>qi&gt; ([1 2 3 4 5 6 7 8 9 10]\n     |&gt; (filter even?)           ; [2 4 6 8 10]\n     |&gt; (map (fn [x] (* x x)))   ; [4 16 36 64 100]\n     |&gt; (reduce + 0))            ; 220\n; =&gt; 220\n</code></pre> <p>\u51e6\u7406\u306e\u6d41\u308c: 1. \u5076\u6570\u3060\u3051\u3092\u62bd\u51fa: <code>[2 4 6 8 10]</code> 2. \u5404\u8981\u7d20\u30922\u4e57: <code>[4 16 36 64 100]</code> 3. \u5168\u3066\u8db3\u3057\u7b97: <code>220</code></p>"},{"location":"ja/tutorial/02-pipelines/#tap","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u30c7\u30d0\u30c3\u30b0: <code>tap&gt;</code>","text":"<p><code>tap&gt;</code>\u306f\u3001\u30c7\u30fc\u30bf\u3092\u5909\u66f4\u305b\u305a\u306b\u526f\u4f5c\u7528\uff08print\u306a\u3069\uff09\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u30c7\u30d0\u30c3\u30b0\u306b\u4fbf\u5229\u3067\u3059\u3002</p> <pre><code>qi&gt; ([1 2 3 4 5]\n     |&gt; (tap println)              ; \u30c7\u30d0\u30c3\u30b0\u51fa\u529b\n     |&gt; (map (fn [x] (* x 2)))\n     |&gt; (tap println)              ; \u30c7\u30d0\u30c3\u30b0\u51fa\u529b\n     |&gt; (reduce + 0))\n; =&gt; \u51fa\u529b: [1 2 3 4 5]\n; =&gt; \u51fa\u529b: [2 4 6 8 10]\n; =&gt; 30\n</code></pre> <p><code>tap&gt;</code>\u3092\u4f7f\u3046\u3068\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u9014\u4e2d\u3067\u30c7\u30fc\u30bf\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/02-pipelines/#_5","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u95a2\u6570\u3092\u5b9a\u7fa9\u3059\u308b","text":"<p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u4f7f\u3063\u3066\u3001\u8aad\u307f\u3084\u3059\u3044\u95a2\u6570\u3092\u66f8\u3051\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/02-pipelines/#_6","title":"\u4f8b: \u30c6\u30ad\u30b9\u30c8\u6574\u5f62\u95a2\u6570","text":"<pre><code>(defn format-title [text]\n  (text\n   |&gt; str/trim\n   |&gt; str/lower\n   |&gt; (str/replace \" \" \"-\")\n   |&gt; (str/concat \"title-\")))\n\nqi&gt; (format-title \"  Hello World  \")\n; =&gt; \"title-hello-world\"\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#_7","title":"\u4f8b: \u30c7\u30fc\u30bf\u96c6\u8a08\u95a2\u6570","text":"<pre><code>(defn sum-of-squares [numbers]\n  (numbers\n   |&gt; (map (fn [x] (* x x)))\n   |&gt; (reduce + 0)))\n\nqi&gt; (sum-of-squares [1 2 3 4 5])\n; =&gt; 55  (1 + 4 + 9 + 16 + 25)\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#4-csv","title":"\u5b9f\u7528\u4f8b4: CSV\u30c7\u30fc\u30bf\u306e\u51e6\u7406\uff08\u6a21\u64ec\uff09","text":"<pre><code>(def csv-data\n  \"Alice,25,Engineer\nBob,30,Designer\nCarol,28,Manager\")\n\n(defn parse-csv-line [line]\n  (let [parts (str/split line \",\")]\n    {:name (first parts)\n     :age (nth parts 1)\n     :role (nth parts 2)}))\n\n(csv-data\n |&gt; (str/split \"\\n\")\n |&gt; (map parse-csv-line))\n; =&gt; [{:name \"Alice\" :age \"25\" :role \"Engineer\"}\n;     {:name \"Bob\" :age \"30\" :role \"Designer\"}\n;     {:name \"Carol\" :age \"28\" :role \"Manager\"}]\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#5","title":"\u5b9f\u7528\u4f8b5: \u7d71\u8a08\u51e6\u7406","text":"<pre><code>(defn analyze-scores [scores]\n  {:count (len scores)\n   :sum (reduce + 0 scores)\n   :average (/ (reduce + 0 scores) (len scores))\n   :max (reduce max 0 scores)\n   :min (reduce min 100 scores)})\n\n(def test-scores [85 92 78 90 88])\n\n(test-scores |&gt; analyze-scores)\n; =&gt; {:count 5 :sum 433 :average 86.6 :max 92 :min 78}\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#_8","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u5229\u70b9","text":""},{"location":"ja/tutorial/02-pipelines/#1_1","title":"1. \u8aad\u307f\u3084\u3059\u3044","text":"<p>\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u304c\u4e00\u76ee\u77ad\u7136\uff1a</p> <pre><code>; \u274c \u8aad\u307f\u306b\u304f\u3044\n(reduce + 0 (map (fn [x] (* x x)) (filter even? [1 2 3 4 5 6])))\n\n; \u2705 \u8aad\u307f\u3084\u3059\u3044\n([1 2 3 4 5 6]\n |&gt; (filter even?)\n |&gt; (map (fn [x] (* x x)))\n |&gt; (reduce + 0))\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#2_2","title":"2. \u30c7\u30d0\u30c3\u30b0\u3057\u3084\u3059\u3044","text":"<p><code>tap&gt;</code>\u3067\u9014\u4e2d\u7d4c\u904e\u3092\u78ba\u8a8d\uff1a</p> <pre><code>([1 2 3 4 5 6]\n |&gt; (filter even?)\n |&gt; (tap println)  ; \u2190 \u3053\u3053\u3067\u78ba\u8a8d\n |&gt; (map (fn [x] (* x x)))\n |&gt; (tap println)  ; \u2190 \u3053\u3053\u3067\u78ba\u8a8d\n |&gt; (reduce + 0))\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#3_1","title":"3. \u62e1\u5f35\u3057\u3084\u3059\u3044","text":"<p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u9014\u4e2d\u306b\u51e6\u7406\u3092\u8ffd\u52a0\u3059\u308b\u306e\u304c\u7c21\u5358\uff1a</p> <pre><code>(data\n |&gt; step1\n |&gt; step2\n |&gt; new-step  ; \u2190 \u7c21\u5358\u306b\u8ffd\u52a0\n |&gt; step3)\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#_9","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u95a2\u6570\u5408\u6210","text":"<p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306f\u3001\u8907\u6570\u306e\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u65b0\u3057\u3044\u95a2\u6570\u3092\u4f5c\u308a\u307e\u3059\u3002</p> <pre><code>(defn double [x] (* x 2))\n(defn add-ten [x] (+ x 10))\n(defn square [x] (* x x))\n\n; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u5408\u6210\n(defn transform [x]\n  (x\n   |&gt; double\n   |&gt; add-ten\n   |&gt; square))\n\nqi&gt; (transform 5)\n; =&gt; 400  ((5 * 2 + 10) ^ 2 = 20 ^ 2 = 400)\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#_10","title":"\u7df4\u7fd2\u554f\u984c","text":""},{"location":"ja/tutorial/02-pipelines/#1-url","title":"\u554f\u984c1: URL\u30b9\u30e9\u30c3\u30b0\u751f\u6210","text":"<p>\u30d6\u30ed\u30b0\u306e\u30bf\u30a4\u30c8\u30eb\u304b\u3089URL\u7528\u306e\u30b9\u30e9\u30c3\u30b0\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn make-slug [title]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  ; \u30d2\u30f3\u30c8: str/trim, str/lower, (str/replace \" \" \"-\") \u3092\u4f7f\u3046\n  )\n\n; \u30c6\u30b9\u30c8\n(make-slug \"  Hello World  \")  ; =&gt; \"hello-world\"\n(make-slug \"Qi Programming Language\")  ; =&gt; \"qi-programming-language\"\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn make-slug [title]\n  (title\n   |&gt; str/trim\n   |&gt; str/lower\n   |&gt; (str/replace \" \" \"-\")))\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#2-2","title":"\u554f\u984c2: \u5076\u6570\u306e2\u4e57\u306e\u5408\u8a08","text":"<p>\u30ea\u30b9\u30c8\u304b\u3089\u5076\u6570\u3060\u3051\u3092\u53d6\u308a\u51fa\u3057\u3001\u305d\u308c\u305e\u308c\u30922\u4e57\u3057\u3066\u3001\u5168\u3066\u8db3\u3057\u7b97\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn sum-even-squares [numbers]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(sum-even-squares [1 2 3 4 5 6])  ; =&gt; 56  (4 + 16 + 36)\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn sum-even-squares [numbers]\n  (numbers\n   |&gt; (filter even?)\n   |&gt; (map (fn [x] (* x x)))\n   |&gt; (reduce + 0)))\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#3_2","title":"\u554f\u984c3: \u540d\u524d\u30ea\u30b9\u30c8\u306e\u6574\u5f62","text":"<p>\u540d\u524d\u306e\u30ea\u30b9\u30c8\u3092\u53d7\u3051\u53d6\u308a\u3001\u3059\u3079\u3066\u5927\u6587\u5b57\u306b\u3057\u3066\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u9806\u306b\u30bd\u30fc\u30c8\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn format-names [names]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(format-names [\"charlie\" \"alice\" \"bob\"])\n; =&gt; [\"ALICE\" \"BOB\" \"CHARLIE\"]\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn format-names [names]\n  (names\n   |&gt; (map str/upper)\n   |&gt; sort))\n</code></pre>"},{"location":"ja/tutorial/02-pipelines/#_11","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068\uff1a</p> <ul> <li>\u2705 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 <code>|&gt;</code> \u306e\u4f7f\u3044\u65b9</li> <li>\u2705 \u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u8a2d\u8a08\u3059\u308b\u8003\u3048\u65b9</li> <li>\u2705 <code>tap&gt;</code>\u3067\u30c7\u30d0\u30c3\u30b0\u3059\u308b\u65b9\u6cd5</li> <li>\u2705 \u5b9f\u7528\u7684\u306a\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u4f8b\uff08\u6587\u5b57\u5217\u3001\u6570\u5024\u3001\u30ea\u30b9\u30c8\uff09</li> <li>\u2705 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068\u95a2\u6570\u5408\u6210</li> </ul>"},{"location":"ja/tutorial/02-pipelines/#_12","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u81ea\u7531\u306b\u6271\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3089\u3001\u6b21\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3057\u3087\u3046\uff01</p> <p>\u27a1\ufe0f \u7b2c3\u7ae0: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u30de\u30b9\u30bf\u30fc\u3059\u308b</p> <p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306f\u3001\u30c7\u30fc\u30bf\u306e\u69cb\u9020\u306b\u5fdc\u3058\u3066\u51e6\u7406\u3092\u5206\u5c90\u3059\u308b\u5f37\u529b\u306a\u6a5f\u80fd\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/03-pattern-matching/","title":"\u7b2c3\u7ae0: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u30de\u30b9\u30bf\u30fc\u3059\u308b","text":"<p>\u6240\u8981\u6642\u9593: 25\u5206</p> <p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306f\u3001\u30c7\u30fc\u30bf\u306e\u69cb\u9020\u306b\u5fdc\u3058\u3066\u51e6\u7406\u3092\u5206\u5c90\u3059\u308b\u5f37\u529b\u306a\u6a5f\u80fd\u3067\u3059\u3002<code>if</code>\u3092\u4f55\u91cd\u306b\u3082\u30cd\u30b9\u30c8\u3059\u308b\u3088\u308a\u3001\u306f\u308b\u304b\u306b\u8aad\u307f\u3084\u3059\u304f\u4fdd\u5b88\u3057\u3084\u3059\u3044\u30b3\u30fc\u30c9\u304c\u66f8\u3051\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/03-pattern-matching/#match","title":"<code>match</code>\u5f0f\u306e\u57fa\u672c","text":"<p><code>match</code>\u306f\u3001\u5024\u3092\u30d1\u30bf\u30fc\u30f3\u3068\u7167\u5408\u3057\u3066\u3001\u30de\u30c3\u30c1\u3057\u305f\u3082\u306e\u306e\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>(match value\n  pattern1 -&gt; result1\n  pattern2 -&gt; result2\n  _ -&gt; default)\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_1","title":"\u4f8b: \u30b7\u30f3\u30d7\u30eb\u306a\u30de\u30c3\u30c1\u30f3\u30b0","text":"<pre><code>qi&gt; (match 42\n      42 -&gt; \"The answer!\"\n      _ -&gt; \"Something else\")\n; =&gt; \"The answer!\"\n\nqi&gt; (match \"hello\"\n      \"hello\" -&gt; \"Hi!\"\n      \"bye\" -&gt; \"Goodbye!\"\n      _ -&gt; \"Unknown\")\n; =&gt; \"Hi!\"\n</code></pre> <p>\u30dd\u30a4\u30f3\u30c8: <code>_</code>\u306f\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4f55\u306b\u3067\u3082\u30de\u30c3\u30c1\uff09\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/03-pattern-matching/#_2","title":"\u30ea\u30b9\u30c8\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u30ea\u30b9\u30c8\u3092\u5206\u89e3\u3057\u3066\u3001\u6700\u521d\u306e\u8981\u7d20\u3084\u6b8b\u308a\u306e\u8981\u7d20\u3092\u53d6\u308a\u51fa\u305b\u307e\u3059\u3002</p> <pre><code>qi&gt; (match [1 2 3]\n      [] -&gt; \"Empty\"\n      [x] -&gt; f\"Single: {x}\"\n      [first second] -&gt; f\"Pair: {first}, {second}\"\n      [a b c] -&gt; f\"Three: {a}, {b}, {c}\")\n; =&gt; \"Three: 1, 2, 3\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#firstrest","title":"first/rest \u30d1\u30bf\u30fc\u30f3","text":"<pre><code>qi&gt; (defn describe-list [lst]\n      (match lst\n        [] -&gt; \"Empty list\"\n        [x] -&gt; f\"Single element: {x}\"\n        [first &amp; rest] -&gt; f\"First: {first}, Rest: {rest}\"))\n\nqi&gt; (describe-list [])\n; =&gt; \"Empty list\"\n\nqi&gt; (describe-list [10])\n; =&gt; \"Single element: 10\"\n\nqi&gt; (describe-list [1 2 3 4 5])\n; =&gt; \"First: 1, Rest: [2 3 4 5]\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_3","title":"\u30de\u30c3\u30d7\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u30de\u30c3\u30d7\u306e\u69cb\u9020\u3092\u5206\u89e3\u3057\u3066\u3001\u5024\u3092\u53d6\u308a\u51fa\u305b\u307e\u3059\u3002</p> <pre><code>qi&gt; (def person {:name \"Alice\" :age 25 :city \"Tokyo\"})\n\nqi&gt; (match person\n      {:name n :age a} -&gt; f\"{n} is {a} years old\")\n; =&gt; \"Alice is 25 years old\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#http","title":"\u5b9f\u7528\u4f8b: HTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u51e6\u7406","text":"<pre><code>(defn handle-response [resp]\n  (match resp\n    {:status 200 :body body} -&gt; f\"Success: {body}\"\n    {:status 404} -&gt; \"Not Found\"\n    {:status 500 :message msg} -&gt; f\"Server Error: {msg}\"\n    _ -&gt; \"Unknown response\"))\n\nqi&gt; (handle-response {:status 200 :body \"OK\"})\n; =&gt; \"Success: OK\"\n\nqi&gt; (handle-response {:status 404})\n; =&gt; \"Not Found\"\n\nqi&gt; (handle-response {:status 500 :message \"Database error\"})\n; =&gt; \"Server Error: Database error\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_4","title":"\u30ac\u30fc\u30c9\u6761\u4ef6","text":"<p><code>when</code>\u3092\u4f7f\u3063\u3066\u3001\u30d1\u30bf\u30fc\u30f3\u306b\u6761\u4ef6\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>(defn classify-number [n]\n  (match n\n    x when (&gt; x 0) -&gt; \"Positive\"\n    x when (&lt; x 0) -&gt; \"Negative\"\n    _ -&gt; \"Zero\"))\n\nqi&gt; (classify-number 10)\n; =&gt; \"Positive\"\n\nqi&gt; (classify-number -5)\n; =&gt; \"Negative\"\n\nqi&gt; (classify-number 0)\n; =&gt; \"Zero\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_5","title":"\u8907\u96d1\u306a\u30ac\u30fc\u30c9","text":"<pre><code>(defn describe-age [age]\n  (match age\n    n when (&lt; n 13) -&gt; \"Child\"\n    n when (and (&gt;= n 13) (&lt; n 20)) -&gt; \"Teenager\"\n    n when (and (&gt;= n 20) (&lt; n 65)) -&gt; \"Adult\"\n    _ -&gt; \"Senior\"))\n\nqi&gt; (describe-age 10)\n; =&gt; \"Child\"\n\nqi&gt; (describe-age 15)\n; =&gt; \"Teenager\"\n\nqi&gt; (describe-age 30)\n; =&gt; \"Adult\"\n\nqi&gt; (describe-age 70)\n; =&gt; \"Senior\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#or","title":"or\u30d1\u30bf\u30fc\u30f3","text":"<p>\u8907\u6570\u306e\u30d1\u30bf\u30fc\u30f3\u3092\u307e\u3068\u3081\u3066\u6271\u3048\u307e\u3059\uff08<code>|</code>\u3067\u533a\u5207\u308b\uff09\u3002</p> <pre><code>(defn weekday-or-weekend [day]\n  (match day\n    \"Monday\" | \"Tuesday\" | \"Wednesday\" | \"Thursday\" | \"Friday\" -&gt; \"Weekday\"\n    \"Saturday\" | \"Sunday\" -&gt; \"Weekend\"\n    _ -&gt; \"Unknown\"))\n\nqi&gt; (weekday-or-weekend \"Monday\")\n; =&gt; \"Weekday\"\n\nqi&gt; (weekday-or-weekend \"Saturday\")\n; =&gt; \"Weekend\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#1","title":"\u5b9f\u7528\u4f8b1: \u30b3\u30de\u30f3\u30c9\u51e6\u7406","text":"<pre><code>(defn handle-command [cmd]\n  (match cmd\n    {:type \"add\" :a a :b b} -&gt; (+ a b)\n    {:type \"sub\" :a a :b b} -&gt; (- a b)\n    {:type \"mul\" :a a :b b} -&gt; (* a b)\n    {:type \"div\" :a a :b b} -&gt; (/ a b)\n    _ -&gt; {:error \"Unknown command\"}))\n\nqi&gt; (handle-command {:type \"add\" :a 10 :b 20})\n; =&gt; 30\n\nqi&gt; (handle-command {:type \"mul\" :a 5 :b 6})\n; =&gt; 30\n\nqi&gt; (handle-command {:type \"unknown\"})\n; =&gt; {:error \"Unknown command\"}\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#2","title":"\u5b9f\u7528\u4f8b2: \u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3","text":"<pre><code>(defn process-state [state event]\n  (match [state event]\n    [\"idle\" \"start\"] -&gt; \"running\"\n    [\"running\" \"pause\"] -&gt; \"paused\"\n    [\"running\" \"stop\"] -&gt; \"stopped\"\n    [\"paused\" \"resume\"] -&gt; \"running\"\n    [\"paused\" \"stop\"] -&gt; \"stopped\"\n    _ -&gt; state))\n\nqi&gt; (process-state \"idle\" \"start\")\n; =&gt; \"running\"\n\nqi&gt; (process-state \"running\" \"pause\")\n; =&gt; \"paused\"\n\nqi&gt; (process-state \"paused\" \"resume\")\n; =&gt; \"running\"\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#3-json","title":"\u5b9f\u7528\u4f8b3: JSON\u30c7\u30fc\u30bf\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>(defn validate-user [data]\n  (match data\n    {:name n :email e} when (and (string? n) (string? e)) -&gt;\n      {:valid true :user {:name n :email e}}\n    _ -&gt;\n      {:valid false :error \"Invalid user data\"}))\n\nqi&gt; (validate-user {:name \"Alice\" :email \"alice@example.com\"})\n; =&gt; {:valid true :user {:name \"Alice\" :email \"alice@example.com\"}}\n\nqi&gt; (validate-user {:name \"Bob\"})\n; =&gt; {:valid false :error \"Invalid user data\"}\n\nqi&gt; (validate-user {:name 123 :email \"test@test.com\"})\n; =&gt; {:valid false :error \"Invalid user data\"}\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#4","title":"\u5b9f\u7528\u4f8b4: \u6728\u69cb\u9020\u306e\u8d70\u67fb","text":"<pre><code>; \u4e8c\u5206\u6728\u306e\u30ce\u30fc\u30c9\n; {:value \u5024 :left \u5de6\u306e\u5b50 :right \u53f3\u306e\u5b50}\n\n(defn tree-sum [tree]\n  (match tree\n    nil -&gt; 0\n    {:value v :left nil :right nil} -&gt; v\n    {:value v :left l :right nil} -&gt; (+ v (tree-sum l))\n    {:value v :left nil :right r} -&gt; (+ v (tree-sum r))\n    {:value v :left l :right r} -&gt; (+ v (tree-sum l) (tree-sum r))))\n\n(def my-tree\n  {:value 10\n   :left {:value 5 :left nil :right nil}\n   :right {:value 15 :left nil :right nil}})\n\nqi&gt; (tree-sum my-tree)\n; =&gt; 30  (10 + 5 + 15)\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#matchif","title":"match\u3068if\u306e\u6bd4\u8f03","text":""},{"location":"ja/tutorial/03-pattern-matching/#if","title":"if\u3092\u4f7f\u3063\u305f\u5834\u5408\uff08\u8aad\u307f\u306b\u304f\u3044\uff09","text":"<pre><code>(defn classify-response [resp]\n  (if (and (map? resp) (= (get resp :status) 200))\n    (get resp :body)\n    (if (and (map? resp) (= (get resp :status) 404))\n      \"Not Found\"\n      (if (and (map? resp) (= (get resp :status) 500))\n        \"Server Error\"\n        \"Unknown\"))))\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#match_1","title":"match\u3092\u4f7f\u3063\u305f\u5834\u5408\uff08\u8aad\u307f\u3084\u3059\u3044\uff09","text":"<pre><code>(defn classify-response [resp]\n  (match resp\n    {:status 200 :body body} -&gt; body\n    {:status 404} -&gt; \"Not Found\"\n    {:status 500} -&gt; \"Server Error\"\n    _ -&gt; \"Unknown\"))\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_6","title":"\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u5229\u70b9","text":""},{"location":"ja/tutorial/03-pattern-matching/#1_1","title":"1. \u53ef\u8aad\u6027","text":"<p>\u30c7\u30fc\u30bf\u69cb\u9020\u304c\u4e00\u76ee\u77ad\u7136\uff1a</p> <pre><code>; \u2705 \u8aad\u307f\u3084\u3059\u3044\n(match user\n  {:name n :age a} -&gt; f\"{n} is {a}\"\n  _ -&gt; \"Unknown\")\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#2_1","title":"2. \u7db2\u7f85\u6027","text":"<p>\u3059\u3079\u3066\u306e\u30b1\u30fc\u30b9\u3092\u51e6\u7406\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3084\u3059\u3044\uff1a</p> <pre><code>(match status\n  \"pending\" -&gt; handle-pending\n  \"approved\" -&gt; handle-approved\n  \"rejected\" -&gt; handle-rejected\n  _ -&gt; handle-unknown)  ; \u5fd8\u308c\u305a\u306b\uff01\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#3_1","title":"3. \u4fdd\u5b88\u6027","text":"<p>\u65b0\u3057\u3044\u30b1\u30fc\u30b9\u3092\u8ffd\u52a0\u3059\u308b\u306e\u304c\u7c21\u5358\uff1a</p> <pre><code>(match command\n  \"start\" -&gt; start-process\n  \"stop\" -&gt; stop-process\n  \"restart\" -&gt; restart-process  ; \u2190 \u8ffd\u52a0\u304c\u7c21\u5358\n  _ -&gt; unknown-command)\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_7","title":"\u7df4\u7fd2\u554f\u984c","text":""},{"location":"ja/tutorial/03-pattern-matching/#1_2","title":"\u554f\u984c1: \u30b0\u30ec\u30fc\u30c9\u5224\u5b9a","text":"<p>\u70b9\u6570\u3092\u53d7\u3051\u53d6\u308a\u3001\u30b0\u30ec\u30fc\u30c9\uff08A/B/C/D/F\uff09\u3092\u8fd4\u3059\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn get-grade [score]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  ; 90\u4ee5\u4e0a: A, 80\u4ee5\u4e0a: B, 70\u4ee5\u4e0a: C, 60\u4ee5\u4e0a: D, \u305d\u308c\u4ee5\u4e0b: F\n  )\n\n; \u30c6\u30b9\u30c8\n(get-grade 95)  ; =&gt; \"A\"\n(get-grade 85)  ; =&gt; \"B\"\n(get-grade 75)  ; =&gt; \"C\"\n(get-grade 65)  ; =&gt; \"D\"\n(get-grade 50)  ; =&gt; \"F\"\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn get-grade [score]\n  (match score\n    s when (&gt;= s 90) -&gt; \"A\"\n    s when (&gt;= s 80) -&gt; \"B\"\n    s when (&gt;= s 70) -&gt; \"C\"\n    s when (&gt;= s 60) -&gt; \"D\"\n    _ -&gt; \"F\"))\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#2-2","title":"\u554f\u984c2: \u30ea\u30b9\u30c8\u306e\u6700\u521d\u306e2\u8981\u7d20\u3092\u53d6\u5f97","text":"<p>\u30ea\u30b9\u30c8\u3092\u53d7\u3051\u53d6\u308a\u3001\u6700\u521d\u306e2\u8981\u7d20\u3092\u8fd4\u3059\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn first-two [lst]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(first-two [1 2 3 4 5])  ; =&gt; [1 2]\n(first-two [10])         ; =&gt; [10]\n(first-two [])           ; =&gt; []\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn first-two [lst]\n  (match lst\n    [] -&gt; []\n    [x] -&gt; [x]\n    [a b &amp; _] -&gt; [a b]))\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#3_2","title":"\u554f\u984c3: \u30aa\u30d7\u30b7\u30e7\u30f3\u578b\u306e\u51e6\u7406","text":"<p><code>:some</code>\u304b<code>:none</code>\u306e\u30de\u30c3\u30d7\u3092\u53d7\u3051\u53d6\u308a\u3001\u5024\u304c\u3042\u308c\u3070\u51e6\u7406\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn process-option [opt]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  ; {:type :some :value v} =&gt; v * 2\n  ; {:type :none} =&gt; 0\n  )\n\n; \u30c6\u30b9\u30c8\n(process-option {:type :some :value 10})  ; =&gt; 20\n(process-option {:type :none})            ; =&gt; 0\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn process-option [opt]\n  (match opt\n    {:type :some :value v} -&gt; (* v 2)\n    {:type :none} -&gt; 0))\n</code></pre>"},{"location":"ja/tutorial/03-pattern-matching/#_8","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068\uff1a</p> <ul> <li>\u2705 <code>match</code>\u5f0f\u306e\u57fa\u672c</li> <li>\u2705 \u30ea\u30b9\u30c8\u3068\u30de\u30c3\u30d7\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</li> <li>\u2705 \u30ac\u30fc\u30c9\u6761\u4ef6\uff08<code>when</code>\uff09</li> <li>\u2705 or\u30d1\u30bf\u30fc\u30f3\uff08<code>|</code>\uff09</li> <li>\u2705 \u5b9f\u7528\u7684\u306a\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u4f8b</li> </ul>"},{"location":"ja/tutorial/03-pattern-matching/#_9","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u81ea\u5728\u306b\u6271\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3089\u3001\u6b21\u306f\u30a8\u30e9\u30fc\u51e6\u7406\u3092\u5b66\u3073\u307e\u3057\u3087\u3046\uff01</p> <p>\u27a1\ufe0f \u7b2c4\u7ae0: \u30a8\u30e9\u30fc\u3092\u512a\u96c5\u306b\u6271\u3046</p> <p>\u30a8\u30e9\u30fc\u51e6\u7406\u3068Railway Pipeline\u306f\u3001\u5805\u7262\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u305f\u3081\u306b\u6b20\u304b\u305b\u307e\u305b\u3093\u3002</p>"},{"location":"ja/tutorial/04-error-handling/","title":"\u7b2c4\u7ae0: \u30a8\u30e9\u30fc\u3092\u512a\u96c5\u306b\u6271\u3046","text":"<p>\u6240\u8981\u6642\u9593: 30\u5206</p> <p>\u30a8\u30e9\u30fc\u51e6\u7406\u306f\u3001\u5805\u7262\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u305f\u3081\u306b\u6b20\u304b\u305b\u307e\u305b\u3093\u3002Qi\u306fRailway Pipeline\u3068\u3044\u3046\u5f37\u529b\u306a\u30a8\u30e9\u30fc\u51e6\u7406\u30d1\u30bf\u30fc\u30f3\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/04-error-handling/#try","title":"\u30a8\u30e9\u30fc\u51e6\u7406\u306e\u57fa\u672c: <code>try</code>","text":"<p><code>try</code>\u306f\u3001\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u30b3\u30fc\u30c9\u3092\u5b89\u5168\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/04-error-handling/#_1","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>qi&gt; (try (+ 1 2))\n; =&gt; 3  (\u6210\u529f\u6642\u306f\u751f\u306e\u5024\u3092\u8fd4\u3059)\n\nqi&gt; (try (/ 1 0))\n; =&gt; {:error \"\u30bc\u30ed\u9664\u7b97\u30a8\u30e9\u30fc\"}  (\u30a8\u30e9\u30fc\u6642\u306f{:error}\u5f62\u5f0f)\n</code></pre> <p>\u91cd\u8981: Qi\u306e\u65b0\u3057\u3044\u4ed5\u69d8\u3067\u306f\u3001<code>try</code>\u306f\u6210\u529f\u6642\u306b\u751f\u306e\u5024\u3092\u8fd4\u3057\u307e\u3059\uff08<code>{:ok value}</code>\u3067\u306f\u3042\u308a\u307e\u305b\u3093\uff09\u3002\u30a8\u30e9\u30fc\u3060\u3051\u304c<code>{:error ...}</code>\u5f62\u5f0f\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/04-error-handling/#error","title":"<code>error?</code>\u8ff0\u8a9e\u3067\u30a8\u30e9\u30fc\u3092\u30c1\u30a7\u30c3\u30af","text":"<p><code>error?</code>\u3092\u4f7f\u3063\u3066\u3001\u5024\u304c\u30a8\u30e9\u30fc\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>qi&gt; (error? {:error \"Something went wrong\"})\n; =&gt; true\n\nqi&gt; (error? 42)\n; =&gt; false\n\nqi&gt; (error? {:ok 10})\n; =&gt; false\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#_2","title":"\u5b9f\u7528\u4f8b","text":"<pre><code>(defn safe-divide [a b]\n  (try (/ a b)))\n\n(defn process [a b]\n  (let [result (safe-divide a b)]\n    (if (error? result)\n      (println \"Error occurred!\")\n      (println f\"Result: {result}\"))))\n\nqi&gt; (process 10 2)\n; =&gt; \"Result: 5\"\n\nqi&gt; (process 10 0)\n; =&gt; \"Error occurred!\"\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#railway-pipeline","title":"Railway Pipeline: <code>|&gt;?</code>","text":"<p>Railway Pipeline\u306f\u3001\u30a8\u30e9\u30fc\u3092\u81ea\u52d5\u7684\u306b\u4f1d\u64ad\u3055\u305b\u308b\u5f37\u529b\u306a\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/04-error-handling/#_3","title":"\u57fa\u672c\u7684\u306a\u8003\u3048\u65b9","text":"<p>\u901a\u5e38\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3(<code>|&gt;</code>)\u3067\u306f\u3001\u5404\u30b9\u30c6\u30c3\u30d7\u304c\u5fc5\u305a\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u3057\u304b\u3057\u3001Railway Pipeline (<code>|&gt;?</code>)\u3067\u306f\u3001\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u3068\u3001\u305d\u308c\u4ee5\u964d\u306e\u51e6\u7406\u3092\u30b9\u30ad\u30c3\u30d7\u3057\u307e\u3059\u3002</p> <pre><code>      \u6210\u529f        \u6210\u529f        \u6210\u529f\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\n |          |          |          |\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; X \u30a8\u30e9\u30fc! \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\n      \u6210\u529f        \u2193        \u30b9\u30ad\u30c3\u30d7\n                \u30a8\u30e9\u30fc\u8fd4\u5374\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#railway-pipeline_1","title":"\u4f8b: \u30b7\u30f3\u30d7\u30eb\u306aRailway Pipeline","text":"<pre><code>(defn validate-positive [x]\n  (if (&gt; x 0)\n    x                          ; \u6210\u529f: \u305d\u306e\u307e\u307e\u5024\u3092\u8fd4\u3059\n    {:error \"Must be positive\"}))  ; \u30a8\u30e9\u30fc\n\n(defn double [x]\n  (* x 2))\n\n(defn add-ten [x]\n  (+ x 10))\n\n; \u6210\u529f\u30b1\u30fc\u30b9\nqi&gt; (10\n     |&gt;? validate-positive\n     |&gt;? double\n     |&gt;? add-ten)\n; =&gt; 30  (10 -&gt; 10 -&gt; 20 -&gt; 30)\n\n; \u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\nqi&gt; (-5\n     |&gt;? validate-positive  ; \u3053\u3053\u3067\u30a8\u30e9\u30fc\n     |&gt;? double             ; \u30b9\u30ad\u30c3\u30d7\n     |&gt;? add-ten)           ; \u30b9\u30ad\u30c3\u30d7\n; =&gt; {:error \"Must be positive\"}\n</code></pre> <p>\u30dd\u30a4\u30f3\u30c8: <code>{:error}</code>\u4ee5\u5916\u306f\u5168\u3066\u6210\u529f\u3068\u3057\u3066\u6271\u308f\u308c\u307e\u3059\uff01</p>"},{"location":"ja/tutorial/04-error-handling/#railway-pipeline_2","title":"Railway Pipeline\u306e\u5f37\u307f","text":""},{"location":"ja/tutorial/04-error-handling/#1","title":"1. \u30a8\u30e9\u30fc\u304c\u81ea\u52d5\u3067\u4f1d\u64ad\u3059\u308b","text":"<pre><code>(defn validate-age [age]\n  (if (and (&gt;= age 0) (&lt;= age 150))\n    age\n    {:error \"Invalid age\"}))\n\n(defn validate-name [name]\n  (if (&gt; (len name) 0)\n    name\n    {:error \"Name cannot be empty\"}))\n\n(defn create-user [name age]\n  ({:name name :age age}\n   |&gt;? (fn [u] (if (&gt; (len (get u :name)) 0)\n                  u\n                  {:error \"Name cannot be empty\"}))\n   |&gt;? (fn [u] (if (and (&gt;= (get u :age) 0) (&lt;= (get u :age) 150))\n                  u\n                  {:error \"Invalid age\"}))))\n\nqi&gt; (create-user \"Alice\" 25)\n; =&gt; {:name \"Alice\" :age 25}\n\nqi&gt; (create-user \"\" 25)\n; =&gt; {:error \"Name cannot be empty\"}\n\nqi&gt; (create-user \"Bob\" 200)\n; =&gt; {:error \"Invalid age\"}\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#2","title":"2. \u8aad\u307f\u3084\u3059\u3044","text":"<p>\u30a8\u30e9\u30fc\u51e6\u7406\u304c\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u306b\u81ea\u7136\u306b\u7d44\u307f\u8fbc\u307e\u308c\u307e\u3059\uff1a</p> <pre><code>; \u274c \u5f93\u6765\u306e\u30a8\u30e9\u30fc\u51e6\u7406\uff08\u8aad\u307f\u306b\u304f\u3044\uff09\n(defn process-data [data]\n  (let [result1 (step1 data)]\n    (if (error? result1)\n      result1\n      (let [result2 (step2 result1)]\n        (if (error? result2)\n          result2\n          (step3 result2))))))\n\n; \u2705 Railway Pipeline\uff08\u8aad\u307f\u3084\u3059\u3044\uff09\n(defn process-data [data]\n  (data\n   |&gt;? step1\n   |&gt;? step2\n   |&gt;? step3))\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#1_1","title":"\u5b9f\u7528\u4f8b1: \u30d5\u30a1\u30a4\u30eb\u51e6\u7406","text":"<pre><code>(defn read-file [path]\n  (try (io/read-file path)))\n\n(defn parse-json [text]\n  (try (json/parse text)))\n\n(defn validate-data [data]\n  (if (map? data)\n    data\n    {:error \"Data must be a map\"}))\n\n(defn extract-field [data field]\n  (if (contains? data field)\n    (get data field)\n    {:error f\"Missing field: {field}\"}))\n\n; Railway Pipeline\u3067\u7e4b\u3050\n(defn load-config [path]\n  (path\n   |&gt;? read-file\n   |&gt;? parse-json\n   |&gt;? validate-data\n   |&gt;? (fn [d] (extract-field d :database))))\n\n; \u4f7f\u7528\u4f8b\nqi&gt; (load-config \"config.json\")\n; =&gt; \"postgresql://localhost/mydb\"  (\u6210\u529f\u6642)\n; =&gt; {:error \"\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\"}  (\u30d5\u30a1\u30a4\u30eb\u306a\u3057)\n; =&gt; {:error \"JSON\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f\"}  (\u4e0d\u6b63\u306aJSON)\n; =&gt; {:error \"Missing field: database\"}  (\u30d5\u30a3\u30fc\u30eb\u30c9\u306a\u3057)\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#2-api","title":"\u5b9f\u7528\u4f8b2: API\u547c\u3073\u51fa\u3057","text":"<pre><code>(defn fetch-user [id]\n  ; \u6a21\u64ecHTTP\u30ea\u30af\u30a8\u30b9\u30c8\n  (if (&gt; id 0)\n    {:status 200 :body f\"{{\"id\":{id},\"name\":\"User{id}\"}}\"}\n    {:status 404}))\n\n(defn check-response [resp]\n  (match resp\n    {:status 200 :body body} -&gt; body\n    {:status 404} -&gt; {:error \"User not found\"}\n    _ -&gt; {:error \"Unknown error\"}))\n\n(defn parse-user [json-str]\n  (try (json/parse json-str)))\n\n(defn extract-name [user]\n  (if (contains? user :name)\n    (get user :name)\n    {:error \"Missing name\"}))\n\n; Railway Pipeline\u3067\u7e4b\u3050\n(defn get-user-name [id]\n  (id\n   |&gt; fetch-user\n   |&gt;? check-response\n   |&gt;? parse-user\n   |&gt;? extract-name))\n\nqi&gt; (get-user-name 1)\n; =&gt; \"User1\"\n\nqi&gt; (get-user-name -1)\n; =&gt; {:error \"User not found\"}\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#tryrailway-pipeline","title":"<code>try</code>\u3068Railway Pipeline\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<p><code>try</code>\u3068Railway Pipeline\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3068\u3001\u5f37\u529b\u306a\u30a8\u30e9\u30fc\u51e6\u7406\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002</p> <pre><code>(defn safe-parse-int [s]\n  (try (string/to-int s)))\n\n(defn validate-range [n]\n  (if (and (&gt;= n 0) (&lt;= n 100))\n    n\n    {:error \"Number must be between 0 and 100\"}))\n\n(defn double [n]\n  (* n 2))\n\n; \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n(defn process-input [input]\n  (input\n   |&gt;? safe-parse-int\n   |&gt;? validate-range\n   |&gt;? double))\n\nqi&gt; (process-input \"25\")\n; =&gt; 50\n\nqi&gt; (process-input \"abc\")\n; =&gt; {:error \"\u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\"}\n\nqi&gt; (process-input \"150\")\n; =&gt; {:error \"Number must be between 0 and 100\"}\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#_4","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/tutorial/04-error-handling/#1-error","title":"1. <code>{:error}</code>\u5f62\u5f0f\u3092\u7d71\u4e00\u3059\u308b","text":"<pre><code>; \u2705 \u826f\u3044\u4f8b\n{:error \"User not found\"}\n{:error \"Invalid input\"}\n{:error \"Database connection failed\"}\n\n; \u274c \u60aa\u3044\u4f8b\uff08\u7d71\u4e00\u3055\u308c\u3066\u3044\u306a\u3044\uff09\n\"error\"\n{:err \"...\"}\n{:failed true}\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#2_1","title":"2. \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u5177\u4f53\u7684\u306b","text":"<pre><code>; \u2705 \u826f\u3044\u4f8b\n{:error f\"User with ID {id} not found\"}\n{:error f\"Age must be between 0 and 150, got {age}\"}\n\n; \u274c \u60aa\u3044\u4f8b\n{:error \"Error\"}\n{:error \"Invalid\"}\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#3","title":"3. \u30a8\u30e9\u30fc\u3092\u65e9\u671f\u306b\u8fd4\u3059","text":"<pre><code>; \u2705 \u826f\u3044\u4f8b: \u65e9\u671f\u30ea\u30bf\u30fc\u30f3\n(defn process [x]\n  (if (&lt; x 0)\n    {:error \"Negative not allowed\"}\n    (do-something x)))\n\n; \u274c \u60aa\u3044\u4f8b: \u6df1\u3044\u30cd\u30b9\u30c8\n(defn process [x]\n  (if (&gt;= x 0)\n    (do-something x)\n    {:error \"Negative not allowed\"}))\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#_5","title":"\u7df4\u7fd2\u554f\u984c","text":""},{"location":"ja/tutorial/04-error-handling/#1_2","title":"\u554f\u984c1: \u5b89\u5168\u306a\u9664\u7b97\u95a2\u6570","text":"<p>\u30bc\u30ed\u9664\u7b97\u3092\u9632\u3050\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn safe-divide [a b]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(safe-divide 10 2)  ; =&gt; 5\n(safe-divide 10 0)  ; =&gt; {:error \"Division by zero\"}\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn safe-divide [a b]\n  (if (= b 0)\n    {:error \"Division by zero\"}\n    (/ a b)))\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#2_2","title":"\u554f\u984c2: \u6570\u5024\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3","text":"<p>\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u6570\u5024\u306b\u5909\u63db\u3057\u30660\u301c100\u306e\u7bc4\u56f2\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn validate-score [input]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  ; \u30d2\u30f3\u30c8: safe-parse-int \u3068 validate-range \u3092\u4f7f\u3046\n  )\n\n; \u30c6\u30b9\u30c8\n(validate-score \"75\")   ; =&gt; 75\n(validate-score \"abc\")  ; =&gt; {:error \"\u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\"}\n(validate-score \"150\")  ; =&gt; {:error \"Range error\"}\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn safe-parse-int [s]\n  (try (string/to-int s)))\n\n(defn validate-range [n]\n  (if (and (&gt;= n 0) (&lt;= n 100))\n    n\n    {:error \"Range error\"}))\n\n(defn validate-score [input]\n  (input\n   |&gt;? safe-parse-int\n   |&gt;? validate-range))\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#3_1","title":"\u554f\u984c3: \u8907\u6570\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u3092\u53d7\u3051\u53d6\u308a\u3001\u540d\u524d\u3068\u5e74\u9f62\u3092\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn validate-user [user]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  ; \u540d\u524d: 1\u6587\u5b57\u4ee5\u4e0a\n  ; \u5e74\u9f62: 0\u301c150\u306e\u7bc4\u56f2\n  )\n\n; \u30c6\u30b9\u30c8\n(validate-user {:name \"Alice\" :age 25})\n; =&gt; {:name \"Alice\" :age 25}\n\n(validate-user {:name \"\" :age 25})\n; =&gt; {:error \"Name cannot be empty\"}\n\n(validate-user {:name \"Bob\" :age 200})\n; =&gt; {:error \"Invalid age\"}\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn validate-user [user]\n  (user\n   |&gt;? (fn [u] (if (&gt; (len (get u :name)) 0)\n                  u\n                  {:error \"Name cannot be empty\"}))\n   |&gt;? (fn [u] (if (and (&gt;= (get u :age) 0) (&lt;= (get u :age) 150))\n                  u\n                  {:error \"Invalid age\"}))))\n</code></pre>"},{"location":"ja/tutorial/04-error-handling/#_6","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068\uff1a</p> <ul> <li>\u2705 <code>try</code>\u3067\u30a8\u30e9\u30fc\u3092\u5b89\u5168\u306b\u30ad\u30e3\u30c3\u30c1</li> <li>\u2705 <code>error?</code>\u8ff0\u8a9e\u3067\u30a8\u30e9\u30fc\u3092\u5224\u5b9a</li> <li>\u2705 Railway Pipeline (<code>|&gt;?</code>)\u3067\u30a8\u30e9\u30fc\u3092\u81ea\u52d5\u4f1d\u64ad</li> <li>\u2705 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9</li> <li>\u2705 \u5b9f\u7528\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406\u30d1\u30bf\u30fc\u30f3</li> </ul>"},{"location":"ja/tutorial/04-error-handling/#_7","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>\u30a8\u30e9\u30fc\u51e6\u7406\u3092\u30de\u30b9\u30bf\u30fc\u3057\u305f\u3089\u3001\u6b21\u306f\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u5b66\u3073\u307e\u3057\u3087\u3046\uff01</p> <p>\u27a1\ufe0f \u7b2c5\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u7c21\u5358\u306b</p> <p>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u306f\u3001Qi\u306e\u6700\u3082\u5f37\u529b\u306a\u6a5f\u80fd\u306e\u4e00\u3064\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/05-concurrency/","title":"\u7b2c5\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u7c21\u5358\u306b","text":"<p>\u6240\u8981\u6642\u9593: 35\u5206</p> <p>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u306f\u3001Qi\u306e\u6700\u3082\u5f37\u529b\u306a\u6a5f\u80fd\u306e\u4e00\u3064\u3067\u3059\u3002\u7c21\u5358\u306b\u3001\u5b89\u5168\u306b\u3001\u9ad8\u901f\u306a\u4e26\u5217\u51e6\u7406\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/05-concurrency/#_1","title":"\u306a\u305c\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u304c\u5fc5\u8981\u304b\uff1f","text":""},{"location":"ja/tutorial/05-concurrency/#_2","title":"\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u51e6\u7406\uff08\u9045\u3044\uff09","text":"<pre><code>(def urls [\"https://api1.com\" \"https://api2.com\" \"https://api3.com\"])\n\n; \u9806\u756a\u306b\u51e6\u7406\uff08\u5408\u8a083\u79d2\u304b\u304b\u308b\uff09\n(map http/get urls)\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_3","title":"\u4e26\u5217\u51e6\u7406\uff08\u901f\u3044\uff09","text":"<pre><code>; \u4e26\u5217\u3067\u51e6\u7406\uff08\u7d041\u79d2\u3067\u5b8c\u4e86\uff01\uff09\n(urls ||&gt; http/get)\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_4","title":"\u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: <code>||&gt;</code>","text":"<p><code>||&gt;</code>\u306f\u3001\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u5404\u8981\u7d20\u3092\u4e26\u5217\u306b\u51e6\u7406\u3057\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/05-concurrency/#_5","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>qi&gt; ([1 2 3 4 5]\n     ||&gt; (fn [x] (* x x)))\n; =&gt; [1 4 9 16 25]\n</code></pre> <p>\u5185\u90e8\u3067\u306f\u81ea\u52d5\u7684\u306b<code>pmap</code>\uff08\u4e26\u5217map\uff09\u304c\u4f7f\u308f\u308c\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/05-concurrency/#1-url","title":"\u5b9f\u7528\u4f8b1: \u8907\u6570\u306eURL\u53d6\u5f97","text":"<pre><code>(def urls\n  [\"https://api.example.com/users/1\"\n   \"https://api.example.com/users/2\"\n   \"https://api.example.com/users/3\"])\n\n; \u4e26\u5217\u3067\u53d6\u5f97\n(urls\n ||&gt; http/get\n ||&gt; (fn [resp] (get resp :body))\n ||&gt; json/parse)\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#map-pmap","title":"\u4e26\u5217map: <code>pmap</code>","text":"<p><code>pmap</code>\u306f\u3001map\u306e\u4e26\u5217\u7248\u3067\u3059\u3002</p> <pre><code>qi&gt; (pmap (fn [x] (* x 2)) [1 2 3 4 5])\n; =&gt; [2 4 6 8 10]\n\nqi&gt; (defn heavy-process [x]\n      (do\n        (sleep 1000)  ; 1\u79d2\u5f85\u3064\n        (* x x)))\n\n; \u9806\u756a\u306b\u51e6\u7406\uff085\u79d2\u304b\u304b\u308b\uff09\nqi&gt; (map heavy-process [1 2 3 4 5])\n; =&gt; [1 4 9 16 25]\n\n; \u4e26\u5217\u306b\u51e6\u7406\uff08\u7d041\u79d2\u3067\u5b8c\u4e86\uff09\nqi&gt; (pmap heavy-process [1 2 3 4 5])\n; =&gt; [1 4 9 16 25]\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#filter-gopfilter","title":"\u4e26\u5217filter: <code>go/pfilter</code>","text":"<p><code>go/pfilter</code>\u306f\u3001filter\u306e\u4e26\u5217\u7248\u3067\u3059\u3002</p> <pre><code>qi&gt; (go/pfilter even? [1 2 3 4 5 6 7 8 9 10])\n; =&gt; [2 4 6 8 10]\n\n(defn is-prime? [n]\n  ; \u7d20\u6570\u5224\u5b9a\uff08\u91cd\u3044\u51e6\u7406\uff09\n  (if (&lt;= n 1)\n    false\n    (loop [i 2]\n      (if (&gt;= (* i i) n)\n        true\n        (if (= (% n i) 0)\n          false\n          (recur (inc i)))))))\n\n; \u4e26\u5217\u3067\u7d20\u6570\u3092\u62bd\u51fa\nqi&gt; (go/pfilter is-prime? (range 1 100))\n; =&gt; [2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97]\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#goroutine","title":"goroutine\u98a8\u306e\u4e26\u884c\u51e6\u7406","text":"<p>Qi\u306f\u3001Go\u8a00\u8a9e\u98a8\u306e\u4e26\u884c\u51e6\u7406\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/05-concurrency/#_6","title":"\u30c1\u30e3\u30cd\u30eb\u306e\u4f5c\u6210","text":"<pre><code>qi&gt; (def ch (go/chan))\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_7","title":"\u9001\u53d7\u4fe1","text":"<pre><code>; \u9001\u4fe1\nqi&gt; (go/send! ch 42)\n\n; \u53d7\u4fe1\nqi&gt; (go/recv! ch)\n; =&gt; 42\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#goroutine_1","title":"goroutine\u3067\u5b9f\u884c","text":"<pre><code>; \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\nqi&gt; (go/run (println \"Hello from goroutine!\"))\n; =&gt; \"Hello from goroutine!\"\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#1","title":"\u5b9f\u7528\u4f8b1: \u4e26\u5217\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9","text":"<pre><code>(defn download-file [url]\n  (println f\"Downloading: {url}\")\n  (let [resp (http/get url)]\n    (get resp :body)))\n\n(def urls\n  [\"https://example.com/file1.txt\"\n   \"https://example.com/file2.txt\"\n   \"https://example.com/file3.txt\"])\n\n; \u4e26\u5217\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n(def results (urls ||&gt; download-file))\n\n; \u307e\u305f\u306f pmap \u3092\u4f7f\u3046\n(def results (pmap download-file urls))\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#2","title":"\u5b9f\u7528\u4f8b2: \u4e26\u5217\u30c7\u30fc\u30bf\u51e6\u7406","text":"<pre><code>(defn process-chunk [chunk]\n  ; \u91cd\u3044\u51e6\u7406\n  (chunk\n   |&gt; (filter even?)\n   |&gt; (map (fn [x] (* x x)))\n   |&gt; (reduce + 0)))\n\n; \u5927\u304d\u306a\u30c7\u30fc\u30bf\u3092\u5206\u5272\n(def data (range 1 1000))\n(def chunks\n  [(take 250 data)\n   (take 250 (drop 250 data))\n   (take 250 (drop 500 data))\n   (take 250 (drop 750 data))])\n\n; \u5404\u30c1\u30e3\u30f3\u30af\u3092\u4e26\u5217\u51e6\u7406\n(def results (chunks ||&gt; process-chunk))\n\n; \u7d50\u679c\u3092\u96c6\u8a08\n(reduce + 0 results)\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#3-goroutine","title":"\u5b9f\u7528\u4f8b3: goroutine\u3068\u30c1\u30e3\u30cd\u30eb","text":"<pre><code>(def ch (go/chan))\n\n; \u30d7\u30ed\u30c7\u30e5\u30fc\u30b5\u30fc\n(go/run\n  (do\n    (go/send! ch 1)\n    (go/send! ch 2)\n    (go/send! ch 3)\n    (go/close! ch)))\n\n; \u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\n(loop [acc []]\n  (let [val (go/try-recv! ch)]\n    (if (nil? val)\n      acc\n      (recur (conj acc val)))))\n; =&gt; [1 2 3]\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#4","title":"\u5b9f\u7528\u4f8b4: \u30ef\u30fc\u30ab\u30fc\u30d7\u30fc\u30eb","text":"<pre><code>(defn worker [id ch]\n  (loop []\n    (let [task (go/try-recv! ch)]\n      (if (nil? task)\n        (println f\"Worker {id} done\")\n        (do\n          (println f\"Worker {id} processing: {task}\")\n          ; \u51e6\u7406\n          (sleep 100)\n          (recur))))))\n\n(def ch (go/chan))\n\n; \u30ef\u30fc\u30ab\u30fc\u3092\u8d77\u52d5\n(go/run (worker 1 ch))\n(go/run (worker 2 ch))\n(go/run (worker 3 ch))\n\n; \u30bf\u30b9\u30af\u3092\u6295\u5165\n(go/send! ch \"Task 1\")\n(go/send! ch \"Task 2\")\n(go/send! ch \"Task 3\")\n(go/send! ch \"Task 4\")\n(go/send! ch \"Task 5\")\n\n; \u30c1\u30e3\u30cd\u30eb\u3092\u30af\u30ed\u30fc\u30ba\n(go/close! ch)\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#atom","title":"Atom: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406","text":"<p>Atom\u3092\u4f7f\u3046\u3068\u3001\u8907\u6570\u306egoroutine\u304b\u3089\u5b89\u5168\u306b\u72b6\u614b\u3092\u66f4\u65b0\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/05-concurrency/#_8","title":"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9","text":"<pre><code>qi&gt; (def counter (atom 0))\n\n; \u5024\u3092\u53d6\u5f97\nqi&gt; (deref counter)\n; =&gt; 0\n\nqi&gt; @counter  ; \u77ed\u7e2e\u5f62\n; =&gt; 0\n\n; \u5024\u3092\u66f4\u65b0\nqi&gt; (swap! counter inc)\n; =&gt; 1\n\nqi&gt; @counter\n; =&gt; 1\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_9","title":"\u5b9f\u7528\u4f8b: \u4e26\u5217\u30ab\u30a6\u30f3\u30bf\u30fc","text":"<pre><code>(def counter (atom 0))\n\n; \u8907\u6570\u306egoroutine\u304b\u3089\u5b89\u5168\u306b\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n(go/run (swap! counter inc))\n\n(sleep 100)  ; \u5b8c\u4e86\u3092\u5f85\u3064\n\nqi&gt; @counter\n; =&gt; 5\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_10","title":"\u4e26\u5217\u51e6\u7406\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","text":""},{"location":"ja/tutorial/05-concurrency/#1_1","title":"1. \u3044\u3064\u4e26\u5217\u5316\u3059\u308b\u304b\uff1f","text":"<p>\u4e26\u5217\u5316\u3059\u3079\u304d\u5834\u5408: - CPU\u96c6\u7d04\u7684\u306a\u51e6\u7406\uff08\u8a08\u7b97\u3001\u5909\u63db\uff09 - I/O\u5f85\u3061\u304c\u591a\u3044\u51e6\u7406\uff08HTTP\u3001\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\uff09 - \u8981\u7d20\u6570\u304c\u591a\u3044\uff08\u76ee\u5b89\uff1a100\u8981\u7d20\u4ee5\u4e0a\uff09</p> <p>\u4e26\u5217\u5316\u3059\u3079\u304d\u3067\u306a\u3044\u5834\u5408: - \u8efd\u91cf\u306a\u51e6\u7406\uff08\u8981\u7d20\u3054\u3068\u306e\u51e6\u7406\u304c1ms\u672a\u6e80\uff09 - \u8981\u7d20\u6570\u304c\u5c11\u306a\u3044\uff08\u76ee\u5b89\uff1a10\u8981\u7d20\u672a\u6e80\uff09 - \u9806\u5e8f\u304c\u91cd\u8981\u306a\u51e6\u7406</p>"},{"location":"ja/tutorial/05-concurrency/#2_1","title":"2. \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6bd4\u8f03","text":"<pre><code>; \u8efd\u91cf\u51e6\u7406 - map\u306e\u65b9\u304c\u901f\u3044\n(map inc [1 2 3 4 5])  ; \u9ad8\u901f\n\n; \u91cd\u3044\u51e6\u7406 - pmap\u306e\u65b9\u304c\u901f\u3044\n(pmap heavy-process [1 2 3 ... 100])  ; \u9ad8\u901f\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#3","title":"3. \u30c7\u30d0\u30c3\u30b0\u306e\u30b3\u30c4","text":"<p>\u4e26\u5217\u51e6\u7406\u306f\u30c7\u30d0\u30c3\u30b0\u304c\u96e3\u3057\u3044\u306e\u3067\u3001\u307e\u305a\u9010\u6b21\u51e6\u7406\u3067\u52d5\u4f5c\u78ba\u8a8d\uff1a</p> <pre><code>; \u2705 \u307e\u305a\u9010\u6b21\u51e6\u7406\u3067\u78ba\u8a8d\n(data |&gt; (map process) |&gt; verify)\n\n; \u2705 \u52d5\u4f5c\u78ba\u8a8d\u5f8c\u306b\u4e26\u5217\u5316\n(data ||&gt; process |&gt; verify)\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_11","title":"\u7df4\u7fd2\u554f\u984c","text":""},{"location":"ja/tutorial/05-concurrency/#1-2","title":"\u554f\u984c1: \u4e26\u52172\u4e57\u8a08\u7b97","text":"<p>\u30ea\u30b9\u30c8\u306e\u5404\u8981\u7d20\u30922\u4e57\u3057\u3066\u3001\u305d\u306e\u5408\u8a08\u3092\u4e26\u5217\u306b\u8a08\u7b97\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn parallel-sum-squares [numbers]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(parallel-sum-squares [1 2 3 4 5])  ; =&gt; 55\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn parallel-sum-squares [numbers]\n  (numbers\n   ||&gt; (fn [x] (* x x))\n   |&gt; (reduce + 0)))\n\n; \u307e\u305f\u306f pmap \u3092\u4f7f\u3046\n(defn parallel-sum-squares [numbers]\n  (pmap (fn [x] (* x x)) numbers)\n  |&gt; (reduce + 0))\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#2_2","title":"\u554f\u984c2: \u4e26\u5217\u30d5\u30a3\u30eb\u30bf\u3068\u5909\u63db","text":"<p>\u5076\u6570\u3060\u3051\u3092\u4e26\u5217\u306b\u62bd\u51fa\u3057\u3066\u30012\u500d\u306b\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(defn parallel-process [numbers]\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(parallel-process [1 2 3 4 5 6])  ; =&gt; [4 8 12]\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(defn parallel-process [numbers]\n  (numbers\n   |&gt; (go/pfilter even?)\n   ||&gt; (fn [x] (* x 2))))\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#3-atom","title":"\u554f\u984c3: Atom\u3067\u30a2\u30af\u30bb\u30b9\u30ab\u30a6\u30f3\u30c8","text":"<p>Atom\u3092\u4f7f\u3063\u3066\u3001\u8907\u6570\u306egoroutine\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30ab\u30a6\u30f3\u30c8\u3092\u5b89\u5168\u306b\u66f4\u65b0\u3059\u308b\u95a2\u6570\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>(def access-count (atom 0))\n\n(defn record-access []\n  ; \u3053\u3053\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\n  )\n\n; \u30c6\u30b9\u30c8\n(go/run (record-access))\n(go/run (record-access))\n(go/run (record-access))\n\n(sleep 100)\n@access-count  ; =&gt; 3\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(def access-count (atom 0))\n\n(defn record-access []\n  (swap! access-count inc))\n</code></pre>"},{"location":"ja/tutorial/05-concurrency/#_12","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068\uff1a</p> <ul> <li>\u2705 \u4e26\u5217\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 (<code>||&gt;</code>)</li> <li>\u2705 \u4e26\u5217map/filter/reduce (<code>pmap</code>, <code>go/pfilter</code>, <code>go/preduce</code>)</li> <li>\u2705 goroutine\u98a8\u306e\u4e26\u884c\u51e6\u7406 (<code>go/run</code>, <code>go/chan</code>)</li> <li>\u2705 Atom\uff08\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406\uff09</li> <li>\u2705 \u4e26\u5217\u51e6\u7406\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9</li> </ul>"},{"location":"ja/tutorial/05-concurrency/#_13","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u3092\u30de\u30b9\u30bf\u30fc\u3057\u305f\u3089\u3001\u6700\u5f8c\u306fWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068API\u3092\u5b66\u3073\u307e\u3057\u3087\u3046\uff01</p> <p>\u27a1\ufe0f \u7b2c6\u7ae0: Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068API</p> <p>HTTP\u30b5\u30fc\u30d0\u30fc\u3068JSON API\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/06-web-api/","title":"\u7b2c6\u7ae0: Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068API","text":"<p>\u6240\u8981\u6642\u9593: 40\u5206</p> <p>Qi\u3067HTTP\u30b5\u30fc\u30d0\u30fc\u3068JSON API\u3092\u69cb\u7bc9\u3059\u308b\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002\u30b7\u30f3\u30d7\u30eb\u3067\u8aad\u307f\u3084\u3059\u3044\u30b3\u30fc\u30c9\u3067\u3001\u672c\u683c\u7684\u306aWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u4f5c\u308c\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/06-web-api/#http","title":"\u6700\u5c0f\u306eHTTP\u30b5\u30fc\u30d0\u30fc","text":"<p>\u307e\u305a\u306f\u3001\u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306aHTTP\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>(defn handler [req]\n  (server/text \"Hello, World!\"))\n\n(server/serve handler {:port 3000})\n; =&gt; \u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5: http://localhost:3000\n</code></pre> <p>\u30d6\u30e9\u30a6\u30b6\u3067<code>http://localhost:3000</code>\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001<code>Hello, World!</code>\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/06-web-api/#_1","title":"\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9","text":""},{"location":"ja/tutorial/06-web-api/#_2","title":"\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u69cb\u9020","text":"<p>\u30cf\u30f3\u30c9\u30e9\u30fc\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ea\u30af\u30a8\u30b9\u30c8\u30de\u30c3\u30d7\u304c\u6e21\u3055\u308c\u307e\u3059\uff1a</p> <pre><code>{:method :get\n :path \"/users/123\"\n :headers {\"content-type\" \"application/json\"}\n :body \"...\"}\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#_3","title":"\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u7a2e\u985e","text":"<p>Qi\u306f\u3001\u4fbf\u5229\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30eb\u30d1\u30fc\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002</p> <pre><code>; \u30c6\u30ad\u30b9\u30c8\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/text \"Hello\")\n; =&gt; {:status 200 :headers {\"Content-Type\" \"text/plain\"} :body \"Hello\"}\n\n; JSON\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/json {\"message\" \"Success\" \"data\" [1 2 3]})\n; =&gt; {:status 200 :headers {\"Content-Type\" \"application/json\"} :body \"...\"}\n\n; HTML\u30ec\u30b9\u30dd\u30f3\u30b9\n(server/html \"&lt;h1&gt;Welcome&lt;/h1&gt;\")\n; =&gt; {:status 200 :headers {\"Content-Type\" \"text/html\"} :body \"...\"}\n\n; \u30ab\u30b9\u30bf\u30e0\u30b9\u30c6\u30fc\u30bf\u30b9\n(server/response 201 {\"message\" \"Created\"})\n; =&gt; {:status 201 ...}\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#_4","title":"\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0","text":"<p>\u30d1\u30b9\u306b\u5fdc\u3058\u3066\u51e6\u7406\u3092\u5206\u5c90\u3057\u307e\u3059\u3002</p> <pre><code>(defn handler [req]\n  (match (get req :path)\n    \"/\" -&gt; (server/text \"Home\")\n    \"/about\" -&gt; (server/text \"About\")\n    \"/api/status\" -&gt; (server/json {:status \"ok\"})\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#_5","title":"\u30e1\u30bd\u30c3\u30c9\u3068\u30d1\u30b9\u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/\"] -&gt; (server/text \"Home\")\n    [\"GET\" \"/users\"] -&gt; (server/json {:users []})\n    [\"POST\" \"/users\"] -&gt; (server/json {:message \"User created\"})\n    [\"GET\" \"/users/123\"] -&gt; (server/json {:id 123 :name \"Alice\"})\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#get","title":"GET: \u30c7\u30fc\u30bf\u53d6\u5f97","text":"<pre><code>(def users\n  [{:id 1 :name \"Alice\" :age 25}\n   {:id 2 :name \"Bob\" :age 30}\n   {:id 3 :name \"Carol\" :age 28}])\n\n(defn get-users [req]\n  (server/json {:users users}))\n\n(defn get-user [req id]\n  (let [user (first (filter (fn [u] (= (get u :id) id)) users))]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (server/json user))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/users\"] -&gt; (get-users req)\n    [\"GET\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id-str (str/replace path \"/api/users/\" \"\")\n            id (string/to-int id-str)]\n        (get-user req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>\u30c6\u30b9\u30c8: <pre><code>curl http://localhost:3000/api/users\n# =&gt; {\"users\":[{\"id\":1,\"name\":\"Alice\",\"age\":25},...]}\n\ncurl http://localhost:3000/api/users/1\n# =&gt; {\"id\":1,\"name\":\"Alice\",\"age\":25}\n\ncurl http://localhost:3000/api/users/999\n# =&gt; {\"error\":\"User not found\"}\n</code></pre></p>"},{"location":"ja/tutorial/06-web-api/#post","title":"POST: \u30c7\u30fc\u30bf\u4f5c\u6210","text":"<pre><code>(def users (atom []))\n\n(defn create-user [req]\n  (let [body (get req :body)\n        user (json/parse body)]\n    (if (error? user)\n      (server/response 400 {:error \"Invalid JSON\"})\n      (do\n        (swap! users conj user)\n        (server/response 201 {:message \"User created\" :user user})))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/users\"] -&gt; (server/json {:users @users})\n    [\"POST\" \"/api/users\"] -&gt; (create-user req)\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>\u30c6\u30b9\u30c8: <pre><code>curl -X POST http://localhost:3000/api/users \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"Alice\",\"age\":25}'\n# =&gt; {\"message\":\"User created\",\"user\":{\"name\":\"Alice\",\"age\":25}}\n</code></pre></p>"},{"location":"ja/tutorial/06-web-api/#_6","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>Railway Pipeline\u3092\u4f7f\u3063\u3066\u3001\u30a8\u30e9\u30fc\u3092\u512a\u96c5\u306b\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>(defn parse-body [req]\n  (let [body (get req :body)]\n    (if (nil? body)\n      {:error \"No body\"}\n      (json/parse body))))\n\n(defn validate-user [user]\n  (if (error? user)\n    user\n    (match user\n      {:name n :age a} when (and (string? n) (number? a)) -&gt; user\n      _ -&gt; {:error \"Invalid user data\"})))\n\n(defn save-user [user]\n  (if (error? user)\n    user\n    (do\n      (swap! users conj user)\n      user)))\n\n(defn create-user [req]\n  (let [result (req\n                |&gt; parse-body\n                |&gt;? validate-user\n                |&gt;? save-user)]\n    (if (error? result)\n      (server/response 400 result)\n      (server/response 201 {:message \"User created\" :user result}))))\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#crud-api","title":"\u5b9f\u7528\u4f8b: CRUD API","text":"<p>\u5b8c\u5168\u306aCRUD\uff08Create, Read, Update, Delete\uff09API\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>(def users (atom {}))\n(def next-id (atom 1))\n\n; Create\n(defn create-user [req]\n  (req\n   |&gt; (get :body)\n   |&gt; json/parse\n   |&gt;? (fn [user]\n         (let [id @next-id\n               new-user (assoc user :id id)]\n           (do\n             (swap! next-id inc)\n             (swap! users assoc id new-user)\n             new-user)))\n   |&gt; (fn [result]\n        (if (error? result)\n          (server/response 400 result)\n          (server/response 201 result)))))\n\n; Read (all)\n(defn list-users [req]\n  (server/json {:users (vals @users)}))\n\n; Read (one)\n(defn get-user [req id]\n  (let [user (get @users id)]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (server/json user))))\n\n; Update\n(defn update-user [req id]\n  (let [user (get @users id)]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (req\n       |&gt; (get :body)\n       |&gt; json/parse\n       |&gt;? (fn [updates]\n             (let [updated (merge user updates)]\n               (do\n                 (swap! users assoc id updated)\n                 updated)))\n       |&gt; (fn [result]\n            (if (error? result)\n              (server/response 400 result)\n              (server/json result)))))))\n\n; Delete\n(defn delete-user [req id]\n  (let [user (get @users id)]\n    (if (nil? user)\n      (server/response 404 {:error \"User not found\"})\n      (do\n        (swap! users dissoc id)\n        (server/response 204 nil)))))\n\n; \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/users\"] -&gt; (list-users req)\n    [\"POST\" \"/api/users\"] -&gt; (create-user req)\n    [\"GET\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/users/\" \"\"))]\n        (get-user req id))\n    [\"PUT\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/users/\" \"\"))]\n        (update-user req id))\n    [\"DELETE\" path] when (str/starts-with? path \"/api/users/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/users/\" \"\"))]\n        (delete-user req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>\u30c6\u30b9\u30c8: <pre><code># Create\ncurl -X POST http://localhost:3000/api/users \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"Alice\",\"age\":25}'\n\n# Read all\ncurl http://localhost:3000/api/users\n\n# Read one\ncurl http://localhost:3000/api/users/1\n\n# Update\ncurl -X PUT http://localhost:3000/api/users/1 \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"age\":26}'\n\n# Delete\ncurl -X DELETE http://localhost:3000/api/users/1\n</code></pre></p>"},{"location":"ja/tutorial/06-web-api/#_7","title":"\u30df\u30c9\u30eb\u30a6\u30a7\u30a2","text":"<p>\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u524d\u51e6\u7406\u30fb\u5f8c\u51e6\u7406\u3092\u884c\u3046\u95a2\u6570\u3067\u3059\u3002</p>"},{"location":"ja/tutorial/06-web-api/#_8","title":"\u30ed\u30b0\u30df\u30c9\u30eb\u30a6\u30a7\u30a2","text":"<pre><code>(defn logger [handler]\n  (fn [req]\n    (do\n      (println f\"{(get req :method)} {(get req :path)}\")\n      (let [resp (handler req)]\n        (do\n          (println f\"  -&gt; {(get resp :status)}\")\n          resp)))))\n\n(defn my-handler [req]\n  (server/text \"Hello\"))\n\n(def app (logger my-handler))\n\n(server/serve app {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#cors","title":"CORS\u30df\u30c9\u30eb\u30a6\u30a7\u30a2","text":"<pre><code>(defn cors [handler]\n  (fn [req]\n    (let [resp (handler req)]\n      (assoc resp :headers\n        (merge (get resp :headers)\n               {:access-control-allow-origin \"*\"\n                :access-control-allow-methods \"GET, POST, PUT, DELETE\"})))))\n\n(def app (cors my-handler))\n\n(server/serve app {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#_9","title":"\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u5408\u6210","text":"<pre><code>(def app\n  (-&gt; my-handler\n      logger\n      cors))\n\n(server/serve app {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#jwt","title":"\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\uff08JWT\uff09","text":"<p>JWT\uff08JSON Web Token\uff09\u3092\u4f7f\u3063\u305f\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <pre><code>;; Authorization\u30d8\u30c3\u30c0\u30fc\u304b\u3089\u30c8\u30fc\u30af\u30f3\u3092\u62bd\u51fa\n(defn extract-auth-token [request]\n  (let [auth-header (get-in request [:headers :authorization])]\n    (if (nil? auth-header)\n      nil\n      (if (string/starts-with? auth-header \"Bearer \")\n        (string/replace-first auth-header \"Bearer \" \"\")\n        nil))))\n\n;; \u8a8d\u8a3c\u304c\u5fc5\u8981\u306a\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u7528\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\n(defn require-auth [handler]\n  (fn [request]\n    (let [token (extract-auth-token request)]\n      (if (nil? token)\n        {:status 401\n         :headers {:content-type \"application/json\"}\n         :body (json/stringify {:error \"Missing authorization token\"})}\n        (match (jwt/verify token \"my-secret-key\")\n          {:error _} -&gt; {:status 401\n                        :headers {:content-type \"application/json\"}\n                        :body (json/stringify {:error \"Invalid token\"})}\n          payload -&gt; (handler (assoc request :user payload)))))))\n\n;; \u4fdd\u8b77\u3055\u308c\u305f\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n(defn handle-profile [request]\n  (let [user (get request :user)]\n    (server/json {:user user :message \"This is a protected resource\"})))\n\n;; \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"POST\" \"/api/login\"] -&gt; (handle-login req)\n    [\"GET\" \"/api/profile\"] -&gt; ((require-auth handle-profile) req)\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre> <p>\u8a8d\u8a3c\u30d5\u30ed\u30fc\u306e\u4f8b: <pre><code># 1. \u30ed\u30b0\u30a4\u30f3\u3057\u3066\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\ncurl -X POST http://localhost:3000/api/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"username\":\"alice\",\"password\":\"secret123\"}'\n# =&gt; {\"token\":\"eyJ0eXAi...\"}\n\n# 2. \u30c8\u30fc\u30af\u30f3\u3092\u4f7f\u3063\u3066\u4fdd\u8b77\u3055\u308c\u305f\u30ea\u30bd\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\ncurl http://localhost:3000/api/profile \\\n  -H \"Authorization: Bearer eyJ0eXAi...\"\n# =&gt; {\"user\":{\"user_id\":1,\"username\":\"alice\"},\"message\":\"This is a protected resource\"}\n\n# 3. \u30c8\u30fc\u30af\u30f3\u306a\u3057\u3067\u30a2\u30af\u30bb\u30b9\uff08401\u30a8\u30e9\u30fc\uff09\ncurl http://localhost:3000/api/profile\n# =&gt; {\"error\":\"Missing authorization token\"}\n</code></pre></p> <p>\u8a73\u7d30\u306a\u5b9f\u88c5\u4f8b: <code>examples/17-jwt-auth.qi</code> \u304a\u3088\u3073 <code>examples/19-auth-api.qi</code> \u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"ja/tutorial/06-web-api/#api","title":"\u5b9f\u7528\u4f8b: \u30b7\u30f3\u30d7\u30eb\u306a\u30d6\u30ed\u30b0API","text":"<pre><code>(def posts (atom {}))\n(def next-id (atom 1))\n\n(defn create-post [req]\n  (req\n   |&gt; (get :body)\n   |&gt; json/parse\n   |&gt;? (fn [post]\n         (let [id @next-id\n               new-post (assoc post :id id :created-at (now))]\n           (do\n             (swap! next-id inc)\n             (swap! posts assoc id new-post)\n             new-post)))\n   |&gt; (fn [result]\n        (if (error? result)\n          (server/response 400 result)\n          (server/response 201 result)))))\n\n(defn list-posts [req]\n  (server/json {:posts (vals @posts)}))\n\n(defn get-post [req id]\n  (let [post (get @posts id)]\n    (if (nil? post)\n      (server/response 404 {:error \"Post not found\"})\n      (server/json post))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/posts\"] -&gt; (list-posts req)\n    [\"POST\" \"/api/posts\"] -&gt; (create-post req)\n    [\"GET\" path] when (str/starts-with? path \"/api/posts/\") -&gt;\n      (let [id (string/to-int (str/replace path \"/api/posts/\" \"\"))]\n        (get-post req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve (logger (cors handler)) {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#_10","title":"\u7df4\u7fd2\u554f\u984c","text":""},{"location":"ja/tutorial/06-web-api/#1-api","title":"\u554f\u984c1: \u30b7\u30f3\u30d7\u30eb\u306a\u30ab\u30a6\u30f3\u30bf\u30fcAPI","text":"<p>\u30a2\u30af\u30bb\u30b9\u30ab\u30a6\u30f3\u30bf\u30fcAPI\u3092\u4f5c\u3063\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>; GET /api/count - \u73fe\u5728\u306e\u30ab\u30a6\u30f3\u30c8\u3092\u8fd4\u3059\n; POST /api/count/increment - \u30ab\u30a6\u30f3\u30c8\u30921\u5897\u3084\u3059\n; POST /api/count/reset - \u30ab\u30a6\u30f3\u30c8\u30920\u306b\u30ea\u30bb\u30c3\u30c8\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(def count (atom 0))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/count\"] -&gt; (server/json {:count @count})\n    [\"POST\" \"/api/count/increment\"] -&gt;\n      (do\n        (swap! count inc)\n        (server/json {:count @count}))\n    [\"POST\" \"/api/count/reset\"] -&gt;\n      (do\n        (reset! count 0)\n        (server/json {:count @count}))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#2-todo-api","title":"\u554f\u984c2: ToDo API","text":"<p>\u30b7\u30f3\u30d7\u30eb\u306aToDo API\u3092\u4f5c\u3063\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>; GET /api/todos - \u5168\u3066\u306eToDo\u3092\u53d6\u5f97\n; POST /api/todos - \u65b0\u3057\u3044ToDo\u3092\u4f5c\u6210\n; PUT /api/todos/:id/complete - ToDo\u3092\u5b8c\u4e86\u306b\u3059\u308b\n</code></pre> \u89e3\u7b54\u4f8b <pre><code>(def todos (atom {}))\n(def next-id (atom 1))\n\n(defn create-todo [req]\n  (let [body (json/parse (get req :body))\n        id @next-id\n        todo {:id id :title (get body :title) :completed false}]\n    (do\n      (swap! next-id inc)\n      (swap! todos assoc id todo)\n      (server/response 201 todo))))\n\n(defn complete-todo [req id]\n  (let [todo (get @todos id)]\n    (if (nil? todo)\n      (server/response 404 {:error \"Todo not found\"})\n      (let [updated (assoc todo :completed true)]\n        (do\n          (swap! todos assoc id updated)\n          (server/json updated))))))\n\n(defn handler [req]\n  (match [(get req :method) (get req :path)]\n    [\"GET\" \"/api/todos\"] -&gt; (server/json {:todos (vals @todos)})\n    [\"POST\" \"/api/todos\"] -&gt; (create-todo req)\n    [\"PUT\" path] when (str/starts-with? path \"/api/todos/\") -&gt;\n      (let [parts (str/split path \"/\")\n            id (string/to-int (nth parts 3))]\n        (complete-todo req id))\n    _ -&gt; (server/response 404 \"Not Found\")))\n\n(server/serve handler {:port 3000})\n</code></pre>"},{"location":"ja/tutorial/06-web-api/#_11","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068\uff1a</p> <ul> <li>\u2705 HTTP\u30b5\u30fc\u30d0\u30fc\u306e\u57fa\u672c</li> <li>\u2705 \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u51e6\u7406</li> <li>\u2705 JSON API\u306e\u69cb\u7bc9</li> <li>\u2705 CRUD\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u5b9f\u88c5</li> <li>\u2705 \u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u30d1\u30bf\u30fc\u30f3</li> <li>\u2705 JWT\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2</li> <li>\u2705 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> </ul>"},{"location":"ja/tutorial/06-web-api/#_12","title":"\ud83c\udf89 \u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u5b8c\u4e86\uff01","text":"<p>\u304a\u75b2\u308c\u3055\u307e\u3067\u3057\u305f\uff01\u3053\u308c\u3067Qi\u306e\u4e3b\u8981\u6a5f\u80fd\u3092\u5168\u3066\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"ja/tutorial/06-web-api/#_13","title":"\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>\u2705 \u57fa\u672c\u69cb\u6587\u3068\u30c7\u30fc\u30bf\u578b</li> <li>\u2705 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50</li> <li>\u2705 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</li> <li>\u2705 \u30a8\u30e9\u30fc\u51e6\u7406\uff08Railway Pipeline\uff09</li> <li>\u2705 \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>\u2705 Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068API</li> </ol>"},{"location":"ja/tutorial/06-web-api/#_14","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ol> <li>\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u59cb\u3081\u308b</li> <li>\u5c0f\u3055\u306aCLI\u30c4\u30fc\u30eb</li> <li>Web API</li> <li> <p>\u30c7\u30fc\u30bf\u51e6\u7406\u30b9\u30af\u30ea\u30d7\u30c8</p> </li> <li> <p>examples/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u898b\u308b</p> </li> <li>\u5b9f\u8df5\u7684\u306a\u30b3\u30fc\u30c9\u4f8b</li> <li> <p>\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9</p> </li> <li> <p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u6df1\u304f\u5b66\u3076</p> </li> <li>\u5b8c\u5168\u306a\u8a00\u8a9e\u4ed5\u69d8</li> <li> <p>\u95a2\u6570\u7d22\u5f15</p> </li> <li> <p>\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306b\u53c2\u52a0\u3059\u308b</p> </li> <li>GitHub Issues</li> <li>Discussions</li> </ol> <p>Happy coding with Qi! \ud83d\ude80</p>"},{"location":"ja/tutorial/openapi-tutorial/","title":"OpenAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","text":"<p>\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001Qi\u306e<code>std/lib/openapi.qi</code>\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3001OpenAPI\u4ed5\u69d8\u3092\u81ea\u52d5\u751f\u6210\u3059\u308bREST API\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/openapi-tutorial/#_1","title":"\u524d\u63d0\u6761\u4ef6","text":"<ul> <li>Qi\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068</li> <li>HTTP\u30b5\u30fc\u30d0\u30fc\u306e\u57fa\u672c\u7684\u306a\u77e5\u8b58</li> <li>REST API\u306e\u57fa\u672c\u7684\u306a\u77e5\u8b58</li> </ul>"},{"location":"ja/tutorial/openapi-tutorial/#1-api","title":"\u30b9\u30c6\u30c3\u30d71: \u30b7\u30f3\u30d7\u30eb\u306aAPI\u30b5\u30fc\u30d0\u30fc\u306e\u4f5c\u6210","text":"<p>\u307e\u305a\u3001OpenAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u308f\u306a\u3044\u901a\u5e38\u306eAPI\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>;; simple-api.qi\n\n;; \u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u53d6\u5f97\n(defn api-get-users [req]\n  (server/json {:users [{:id 1 :name \"Alice\"} {:id 2 :name \"Bob\"}]}))\n\n;; \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n(defn api-create-user [req]\n  (let [body (json/parse (get req :body))]\n    (server/json {:success true :user body} 201)))\n\n;; \u30eb\u30fc\u30bf\u30fc\n(defn router [req]\n  (match [(get req :method) (get req :path)]\n    [:get \"/api/users\"] -&gt; (api-get-users req)\n    [:post \"/api/users\"] -&gt; (api-create-user req)\n    _ -&gt; (server/json {:error \"Not Found\"} 404)))\n\n;; \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\n(server/serve router {:port 3000})\n(println \"Server started on http://localhost:3000\")\n</code></pre> <p>\u3053\u308c\u306f\u52d5\u4f5c\u3057\u307e\u3059\u304c\u3001API\u4ed5\u69d8\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u3042\u308a\u307e\u305b\u3093\u3002</p>"},{"location":"ja/tutorial/openapi-tutorial/#2-openapi","title":"\u30b9\u30c6\u30c3\u30d72: OpenAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5c0e\u5165","text":"<p>OpenAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3001\u540c\u3058API\u306b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>;; openapi-demo.qi\n\n;; OpenAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\uff08\u30b7\u30f3\u30d7\u30eb\u306a\u30a4\u30f3\u30dd\u30fc\u30c8\uff09\n(use \"openapi\" :as openapi)\n\n;; ========================================\n;; API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u5b9a\u7fa9\uff08OpenAPI\u5bfe\u5fdc\uff09\n;; ========================================\n\n;; \u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u53d6\u5f97\n(openapi/defapi :get \"/api/users\"\n  {:summary \"\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u53d6\u5f97\"\n   :tags [\"users\"]\n   :responses {\n     200 {:description \"\u6210\u529f\"\n          :content {\"application/json\" {\n            :schema {\n              :type \"object\"\n              :properties {\n                \"users\" {\n                  :type \"array\"\n                  :items {\n                    :type \"object\"\n                    :properties {\n                      \"id\" {:type \"integer\"}\n                      \"name\" {:type \"string\"}}}}}}}}}}}\n  api-get-users\n\n  (server/json {:users [{:id 1 :name \"Alice\"} {:id 2 :name \"Bob\"}]}))\n\n;; \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n(openapi/defapi :post \"/api/users\"\n  {:summary \"\u65b0\u3057\u3044\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\"\n   :tags [\"users\"]\n   :requestBody {\n     :required true\n     :content {\"application/json\" {\n       :schema {\n         :type \"object\"\n         :properties {\n           \"name\" {:type \"string\"}\n           \"email\" {:type \"string\" :format \"email\"}}\n         :required [\"name\" \"email\"]}}}}\n   :responses {\n     201 {:description \"\u4f5c\u6210\u6210\u529f\"}\n     400 {:description \"\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u4e0d\u6b63\"}}}\n  api-create-user\n\n  (let [body (json/parse (get req :body))]\n    (server/json {:success true :user body} 201)))\n\n;; ========================================\n;; \u30eb\u30fc\u30bf\u30fc\u8a2d\u5b9a\n;; ========================================\n\n;; API\u30eb\u30fc\u30bf\u30fc\n(defn api-router [req]\n  (match [(get req :method) (get req :path)]\n    [:get \"/api/users\"] -&gt; (api-get-users req)\n    [:post \"/api/users\"] -&gt; (api-create-user req)\n    _ -&gt; (server/json {:error \"Not Found\"} 404)))\n\n;; Swagger\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u7d71\u5408\n(def router\n  (openapi/with-swagger\n    api-router\n    {:title \"User Management API\"\n     :version \"1.0.0\"\n     :description \"\u30e6\u30fc\u30b6\u30fc\u7ba1\u7406\u306e\u305f\u3081\u306eREST API\"}))\n\n;; \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\n(server/serve router {:port 3000})\n(println \"Server started on http://localhost:3000\")\n(println \"Swagger JSON: http://localhost:3000/api/swagger.json\")\n</code></pre>"},{"location":"ja/tutorial/openapi-tutorial/#3","title":"\u30b9\u30c6\u30c3\u30d73: \u52d5\u4f5c\u78ba\u8a8d","text":"<p>\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u307e\u3059\uff1a</p> <pre><code>QI_LANG=ja qi openapi-demo.qi\n</code></pre> <p>Swagger JSON \u3092\u53d6\u5f97\uff1a</p> <pre><code>curl http://localhost:3000/api/swagger.json | jq .\n</code></pre> <p>\u51fa\u529b\u4f8b\uff1a</p> <pre><code>{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"User Management API\",\n    \"version\": \"1.0.0\",\n    \"description\": \"\u30e6\u30fc\u30b6\u30fc\u7ba1\u7406\u306e\u305f\u3081\u306eREST API\"\n  },\n  \"paths\": {\n    \"/api/users\": {\n      \"get\": {\n        \"summary\": \"\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u53d6\u5f97\",\n        \"tags\": [\"users\"],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"\u6210\u529f\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {...}\n              }\n            }\n          }\n        }\n      },\n      \"post\": {\n        \"summary\": \"\u65b0\u3057\u3044\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\",\n        \"tags\": [\"users\"],\n        \"requestBody\": {...},\n        \"responses\": {...}\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"ja/tutorial/openapi-tutorial/#4","title":"\u30b9\u30c6\u30c3\u30d74: \u30d1\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8ffd\u52a0","text":"<p>\u500b\u5225\u30e6\u30fc\u30b6\u30fc\u53d6\u5f97\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97\n(openapi/defapi :get \"/api/users/{id}\"\n  {:summary \"\u7279\u5b9a\u306e\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u53d6\u5f97\"\n   :tags [\"users\"]\n   :parameters [{\n     :name \"id\"\n     :in \"path\"\n     :required true\n     :description \"\u30e6\u30fc\u30b6\u30fcID\"\n     :schema {:type \"integer\"}}]\n   :responses {\n     200 {:description \"\u6210\u529f\"\n          :content {\"application/json\" {\n            :schema {\n              :type \"object\"\n              :properties {\n                \"user\" {\n                  :type \"object\"\n                  :properties {\n                    \"id\" {:type \"integer\"}\n                    \"name\" {:type \"string\"}\n                    \"email\" {:type \"string\"}}}}}}}}\n     404 {:description \"\u30e6\u30fc\u30b6\u30fc\u304c\u898b\u3064\u304b\u3089\u306a\u3044\"}}}\n  api-get-user\n\n  (let [id-str (last (str/split (get req :path) \"/\"))\n        id (to-int id-str)]\n    (if (= id 1)\n      (server/json {:user {:id 1 :name \"Alice\" :email \"alice@example.com\"}})\n      (server/json {:error \"User not found\"} 404))))\n\n;; \u30eb\u30fc\u30bf\u30fc\u3092\u66f4\u65b0\n(defn api-router [req]\n  (let [path (get req :path)]\n    (match [(get req :method) path]\n      [:get \"/api/users\"] -&gt; (api-get-users req)\n      [:post \"/api/users\"] -&gt; (api-create-user req)\n      [:get (re-matches #\"/api/users/\\d+\" _)] -&gt; (api-get-user req)\n      _ -&gt; (server/json {:error \"Not Found\"} 404))))\n</code></pre> <p>\u30c6\u30b9\u30c8\uff1a</p> <pre><code>curl http://localhost:3000/api/users/1 | jq .\n</code></pre>"},{"location":"ja/tutorial/openapi-tutorial/#5","title":"\u30b9\u30c6\u30c3\u30d75: \u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8ffd\u52a0","text":"<p>\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u53d6\u5f97\u306b\u30da\u30fc\u30b8\u30cd\u30fc\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>(openapi/defapi :get \"/api/users\"\n  {:summary \"\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u53d6\u5f97\uff08\u30da\u30fc\u30b8\u30cd\u30fc\u30b7\u30e7\u30f3\u5bfe\u5fdc\uff09\"\n   :tags [\"users\"]\n   :parameters [\n     {:name \"limit\"\n      :in \"query\"\n      :required false\n      :description \"\u53d6\u5f97\u4ef6\u6570\"\n      :schema {:type \"integer\" :default 10 :minimum 1 :maximum 100}}\n     {:name \"offset\"\n      :in \"query\"\n      :required false\n      :description \"\u30aa\u30d5\u30bb\u30c3\u30c8\"\n      :schema {:type \"integer\" :default 0 :minimum 0}}]\n   :responses {\n     200 {:description \"\u6210\u529f\"}}}\n  api-get-users\n\n  (let [query-params (parse-query-string (get req :query))\n        limit (or (to-int (get query-params \"limit\")) 10)\n        offset (or (to-int (get query-params \"offset\")) 0)]\n    (server/json\n      {:users [{:id 1 :name \"Alice\"} {:id 2 :name \"Bob\"}]\n       :limit limit\n       :offset offset})))\n</code></pre> <p>\u30c6\u30b9\u30c8\uff1a</p> <pre><code>curl \"http://localhost:3000/api/users?limit=5&amp;offset=10\" | jq .\n</code></pre>"},{"location":"ja/tutorial/openapi-tutorial/#6","title":"\u30b9\u30c6\u30c3\u30d76: \u8a8d\u8a3c\u30d8\u30c3\u30c0\u30fc\u306e\u8ffd\u52a0","text":"<p>\u8a8d\u8a3c\u304c\u5fc5\u8981\u306a\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>(openapi/defapi :delete \"/api/users/{id}\"\n  {:summary \"\u30e6\u30fc\u30b6\u30fc\u3092\u524a\u9664\"\n   :tags [\"users\"]\n   :parameters [\n     {:name \"id\"\n      :in \"path\"\n      :required true\n      :schema {:type \"integer\"}}\n     {:name \"Authorization\"\n      :in \"header\"\n      :required true\n      :description \"Bearer \u30c8\u30fc\u30af\u30f3\"\n      :schema {:type \"string\"}}]\n   :responses {\n     204 {:description \"\u524a\u9664\u6210\u529f\"}\n     401 {:description \"\u8a8d\u8a3c\u304c\u5fc5\u8981\"}\n     404 {:description \"\u30e6\u30fc\u30b6\u30fc\u304c\u898b\u3064\u304b\u3089\u306a\u3044\"}}}\n  api-delete-user\n\n  (let [auth (get (get req :headers) \"authorization\")]\n    (if (and auth (str/starts-with? auth \"Bearer \"))\n      (server/json {} 204)\n      (server/json {:error \"Unauthorized\"} 401))))\n</code></pre> <p>\u30c6\u30b9\u30c8\uff1a</p> <pre><code># \u8a8d\u8a3c\u306a\u3057\uff08\u30a8\u30e9\u30fc\uff09\ncurl -X DELETE http://localhost:3000/api/users/1\n\n# \u8a8d\u8a3c\u3042\u308a\uff08\u6210\u529f\uff09\ncurl -X DELETE http://localhost:3000/api/users/1 \\\n  -H \"Authorization: Bearer token123\"\n</code></pre>"},{"location":"ja/tutorial/openapi-tutorial/#7","title":"\u30b9\u30c6\u30c3\u30d77: \u30b9\u30ad\u30fc\u30de\u306e\u518d\u5229\u7528","text":"<p>\u5171\u901a\u306e\u30b9\u30ad\u30fc\u30de\u3092\u5b9a\u7fa9\u3057\u3066\u518d\u5229\u7528\u3057\u307e\u3059\u3002</p> <pre><code>;; \u5171\u901a\u30b9\u30ad\u30fc\u30de\u5b9a\u7fa9\n(def user-schema\n  {:type \"object\"\n   :properties {\n     \"id\" {:type \"integer\"}\n     \"name\" {:type \"string\"}\n     \"email\" {:type \"string\" :format \"email\"}\n     \"created_at\" {:type \"string\" :format \"date-time\"}}})\n\n(def error-schema\n  {:type \"object\"\n   :properties {\n     \"error\" {:type \"string\"}\n     \"message\" {:type \"string\"}}})\n\n;; \u30b9\u30ad\u30fc\u30de\u3092\u4f7f\u7528\n(openapi/defapi :get \"/api/users/{id}\"\n  {:summary \"\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97\"\n   :responses {\n     200 {:description \"\u6210\u529f\"\n          :content {\"application/json\" {:schema user-schema}}}\n     404 {:description \"Not Found\"\n          :content {\"application/json\" {:schema error-schema}}}}}\n  api-get-user\n  ...)\n</code></pre>"},{"location":"ja/tutorial/openapi-tutorial/#8-swagger-ui","title":"\u30b9\u30c6\u30c3\u30d78: Swagger UI\u306e\u7d71\u5408","text":"<p>Swagger UI\u3092\u4f7f\u3063\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u3067API\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8868\u793a\u3057\u307e\u3059\u3002</p> <pre><code>&lt;!-- static/swagger-ui.html --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;API Documentation&lt;/title&gt;\n  &lt;link rel=\"stylesheet\" href=\"https://unpkg.com/swagger-ui-dist@5/swagger-ui.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;div id=\"swagger-ui\"&gt;&lt;/div&gt;\n  &lt;script src=\"https://unpkg.com/swagger-ui-dist@5/swagger-ui-bundle.js\"&gt;&lt;/script&gt;\n  &lt;script&gt;\n    SwaggerUIBundle({\n      url: '/api/swagger.json',\n      dom_id: '#swagger-ui',\n    })\n  &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u30eb\u30fc\u30bf\u30fc\u306b\u8ffd\u52a0\uff1a</p> <pre><code>(defn router [req]\n  (let [path (get req :path)]\n    (cond\n      ;; Swagger JSON\n      (= path \"/api/swagger.json\")\n        ((openapi/swagger-endpoint api-info) req)\n\n      ;; Swagger UI\n      (= path \"/docs\")\n        {:status 200\n         :headers {\"Content-Type\" \"text/html\"}\n         :body (slurp \"static/swagger-ui.html\")}\n\n      ;; API endpoints\n      (str/starts-with? path \"/api/\")\n        (api-router req)\n\n      :else\n        (server/json {:error \"Not Found\"} 404))))\n</code></pre> <p>\u30d6\u30e9\u30a6\u30b6\u3067<code>http://localhost:3000/docs</code>\u3092\u958b\u304f\u3068\u3001Swagger UI\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"ja/tutorial/openapi-tutorial/#_2","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>OpenAPI Library Reference</li> <li>HTTP Server Documentation</li> <li>Database Integration</li> </ul>"},{"location":"ja/tutorial/openapi-tutorial/#_3","title":"\u307e\u3068\u3081","text":"<p>\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\uff1a</p> <ol> <li>OpenAPI\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9</li> <li><code>defapi</code>\u30de\u30af\u30ed\u3067\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u5b9a\u7fa9</li> <li>\u30d1\u30b9\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5b9a\u7fa9</li> <li>\u8a8d\u8a3c\u30d8\u30c3\u30c0\u30fc\u306e\u8ffd\u52a0</li> <li>\u30b9\u30ad\u30fc\u30de\u306e\u518d\u5229\u7528</li> <li>Swagger UI\u3068\u306e\u7d71\u5408</li> </ol> <p>\u3092\u5b66\u3073\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u3001OpenAPI\u4ed5\u69d8\u3092\u81ea\u52d5\u751f\u6210\u3059\u308bREST API\u3092\u69cb\u7bc9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002</p>"},{"location":"ja/spec/VALIDATION_REPORT/","title":"Qi\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u691c\u8a3c\u30ec\u30dd\u30fc\u30c8","text":"<p>\u691c\u8a3c\u65e5: 2025-11-15 \u5bfe\u8c61: docs/ja/spec/ \u914d\u4e0b\u306eMarkdown\u30d5\u30a1\u30a4\u30eb</p>"},{"location":"ja/spec/VALIDATION_REPORT/#_1","title":"\u691c\u8a3c\u7d50\u679c\u30b5\u30de\u30ea\u30fc","text":""},{"location":"ja/spec/VALIDATION_REPORT/#5","title":"\u512a\u51485\u30d5\u30a1\u30a4\u30eb\u306e\u691c\u8a3c\u7d50\u679c","text":"\u30d5\u30a1\u30a4\u30eb \u30b3\u30fc\u30c9\u4f8b\u6570 \u6210\u529f \u30a8\u30e9\u30fc \u6210\u529f\u7387 02-flow-pipes.md 17 5 12 29.4% 03-concurrency.md 22 18 4 81.8% 04-match.md 14 1 13 7.1% 05-syntax-basics.md 41 25 16 61.0% 10-stdlib-string.md 20 16 4 80.0% \u5408\u8a08 114 65 49 57.0%"},{"location":"ja/spec/VALIDATION_REPORT/#_2","title":"\u4fee\u6b63\u3057\u305f\u30d0\u30b0","text":""},{"location":"ja/spec/VALIDATION_REPORT/#1-goselect","title":"1. \u2705 <code>go/select!</code> \u69cb\u6587\u306e\u8aa4\u308a","text":"<p>\u554f\u984c: \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u305f\u69cb\u6587\u304c\u5b9f\u88c5\u3068\u7570\u306a\u3063\u3066\u3044\u305f</p> <p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u8aa4\u3063\u305f\u8a18\u8f09: <pre><code>(go/select!\n  ch1 (fn [val] ...)\n  ch2 (fn [val] ...))\n</code></pre></p> <p>\u6b63\u3057\u3044\u69cb\u6587: <pre><code>(go/select! [\n  [ch1 (fn [val] ...)]\n  [ch2 (fn [val] ...)]])\n</code></pre></p> <p>\u4fee\u6b63\u7b87\u6240: <code>03-concurrency.md:83</code></p>"},{"location":"ja/spec/VALIDATION_REPORT/#2","title":"2. \u2705 \u30ad\u30fc\u30ef\u30fc\u30c9\u95a2\u6570\u30a2\u30af\u30bb\u30b9\u306e\u8aa4\u308a","text":"<p>\u554f\u984c: Clojure\u98a8\u306e\u30ad\u30fc\u30ef\u30fc\u30c9\u95a2\u6570\u30a2\u30af\u30bb\u30b9 <code>(:key map)</code> \u304c\u672a\u5b9f\u88c5</p> <p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u8aa4\u3063\u305f\u8a18\u8f09: <pre><code>(get user :name)  ;; =&gt; \"Bob\"\n</code></pre></p> <p>\u6b63\u3057\u3044\u69cb\u6587: <pre><code>(get user :name)  ;; =&gt; \"Bob\"\n</code></pre></p> <p>\u4fee\u6b63\u7b87\u6240: - <code>05-syntax-basics.md:125</code> - <code>05-syntax-basics.md:87</code> (f-string\u5185\u306e\u30de\u30c3\u30d7\u30a2\u30af\u30bb\u30b9)</p>"},{"location":"ja/spec/VALIDATION_REPORT/#3-set","title":"3. \u2705 Set\u69cb\u6587 <code>#{}</code> \u306e\u524a\u9664","text":"<p>\u554f\u984c: Set\u578b\u306e\u30ea\u30c6\u30e9\u30eb\u69cb\u6587\u304c\u672a\u5b9f\u88c5</p> <p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u8aa4\u3063\u305f\u8a18\u8f09: <pre><code>(def clients (atom #{}))\n</code></pre></p> <p>\u4fee\u6b63\u5f8c: <pre><code>(def clients (atom []))  ;; \u30d9\u30af\u30bf\u30fc\u3092\u4f7f\u7528\n</code></pre></p> <p>\u4fee\u6b63\u7b87\u6240: <code>03-concurrency.md:311</code></p>"},{"location":"ja/spec/VALIDATION_REPORT/#4-","title":"4. \u2705 \u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed <code>-&gt;</code> \u306e\u524a\u9664","text":"<p>\u554f\u984c: Clojure\u98a8\u306e\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed\u304c\u672a\u5b9f\u88c5</p> <p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u8aa4\u3063\u305f\u8a18\u8f09: <pre><code>(-&gt; (go/run (fn [] 10))\n    (go/then (fn [x] (* x 2)))\n    (go/await))\n</code></pre></p> <p>\u4fee\u6b63\u5f8c: <pre><code>(def p (go/run (fn [] 10)))\n(def p2 (go/then p (fn [x] (* x 2))))\n(go/await p2)\n</code></pre></p> <p>\u4fee\u6b63\u7b87\u6240: <code>03-concurrency.md:188</code></p>"},{"location":"ja/spec/VALIDATION_REPORT/#_3","title":"\u6b8b\u5b58\u3059\u308b\u554f\u984c","text":""},{"location":"ja/spec/VALIDATION_REPORT/#_4","title":"\u30a8\u30e9\u30fc\u5206\u985e","text":"\u30ab\u30c6\u30b4\u30ea \u4ef6\u6570 \u8aac\u660e \u672a\u5b9a\u7fa9\u5909\u6570 35 \u6982\u5ff5\u7684\u306a\u4f8b\u3067\u672a\u5b9a\u7fa9\u306e\u5909\u6570\u3092\u4f7f\u7528 \u5916\u90e8API 1 \u5b9f\u969b\u306b\u5b58\u5728\u3057\u306a\u3044API\u3078\u306e\u30a2\u30af\u30bb\u30b9 \u305d\u306e\u4ed6 13 \u305d\u306e\u4ed6\u306e\u69cb\u6587\u30a8\u30e9\u30fc\u3084\u672a\u5b9f\u88c5\u6a5f\u80fd"},{"location":"ja/spec/VALIDATION_REPORT/#_5","title":"\u5178\u578b\u7684\u306a\u672a\u5b9a\u7fa9\u5909\u6570\u306e\u4f8b","text":"<p>\u30d5\u30a1\u30a4\u30eb: <code>02-flow-pipes.md:28</code></p> <pre><code>;; \u57fa\u672c\n(data |&gt; parse |&gt; transform |&gt; save)\n</code></pre> <p>\u30a8\u30e9\u30fc: <code>\u672a\u5b9a\u7fa9\u306e\u5909\u6570: data, parse, transform, save</code></p> <p>\u554f\u984c: \u6982\u5ff5\u7684\u306a\u8aac\u660e\u306e\u305f\u3081\u306e\u64ec\u4f3c\u30b3\u30fc\u30c9</p> <p>\u63a8\u5968\u5bfe\u5fdc: 1. \u5b9f\u884c\u53ef\u80fd\u306a\u5b8c\u5168\u306a\u4f8b\u306b\u66f8\u304d\u63db\u3048\u308b 2. <code>(comment ...)</code> \u3067\u56f2\u3093\u3067\u5b9f\u884c\u4e0d\u53ef\u3067\u3042\u308b\u3053\u3068\u3092\u660e\u793a</p>"},{"location":"ja/spec/VALIDATION_REPORT/#api","title":"\u5916\u90e8API\u30a2\u30af\u30bb\u30b9\u306e\u4f8b","text":"<p>\u30d5\u30a1\u30a4\u30eb: <code>02-flow-pipes.md:153</code></p> <pre><code>(\"https://api.example.com/users/123\" |&gt; http/get ...)\n</code></pre> <p>\u30a8\u30e9\u30fc: <code>error sending request for url</code></p> <p>\u63a8\u5968\u5bfe\u5fdc: \u30e2\u30c3\u30af\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u305f\u4f8b\u306b\u5909\u66f4</p>"},{"location":"ja/spec/VALIDATION_REPORT/#_6","title":"\u4fee\u6b63\u5185\u5bb9\u306e\u691c\u8a3c","text":"<p>\u4fee\u6b63\u5f8c\u306e\u6210\u529f\u7387: 57.0% (65/114) \u4fee\u6b63\u524d\u306e\u6210\u529f\u7387: 52.6% (60/114) \u6539\u5584: +4.4% (5\u4ef6\u306e\u30d0\u30b0\u4fee\u6b63)</p>"},{"location":"ja/spec/VALIDATION_REPORT/#_7","title":"\u63a8\u5968\u3055\u308c\u308b\u8ffd\u52a0\u4f5c\u696d","text":""},{"location":"ja/spec/VALIDATION_REPORT/#_8","title":"\u512a\u5148\u5ea6: \u9ad8","text":"<ol> <li>\u672a\u5b9a\u7fa9\u5909\u6570\u306e\u4f8b\u3092\u5b9f\u884c\u53ef\u80fd\u306b\u3059\u308b</li> <li>02-flow-pipes.md: 12\u4ef6</li> <li>04-match.md: 13\u4ef6</li> <li> <p>05-syntax-basics.md: 10\u4ef6\u4ee5\u4e0a</p> </li> <li> <p>\u6982\u5ff5\u7684\u306a\u4f8b\u3068\u30b3\u30fc\u30c9\u4f8b\u306e\u5206\u96e2</p> </li> <li>\u6982\u5ff5\u8aac\u660e \u2192 \u30b3\u30e1\u30f3\u30c8 or \u5225\u30bb\u30af\u30b7\u30e7\u30f3</li> <li>\u30b3\u30fc\u30c9\u4f8b \u2192 \u5fc5\u305a\u5b9f\u884c\u53ef\u80fd\u306a\u5b8c\u5168\u306a\u4f8b</li> </ol>"},{"location":"ja/spec/VALIDATION_REPORT/#_9","title":"\u512a\u5148\u5ea6: \u4e2d","text":"<ol> <li>\u6b8b\u308a33\u30d5\u30a1\u30a4\u30eb\u306e\u691c\u8a3c</li> <li>06-data-structures.md</li> <li>07-functions.md</li> <li>08-error-handling.md</li> <li>09-modules.md</li> <li>11-stdlib-http.md</li> <li> <p>...\u7b49</p> </li> <li> <p>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u4f8b\u306e\u6539\u5584</p> </li> <li>try\u30d6\u30ed\u30c3\u30af\u306e\u4f7f\u7528\u4f8b\u3092\u5897\u3084\u3059</li> <li>\u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u306e\u51e6\u7406\u3092\u660e\u78ba\u306b\u3059\u308b</li> </ol>"},{"location":"ja/spec/VALIDATION_REPORT/#_10","title":"\u512a\u5148\u5ea6: \u4f4e","text":"<ol> <li>\u8868\u8a18\u306e\u7d71\u4e00</li> <li>\u30b3\u30e1\u30f3\u30c8\u5f62\u5f0f\u306e\u7d71\u4e00</li> <li>\u30a4\u30f3\u30c7\u30f3\u30c8\u306e\u7d71\u4e00</li> <li>\u51fa\u529b\u4f8b\u306e\u8a18\u8f09\u65b9\u6cd5\u306e\u7d71\u4e00</li> </ol>"},{"location":"ja/spec/VALIDATION_REPORT/#_11","title":"\u691c\u8a3c\u65b9\u6cd5","text":""},{"location":"ja/spec/VALIDATION_REPORT/#_12","title":"\u4f7f\u7528\u3057\u305f\u30c4\u30fc\u30eb","text":"<ul> <li>Python\u691c\u8a3c\u30b9\u30af\u30ea\u30d7\u30c8: <code>/tmp/verify_docs.py</code></li> <li>Qi\u30a4\u30f3\u30bf\u30fc\u30d7\u30ea\u30bf: <code>/Users/hiro/Projects/qi-lang/target/release/qi</code></li> </ul>"},{"location":"ja/spec/VALIDATION_REPORT/#_13","title":"\u691c\u8a3c\u624b\u9806","text":"<ol> <li>Markdown\u30d5\u30a1\u30a4\u30eb\u304b\u3089 <code>```qi</code> \u30d6\u30ed\u30c3\u30af\u3092\u62bd\u51fa</li> <li>\u30b3\u30e1\u30f3\u30c8\u3084REPL\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u9664\u53bb</li> <li>\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3057\u3066\u5b9f\u884c</li> <li>\u30a8\u30e9\u30fc\u3092\u5206\u985e\u30fb\u5206\u6790</li> </ol>"},{"location":"ja/spec/VALIDATION_REPORT/#_14","title":"\u30b9\u30ad\u30c3\u30d7\u3057\u305f\u4f8b","text":"<ul> <li><code>(comment ...)</code> \u30d6\u30ed\u30c3\u30af</li> <li>HTTP\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u30b3\u30fc\u30c9 (<code>http/listen</code>)</li> <li>\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u4f9d\u5b58 (<code>db/</code>, <code>kvs/</code>, <code>sql</code>)</li> </ul>"},{"location":"ja/spec/VALIDATION_REPORT/#_15","title":"\u4eca\u5f8c\u306e\u6539\u5584\u63d0\u6848","text":"<ol> <li>CI/CD\u3067\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u691c\u8a3c</li> <li>GitHub Actions\u3067\u30b3\u30fc\u30c9\u4f8b\u3092\u81ea\u52d5\u30c6\u30b9\u30c8</li> <li> <p>PR\u30de\u30fc\u30b8\u524d\u306b\u691c\u8a3c\u3092\u5fc5\u9808\u5316</p> </li> <li> <p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3</p> </li> <li>\u30b3\u30fc\u30c9\u4f8b\u306f\u5fc5\u305a\u5b9f\u884c\u53ef\u80fd\u306b\u3059\u308b</li> <li>\u6982\u5ff5\u7684\u306a\u4f8b\u306f <code>(comment ...)</code> \u3067\u56f2\u3080</li> <li> <p>\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u304c\u5fc5\u8981\u306a\u4f8b\u306f\u30e2\u30c3\u30af\u3092\u4f7f\u7528</p> </li> <li> <p>\u6a19\u6e96\u7684\u306a\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6574\u5099</p> </li> <li>\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb</li> <li>\u30e2\u30c3\u30afAPI</li> <li>\u30c6\u30b9\u30c8\u7528\u306e\u5171\u901a\u95a2\u6570</li> </ol>"},{"location":"ja/spec/VALIDATION_REPORT/#_16","title":"\u307e\u3068\u3081","text":"<ul> <li>\u2705 \u512a\u51485\u30d5\u30a1\u30a4\u30eb\u306e\u691c\u8a3c\u5b8c\u4e86</li> <li>\u2705 \u4e3b\u8981\u306a\u30d0\u30b04\u4ef6\u3092\u4fee\u6b63</li> <li>\u2705 \u6210\u529f\u7387\u309252.6% \u2192 57.0%\u306b\u6539\u5584</li> <li>\ud83d\udd04 \u6b8b\u5b58\u3059\u308b49\u4ef6\u306e\u30a8\u30e9\u30fc\u306f\u4e3b\u306b\u672a\u5b9a\u7fa9\u5909\u6570\uff08\u6982\u5ff5\u7684\u306a\u4f8b\uff09</li> <li>\ud83d\udcdd \u5b9f\u884c\u53ef\u80fd\u306a\u5b8c\u5168\u306a\u4f8b\u3078\u306e\u66f8\u304d\u63db\u3048\u3092\u63a8\u5968</li> </ul>"}]}